Project Path: arc_gmh5225_DiaSymbolView_vzjo1hl1

Source Tree:

```txt
arc_gmh5225_DiaSymbolView_vzjo1hl1
├── Compiling.md
├── DiaNodes.pas
├── DiaProperties.pas
├── DiaSymbolView.dpr
├── DiaSymbolView.dproj
├── DiaSymbolView.ico
├── LICENSE.txt
├── MainForm.dfm
├── MainForm.pas
├── NtUtilsUI
├── Readme.md
├── RegisterNames.pas
├── Settings.pas
└── TextHelpers.pas

```

`Compiling.md`:

```md
# Compiling Instructions

To compile the project, you can use the free [Community Edition of Embarcadero Delphi](https://www.embarcadero.com/products/delphi/starter). There are, however, some extra steps since the tool uses custom UI components which need to be registered in the IDE before it can open the project:

1. Clone the repository **and its submodule dependencies** using `git clone --recurse-submodules`. Alternatively, you can use `git submodule update --init --recursive` after cloning the repository.
2. Make sure there are files under the `.\NtUtilsUI\NtUtils` directory, otherwise, you didn't clone all submodules.
3. Install `VirtualTree for VCL` using the IDE menu `Tools` -> `GetIt Package Manager`.
![VirtualTree](https://user-images.githubusercontent.com/30962924/180660667-43aa9113-ccc6-4548-8a94-9f81ed84e8eb.png)
4. Open `.\NtUtilsUI\Components\VirtualTreesExtension.dproj` in the IDE and click `Install` on the project to register it as a design-time package.    
![Install](https://user-images.githubusercontent.com/30962924/180660721-50fe47dc-039d-40cf-a190-c99f91ac0e2d.png)
5. Similarly, open `.\NtUtilsUI\VclEx\VclExtension.dproj` and click `Install`.
6. You can now open the main `.dproj` file and build the project from there.

Optionally, if you also want to generate a debug symbols during compilation, you'll need [map2pdb](https://github.com/andersmelander/map2pdb), which can convert Delphi-generated `.map` into a `.pdb` and attach it to the compiled executable. The project is already configured for generating `*.map` files and using a post-build event for their conversion into `.pdb`, so you can download map2pdb and place it somewhere where the Delphi compiler can find and invoke it.

```

`DiaNodes.pas`:

```pas
unit DiaNodes;

{
  This module provides logic for creating tree nodes with symbol properties.
}

interface

uses
  Ntapi.msdia, NtUtils, DevirtualizedTree;

const
  colProperty = 0;
  colValue = 1;
  colMax = 2;

var
  EnableSorting: Boolean = True;

// Prepare initial nodes for a PDB
function DiaxMakeSessionNodeChildren(
  const Session: IDiaSession
): TArray<INodeProvider>;

implementation

uses
  Ntapi.DbgHelp, NtUiLib.Errors, NtUtils.SysUtils, VirtualTrees,
  DevirtualizedTree.Provider, DelphiUiLib.LiteReflection, NtUiCommon.Helpers,
  DiaProperties, TextHelpers, DelphiUtils.LiteRTTI, DelphiUiLib.Strings;

type
  // A simple leaf node
  TDiaxTextNode = class (TNodeProvider, INodeProvider)
    constructor Create(
      const PropertyName: String;
      const Value: String;
      const Hint: String = ''
    );
  end;

  // An node for an object with inspectable properties
  TDiaxInstanceNode<I : IInterface> = class (TNodeProvider, INodeProvider)
    FInstance: I;
    FAutoExpand: Boolean;
    function MakeChildNodes: TArray<INodeProvider>;
    constructor Create(const PropertyName: String; Instance: I; AutoExpand: Boolean = False);
    procedure Initialize; override;
    procedure NotifyFirstExpanding; override;
    class function NodeFromRelationTo<ISource>(
      const Source: ISource;
      const Definition: TDiaxInstanceProperty<ISource, I>;
      out Node: INodeProvider;
      AutoExpand: Boolean = False
    ): Boolean; static;
  end;

  // A node for a collection of objects
  TDiaxEnumNode<I : IInterface> = class (TNodeProvider, INodeProvider)
    FSortByName: Boolean;
    FEnum: IDiaEnum<I>;
    procedure SetCount(const Status: TNtxStatus; Count: Integer);
    procedure Initialize; override;
    procedure NotifyFirstExpanding; override;
    class function NodeFromRelationTo<ISource>(
      const Source: ISource;
      const Definition: TDiaxEnumProperty<ISource, I>;
      out Node: INodeProvider;
      SortByName: Boolean = False
    ): Boolean; static;
    constructor Create(
      const PropertyName: String;
      const Enum: IDiaEnum<I>;
      SortByName: Boolean = False
    );
  end;

constructor TDiaxTextNode.Create;
begin
  inherited Create(colMax);
  FColumnText[colProperty] := PropertyName;
  FColumnText[colValue] := Value;
  FHint := Hint;
end;

constructor TDiaxInstanceNode<I>.Create;
begin
  inherited Create(colMax);
  FColumnText[colProperty] := PropertyName;
  FInstance := Instance;
  FAutoExpand := AutoExpand;
end;

class function TDiaxInstanceNode<I>.NodeFromRelationTo<ISource>;
var
  Instance: I;
begin
  // Try to query a related instance
  Result := Definition.Callback(Source, Instance);

  if Result then
    Node := TDiaxInstanceNode<I>.Create(Definition.Name, Instance, AutoExpand);
end;

procedure TDiaxInstanceNode<I>.Initialize;
var
  Name: String;
  LocalInstance: I;
  Symbol: IDiaSymbol absolute LocalInstance;
  SourceFile: IDiaSourceFile absolute LocalInstance;
  AssemeblyFile: IDiaInputAssemblyFile absolute LocalInstance;
  Line: IDiaLineNumber absolute LocalInstance;
  Section: IDiaSectionContrib absolute LocalInstance;
  Segment: IDiaSegment absolute LocalInstance;
  InjectedSource: IDiaInjectedSource absolute LocalInstance;
  FrameData: IDiaFrameData absolute LocalInstance;
  Table: IDiaTable absolute LocalInstance;
  DebugStream: IDiaEnumDebugStreamData absolute LocalInstance;
  ImageData: IDiaImageData absolute LocalInstance;
  BinaryData: IBinaryData absolute LocalInstance;
begin
  inherited;
  LocalInstance := FInstance;

  // Determine the instance name base on its type
  if TypeInfo(I) = TypeInfo(IDiaSymbol) then
    Name := DiaxFormatSymbolName(Symbol)
  else if TypeInfo(I) = TypeInfo(IDiaSourceFile) then
    Name := DiaxFormatSourceFileName(SourceFile)
  else if TypeInfo(I) = TypeInfo(IDiaInputAssemblyFile) then
    Name := DiaxFormatInputAssemblyName(AssemeblyFile)
  else if TypeInfo(I) = TypeInfo(IDiaLineNumber) then
    Name := DiaxFormatLineNumberName(Line)
  else if TypeInfo(I) = TypeInfo(IDiaSectionContrib) then
    Name := DiaxFormatSectionName(Section)
  else if TypeInfo(I) = TypeInfo(IDiaSegment) then
    Name := DiaxFormatSegmentName(Segment)
  else if TypeInfo(I) = TypeInfo(IDiaInjectedSource) then
    Name := DiaxFormatInjectedSourceName(InjectedSource)
  else if TypeInfo(I) = TypeInfo(IDiaFrameData) then
    Name := DiaxFormatFrameDataName(FrameData)
  else if TypeInfo(I) = TypeInfo(IDiaTable) then
    Name := DiaxFormatTableName(Table)
  else if TypeInfo(I) = TypeInfo(IDiaEnumDebugStreamData) then
    Name := DiaxFormatDebugStreamName(DebugStream)
  else if TypeInfo(I) = TypeInfo(IDiaImageData) then
    Name := DiaxFormatImageData(ImageData)
  else if TypeInfo(I) = TypeInfo(IBinaryData) then
    Name := DiaxFormatBinaryData(BinaryData)
  else if Assigned(TypeInfo(I)) then
    Name := '(' + PLiteRttiTypeInfo(TypeInfo(I)).Name + ')'
  else
    Name := '';

  FColumnText[colValue] := Name;
  Include(FNode.States, vsHasChildren);

  if FAutoExpand then
    FTree.Expanded[FNode] := True;
end;

function DiaxMakeSessionNodeChildren(
  const Session: IDiaSession
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaSession>>;
  ToSymbol: TArray<TDiaxInstanceProperty<IDiaSession, IDiaSymbol>>;
  ToSymbolEnum: TArray<TDiaxEnumProperty<IDiaSession, IDiaSymbol>>;
  ToSourceFileEnum: TArray<TDiaxEnumProperty<IDiaSession, IDiaSourceFile>>;
  ToAssemblyFileEnum: TArray<TDiaxEnumProperty<IDiaSession, IDiaInputAssemblyFile>>;
  ToTableEnum: TArray<TDiaxEnumProperty<IDiaSession, IDiaTable>>;
  ToDebugStreamEnum: TArray<TDiaxEnumProperty<IDiaSession, IDiaEnumDebugStreamData>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  // Collect callbacks for session properties
  ToReflection := DiaxSessionToReflection;
  ToSymbol := DiaxSessionToSymbol;
  ToSymbolEnum := DiaxSessionToSymbolEnum;
  ToSourceFileEnum := DiaxSessionToSourceFileEnum;
  ToAssemblyFileEnum := DiaxSessionToAssemblyFileEnum;
  ToTableEnum := DiaxSessionToTableEnum;
  ToDebugStreamEnum := DiaxSessionToDebugStreamEnum;

  SetLength(Result, Length(ToReflection) + Length(ToSymbol) +
    Length(ToSymbolEnum) + Length(ToSourceFileEnum) +
    Length(ToAssemblyFileEnum) + Length(ToTableEnum) +
    Length(ToDebugStreamEnum));
  j := 0;

  // Symbol instances, auto-expanded
  for k := 0 to High(ToSymbol) do
    if TDiaxInstanceNode<IDiaSymbol>.NodeFromRelationTo<IDiaSession>(Session,
      ToSymbol[k], Result[j], True) then
      Inc(j);

  // Symbol enumerators, auto-sorted
  for k := 0 to High(ToSymbolEnum) do
    if TDiaxEnumNode<IDiaSymbol>.NodeFromRelationTo<IDiaSession>(Session,
      ToSymbolEnum[k], Result[j], True) then
      Inc(j);

  // Source file enumerators
  for k := 0 to High(ToSourceFileEnum) do
    if TDiaxEnumNode<IDiaSourceFile>.NodeFromRelationTo<IDiaSession>(Session,
      ToSourceFileEnum[k], Result[j]) then
      Inc(j);

  // Assembly file enumerators
  for k := 0 to High(ToAssemblyFileEnum) do
    if TDiaxEnumNode<IDiaInputAssemblyFile>.NodeFromRelationTo<IDiaSession>(
      Session, ToAssemblyFileEnum[k], Result[j]) then
      Inc(j);

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(Session, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Table enumerators
  for k := 0 to High(ToTableEnum) do
    if TDiaxEnumNode<IDiaTable>.NodeFromRelationTo<IDiaSession>(
      Session, ToTableEnum[k], Result[j]) then
      Inc(j);

  // Debug stream enumerators
  for k := 0 to High(ToDebugStreamEnum) do
    if TDiaxEnumNode<IDiaEnumDebugStreamData>.NodeFromRelationTo<IDiaSession>(
      Session, ToDebugStreamEnum[k], Result[j]) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeSymbolNodeChildren(
  const Symbol: IDiaSymbol
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaSymbol>>;
  ToSymbol: TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaSymbol>>;
  ToSymbolEnum: TArray<TDiaxEnumProperty<IDiaSymbol, IDiaSymbol>>;
  ToSourceEnum: TArray<TDiaxEnumProperty<IDiaSymbol, IDiaSourceFile>>;
  ToLine: TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaLineNumber>>;
  ToLineEnum: TArray<TDiaxEnumProperty<IDiaSymbol, IDiaLineNumber>>;
  ToAssembly: TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaInputAssemblyFile>>;
  Reflection: TRttixFullReflection;
  IsExeTag: Boolean;
  Tag: TSymTagEnum;
  j, k: Integer;
begin
  // Collect callbacks for symbol properties
  IsExeTag := (Symbol.get_symTag(Tag) = S_OK) and (Tag = SymTagExe);
  ToReflection := DiaxSymbolToReflection;
  ToSymbol := DiaxSymbolToSymbol;
  ToSourceEnum := DiaxSymbolToSourceFileEnum;
  ToLine := DiaxSymbolToLineNumber;
  ToAssembly := DiaxSymbolToAssemblyFile;
  ToSymbolEnum := DiaxSymbolToSymbolEnum;
  ToLineEnum := DiaxSymbolToLineNumberEnum;

  SetLength(Result, Length(ToReflection) + Length(ToSymbol) +
    Length(ToSymbolEnum) + Length(ToSourceEnum) + Length(ToLine) +
    Length(ToLineEnum) + Length(ToAssembly));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(Symbol, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Symbol instances
  for k := 0 to High(ToSymbol) do
    if TDiaxInstanceNode<IDiaSymbol>.NodeFromRelationTo<IDiaSymbol>(Symbol,
      ToSymbol[k], Result[j]) then
      Inc(j);

  // Source file enumerators
  for k := 0 to High(ToSourceEnum) do
    if TDiaxEnumNode<IDiaSourceFile>.NodeFromRelationTo<IDiaSymbol>(Symbol,
      ToSourceEnum[k], Result[j]) then
      Inc(j);

  // Line number instances
  for k := 0 to High(ToLine) do
    if TDiaxInstanceNode<IDiaLineNumber>.NodeFromRelationTo<IDiaSymbol>(Symbol,
      ToLine[k], Result[j]) then
      Inc(j);

  // Input assembly instances
  for k := 0 to High(ToAssembly) do
    if TDiaxInstanceNode<IDiaInputAssemblyFile>.NodeFromRelationTo<IDiaSymbol>(
      Symbol, ToAssembly[k], Result[j]) then
      Inc(j);

  // Line number enumerators
  for k := 0 to High(ToLineEnum) do
    if TDiaxEnumNode<IDiaLineNumber>.NodeFromRelationTo<IDiaSymbol>(Symbol,
      ToLineEnum[k], Result[j]) then
      Inc(j);

  // Symbol enumerators, auto-sorted when referring to the global scope
  for k := 0 to High(ToSymbolEnum) do
    if TDiaxEnumNode<IDiaSymbol>.NodeFromRelationTo<IDiaSymbol>(Symbol,
      ToSymbolEnum[k], Result[j], IsExeTag) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeSourceFileChildren(
  const SourceFile: IDiaSourceFile
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaSourceFile>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxSourceFileToReflection;

  SetLength(Result, Length(ToReflection));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(SourceFile, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  SetLength(Result, j);
end;

function DiaxMakeAssemblyFileChildren(
  const AssemblyFile: IDiaInputAssemblyFile
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaInputAssemblyFile>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxAssemblyFileToReflection;

  SetLength(Result, Length(ToReflection));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(AssemblyFile, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  SetLength(Result, j);
end;

function DiaxMakeLineNodeChildren(
  const Line: IDiaLineNumber
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaLineNumber>>;
  ToSymbol: TArray<TDiaxInstanceProperty<IDiaLineNumber, IDiaSymbol>>;
  ToSourceFile: TArray<TDiaxInstanceProperty<IDiaLineNumber, IDiaSourceFile>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxLineNumberToReflection;
  ToSymbol := DiaxLineNumberToSymbol;
  ToSourceFile := DiaxLineNumberToSourceFile;

  SetLength(Result, Length(ToReflection) + Length(ToSymbol) +
    Length(ToSourceFile));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(Line, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Symbol instances
  for k := 0 to High(ToSymbol) do
    if TDiaxInstanceNode<IDiaSymbol>.NodeFromRelationTo<IDiaLineNumber>(Line,
      ToSymbol[k], Result[j]) then
      Inc(j);

  // Source file instances
  for k := 0 to High(ToSourceFile) do
    if TDiaxInstanceNode<IDiaSourceFile>.NodeFromRelationTo<IDiaLineNumber>(Line,
      ToSourceFile[k], Result[j]) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeSectionChildren(
  const Section: IDiaSectionContrib
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaSectionContrib>>;
  ToSymbol: TArray<TDiaxInstanceProperty<IDiaSectionContrib, IDiaSymbol>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxSectionToReflection;
  ToSymbol := DiaxSectionToSymbol;

  SetLength(Result, Length(ToReflection) + Length(ToSymbol));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(Section, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Symbol instances
  for k := 0 to High(ToSymbol) do
    if TDiaxInstanceNode<IDiaSymbol>.NodeFromRelationTo<IDiaSectionContrib>(
      Section, ToSymbol[k], Result[j]) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeSegmentChildren(
  const Segment: IDiaSegment
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaSegment>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxSegmentToReflection;

  SetLength(Result, Length(ToReflection));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(Segment, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  SetLength(Result, j);
end;

function DiaxMakeInjectedSourceChildren(
  const InjectedSource: IDiaInjectedSource
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaInjectedSource>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxInjectedSourceToReflection;

  SetLength(Result, Length(ToReflection));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(InjectedSource, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  SetLength(Result, j);
end;

function DiaxMakeFrameDataChildren(
  const FrameData: IDiaFrameData
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaFrameData>>;
  ToFrameData: TArray<TDiaxInstanceProperty<IDiaFrameData, IDiaFrameData>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxFrameDataToReflection;
  ToFrameData := DiaxFrameDataToFrameData;

  SetLength(Result, Length(ToReflection) + Length(ToFrameData));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(FrameData, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Frame data instances
  for k := 0 to High(ToFrameData) do
    if TDiaxInstanceNode<IDiaFrameData>.NodeFromRelationTo<IDiaFrameData>(
      FrameData, ToFrameData[k], Result[j]) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeTableChildren(
  const Table: IDiaTable
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaTable>>;
  ToSymbolEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaSymbol>>;
  ToSourceFileEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaSourceFile>>;
  ToAssemblyFileEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaInputAssemblyFile>>;
  ToLineEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaLineNumber>>;
  ToSectionEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaSectionContrib>>;
  ToSegmentEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaSegment>>;
  ToInjectedSourceEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaInjectedSource>>;
  ToFrameDataEnum: TArray<TDiaxEnumProperty<IDiaTable, IDiaFrameData>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxTableToReflection;
  ToSymbolEnum := DiaxTableToSymbolEnum;
  ToSourceFileEnum := DiaxTableToSourceFileEnum;
  ToAssemblyFileEnum := DiaxTableToAssemblyFileEnum;
  ToLineEnum := DiaxTableToLineNumberEnum;
  ToSectionEnum := DiaxTableToSectionEnum;
  ToSegmentEnum := DiaxTableToSegmentEnum;
  ToInjectedSourceEnum := DiaxTableToInjectedSourceEnum;
  ToFrameDataEnum := DiaxTableToFrameDataEnum;

  SetLength(Result, Length(ToReflection) + Length(ToSymbolEnum) +
    Length(ToSourceFileEnum) + Length(ToAssemblyFileEnum) + Length(ToLineEnum) +
    Length(ToSectionEnum) + Length(ToSegmentEnum) + Length(ToInjectedSourceEnum)
    + Length(ToFrameDataEnum));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(Table, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Symbol enumerators
  for k := 0 to High(ToSymbolEnum) do
    if TDiaxEnumNode<IDiaSymbol>.NodeFromRelationTo<IDiaTable>(Table,
      ToSymbolEnum[k], Result[j], True) then
      Inc(j);

  // Line number enumerators
  for k := 0 to High(ToLineEnum) do
    if TDiaxEnumNode<IDiaLineNumber>.NodeFromRelationTo<IDiaTable>(Table,
      ToLineEnum[k], Result[j], True) then
      Inc(j);

  // Source file enumerators
  for k := 0 to High(ToSourceFileEnum) do
    if TDiaxEnumNode<IDiaSourceFile>.NodeFromRelationTo<IDiaTable>(Table,
      ToSourceFileEnum[k], Result[j], True) then
      Inc(j);

  // Input assembly enumerators
  for k := 0 to High(ToAssemblyFileEnum) do
    if TDiaxEnumNode<IDiaInputAssemblyFile>.NodeFromRelationTo<IDiaTable>(Table,
      ToAssemblyFileEnum[k], Result[j], True) then
      Inc(j);

  // Section contribution enumerators
  for k := 0 to High(ToSectionEnum) do
    if TDiaxEnumNode<IDiaSectionContrib>.NodeFromRelationTo<IDiaTable>(Table,
      ToSectionEnum[k], Result[j], True) then
      Inc(j);

  // Segment enumerators
  for k := 0 to High(ToSegmentEnum) do
    if TDiaxEnumNode<IDiaSegment>.NodeFromRelationTo<IDiaTable>(Table,
      ToSegmentEnum[k], Result[j], True) then
      Inc(j);

  // Injected sources enumerators
  for k := 0 to High(ToInjectedSourceEnum) do
    if TDiaxEnumNode<IDiaInjectedSource>.NodeFromRelationTo<IDiaTable>(Table,
      ToInjectedSourceEnum[k], Result[j], True) then
      Inc(j);

  // Frame data enumerators
  for k := 0 to High(ToFrameDataEnum) do
    if TDiaxEnumNode<IDiaFrameData>.NodeFromRelationTo<IDiaTable>(Table,
      ToFrameDataEnum[k], Result[j], True) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeDebugStreamChildren(
  const DebugStream: IDiaEnumDebugStreamData
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaEnumDebugStreamData>>;
  ToImageData: TArray<TDiaxInstanceProperty<IDiaEnumDebugStreamData, IDiaImageData>>;
  ToBinaryDataEnum: TArray<TDiaxEnumProperty<IDiaEnumDebugStreamData, IBinaryData>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxDebugStreamToReflection;
  ToImageData := DiaxDebugStreamToImageData;
  ToBinaryDataEnum := DiaxDebugStreamToBinaryDataEnum;

  SetLength(Result, Length(ToReflection) + Length(ToImageData) +
    Length(ToBinaryDataEnum));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(DebugStream, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // Image data instances
  for k := 0 to High(ToImageData) do
    if TDiaxInstanceNode<IDiaImageData>.NodeFromRelationTo<IDiaEnumDebugStreamData>(
      DebugStream, ToImageData[k], Result[j]) then
      Inc(j);

  // Binary data instances
  for k := 0 to High(ToBinaryDataEnum) do
    if TDiaxEnumNode<IBinaryData>.NodeFromRelationTo<IDiaEnumDebugStreamData>(
      DebugStream, ToBinaryDataEnum[k], Result[j]) then
      Inc(j);

  SetLength(Result, j);
end;

function DiaxMakeImageDataChildren(
  const ImageData: IDiaImageData
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IDiaImageData>>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxImageDataToReflection;

  SetLength(Result, Length(ToReflection));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(ImageData, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  SetLength(Result, j);
end;

function DiaxMakeBinaryDataChildren(
  const BinaryData: IBinaryData
): TArray<INodeProvider>;
var
  ToReflection: TArray<TDiaxReflectionProperty<IBinaryData>>;
  ToFields: TArray<TSimpleProperty>;
  Reflection: TRttixFullReflection;
  j, k: Integer;
begin
  ToReflection := DiaxBinaryDataToReflection;
  ToFields := BinaryData.FormatProperties;

  SetLength(Result, Length(ToReflection) + Length(ToFields));
  j := 0;

  // Simple properties
  for k := 0 to High(ToReflection) do
    if ToReflection[k].Callback(BinaryData, Reflection) then
    begin
      Result[j] := TDiaxTextNode.Create(ToReflection[k].Name, Reflection.Text,
        Reflection.Hint);
      Inc(j);
    end;

  // RTTI fields
  for k := 0 to High(ToFields) do
  begin
    Result[j] := TDiaxTextNode.Create(PrettifyCamelCase(ToFields[k].Name),
      ToFields[k].Value.Text, ToFields[k].Value.Hint);
    Inc(j);
  end;

  SetLength(Result, j);
end;

function TDiaxInstanceNode<I>.MakeChildNodes;
var
  LocalInstance: I;
  Symbol: IDiaSymbol absolute LocalInstance;
  SourceFile: IDiaSourceFile absolute LocalInstance;
  AssemblyFile: IDiaInputAssemblyFile absolute LocalInstance;
  Line: IDiaLineNumber absolute LocalInstance;
  Section: IDiaSectionContrib absolute LocalInstance;
  Segment: IDiaSegment absolute LocalInstance;
  InjectedSource: IDiaInjectedSource absolute LocalInstance;
  FrameData: IDiaFrameData absolute LocalInstance;
  Table: IDiaTable absolute LocalInstance;
  DebugStream: IDiaEnumDebugStreamData absolute LocalInstance;
  ImageData: IDiaImageData absolute LocalInstance;
  BinaryData: IBinaryData absolute LocalInstance;
begin
  LocalInstance := FInstance;

  // Collect children based on the type
  if TypeInfo(I) = TypeInfo(IDiaSymbol) then
    Result := DiaxMakeSymbolNodeChildren(Symbol)
  else if TypeInfo(I) = TypeInfo(IDiaSourceFile) then
    Result := DiaxMakeSourceFileChildren(SourceFile)
  else if TypeInfo(I) = TypeInfo(IDiaInputAssemblyFile) then
    Result := DiaxMakeAssemblyFileChildren(AssemblyFile)
  else if TypeInfo(I) = TypeInfo(IDiaLineNumber) then
    Result := DiaxMakeLineNodeChildren(Line)
  else if TypeInfo(I) = TypeInfo(IDiaSectionContrib) then
    Result := DiaxMakeSectionChildren(Section)
  else if TypeInfo(I) = TypeInfo(IDiaSegment) then
    Result := DiaxMakeSegmentChildren(Segment)
  else if TypeInfo(I) = TypeInfo(IDiaInjectedSource) then
    Result := DiaxMakeInjectedSourceChildren(InjectedSource)
  else if TypeInfo(I) = TypeInfo(IDiaFrameData) then
    Result := DiaxMakeFrameDataChildren(FrameData)
  else if TypeInfo(I) = TypeInfo(IDiaTable) then
    Result := DiaxMakeTableChildren(Table)
  else if TypeInfo(I) = TypeInfo(IDiaEnumDebugStreamData) then
    Result := DiaxMakeDebugStreamChildren(DebugStream)
  else if TypeInfo(I) = TypeInfo(IDiaImageData) then
    Result := DiaxMakeImageDataChildren(ImageData)
  else if TypeInfo(I) = TypeInfo(IBinaryData) then
    Result := DiaxMakeBinaryDataChildren(BinaryData)
  else
    Result := nil;
end;

procedure TDiaxInstanceNode<I>.NotifyFirstExpanding;
var
  ChildNodes: TArray<INodeProvider>;
  ChildNode: INodeProvider;
begin
  FTree.BeginUpdateAuto;

  // Generate children nodes
  ChildNodes := MakeChildNodes;

  for ChildNode in ChildNodes do
    FTree.AddChildEx(FNode, ChildNode);

  if Length(ChildNodes) <= 0 then
    Exclude(FNode.States, vsHasChildren);
end;

constructor TDiaxEnumNode<I>.Create;
begin
  inherited Create(colMax);
  FColumnText[colProperty] := PropertyName;
  FEnum := Enum;
  FSortByName := SortByName;
end;

class function TDiaxEnumNode<I>.NodeFromRelationTo<ISource>;
var
  Enum: IDiaEnum<I>;
begin
  // Try to query a related enumerators
  Result := Definition.Callback(Source, Enum);

  if Result then
    Node := TDiaxEnumNode<I>.Create(Definition.Name, Enum, SortByName);
end;

procedure TDiaxEnumNode<I>.Initialize;
var
  Status: TNtxStatus;
  Count: Integer;
begin
  inherited;

  Status.Location := 'IDiaEnum::get_Count';
  Status.HResult := FEnum.get_Count(Count);
  SetCount(Status, Count);

  if Status.IsSuccess and (Count > 0) then
    Include(FNode.States, vsHasChildren);
end;

procedure TDiaxEnumNode<I>.NotifyFirstExpanding;
var
  Status: TNtxStatus;
  Children: TArray<I>;
  j: Integer;
begin
  if not Assigned(FEnum) then
    Exit;

  // Collect entries from the enumerator
  Status := DiaxProperties.CollectEnum<I>(FEnum, Children);
  SetCount(Status, Length(Children));

  // Apply sorting if supported
  if EnableSorting then
  begin
    if (TypeInfo(I) = TypeInfo(IDiaSymbol)) then
      DiaxSortSymbols(TArray<IDiaSymbol>(Children), FSortByName)
    else if TypeInfo(I) = TypeInfo(IDiaSourceFile) then
      DiaxSortSourceFiles(TArray<IDiaSourceFile>(Children))
    else if TypeInfo(I) = TypeInfo(IDiaLineNumber) then
      DiaxSortLineNumbers(TArray<IDiaLineNumber>(Children))
    else if TypeInfo(I) = TypeInfo(IDiaSectionContrib) then
      DiaxSortSections(TArray<IDiaSectionContrib>(Children));
  end;

  if Status.IsSuccess then
  begin
    FTree.BeginUpdateAuto;

    // Generate child nodes
    for j := 0 to High(Children) do
      FTree.AddChildEx(FNode, TDiaxInstanceNode<I>.Create(
        FormatArrayIndex(j), Children[j]));
  end;
end;

procedure TDiaxEnumNode<I>.SetCount;
var
  ElementName: String;
begin
  if Status.IsSuccess then
  begin
    if TypeInfo(I) = TypeInfo(IDiaSymbol) then
      ElementName := 'Symbols'
    else if TypeInfo(I) = TypeInfo(IDiaSourceFile) then
      ElementName := 'Source Files'
    else if TypeInfo(I) = TypeInfo(IDiaInputAssemblyFile) then
      ElementName := 'Input Assembly Files'
    else if TypeInfo(I) = TypeInfo(IDiaLineNumber) then
      ElementName := 'Line Numbers'
    else if TypeInfo(I) = TypeInfo(IDiaSectionContrib) then
      ElementName := 'Section Contributions'
    else if TypeInfo(I) = TypeInfo(IDiaSegment) then
      ElementName := 'Segments'
    else if TypeInfo(I) = TypeInfo(IDiaInjectedSource) then
      ElementName := 'Injected Sources'
    else if TypeInfo(I) = TypeInfo(IDiaTable) then
      ElementName := 'Tables'
    else if TypeInfo(I) = TypeInfo(IDiaEnumDebugStreamData) then
      ElementName := 'Debug Streams'
    else
      ElementName := 'Entries';

    FColumnText[colValue] := RtlxFormatString('(%u %s)', [Count, ElementName])
  end
  else
  begin
    FColumnText[colValue] := '(Error)';
    FHint := Status.ToString;
  end;
  Invalidate;
end;

end.

```

`DiaProperties.pas`:

```pas
unit DiaProperties;

{
  This module provides access to most of IDiaSymbol's properties.
}

interface

uses
  Ntapi.DbgHelp, Ntapi.msdia, Ntapi.ImageHlp, NtUtils, DelphiApi.Reflection,
  DelphiUtils.LiteRTTI, DelphiUiLib.LiteReflection;

type
  DiaxProperties = class abstract
    // Iterate over a DIA enum and collect all elements
    class function CollectEnum<I>(
      const Enum: IDiaEnum<I>;
      out EnumValues: TArray<I>
    ): TNtxStatus; static;
  end;

  // A callback for collecting a simple (reflection) object property
  TDiaxReflectionPropertyCallback<I> = function (
    const Source: I;
    out Reflection: TRttixFullReflection
  ): Boolean;

  // A simple (reflection) object property
  TDiaxReflectionProperty<I> = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<I>;
  end;

  // A callback for collecting an associated instance
  TDiaxInstancePropertyCallback<ISource, IInstance> = function (
    const Source: ISource;
    out Instance: IInstance
  ): Boolean;

  // An associated instance property
  TDiaxInstanceProperty<ISource, IInstance> = record
    Name: String;
    Callback: TDiaxInstancePropertyCallback<ISource, IInstance>;
  end;

  // A callback for collecting an associated instance enumerator
  TDiaxEnumPropertyCallback<ISource, IInstance> = function (
    const Source: ISource;
    out Enum: IDiaEnum<IInstance>
  ): Boolean;

  // An associated instance enumerator property
  TDiaxEnumProperty<ISource, IInstance> = record
    Name: String;
    Callback: TDiaxEnumPropertyCallback<ISource, IInstance>;
  end;

  TSimpleProperty = record
    Name: String;
    Value: TRttixFullReflection;
  end;

  // A custom interface for exposed blocks of binary data
  IBinaryData = interface
    ['{22F1DB68-33DF-4B6C-BE1C-8192C486D040}']
    function GetTypeInfo: IRttixType;
    function GetData: IMemory;
    function FormatProperties: TArray<TSimpleProperty>;

    property TypeInfo: IRttixType read GetTypeInfo;
    property Data: IMemory read GetData;
  end;

  // A custom interface for IMAGE_SECTION_HEADER data
  IImageSectionHeader = interface (IBinaryData)
    ['{2A9909F3-182C-4B21-A88B-BF0BE3C49C90}']
    function GetSectionName: String;
    property SectionName: String read GetSectionName;
  end;

  // A custom interface for XFIXUP_DATA data
  IXFixupData = interface (IBinaryData)
    ['{A573CB90-4CFC-4156-BC62-045E23087436}']
  end;

  // A custom interface for FPO_DATA data
  IFpoData = interface (IBinaryData)
    ['{015513A3-E2CA-4A4B-9B11-780C5AB76CE3}']
  end;

  // A custom interface for FRAMEDATA data
  IFrameData = interface (IBinaryData)
    ['{41AECE30-A550-487F-860C-CBF2C415CCDF}']
  end;

  // A custom interface for OMAP_DATA data
  IOmapData = interface (IBinaryData)
    ['{80121B3E-3325-4CF8-B591-DB21D597A26B}']
  end;

{ IDiaSession }

// Remember the current session for better setting lookup
procedure DiaxSetCurrentSession(const Session: IDiaSession);

// IDiaSession to reflection properties
function DiaxSessionToReflection(
): TArray<TDiaxReflectionProperty<IDiaSession>>;

// IDiaSession to IDiaSymbol properties
function DiaxSessionToSymbol(
): TArray<TDiaxInstanceProperty<IDiaSession, IDiaSymbol>>;

// IDiaSession to IDiaEnum<IDiaSymbol> properties
function DiaxSessionToSymbolEnum(
): TArray<TDiaxEnumProperty<IDiaSession, IDiaSymbol>>;

// IDiaSession to IDiaEnum<IDiaSourceFile> properties
function DiaxSessionToSourceFileEnum(
): TArray<TDiaxEnumProperty<IDiaSession, IDiaSourceFile>>;

// IDiaSession to IDiaEnum<IDiaInputAssemblyFile> properties
function DiaxSessionToAssemblyFileEnum(
): TArray<TDiaxEnumProperty<IDiaSession, IDiaInputAssemblyFile>>;

// IDiaSession to IDiaEnum<IDiaTable> properties
function DiaxSessionToTableEnum(
): TArray<TDiaxEnumProperty<IDiaSession, IDiaTable>>;

// IDiaSession to IDiaEnum<IDiaEnumDebugStreamData> properties
function DiaxSessionToDebugStreamEnum(
): TArray<TDiaxEnumProperty<IDiaSession, IDiaEnumDebugStreamData>>;

{ IDiaSymbol }

// Sort IDiaSymbol entries
procedure DiaxSortSymbols(
  var Symbols: TArray<IDiaSymbol>;
  SortByName: Boolean
);

// IDiaSymbol to reflection properties
function DiaxSymbolToReflection(
): TArray<TDiaxReflectionProperty<IDiaSymbol>>;

// IDiaSymbol to IDiaSymbol properties
function DiaxSymbolToSymbol(
): TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaSymbol>>;

// IDiaSymbol to IDiaEnum<IDiaSourceFile> properties
function DiaxSymbolToSourceFileEnum(
): TArray<TDiaxEnumProperty<IDiaSymbol, IDiaSourceFile>>;

// IDiaSymbol to IDiaEnum<IDiaSymbol> properties
function DiaxSymbolToSymbolEnum(
): TArray<TDiaxEnumProperty<IDiaSymbol, IDiaSymbol>>;

// IDiaSymbol to IDiaLineNumber properties
function DiaxSymbolToLineNumber(
): TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaLineNumber>>;

// IDiaSymbol to IDiaEnum<IDiaLineNumber> properties
function DiaxSymbolToLineNumberEnum(
): TArray<TDiaxEnumProperty<IDiaSymbol, IDiaLineNumber>>;

// IDiaSymbol to IDiaInputAssemblyFile properties
function DiaxSymbolToAssemblyFile(
): TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaInputAssemblyFile>>;

{ IDiaSourceFile }

// Sort IDiaSourceFile entries
procedure DiaxSortSourceFiles(var SourceFiles: TArray<IDiaSourceFile>);

// IDiaSourceFile to reflection properties
function DiaxSourceFileToReflection(
): TArray<TDiaxReflectionProperty<IDiaSourceFile>>;

{ IDiaInputAssemblyFile }

// IDiaInputAssemblyFile to reflection properties
function DiaxAssemblyFileToReflection(
): TArray<TDiaxReflectionProperty<IDiaInputAssemblyFile>>;

{ IDiaLineNumber }

// Sort IDiaLineNumber entries
procedure DiaxSortLineNumbers(var Lines: TArray<IDiaLineNumber>);

// IDiaLineNumber to reflection properties
function DiaxLineNumberToReflection(
): TArray<TDiaxReflectionProperty<IDiaLineNumber>>;

// IDiaLineNumber to IDiaSymbol properties
function DiaxLineNumberToSymbol(
): TArray<TDiaxInstanceProperty<IDiaLineNumber, IDiaSymbol>>;

// IDiaLineNumber to IDiaSourceFile properties
function DiaxLineNumberToSourceFile(
): TArray<TDiaxInstanceProperty<IDiaLineNumber, IDiaSourceFile>>;

{ IDiaSectionContrib }

// Sort IDiaSectionContrib entries
procedure DiaxSortSections(var Sections: TArray<IDiaSectionContrib>);

// IDiaSectionContrib to reflection properties
function DiaxSectionToReflection(
): TArray<TDiaxReflectionProperty<IDiaSectionContrib>>;

// IDiaSectionContrib to IDiaSymbol properties
function DiaxSectionToSymbol(
): TArray<TDiaxInstanceProperty<IDiaSectionContrib, IDiaSymbol>>;

{ IDiaSegment }

// IDiaSegment to reflection properties
function DiaxSegmentToReflection(
): TArray<TDiaxReflectionProperty<IDiaSegment>>;

{ IDiaInjectedSource }

// IDiaInjectedSource to reflection properties
function DiaxInjectedSourceToReflection(
): TArray<TDiaxReflectionProperty<IDiaInjectedSource>>;

{ IDiaFrameData }

// IDiaFrameData to reflection properties
function DiaxFrameDataToReflection(
): TArray<TDiaxReflectionProperty<IDiaFrameData>>;

// IDiaFrameData to IDiaFrameData properties
function DiaxFrameDataToFrameData(
): TArray<TDiaxInstanceProperty<IDiaFrameData, IDiaFrameData>>;

{ IDiaTable }

// IDiaTable to reflection properties
function DiaxTableToReflection(
): TArray<TDiaxReflectionProperty<IDiaTable>>;

// IDiaTable to IDiaSymbol properties
function DiaxTableToSymbolEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaSymbol>>;

// IDiaTable to IDiaSourceFile properties
function DiaxTableToSourceFileEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaSourceFile>>;

// IDiaTable to IDiaInputAssemblyFile properties
function DiaxTableToAssemblyFileEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaInputAssemblyFile>>;

// IDiaTable to IDiaLineNumber properties
function DiaxTableToLineNumberEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaLineNumber>>;

// IDiaTable to IDiaSectionContrib properties
function DiaxTableToSectionEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaSectionContrib>>;

// IDiaTable to IDiaSegment properties
function DiaxTableToSegmentEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaSegment>>;

// IDiaTable to IDiaInjectedSource properties
function DiaxTableToInjectedSourceEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaInjectedSource>>;

// IDiaTable to IDiaFrameData properties
function DiaxTableToFrameDataEnum(
): TArray<TDiaxEnumProperty<IDiaTable, IDiaFrameData>>;

{ IDiaEnumDebugStreamData }

// IDiaEnumDebugStreamData to reflection properties
function DiaxDebugStreamToReflection(
): TArray<TDiaxReflectionProperty<IDiaEnumDebugStreamData>>;

// IDiaEnumDebugStreamData to IDiaImageData properties
function DiaxDebugStreamToImageData(
): TArray<TDiaxInstanceProperty<IDiaEnumDebugStreamData, IDiaImageData>>;

// IDiaEnumDebugStreamData to IDiaEnum<IBinaryData> properties
function DiaxDebugStreamToBinaryDataEnum(
): TArray<TDiaxEnumProperty<IDiaEnumDebugStreamData, IBinaryData>>;

{ IDiaImageData }

// IDiaImageData to reflection properties
function DiaxImageDataToReflection(
): TArray<TDiaxReflectionProperty<IDiaImageData>>;

{ IBinaryData }

// IBinaryData to reflection properties
function DiaxBinaryDataToReflection(
): TArray<TDiaxReflectionProperty<IBinaryData>>;

implementation

uses
  Ntapi.WinNt, NtUtils.SysUtils, DelphiUtils.Arrays, DelphiUiLib.Strings,
  DelphiUiLib.LiteReflection.Types, RegisterNames, TextHelpers;

{$BOOLEVAL OFF}
{$IFOPT R+}{$DEFINE R+}{$ENDIF}
{$IFOPT Q+}{$DEFINE Q+}{$ENDIF}

{$REGION 'Generic helpers'}

var
  CurrentDiaSession: IDiaSession;
  CurrentDiaMachineType: TImageMachine32;

procedure DiaxSetCurrentSession;
var
  Scope: IDiaSymbol;
begin
  CurrentDiaSession := Session;

  if not Assigned(Session) or (Session.get_globalScope(Scope) <> S_OK) or
    (Scope.get_machineType(CurrentDiaMachineType) <> S_OK) then
    CurrentDiaMachineType := 0;
end;

function DiaxCurrentFixupDataTypeInfo: PLiteRttiTypeInfo;
begin
  case CurrentDiaMachineType of
    IMAGE_FILE_MACHINE_I386:
      Result := TypeInfo(TXFixupDataI386);

    IMAGE_FILE_MACHINE_AMD64:
      Result := TypeInfo(TXFixupDataAmd64);

    IMAGE_FILE_MACHINE_ARM, IMAGE_FILE_MACHINE_THUMB, IMAGE_FILE_MACHINE_ARMNT:
      Result := TypeInfo(TXFixupDataArm);

    IMAGE_FILE_MACHINE_ARM64:
      Result := TypeInfo(TXFixupDataArm64);

  else
    Result := TypeInfo(TXFixupData);
  end;
end;

type
  TFakeDiaEnum<I> = class (TAutoInterfacedObject, IDiaEnum<I>)
    FElements: TArray<I>;
    FPosition: Integer;
    function get__NewEnum(out RetVal: IUnknown): HResult; stdcall;
    function get_Count(out RetVal: Integer): HResult; stdcall;
    function Item(Index: Cardinal; out Item: I): HResult; stdcall;
    function Next(Count: Integer; out Elements: I; out Fetched: Integer): HResult; stdcall;
    function Skip(Count: Cardinal): HResult; stdcall;
    function Reset: HResult; stdcall;
    function Clone(out Enum: IDiaEnum<I>): HResult; stdcall;
    constructor Create(const Elements: TArray<I>; Position: Integer = 0);
  end;

function TFakeDiaEnum<I>.Clone;
begin
  Enum := TFakeDiaEnum<I>.Create(FElements, FPosition);
  Result := S_OK;
end;

constructor TFakeDiaEnum<I>.Create;
begin
  FElements := Elements;
  FPosition := Position;
end;

function TFakeDiaEnum<I>.get_Count;
begin
  RetVal := Length(FElements);
  Result := S_OK;
end;

function TFakeDiaEnum<I>.get__NewEnum;
begin
  Result := E_NOTIMPL;
end;

function TFakeDiaEnum<I>.Item;
begin
  if Index <= High(FElements) then
  begin
    Item := FElements[Index];
    Result := S_OK;
  end
  else
    Result := S_FALSE;
end;

function TFakeDiaEnum<I>.Next;
var
  Buffer: ^I;
begin
  Buffer := @Elements;
  Fetched := 0;

  while (FPosition <= High(FElements)) and (Fetched < Count) do
  begin
    Buffer^ := FElements[FPosition];
    Inc(FPosition);
    Inc(Fetched);
    Inc(Buffer);
  end;

  if Fetched > 0 then
    Result := S_OK
  else
    Result := S_FALSE;
end;

function TFakeDiaEnum<I>.Reset;
begin
  FPosition := 0;
  Result := S_OK;
end;

function TFakeDiaEnum<I>.Skip;
begin
  Inc(FPosition, Count);
  Result := S_OK;
end;

class function DiaxProperties.CollectEnum<I>;
begin
var
  Count, Fetched: Integer;
begin
  Enum.Reset;
  Result.Location := 'IDiaEnum::get_Count';
  Result.HResult := Enum.get_Count(Count);

  if not Result.IsSuccess or (Count <= 0) then
    Exit;

  EnumValues := nil;
  SetLength(EnumValues, Count);

  // Retrieve all entries
  Result.Location := 'IDiaEnum::Next';
  Result.HResultAllowFalse := Enum.Next(Count, EnumValues[0], Fetched);

  // Truncate if necessary
  if Result.IsSuccess and (Fetched < Count) then
    SetLength(EnumValues, Fetched);
end;
end;

{$ENDREGION}
{$REGION 'IDiaSession to reflection'}

function DiaxSession_getFuncMDTokenMapSize(
  const Session: IDiaSession;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Session.getFuncMDTokenMapSize(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsBytes);
end;

function DiaxSession_getTypeMDTokenMapSize(
  const Session: IDiaSession;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Session.getTypeMDTokenMapSize(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsBytes);
end;

function DiaxSession_isFastLinkPDB(
  const Session: IDiaSession;
  out Reflection: TRttixFullReflection
): Boolean;
var
  SessionEx: IDiaSessionEx;
  Value: LongBool;
begin
  Result := (Session.QueryInterface(IDiaSession, SessionEx) = S_OK) and
    (SessionEx.isFastLinkPDB(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSession_isPortablePDB(
  const Session: IDiaSession;
  out Reflection: TRttixFullReflection
): Boolean;
var
  SessionEx: IDiaSessionEx;
  Value: LongBool;
begin
  Result := (Session.QueryInterface(IDiaSession, SessionEx) = S_OK) and
    (SessionEx.isPortablePDB(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxSessionReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaSession>;
  end;

const
  DiaxpSessionToReflectionDef: array [0..3] of TDiaxSessionReflectionProperty = (
    (Name: 'Function Metadata Token Map'; Callback: DiaxSession_getFuncMDTokenMapSize),
    (Name: 'Type Metadata Token Map'; Callback: DiaxSession_getTypeMDTokenMapSize),
    (Name: 'Fast-link PDB'; Callback: DiaxSession_isFastLinkPDB),
    (Name: 'Portable PDB'; Callback: DiaxSession_isPortablePDB)
  );

var
  DiaxpSessionToReflectionCache: TArray<TDiaxReflectionProperty<IDiaSession>>;

function DiaxSessionToReflection;
var
  i: Integer;
begin
  if Length(DiaxpSessionToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpSessionToReflectionCache,
      Length(DiaxpSessionToReflectionDef));

    for i := 0 to High(DiaxpSessionToReflectionCache) do
    begin
      DiaxpSessionToReflectionCache[i].Name :=
        DiaxpSessionToReflectionDef[i].Name;
      DiaxpSessionToReflectionCache[i].Callback :=
        DiaxpSessionToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpSessionToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaSession to IDiaSymbol'}

function DiaxSession_get_globalScope(
  const Session: IDiaSession;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Session.get_globalScope(Value) = S_OK;
end;

function DiaxSessionToSymbol;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Global Scope';
  Result[0].Callback := DiaxSession_get_globalScope;
end;

{$ENDREGION}
{$REGION 'IDiaSession to IDiaEnum<IDiaSymbol>'}

function DiaxSession_getExports(
  const Session: IDiaSession;
  out Value: IDiaEnum<IDiaSymbol>
): Boolean;
begin
  Result := Session.getExports(IDiaEnumSymbols(Value)) = S_OK;
end;

function DiaxSession_getHeapAllocationSites(
  const Session: IDiaSession;
  out Value: IDiaEnum<IDiaSymbol>
): Boolean;
begin
  Result := Session.getHeapAllocationSites(IDiaEnumSymbols(Value)) = S_OK;
end;

function DiaxSessionToSymbolEnum;
begin
  SetLength(Result, 2);
  Result[0].Name := 'Exports';
  Result[0].Callback := DiaxSession_getExports;
  Result[1].Name := 'Heap Allocation Sites';
  Result[1].Callback := DiaxSession_getHeapAllocationSites;
end;

{$ENDREGION}
{$REGION 'IDiaSession to IDiaEnum<IDiaSourceFile>'}

function DiaxSession_findFile(
  const Session: IDiaSession;
  out Value: IDiaEnum<IDiaSourceFile>
): Boolean;
begin
  Result := Session.findFile(nil, '', 0, IDiaEnumSourceFiles(Value)) = S_OK;
end;

function DiaxSessionToSourceFileEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Source Files';
  Result[0].Callback := DiaxSession_findFile;
end;

{$ENDREGION}
{$REGION 'IDiaSession to IDiaEnum<IDiaInputAssemblyFile>'}

function DiaxSession_findInputAssemblyFiles(
  const Session: IDiaSession;
  out Value: IDiaEnum<IDiaInputAssemblyFile>
): Boolean;
begin
  Result := Session.findInputAssemblyFiles(IDiaEnumInputAssemblyFiles(Value)) = S_OK;
end;

function DiaxSessionToAssemblyFileEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Input Assembly Files';
  Result[0].Callback := DiaxSession_findInputAssemblyFiles;
end;

{$ENDREGION}
{$REGION 'IDiaSession to IDiaEnum<IDiaTable>'}

function DiaxSession_getEnumTables(
  const Session: IDiaSession;
  out Value: IDiaEnum<IDiaTable>
): Boolean;
begin
  Result := Session.getEnumTables(IDiaEnumTables(Value)) = S_OK;
end;

function DiaxSessionToTableEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Tables';
  Result[0].Callback := DiaxSession_getEnumTables;
end;

{$ENDREGION}
{$REGION 'IDiaSession to IDiaEnum<IDiaEnumDebugStreamData>'}

function DiaxSession_getEnumDebugStreams(
  const Session: IDiaSession;
  out Value: IDiaEnum<IDiaEnumDebugStreamData>
): Boolean;
begin
  Result := Session.getEnumDebugStreams(IDiaEnumDebugStreams(Value)) = S_OK;
end;

function DiaxSessionToDebugStreamEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Debug Streams';
  Result[0].Callback := DiaxSession_getEnumDebugStreams;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol Sorting'}

procedure DiaxSortSymbols;
var
  Tags: TArray<TSymTagEnum>;
  Names: TArray<String>;
  WideName: WideString;
  Parent: IDiaSymbol;
  i: Integer;
begin
  // Collect all tags
  SetLength(Tags, Length(Symbols));

  for i := 0 to High(Symbols) do
    if Symbols[i].get_symTag(Tags[i]) <> S_OK then
      Tags[i] := SymTagNull;

  if SortByName then
  begin
    // Collect all names, in case we need to sort by them
    SetLength(Names, Length(Symbols));

    for i := 0 to High(Symbols) do
      if (Symbols[i].get_name(WideName) = S_OK) and (WideName <> '') then
      begin
        Names[i] := WideName;

        // For compilands, we only need the file name, not the entire path
        if Tags[i] = SymTagCompiland then
          Names[i] := RtlxExtractNamePath(Names[i]);
      end
      // For heap allocation sites, we use the name of the parent
      else if (Tags[i] = SymTagHeapAllocationSite) and
        (Symbols[i].get_lexicalParent(Parent) = S_OK) and
        (Parent.get_name(WideName) = S_OK) and (WideName <> '') then
        Names[i] := WideName;
  end
  else
    Names := nil;

  // Sort by tag and then by name
  TArray.SortIndexInline<IDiaSymbol>(Symbols,
    function (const IndexA, IndexB: Integer): Integer
    begin
      // Group by tag
      {$R-}{$Q-}
      Result := Integer(Tags[IndexA]) - Integer(Tags[IndexB]);
      {$IFDEF Q+}{$Q+}{$ENDIF}{$IFDEF R+}{$R+}{$ENDIF}

      if Result <> 0 then
        Exit;

      // Then sort by name
      if SortByName then
      begin
        Result := RtlxCompareStrings(Names[IndexA], Names[IndexB]);

        if Result <> 0 then
          Exit;
      end;

      // Then by index, to preserve order of unnamed entries of the same type
      {$R-}{$Q-}
      Result := IndexA - IndexB;
      {$IFDEF Q+}{$Q+}{$ENDIF}{$IFDEF R+}{$R+}{$ENDIF}
    end
  );
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to reflection'}

function DiaxSymbol_get_symTag(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TSymTagEnum;
begin
  Result := Symbol.get_symTag(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_name(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_name(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_dataKind(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TDataKind;
begin
  Result := Symbol.get_dataKind(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_locationType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TLocationType;
begin
  Result := Symbol.get_locationType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_addressSection(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_addressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_addressOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_addressOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_relativeVirtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_relativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_virtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Symbol.get_virtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_registerId(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_registerId(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText, rfHint];
    Reflection.Text := LookupRegisterName(Value, CurrentDiaMachineType);
    Reflection.Hint := BuildHint([
      THintSection.New('Value (decimal)', UiLibUIntToDec(Value)),
      THintSection.New('Value (hex)', UiLibUIntToHex(Value))
    ]);
  end;
end;

function DiaxSymbol_get_offset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Integer;
begin
  Result := Symbol.get_offset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_length(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Symbol.get_length(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_slot(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_slot(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_volatileType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_volatileType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_constType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_constType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_unalignedType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_unalignedType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_access(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvAccessE;
begin
  Result := Symbol.get_access(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_libraryName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_libraryName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_platform(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvCpuTypeE;
begin
  Result := Symbol.get_platform(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_language(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvCflLang;
begin
  Result := Symbol.get_language(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_editAndContinueEnabled(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_editAndContinueEnabled(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_frontEndMajor(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_frontEndMajor(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_frontEndMinor(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_frontEndMinor(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_frontEndBuild(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_frontEndBuild(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_backEndMajor(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_backEndMajor(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_backEndMinor(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_backEndMinor(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_backEndBuild(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_backEndBuild(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_sourceFileName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_sourceFileName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_thunkOrdinal(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TThunkOrdinal;
begin
  Result := Symbol.get_thunkOrdinal(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_thisAdjust(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Integer;
begin
  Result := Symbol.get_thisAdjust(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_virtualBaseOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_virtualBaseOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_virtual(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_virtual(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_intro(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_intro(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_pure(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_pure(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_callingConvention(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvCallE;
begin
  Result := Symbol.get_callingConvention(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_value(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TVarData;
begin
  Result := Symbol.get_value(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_baseType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TBasicType;
begin
  Result := Symbol.get_baseType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_token(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_token(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_timeStamp(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TUnixTime;
begin
  Result := Symbol.get_timeStamp(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_guid(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TGuid;
begin
  Result := Symbol.get_guid(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_symbolsFileName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_symbolsFileName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_reference(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_reference(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_count(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_count(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_bitPosition(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_bitPosition(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_packed(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_packed(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_constructor(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_constructor(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_overloadedOperator(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_overloadedOperator(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_nested(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_nested(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasNestedTypes(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasNestedTypes(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasAssignmentOperator(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasAssignmentOperator(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasCastOperator(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasCastOperator(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_scoped(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_scoped(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_virtualBaseClass(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_virtualBaseClass(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_indirectVirtualBaseClass(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_indirectVirtualBaseClass(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_virtualBasePointerOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Integer;
begin
  Result := Symbol.get_virtualBasePointerOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_code(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_code(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_function(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_function(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_managed(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_managed(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_msil(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_msil(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_virtualBaseDispIndex(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_virtualBaseDispIndex(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_undecoratedName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_undecoratedName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_age(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_age(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_signature(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_signature(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_compilerGenerated(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_compilerGenerated(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_addressTaken(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_addressTaken(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_rank(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_rank(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_dataBytes(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Buffer: IMemory;
  Size: Cardinal;
begin
  Result := Symbol.get_dataBytes(0, Size, nil) = S_OK;

  if not Result then
    Exit;

  Buffer := Auto.AllocateDynamic(Size);
  Result := Symbol.get_dataBytes(Buffer.Size, Size, Buffer.Data) = S_OK;

  if Result then
    Reflection := FormatBuffer(Buffer, True, True);
end;

function DiaxSymbol_get_targetSection(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_targetSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_targetOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_targetOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_targetRelativeVirtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_targetRelativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_targetVirtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Symbol.get_targetVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_machineType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TImageMachine32;
begin
  Result := Symbol.get_machineType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_oemId(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_oemId(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_oemSymbolId(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_oemSymbolId(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_udtKind(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TUdtKind;
begin
  Result := Symbol.get_udtKind(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_noReturn(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_noReturn(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_customCallingConvention(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_customCallingConvention(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_noInline(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_noInline(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_optimizedCodeDebugInfo(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_optimizedCodeDebugInfo(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_notReached(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_notReached(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_interruptReturn(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_interruptReturn(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_farReturn(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_farReturn(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isStatic(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isStatic(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasDebugInfo(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasDebugInfo(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isLTCG(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isLTCG(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isDataAligned(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isDataAligned(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasSecurityChecks(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasSecurityChecks(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_compilerName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_compilerName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_hasAlloca(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasAlloca(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasSetJump(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasSetJump(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasLongJump(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasLongJump(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasInlAsm(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasInlAsm(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasEH(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasEH(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasSEH(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasSEH(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasEHa(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasEHa(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isNaked(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isNaked(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isAggregated(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isAggregated(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isSplitted(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isSplitted(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_inlSpec(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_inlSpec(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_noStackOrdering(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_noStackOrdering(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasManagedCode(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasManagedCode(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isHotpatchable(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isHotpatchable(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isCVTCIL(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isCVTCIL(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isMSILNetmodule(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isMSILNetmodule(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isCTypes(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isCTypes(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isStripped(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isStripped(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_frontEndQFE(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_frontEndQFE(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_backEndQFE(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_backEndQFE(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_wasInlined(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_wasInlined(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_strictGSCheck(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_strictGSCheck(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isCxxReturnUdt(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isCxxReturnUdt(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isConstructorVirtualBase(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isConstructorVirtualBase(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_RValueReference(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_RValueReference(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_framePointerPresent(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_framePointerPresent(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isSafeBuffers(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isSafeBuffers(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_intrinsic(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_intrinsic(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_sealed(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_sealed(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hfaFloat(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hfaFloat(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hfaDouble(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hfaDouble(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_liveRangeStartAddressSection(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_liveRangeStartAddressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_liveRangeStartAddressOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_liveRangeStartAddressOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_liveRangeStartRelativeVirtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_liveRangeStartRelativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_countLiveRanges(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_countLiveRanges(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_liveRangeLength(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Symbol.get_liveRangeLength(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_offsetInUdt(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_offsetInUdt(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_paramBasePointerRegisterId(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_paramBasePointerRegisterId(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_localBasePointerRegisterId(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_localBasePointerRegisterId(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isLocationControlFlowDependent(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isLocationControlFlowDependent(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_stride(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_stride(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_numberOfRows(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_numberOfRows(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_numberOfColumns(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_numberOfColumns(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isMatrixRowMajor(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isMatrixRowMajor(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isReturnValue(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isReturnValue(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isOptimizedAway(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isOptimizedAway(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_builtInKind(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_builtInKind(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_registerType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvHlslRegE;
begin
  Result := Symbol.get_registerType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_baseDataSlot(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_baseDataSlot(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_baseDataOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_baseDataOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_textureSlot(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_textureSlot(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_samplerSlot(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_samplerSlot(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_uavSlot(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_uavSlot(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_sizeInUdt(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_sizeInUdt(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_memorySpaceKind(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvHlslMemorySpaceE;
begin
  Result := Symbol.get_memorySpaceKind(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_numberOfModifiers(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_numberOfModifiers(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_numberOfRegisterIndices(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_numberOfRegisterIndices(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isHLSLData(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isHLSLData(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isPointerToDataMember(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isPointerToDataMember(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isPointerToMemberFunction(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isPointerToMemberFunction(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isSingleInheritance(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isSingleInheritance(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isMultipleInheritance(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isMultipleInheritance(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isVirtualInheritance(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isVirtualInheritance(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_restrictedType(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_restrictedType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isPointerBasedOnSymbolValue(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isPointerBasedOnSymbolValue(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_objectFileName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_objectFileName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_isAcceleratorGroupSharedLocal(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isAcceleratorGroupSharedLocal(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isAcceleratorPointerTagLiveRange(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isAcceleratorPointerTagLiveRange(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isAcceleratorStubFunction(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isAcceleratorStubFunction(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_numberOfAcceleratorPointerTags(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_numberOfAcceleratorPointerTags(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isSdl(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isSdl(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isWinRTPointer(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isWinRTPointer(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isRefUdt(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isRefUdt(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isValueUdt(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isValueUdt(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isInterfaceUdt(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isInterfaceUdt(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isPGO(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isPGO(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_hasValidPGOCounts(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasValidPGOCounts(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_isOptimizedForSpeed(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_isOptimizedForSpeed(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_PGOEntryCount(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_PGOEntryCount(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_PGOEdgeCount(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_PGOEdgeCount(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_PGODynamicInstructionCount(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Symbol.get_PGODynamicInstructionCount(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_staticSize(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_staticSize(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_finalLiveStaticSize(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_finalLiveStaticSize(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_phaseName(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Symbol.get_phaseName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSymbol_get_hasControlFlowCheck(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_hasControlFlowCheck(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_constantExport(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_constantExport(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_dataExport(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_dataExport(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_privateExport(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_privateExport(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_noNameExport(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_noNameExport(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_exportHasExplicitlyAssignedOrdinal(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_exportHasExplicitlyAssignedOrdinal(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_exportIsForwarder(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Symbol.get_exportIsForwarder(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_ordinal(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_ordinal(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_frameSize(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_frameSize(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_exceptionHandlerAddressSection(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_exceptionHandlerAddressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_exceptionHandlerAddressOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_exceptionHandlerAddressOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_exceptionHandlerRelativeVirtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_exceptionHandlerRelativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_exceptionHandlerVirtualAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Symbol.get_exceptionHandlerVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol_get_characteristics(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TImageSectionCharacteristics;
begin
  Result := Symbol.get_characteristics(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol_get_bindID(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_bindID(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_bindSpace(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_bindSpace(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol_get_bindSlot(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Symbol.get_bindSlot(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol2_get_isObjCClass(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol2: IDiaSymbol2;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol2, Symbol2) = S_OK) and
    (Symbol2.get_isObjCClass(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol2_get_isObjCCategory(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol2: IDiaSymbol2;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol2, Symbol2) = S_OK) and
    (Symbol2.get_isObjCCategory(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol2_get_isObjCProtocol(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol2: IDiaSymbol2;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol2, Symbol2) = S_OK) and
    (Symbol2.get_isObjCProtocol(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol4_get_noexcept(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol4: IDiaSymbol4;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol4, Symbol4) = S_OK) and
    (Symbol4.get_noexcept(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol5_get_hasAbsoluteAddress(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol5: IDiaSymbol5;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol5, Symbol5) = S_OK) and
    (Symbol5.get_hasAbsoluteAddress(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol6_get_isStaticMemberFunc(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol6: IDiaSymbol6;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol6, Symbol6) = S_OK) and
    (Symbol6.get_isStaticMemberFunc(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol7_get_isSignRet(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol7: IDiaSymbol7;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol7, Symbol7) = S_OK) and
    (Symbol7.get_isSignRet(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol8_get_coroutineKind(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol8: IDiaSymbol8;
  Value: TCvCoroutineKindE;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol8, Symbol8) = S_OK) and
    (Symbol8.get_coroutineKind(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSymbol8_get_associatedSymbolKind(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol8: IDiaSymbol8;
  Value: TCvAssociationKindE;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol8, Symbol8) = S_OK) and
    (Symbol8.get_associatedSymbolKind(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol8_get_associatedSymbolSection(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol8: IDiaSymbol8;
  Value: Cardinal;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol8, Symbol8) = S_OK) and
    (Symbol8.get_associatedSymbolSection(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol8_get_associatedSymbolOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol8: IDiaSymbol8;
  Value: Cardinal;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol8, Symbol8) = S_OK) and
    (Symbol8.get_associatedSymbolOffset(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol8_get_associatedSymbolRva(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol8: IDiaSymbol8;
  Value: Cardinal;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol8, Symbol8) = S_OK) and
    (Symbol8.get_associatedSymbolRva(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol8_get_associatedSymbolAddr(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol8: IDiaSymbol8;
  Value: UInt64;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol8, Symbol8) = S_OK) and
    (Symbol8.get_associatedSymbolAddr(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol9_get_framePadSize(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol9: IDiaSymbol9;
  Value: Cardinal;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol9, Symbol9) = S_OK) and
    (Symbol9.get_framePadSize(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol9_get_framePadOffset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol9: IDiaSymbol9;
  Value: Cardinal;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol9, Symbol9) = S_OK) and
    (Symbol9.get_framePadOffset(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSymbol9_get_isRTCs(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol9: IDiaSymbol9;
  Value: LongBool;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol9, Symbol9) = S_OK) and
    (Symbol9.get_isRTCs(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSymbol11_get_discriminatedUnionTag_Offset(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol11: IDiaSymbol11;
  ValueSymbol: IDiaSymbol;
  ValueOffset: Cardinal;
  ValueMask: TDiaTagValue;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol11, Symbol11) = S_OK) and
    (Symbol11.get_discriminatedUnionTag(ValueSymbol, ValueOffset,
    ValueMask) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(ValueOffset, RttixAsHex);
end;

function DiaxSymbol11_get_discriminatedUnionTag_Mask(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Symbol11: IDiaSymbol11;
  ValueSymbol: IDiaSymbol;
  ValueOffset: Cardinal;
  ValueMask: TDiaTagValue;
  Value: UInt64;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol11, Symbol11) = S_OK) and
    (Symbol11.get_discriminatedUnionTag(ValueSymbol, ValueOffset,
    ValueMask) = S_OK);

  if Result then
  begin
    case ValueMask.valueSizeBytes of
      1: Value := ValueMask.value.data8;
      2: Value := ValueMask.value.data16;
      4: Value := ValueMask.value.data32;
      8: Value := ValueMask.value.data64;
    else
      Reflection.ValidFormats := [rfText];
      Reflection.Text := RtlxFormatString('(A DiaTagValue with %u bytes)',
        [Cardinal(ValueMask.valueSizeBytes)]);
      Reflection.Hint := '';
      Exit;
    end;

    Reflection := Rttix.FormatFull(Value, RttixAsHex);
  end;
end;

function DiaxSymbol_getSourceLinkInfo(
  const Symbol: IDiaSymbol;
  out Reflection: TRttixFullReflection
): Boolean;
var
  SessionEx: IDiaSessionEx;
  Enum: IDiaEnumSourceLink;
  Value: Cardinal;
begin
  Result := Assigned(CurrentDiaSession) and
    (CurrentDiaSession.QueryInterface(IDiaSession, SessionEx) = S_OK) and
    (SessionEx.getSourceLinkInfo(Symbol, Enum) = S_OK) and
    (Enum.Count(Value) = S_OK);

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxFormatString('(%u Source Link Blobs)', [Value]);
    Reflection.Hint := ''
  end;
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxSymbolReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaSymbol>;
  end;

const
  DiaxpSymbolToReflectionDef: array [0..206] of TDiaxSymbolReflectionProperty = (
    (Name: 'Tag'; Callback: DiaxSymbol_get_symTag),
    (Name: 'Name'; Callback: DiaxSymbol_get_name),
    (Name: 'Data Kind'; Callback: DiaxSymbol_get_dataKind),
    (Name: 'Location Type'; Callback: DiaxSymbol_get_locationType),
    (Name: 'Address Section'; Callback: DiaxSymbol_get_addressSection),
    (Name: 'Address Offset'; Callback: DiaxSymbol_get_addressOffset),
    (Name: 'Relative Virtual Address'; Callback: DiaxSymbol_get_relativeVirtualAddress),
    (Name: 'Virtual Address'; Callback: DiaxSymbol_get_virtualAddress),
    (Name: 'Register Id'; Callback: DiaxSymbol_get_registerId),
    (Name: 'Offset'; Callback: DiaxSymbol_get_offset),
    (Name: 'Length'; Callback: DiaxSymbol_get_length),
    (Name: 'Slot'; Callback: DiaxSymbol_get_slot),
    (Name: 'Volatile'; Callback: DiaxSymbol_get_volatileType),
    (Name: 'Const'; Callback: DiaxSymbol_get_constType),
    (Name: 'Unaligned'; Callback: DiaxSymbol_get_unalignedType),
    (Name: 'Access'; Callback: DiaxSymbol_get_access),
    (Name: 'Library Name'; Callback: DiaxSymbol_get_libraryName),
    (Name: 'Platform'; Callback: DiaxSymbol_get_platform),
    (Name: 'Language'; Callback: DiaxSymbol_get_language),
    (Name: 'Edit And Continue Enabled'; Callback: DiaxSymbol_get_editAndContinueEnabled),
    (Name: 'Frontend Major'; Callback: DiaxSymbol_get_frontEndMajor),
    (Name: 'Frontend Minor'; Callback: DiaxSymbol_get_frontEndMinor),
    (Name: 'Frontend Build'; Callback: DiaxSymbol_get_frontEndBuild),
    (Name: 'Frontend QFE'; Callback: DiaxSymbol_get_frontEndQFE),
    (Name: 'Backend Major'; Callback: DiaxSymbol_get_backEndMajor),
    (Name: 'Backend Minor'; Callback: DiaxSymbol_get_backEndMinor),
    (Name: 'Backend Build'; Callback: DiaxSymbol_get_backEndBuild),
    (Name: 'Backend QFE'; Callback: DiaxSymbol_get_backEndQFE),
    (Name: 'Source File Name'; Callback: DiaxSymbol_get_sourceFileName),
    (Name: 'Thunk Ordinal'; Callback: DiaxSymbol_get_thunkOrdinal),
    (Name: 'This Adjust'; Callback: DiaxSymbol_get_thisAdjust),
    (Name: 'Virtual Base Offset'; Callback: DiaxSymbol_get_virtualBaseOffset),
    (Name: 'Virtual'; Callback: DiaxSymbol_get_virtual),
    (Name: 'Introducing Virtual Function'; Callback: DiaxSymbol_get_intro),
    (Name: 'Pure'; Callback: DiaxSymbol_get_pure),
    (Name: 'Calling Convention'; Callback: DiaxSymbol_get_callingConvention),
    (Name: 'Value'; Callback: DiaxSymbol_get_value),
    (Name: 'Base Type'; Callback: DiaxSymbol_get_baseType),
    (Name: 'Token'; Callback: DiaxSymbol_get_token),
    (Name: 'Timestamp'; Callback: DiaxSymbol_get_timeStamp),
    (Name: 'GUID'; Callback: DiaxSymbol_get_guid),
    (Name: 'Symbols File Name'; Callback: DiaxSymbol_get_symbolsFileName),
    (Name: 'Reference'; Callback: DiaxSymbol_get_reference),
    (Name: 'Count'; Callback: DiaxSymbol_get_count),
    (Name: 'Bit Position'; Callback: DiaxSymbol_get_bitPosition),
    (Name: 'Packed'; Callback: DiaxSymbol_get_packed),
    (Name: 'Constructor'; Callback: DiaxSymbol_get_constructor),
    (Name: 'Overloaded Operator'; Callback: DiaxSymbol_get_overloadedOperator),
    (Name: 'Nested'; Callback: DiaxSymbol_get_nested),
    (Name: 'Has Nested Types'; Callback: DiaxSymbol_get_hasNestedTypes),
    (Name: 'Has Assignment Operator'; Callback: DiaxSymbol_get_hasAssignmentOperator),
    (Name: 'Has Cast Operator'; Callback: DiaxSymbol_get_hasCastOperator),
    (Name: 'Scoped'; Callback: DiaxSymbol_get_scoped),
    (Name: 'Virtual Base Class'; Callback: DiaxSymbol_get_virtualBaseClass),
    (Name: 'Indirect Virtual Base Class'; Callback: DiaxSymbol_get_indirectVirtualBaseClass),
    (Name: 'Virtual Base Pointer Offset'; Callback: DiaxSymbol_get_virtualBasePointerOffset),
    (Name: 'Code'; Callback: DiaxSymbol_get_code),
    (Name: 'Function'; Callback: DiaxSymbol_get_function),
    (Name: 'Managed'; Callback: DiaxSymbol_get_managed),
    (Name: 'MSIL'; Callback: DiaxSymbol_get_msil),
    (Name: 'Virtual Base Disp Index'; Callback: DiaxSymbol_get_virtualBaseDispIndex),
    (Name: 'Undecorated Name'; Callback: DiaxSymbol_get_undecoratedName),
    (Name: 'Age'; Callback: DiaxSymbol_get_age),
    (Name: 'Signature'; Callback: DiaxSymbol_get_signature),
    (Name: 'Compiler-generated'; Callback: DiaxSymbol_get_compilerGenerated),
    (Name: 'Address Taken'; Callback: DiaxSymbol_get_addressTaken),
    (Name: 'Rank'; Callback: DiaxSymbol_get_rank),
    (Name: 'Data Bytes'; Callback: DiaxSymbol_get_dataBytes),
    (Name: 'Target Section'; Callback: DiaxSymbol_get_targetSection),
    (Name: 'Target Offset'; Callback: DiaxSymbol_get_targetOffset),
    (Name: 'Target RVA'; Callback: DiaxSymbol_get_targetRelativeVirtualAddress),
    (Name: 'Target VA'; Callback: DiaxSymbol_get_targetVirtualAddress),
    (Name: 'Machine Type'; Callback: DiaxSymbol_get_machineType),
    (Name: 'OEM ID'; Callback: DiaxSymbol_get_oemId),
    (Name: 'OEM Symbol ID'; Callback: DiaxSymbol_get_oemSymbolId),
    (Name: 'UDT Kind'; Callback: DiaxSymbol_get_udtKind),
    (Name: 'No-return'; Callback: DiaxSymbol_get_noReturn),
    (Name: 'Custom Calling Convention'; Callback: DiaxSymbol_get_customCallingConvention),
    (Name: 'No-inline'; Callback: DiaxSymbol_get_noInline),
    (Name: 'Optimized Code Debug Info'; Callback: DiaxSymbol_get_optimizedCodeDebugInfo),
    (Name: 'Not Reached'; Callback: DiaxSymbol_get_notReached),
    (Name: 'Interrupt Return'; Callback: DiaxSymbol_get_interruptReturn),
    (Name: 'Far Return'; Callback: DiaxSymbol_get_farReturn),
    (Name: 'Static'; Callback: DiaxSymbol_get_isStatic),
    (Name: 'Has Debug Info'; Callback: DiaxSymbol_get_hasDebugInfo),
    (Name: 'LTCG'; Callback: DiaxSymbol_get_isLTCG),
    (Name: 'Data Aligned'; Callback: DiaxSymbol_get_isDataAligned),
    (Name: 'Has Security Checks'; Callback: DiaxSymbol_get_hasSecurityChecks),
    (Name: 'Compiler Name'; Callback: DiaxSymbol_get_compilerName),
    (Name: 'Has Alloca'; Callback: DiaxSymbol_get_hasAlloca),
    (Name: 'Has Set Jump'; Callback: DiaxSymbol_get_hasSetJump),
    (Name: 'Has Long Jump'; Callback: DiaxSymbol_get_hasLongJump),
    (Name: 'Has Inline Assembly'; Callback: DiaxSymbol_get_hasInlAsm),
    (Name: 'Has EH'; Callback: DiaxSymbol_get_hasEH),
    (Name: 'Has SEH'; Callback: DiaxSymbol_get_hasSEH),
    (Name: 'Has EHa'; Callback: DiaxSymbol_get_hasEHa),
    (Name: 'Naked'; Callback: DiaxSymbol_get_isNaked),
    (Name: 'Aggregated'; Callback: DiaxSymbol_get_isAggregated),
    (Name: 'Splitted'; Callback: DiaxSymbol_get_isSplitted),
    (Name: 'Inline Specified'; Callback: DiaxSymbol_get_inlSpec),
    (Name: 'No Stack Ordering'; Callback: DiaxSymbol_get_noStackOrdering),
    (Name: 'Has Managed Code'; Callback: DiaxSymbol_get_hasManagedCode),
    (Name: 'Hotpatchable'; Callback: DiaxSymbol_get_isHotpatchable),
    (Name: 'CVTCIL'; Callback: DiaxSymbol_get_isCVTCIL),
    (Name: 'MSIL Netmodule'; Callback: DiaxSymbol_get_isMSILNetmodule),
    (Name: 'C Types'; Callback: DiaxSymbol_get_isCTypes),
    (Name: 'Stripped'; Callback: DiaxSymbol_get_isStripped),
    (Name: 'Was Inlined'; Callback: DiaxSymbol_get_wasInlined),
    (Name: 'Strict GS Check'; Callback: DiaxSymbol_get_strictGSCheck),
    (Name: 'C++ Return UDT'; Callback: DiaxSymbol_get_isCxxReturnUdt),
    (Name: 'Constructor Virtual Base'; Callback: DiaxSymbol_get_isConstructorVirtualBase),
    (Name: 'RValueReference'; Callback: DiaxSymbol_get_RValueReference),
    (Name: 'Frame Pointer Present'; Callback: DiaxSymbol_get_framePointerPresent),
    (Name: 'Safe Buffers'; Callback: DiaxSymbol_get_isSafeBuffers),
    (Name: 'Intrinsic'; Callback: DiaxSymbol_get_intrinsic),
    (Name: 'Sealed'; Callback: DiaxSymbol_get_sealed),
    (Name: 'HFA Float'; Callback: DiaxSymbol_get_hfaFloat),
    (Name: 'HFA Double'; Callback: DiaxSymbol_get_hfaDouble),
    (Name: 'Live Range Start Address Section'; Callback: DiaxSymbol_get_liveRangeStartAddressSection),
    (Name: 'Live Range Start Address Offset'; Callback: DiaxSymbol_get_liveRangeStartAddressOffset),
    (Name: 'Live Range Start RVA'; Callback: DiaxSymbol_get_liveRangeStartRelativeVirtualAddress),
    (Name: 'Count Live Ranges'; Callback: DiaxSymbol_get_countLiveRanges),
    (Name: 'Live Range Length'; Callback: DiaxSymbol_get_liveRangeLength),
    (Name: 'Offset In UDT'; Callback: DiaxSymbol_get_offsetInUdt),
    (Name: 'Param Base Pointer Register ID'; Callback: DiaxSymbol_get_paramBasePointerRegisterId),
    (Name: 'Local Base Pointer Register ID'; Callback: DiaxSymbol_get_localBasePointerRegisterId),
    (Name: 'Location Control Flow Dependent'; Callback: DiaxSymbol_get_isLocationControlFlowDependent),
    (Name: 'Stride'; Callback: DiaxSymbol_get_stride),
    (Name: 'Number Of Rows'; Callback: DiaxSymbol_get_numberOfRows),
    (Name: 'Number Of Columns'; Callback: DiaxSymbol_get_numberOfColumns),
    (Name: 'Matrix Row Major'; Callback: DiaxSymbol_get_isMatrixRowMajor),
    (Name: 'Return Value'; Callback: DiaxSymbol_get_isReturnValue),
    (Name: 'Optimized Away'; Callback: DiaxSymbol_get_isOptimizedAway),
    (Name: 'Built-in Kind'; Callback: DiaxSymbol_get_builtInKind),
    (Name: 'Register Type'; Callback: DiaxSymbol_get_registerType),
    (Name: 'Base Data Slot'; Callback: DiaxSymbol_get_baseDataSlot),
    (Name: 'Base Data Offset'; Callback: DiaxSymbol_get_baseDataOffset),
    (Name: 'Texture Slot'; Callback: DiaxSymbol_get_textureSlot),
    (Name: 'Sampler Slot'; Callback: DiaxSymbol_get_samplerSlot),
    (Name: 'UAV Slot'; Callback: DiaxSymbol_get_uavSlot),
    (Name: 'Size In UDT'; Callback: DiaxSymbol_get_sizeInUdt),
    (Name: 'Memory Space Kind'; Callback: DiaxSymbol_get_memorySpaceKind),
    (Name: 'Number Of Modifiers'; Callback: DiaxSymbol_get_numberOfModifiers),
    (Name: 'Number Of Register Indices'; Callback: DiaxSymbol_get_numberOfRegisterIndices),
    (Name: 'HLSL Data'; Callback: DiaxSymbol_get_isHLSLData),
    (Name: 'Pointer To Data Member'; Callback: DiaxSymbol_get_isPointerToDataMember),
    (Name: 'Pointer To Member Function'; Callback: DiaxSymbol_get_isPointerToMemberFunction),
    (Name: 'Single Inheritance'; Callback: DiaxSymbol_get_isSingleInheritance),
    (Name: 'Multiple Inheritance'; Callback: DiaxSymbol_get_isMultipleInheritance),
    (Name: 'Virtual Inheritance'; Callback: DiaxSymbol_get_isVirtualInheritance),
    (Name: 'Restricted Type'; Callback: DiaxSymbol_get_restrictedType),
    (Name: 'Pointer Based On Symbol Value'; Callback: DiaxSymbol_get_isPointerBasedOnSymbolValue),
    (Name: 'Object Filename'; Callback: DiaxSymbol_get_objectFileName),
    (Name: 'Accelerator Group Shared Local'; Callback: DiaxSymbol_get_isAcceleratorGroupSharedLocal),
    (Name: 'Accelerator Pointer Tag Live Range'; Callback: DiaxSymbol_get_isAcceleratorPointerTagLiveRange),
    (Name: 'Accelerator Stub Function'; Callback: DiaxSymbol_get_isAcceleratorStubFunction),
    (Name: 'Number Of Accelerator Pointer Tags'; Callback: DiaxSymbol_get_numberOfAcceleratorPointerTags),
    (Name: 'SDL'; Callback: DiaxSymbol_get_isSdl),
    (Name: 'WinRT Pointer'; Callback: DiaxSymbol_get_isWinRTPointer),
    (Name: 'Ref UDT'; Callback: DiaxSymbol_get_isRefUdt),
    (Name: 'Value UDT'; Callback: DiaxSymbol_get_isValueUdt),
    (Name: 'Interface UDT'; Callback: DiaxSymbol_get_isInterfaceUdt),
    (Name: 'PGO'; Callback: DiaxSymbol_get_isPGO),
    (Name: 'Has Valid PGO Counts'; Callback: DiaxSymbol_get_hasValidPGOCounts),
    (Name: 'Optimized For Speed'; Callback: DiaxSymbol_get_isOptimizedForSpeed),
    (Name: 'PGO Entry Count'; Callback: DiaxSymbol_get_PGOEntryCount),
    (Name: 'PGO Edge Count'; Callback: DiaxSymbol_get_PGOEdgeCount),
    (Name: 'PGO Dynamic Instruction Count'; Callback: DiaxSymbol_get_PGODynamicInstructionCount),
    (Name: 'Static Size'; Callback: DiaxSymbol_get_staticSize),
    (Name: 'Final Live Static Size'; Callback: DiaxSymbol_get_finalLiveStaticSize),
    (Name: 'Phase Name'; Callback: DiaxSymbol_get_phaseName),
    (Name: 'Has Control Flow Check'; Callback: DiaxSymbol_get_hasControlFlowCheck),
    (Name: 'Constant Export'; Callback: DiaxSymbol_get_constantExport),
    (Name: 'Data Export'; Callback: DiaxSymbol_get_dataExport),
    (Name: 'Private Export'; Callback: DiaxSymbol_get_privateExport),
    (Name: 'No-name Export'; Callback: DiaxSymbol_get_noNameExport),
    (Name: 'Export Has Explicitly Assigned Ordinal'; Callback: DiaxSymbol_get_exportHasExplicitlyAssignedOrdinal),
    (Name: 'Export Is Forwarder'; Callback: DiaxSymbol_get_exportIsForwarder),
    (Name: 'Ordinal'; Callback: DiaxSymbol_get_ordinal),
    (Name: 'Frame Size'; Callback: DiaxSymbol_get_frameSize),
    (Name: 'Exception Handler Address Section'; Callback: DiaxSymbol_get_exceptionHandlerAddressSection),
    (Name: 'Exception Handler Address Offset'; Callback: DiaxSymbol_get_exceptionHandlerAddressOffset),
    (Name: 'Exception Handler RVA'; Callback: DiaxSymbol_get_exceptionHandlerRelativeVirtualAddress),
    (Name: 'Exception Handler VA'; Callback: DiaxSymbol_get_exceptionHandlerVirtualAddress),
    (Name: 'Characteristics'; Callback: DiaxSymbol_get_characteristics),
    (Name: 'Bind ID'; Callback: DiaxSymbol_get_bindID),
    (Name: 'Bind Space'; Callback: DiaxSymbol_get_bindSpace),
    (Name: 'Bind Slot'; Callback: DiaxSymbol_get_bindSlot),
    (Name: 'Objective-C Class'; Callback: DiaxSymbol2_get_isObjCClass),
    (Name: 'Objective-C Category'; Callback: DiaxSymbol2_get_isObjCCategory),
    (Name: 'Objective-C Protocol'; Callback: DiaxSymbol2_get_isObjCProtocol),
    (Name: 'No-except'; Callback: DiaxSymbol4_get_noexcept),
    (Name: 'Has Absolute Address'; Callback: DiaxSymbol5_get_hasAbsoluteAddress),
    (Name: 'Static Member Function'; Callback: DiaxSymbol6_get_isStaticMemberFunc),
    (Name: 'Sign Return'; Callback: DiaxSymbol7_get_isSignRet),
    (Name: 'Coroutine Kind'; Callback: DiaxSymbol8_get_coroutineKind),
    (Name: 'Associated Symbol Kind'; Callback: DiaxSymbol8_get_associatedSymbolKind),
    (Name: 'Associated Symbol Section'; Callback: DiaxSymbol8_get_associatedSymbolSection),
    (Name: 'Associated Symbol Offset'; Callback: DiaxSymbol8_get_associatedSymbolOffset),
    (Name: 'Associated Symbol RVA'; Callback: DiaxSymbol8_get_associatedSymbolRva),
    (Name: 'Associated Symbol Address'; Callback: DiaxSymbol8_get_associatedSymbolAddr),
    (Name: 'Frame Pad Size'; Callback: DiaxSymbol9_get_framePadSize),
    (Name: 'Frame Pad Offset'; Callback: DiaxSymbol9_get_framePadOffset),
    (Name: 'RTCs'; Callback: DiaxSymbol9_get_isRTCs),
    (Name: 'Discriminated Union Tag Offset'; Callback: DiaxSymbol11_get_discriminatedUnionTag_Offset),
    (Name: 'Discriminated Union Tag Mask'; Callback: DiaxSymbol11_get_discriminatedUnionTag_Mask),
    (Name: 'Source Link Info'; Callback: DiaxSymbol_getSourceLinkInfo)
  );

var
  DiaxpSymbolToReflectionCache: TArray<TDiaxReflectionProperty<IDiaSymbol>>;

function DiaxSymbolToReflection;
var
  i: Integer;
begin
  if Length(DiaxpSymbolToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpSymbolToReflectionCache, Length(DiaxpSymbolToReflectionDef));

    for i := 0 to High(DiaxpSymbolToReflectionCache) do
    begin
      DiaxpSymbolToReflectionCache[i].Name :=
        DiaxpSymbolToReflectionDef[i].Name;
      DiaxpSymbolToReflectionCache[i].Callback :=
        DiaxpSymbolToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpSymbolToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to IDiaSymbol'}

function DiaxSymbol_get_lexicalParent(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_lexicalParent(Value) = S_OK;
end;

function DiaxSymbol_get_classParent(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_classParent(Value) = S_OK;
end;

function DiaxSymbol_get_type(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_type(Value) = S_OK;
end;

function DiaxSymbol_get_arrayIndexType(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_arrayIndexType(Value) = S_OK;
end;

function DiaxSymbol_get_virtualTableShape(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_virtualTableShape(Value) = S_OK;
end;

function DiaxSymbol_get_lowerBound(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_lowerBound(Value) = S_OK;
end;

function DiaxSymbol_get_upperBound(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_upperBound(Value) = S_OK;
end;

function DiaxSymbol_get_objectPointerType(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_objectPointerType(Value) = S_OK;
end;

function DiaxSymbol_get_container(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_container(Value) = S_OK;
end;

function DiaxSymbol_get_virtualBaseTableType(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_virtualBaseTableType(Value) = S_OK;
end;

function DiaxSymbol_get_unmodifiedType(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_unmodifiedType(Value) = S_OK;
end;

function DiaxSymbol_get_subType(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_subType(Value) = S_OK;
end;

function DiaxSymbol_get_baseSymbol(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_baseSymbol(Value) = S_OK;
end;

function DiaxSymbol_get_coffGroup(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
begin
  Result := Symbol.get_coffGroup(Value) = S_OK;
end;

function DiaxSymbol3_get_inlinee(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
var
  Symbol3: IDiaSymbol3;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol3, Symbol3) = S_OK) and
    (Symbol3.get_inlinee(Value) = S_OK);
end;

function DiaxSymbol11_get_discriminatedUnionTag_Type(
  const Symbol: IDiaSymbol;
  out Value: IDiaSymbol
): Boolean;
var
  Symbol11: IDiaSymbol11;
  ValueOffset: Cardinal;
  ValueMask: TDiaTagValue;
begin
  Result := (Symbol.QueryInterface(IDiaSymbol11, Symbol11) = S_OK) and
    (Symbol11.get_discriminatedUnionTag(Value, ValueOffset, ValueMask) = S_OK);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxSymbolSymbolProperty = record
    Name: String;
    Callback: TDiaxInstancePropertyCallback<IDiaSymbol, IDiaSymbol>;
  end;

const
  DiaxpSymbolToSymbolDef: array [0..15] of TDiaxSymbolSymbolProperty = (
    (Name: 'Lexical Parent'; Callback: DiaxSymbol_get_lexicalParent),
    (Name: 'Class Parent'; Callback: DiaxSymbol_get_classParent),
    (Name: 'Type'; Callback: DiaxSymbol_get_type),
    (Name: 'Array Index Type'; Callback: DiaxSymbol_get_arrayIndexType),
    (Name: 'Virtual Table Shape'; Callback: DiaxSymbol_get_virtualTableShape),
    (Name: 'Lower Bound'; Callback: DiaxSymbol_get_lowerBound),
    (Name: 'Upper Bound'; Callback: DiaxSymbol_get_upperBound),
    (Name: 'Object Pointer Type'; Callback: DiaxSymbol_get_objectPointerType),
    (Name: 'Container'; Callback: DiaxSymbol_get_container),
    (Name: 'Virtual Base Table Type'; Callback: DiaxSymbol_get_virtualBaseTableType),
    (Name: 'Unmodified Type'; Callback: DiaxSymbol_get_unmodifiedType),
    (Name: 'Subtype'; Callback: DiaxSymbol_get_subType),
    (Name: 'Base Symbol'; Callback: DiaxSymbol_get_baseSymbol),
    (Name: 'Coff Group'; Callback: DiaxSymbol_get_coffGroup),
    (Name: 'Inlinee'; Callback: DiaxSymbol3_get_inlinee),
    (Name: 'Discriminated Union Tag Type'; Callback: DiaxSymbol11_get_discriminatedUnionTag_Type)
  );

var
  DiaxpSymbolToSymbolCache: TArray<TDiaxInstanceProperty<IDiaSymbol, IDiaSymbol>>;

function DiaxSymbolToSymbol;
var
  i: Integer;
begin
  if Length(DiaxpSymbolToSymbolCache) <= 0 then
  begin
    SetLength(DiaxpSymbolToSymbolCache, Length(DiaxpSymbolToSymbolDef));

    for i := 0 to High(DiaxpSymbolToSymbolCache) do
    begin
      DiaxpSymbolToSymbolCache[i].Name := DiaxpSymbolToSymbolDef[i].Name;
      DiaxpSymbolToSymbolCache[i].Callback := DiaxpSymbolToSymbolDef[i].Callback;
    end;
  end;

  Result := DiaxpSymbolToSymbolCache;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to IDiaEnum<IDiaSymbol>'}

function DiaxSymbol_findFile(
  const Symbol: IDiaSymbol;
  out Enum: IDiaEnum<IDiaSourceFile>
): Boolean;
begin
  Result := Assigned(CurrentDiaSession) and (CurrentDiaSession.findFile(Symbol,
    '', 0, IDiaEnumSourceFiles(Enum)) = S_OK);
end;

function DiaxSymbolToSourceFileEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Files';
  Result[0].Callback := DiaxSymbol_findFile;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to IDiaEnum<IDiaSymbol>'}

function DiaxSymbol_get_types(
  const Symbol: IDiaSymbol;
  out Enum: IDiaEnum<IDiaSymbol>
): Boolean;
var
  Required: Cardinal;
  Elements: TArray<IDiaSymbol>;
begin
  Result := Symbol.get_types(0, Required, nil) = S_OK;

  if not Result then
    Exit;

  if Required > 0 then
  begin
    SetLength(Elements, Required);
    Result := Symbol.get_types(Length(Elements), Required, Elements[0]) = S_OK;

    if not Result then
      Exit;

    SetLength(Elements, Required);
  end
  else
    Elements := nil;

  Enum := TFakeDiaEnum<IDiaSymbol>.Create(Elements);
end;

function DiaxSymbol_findChildren(
  const Symbol: IDiaSymbol;
  out Enum: IDiaEnum<IDiaSymbol>
): Boolean;
begin
  Result := Symbol.findChildren(SymTagNull, '', 0, IDiaEnumSymbols(Enum)) = S_OK;
end;

function DiaxSymbolToSymbolEnum;
begin
  SetLength(Result, 2);
  Result[0].Name := 'Types';
  Result[0].Callback := DiaxSymbol_get_types;
  Result[1].Name := 'Children';
  Result[1].Callback := DiaxSymbol_findChildren;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to IDiaLineNumber'}

function DiaxSymbol_getSrcLineOnTypeDefn(
  const Symbol: IDiaSymbol;
  out LineNumber: IDiaLineNumber
): Boolean;
begin
  Result := Symbol.getSrcLineOnTypeDefn(LineNumber) = S_OK;
end;

function DiaxSymbolToLineNumber;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Source Line On Type Definition';
  Result[0].Callback := DiaxSymbol_getSrcLineOnTypeDefn;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to IDiaEnum<IDiaLineNumber>'}

function DiaxSymbol_findInlineeLines(
  const Symbol: IDiaSymbol;
  out Enum: IDiaEnum<IDiaLineNumber>
): Boolean;
begin
  Result := Symbol.findInlineeLines(IDiaEnumLineNumbers(Enum)) = S_OK;
end;

function DiaxSymbolToLineNumberEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Inlinee Lines';
  Result[0].Callback := DiaxSymbol_findInlineeLines;
end;

{$ENDREGION}
{$REGION 'IDiaSymbol to IDiaInputAssemblyFile'}

function DiaxSymbol_findInputAssemblyFile(
  const Symbol: IDiaSymbol;
  out AssemblyFile: IDiaInputAssemblyFile
): Boolean;
begin
  Result := Symbol.findInputAssemblyFile(AssemblyFile) = S_OK;
end;

function DiaxSymbolToAssemblyFile;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Input Assembly File';
  Result[0].Callback := DiaxSymbol_findInputAssemblyFile;
end;

{$ENDREGION}
{$REGION 'IDiaSourceFile sorting'}

procedure DiaxSortSourceFiles;
var
  Names: TArray<String>;
  WideName: WideString;
  i: Integer;
begin
  // Collect names for sorting
  SetLength(Names, Length(SourceFiles));

  for i := 0 to High(SourceFiles) do
    if SourceFiles[i].get_fileName(WideName) = S_OK then
      Names[i] := RtlxExtractNamePath(WideName);

  // Sort by name
  TArray.SortIndexInline<IDiaSourceFile>(SourceFiles,
    function (const IndexA, IndexB: Integer): Integer
    begin
      Result := RtlxCompareStrings(Names[IndexA], Names[IndexB]);
    end
  );
end;

{$ENDREGION}
{$REGION 'IDiaSourceFile to reflection'}

function DiaxSourceFilee_get_fileName(
  const SourceFile: IDiaSourceFile;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := SourceFile.get_fileName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxSourceFilee_get_checksumType(
  const SourceFile: IDiaSourceFile;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TCvSourceChecksumT;
begin
  Result := SourceFile.get_checksumType(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

function DiaxSourceFilee_get_checksum(
  const SourceFile: IDiaSourceFile;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Size: Cardinal;
  Buffer: IMemory;
begin
  Result := (SourceFile.get_checksum(0, Size, nil) = S_OK) and (Size > 0);

  if not Result then
    Exit;

  Buffer := Auto.AllocateDynamic(Size);
  Result := SourceFile.get_checksum(Buffer.Size, Size, Buffer.Data) = S_OK;

  if Result then
    Reflection := FormatBuffer(Buffer, False, False);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxSourceFileReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaSourceFile>;
  end;

const
  DiaxpSourceFileToReflectionDef: array [0..2] of TDiaxSourceFileReflectionProperty = (
    (Name: 'File Name'; Callback: DiaxSourceFilee_get_fileName),
    (Name: 'Checksum Type'; Callback: DiaxSourceFilee_get_checksumType),
    (Name: 'Checksum'; Callback: DiaxSourceFilee_get_checksum)
  );

var
  DiaxpSourceFileToReflectionCache: TArray<TDiaxReflectionProperty<IDiaSourceFile>>;

function DiaxSourceFileToReflection;
var
  i: Integer;
begin
  if Length(DiaxpSourceFileToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpSourceFileToReflectionCache, Length(DiaxpSourceFileToReflectionDef));

    for i := 0 to High(DiaxpSourceFileToReflectionCache) do
    begin
      DiaxpSourceFileToReflectionCache[i].Name :=
        DiaxpSourceFileToReflectionDef[i].Name;
      DiaxpSourceFileToReflectionCache[i].Callback :=
        DiaxpSourceFileToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpSourceFileToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaInputAssemblyFile to reflection'}

function DiaxAssemblyFile_get_timestamp(
  const AssemblyFile: IDiaInputAssemblyFile;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TUnixTime;
begin
  Result := AssemblyFile.get_timestamp(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxAssemblyFile_get_pdbAvailableAtILMerge(
  const AssemblyFile: IDiaInputAssemblyFile;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := AssemblyFile.get_pdbAvailableAtILMerge(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxAssemblyFile_get_fileName(
  const AssemblyFile: IDiaInputAssemblyFile;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := AssemblyFile.get_fileName(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxAssemblyFileReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaInputAssemblyFile>;
  end;

const
  DiaxpAssemblyFileToReflectionDef: array [0..2] of TDiaxAssemblyFileReflectionProperty = (
    (Name: 'Timestamp'; Callback: DiaxAssemblyFile_get_timestamp),
    (Name: 'PDB Available At IL Merge'; Callback: DiaxAssemblyFile_get_pdbAvailableAtILMerge),
    (Name: 'File Name'; Callback: DiaxAssemblyFile_get_fileName)
  );

var
  DiaxpAssemblyFileToReflectionCache: TArray<TDiaxReflectionProperty<IDiaInputAssemblyFile>>;

function DiaxAssemblyFileToReflection;
var
  i: Integer;
begin
  if Length(DiaxpAssemblyFileToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpAssemblyFileToReflectionCache,
      Length(DiaxpAssemblyFileToReflectionDef));

    for i := 0 to High(DiaxpAssemblyFileToReflectionCache) do
    begin
      DiaxpAssemblyFileToReflectionCache[i].Name :=
        DiaxpAssemblyFileToReflectionDef[i].Name;
      DiaxpAssemblyFileToReflectionCache[i].Callback :=
        DiaxpAssemblyFileToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpAssemblyFileToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaLineNumber sorting'}

procedure DiaxSortLineNumbers;
var
  Names: TArray<String>;
  FileIDs: TArray<Cardinal>;
  Numbers: TArray<Cardinal>;
  SourceFile: IDiaSourceFile;
  WideName: WideString;
  i: Integer;
begin
  // Collect filenames and numbers for sorting
  SetLength(Names, Length(Lines));
  SetLength(FileIDs, Length(Lines));
  SetLength(Numbers, Length(Lines));

  for i := 0 to High(Lines) do
  begin
    if Lines[i].get_sourceFile(SourceFile) = S_OK then
    begin
      // Use only the name part, not the entire path
      if SourceFile.get_fileName(WideName) = S_OK then
        Names[i] := RtlxExtractNamePath(WideName);

      if SourceFile.get_uniqueId(FileIDs[i]) <> S_OK then
        FileIDs[i] := 0;
    end;

    if Lines[i].get_lineNumber(Numbers[i]) <> S_OK then
      Numbers[i] := 0;
  end;

  // Sort by name and then by number
  TArray.SortIndexInline<IDiaLineNumber>(Lines,
    function (const IndexA, IndexB: Integer): Integer
    begin
      if FileIDs[IndexA] = FileIDs[IndexB] then
        Result := 0
      else
        Result := RtlxCompareStrings(Names[IndexA], Names[IndexB]);

      if Result = 0 then
      begin
        {$R-}{$Q-}
        Result := Integer(Numbers[IndexA]) - Integer(Numbers[IndexB]);
        {$IFDEF Q+}{$Q+}{$ENDIF}{$IFDEF R+}{$R+}{$ENDIF}
      end;
    end
  );
end;

{$ENDREGION}
{$REGION 'IDiaLineNumber to reflection'}

function DiaxLine_get_lineNumber(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_lineNumber(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxLine_get_lineNumberEnd(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_lineNumberEnd(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxLine_get_columnNumber(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_columnNumber(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxLine_get_columnNumberEnd(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_columnNumberEnd(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxLine_get_addressSection(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_addressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxLine_get_addressOffset(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_addressOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxLine_get_relativeVirtualAddress(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_relativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxLine_get_virtualAddress(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Line.get_virtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxLine_get_length(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Line.get_length(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxLine_get_statement(
  const Line: IDiaLineNumber;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Line.get_statement(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxLineNumberReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaLineNumber>;
  end;

const
  DiaxpLineNumberToReflectionDef: array [0..9] of TDiaxLineNumberReflectionProperty = (
    (Name: 'Line Number'; Callback: DiaxLine_get_lineNumber),
    (Name: 'Line Number End'; Callback: DiaxLine_get_lineNumberEnd),
    (Name: 'Column Number'; Callback: DiaxLine_get_columnNumber),
    (Name: 'Column Number End'; Callback: DiaxLine_get_columnNumberEnd),
    (Name: 'Address Section'; Callback: DiaxLine_get_addressSection),
    (Name: 'Address Offset'; Callback: DiaxLine_get_addressOffset),
    (Name: 'Relative Virtual Address'; Callback: DiaxLine_get_relativeVirtualAddress),
    (Name: 'Virtual Address'; Callback: DiaxLine_get_virtualAddress),
    (Name: 'Length'; Callback: DiaxLine_get_length),
    (Name: 'Statement'; Callback: DiaxLine_get_statement)
  );

var
  DiaxpLineNumberToReflectionCache: TArray<TDiaxReflectionProperty<IDiaLineNumber>>;

function DiaxLineNumberToReflection;
var
  i: Integer;
begin
  if Length(DiaxpLineNumberToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpLineNumberToReflectionCache,
      Length(DiaxpLineNumberToReflectionDef));

    for i := 0 to High(DiaxpLineNumberToReflectionCache) do
    begin
      DiaxpLineNumberToReflectionCache[i].Name :=
        DiaxpLineNumberToReflectionDef[i].Name;
      DiaxpLineNumberToReflectionCache[i].Callback :=
        DiaxpLineNumberToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpLineNumberToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaLineNumber to IDiaSymbol'}

function DiaxLine_get_compiland(
  const LineNumber: IDiaLineNumber;
  out Symbol: IDiaSymbol
): Boolean;
begin
  Result := LineNumber.get_compiland(Symbol) = S_OK;
end;

function DiaxLineNumberToSymbol;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Compiland';
  Result[0].Callback := DiaxLine_get_compiland;
end;

{$ENDREGION}
{$REGION 'IDiaLineNumber to IDiaSourceFile'}

function DiaxLineNumber_get_sourceFile(
  const LineNumber: IDiaLineNumber;
  out SourceFile: IDiaSourceFile
): Boolean;
begin
  Result := LineNumber.get_sourceFile(SourceFile) = S_OK;
end;

function DiaxLineNumberToSourceFile;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Source File';
  Result[0].Callback := DiaxLineNumber_get_sourceFile;
end;

{$ENDREGION}
{$REGION 'IDiaSectionContrib sorting'}

procedure DiaxSortSections;
var
  RVAs: TArray<Cardinal>;
  i: Integer;
begin
  // Collect RVAs for sorting
  SetLength(RVAs, Length(Sections));

  for i := 0 to High(Sections) do
    if Sections[i].get_relativeVirtualAddress(RVAs[i]) <> S_OK then
      RVAs[i] := 0;

  // Sort by RVAs
  TArray.SortIndexInline<IDiaSectionContrib>(Sections,
    function (const IndexA, IndexB: Integer): Integer
    begin
      {$R-}{$Q-}
      Result := Integer(RVAs[IndexA]) - Integer(RVAs[IndexB]);
      {$IFDEF Q+}{$Q+}{$ENDIF}{$IFDEF R+}{$R+}{$ENDIF}
    end
  );
end;

{$ENDREGION}
{$REGION 'IDiaSectionContrib to reflection'}

function DiaxSection_get_addressSection(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Section.get_addressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_addressOffset(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Section.get_addressOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSection_get_relativeVirtualAddress(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Section.get_relativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSection_get_virtualAddress(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Section.get_virtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSection_get_length(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Section.get_length(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSection_get_notPaged(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_notPaged(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_code(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_code(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_initializedData(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_initializedData(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_uninitializedData(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_uninitializedData(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_remove(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_remove(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_comdat(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_comdat(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_discardable(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_discardable(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_notCached(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_notCached(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_share(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_share(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_execute(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_execute(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_read(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_read(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_write(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_write(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSection_get_dataCrc(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Section.get_dataCrc(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSection_get_relocationsCrc(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Section.get_relocationsCrc(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSection_get_code16bit(
  const Section: IDiaSectionContrib;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Section.get_code16bit(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxSectionReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaSectionContrib>;
  end;

const
  DiaxpSectionToReflectionDef: array [0..19] of TDiaxSectionReflectionProperty = (
    (Name: 'Address Section'; Callback: DiaxSection_get_addressSection),
    (Name: 'Address Offset'; Callback: DiaxSection_get_addressOffset),
    (Name: 'Relative Virtual Address'; Callback: DiaxSection_get_relativeVirtualAddress),
    (Name: 'Virtual Address'; Callback: DiaxSection_get_virtualAddress),
    (Name: 'Length'; Callback: DiaxSection_get_length),
    (Name: 'Not Paged'; Callback: DiaxSection_get_notPaged),
    (Name: 'Code'; Callback: DiaxSection_get_code),
    (Name: 'Initialized Data'; Callback: DiaxSection_get_initializedData),
    (Name: 'Uninitialized Data'; Callback: DiaxSection_get_uninitializedData),
    (Name: 'Remove'; Callback: DiaxSection_get_remove),
    (Name: 'COMDAT'; Callback: DiaxSection_get_comdat),
    (Name: 'Discardable'; Callback: DiaxSection_get_discardable),
    (Name: 'Not Cached'; Callback: DiaxSection_get_notCached),
    (Name: 'Share'; Callback: DiaxSection_get_share),
    (Name: 'Execute'; Callback: DiaxSection_get_execute),
    (Name: 'Read'; Callback: DiaxSection_get_read),
    (Name: 'Write'; Callback: DiaxSection_get_write),
    (Name: 'Data CRC'; Callback: DiaxSection_get_dataCrc),
    (Name: 'Relocations CRC'; Callback: DiaxSection_get_relocationsCrc),
    (Name: 'Code 16-bit'; Callback: DiaxSection_get_code16bit)
  );

var
  DiaxpSectionToReflectionCache: TArray<TDiaxReflectionProperty<IDiaSectionContrib>>;

function DiaxSectionToReflection;
var
  i: Integer;
begin
  if Length(DiaxpSectionToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpSectionToReflectionCache,
      Length(DiaxpSectionToReflectionDef));

    for i := 0 to High(DiaxpSectionToReflectionCache) do
    begin
      DiaxpSectionToReflectionCache[i].Name :=
        DiaxpSectionToReflectionDef[i].Name;
      DiaxpSectionToReflectionCache[i].Callback :=
        DiaxpSectionToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpSectionToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaSectionContrib to IDiaSymbol'}

function DiaxSection_get_sourceFile(
  const Section: IDiaSectionContrib;
  out Symbol: IDiaSymbol
): Boolean;
begin
  Result := Section.get_compiland(Symbol) = S_OK;
end;

function DiaxSectionToSymbol;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Compiland';
  Result[0].Callback := DiaxSection_get_sourceFile;
end;

{$ENDREGION}
{$REGION 'IDiaSegment to reflection'}

function DiaxSegment_get_frame(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Segment.get_frame(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSegment_get_offset(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Segment.get_offset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSegment_get_length(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Segment.get_length(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSegment_get_read(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Segment.get_read(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSegment_get_write(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Segment.get_write(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSegment_get_execute(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := Segment.get_execute(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSegment_get_addressSection(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Segment.get_addressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxSegment_get_relativeVirtualAddress(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := Segment.get_relativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxSegment_get_virtualAddress(
  const Segment: IDiaSegment;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := Segment.get_virtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxSegmentReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaSegment>;
  end;

const
  DiaxpSegmentToReflectionDef: array [0..8] of TDiaxSegmentReflectionProperty = (
    (Name: 'Frame'; Callback: DiaxSegment_get_frame),
    (Name: 'Offset'; Callback: DiaxSegment_get_offset),
    (Name: 'Length'; Callback: DiaxSegment_get_length),
    (Name: 'Read'; Callback: DiaxSegment_get_read),
    (Name: 'Write'; Callback: DiaxSegment_get_write),
    (Name: 'Execute'; Callback: DiaxSegment_get_execute),
    (Name: 'Address Section'; Callback: DiaxSegment_get_addressSection),
    (Name: 'Relative Virtual Address'; Callback: DiaxSegment_get_relativeVirtualAddress),
    (Name: 'Virtual Address'; Callback: DiaxSegment_get_virtualAddress)
  );

var
  DiaxpSegmentToReflectionCache: TArray<TDiaxReflectionProperty<IDiaSegment>>;

function DiaxSegmentToReflection;
var
  i: Integer;
begin
  if Length(DiaxpSegmentToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpSegmentToReflectionCache,
      Length(DiaxpSegmentToReflectionDef));

    for i := 0 to High(DiaxpSegmentToReflectionCache) do
    begin
      DiaxpSegmentToReflectionCache[i].Name :=
        DiaxpSegmentToReflectionDef[i].Name;
      DiaxpSegmentToReflectionCache[i].Callback :=
        DiaxpSegmentToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpSegmentToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaInjectedSource to reflection'}

function DiaxInjectedSource_get_crc(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := InjectedSource.get_crc(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxInjectedSource_get_length(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := InjectedSource.get_length(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxInjectedSource_get_filename(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := InjectedSource.get_filename(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxInjectedSource_get_objectFilename(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := InjectedSource.get_objectFilename(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxInjectedSource_get_virtualFilename(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := InjectedSource.get_virtualFilename(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxInjectedSource_get_sourceCompression(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := InjectedSource.get_sourceCompression(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxInjectedSource_get_source(
  const InjectedSource: IDiaInjectedSource;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Buffer: IMemory;
  Size: Cardinal;
begin
  Result := InjectedSource.get_source(0, Size, nil) = S_OK;

  if not Result then
    Exit;

  Buffer := Auto.AllocateDynamic(Size);
  Result := InjectedSource.get_source(Buffer.Size, Size, Buffer.Data) = S_OK;

  if Result then
    Reflection := FormatBuffer(Buffer, True, True);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxInjectedSourceReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaInjectedSource>;
  end;

const
  DiaxpInjectedSourceToReflectionDef: array [0..6] of TDiaxInjectedSourceReflectionProperty = (
    (Name: 'CRC'; Callback: DiaxInjectedSource_get_crc),
    (Name: 'Length'; Callback: DiaxInjectedSource_get_length),
    (Name: 'Filename'; Callback: DiaxInjectedSource_get_filename),
    (Name: 'Object Filename'; Callback: DiaxInjectedSource_get_objectFilename),
    (Name: 'Virtual Filename'; Callback: DiaxInjectedSource_get_virtualFilename),
    (Name: 'Source Compression Method'; Callback: DiaxInjectedSource_get_sourceCompression),
    (Name: 'Source Size'; Callback: DiaxInjectedSource_get_source)
  );

var
  DiaxpInjectedSourceToReflectionCache: TArray<TDiaxReflectionProperty<IDiaInjectedSource>>;

function DiaxInjectedSourceToReflection;
var
  i: Integer;
begin
  if Length(DiaxpInjectedSourceToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpInjectedSourceToReflectionCache,
      Length(DiaxpInjectedSourceToReflectionDef));

    for i := 0 to High(DiaxpInjectedSourceToReflectionCache) do
    begin
      DiaxpInjectedSourceToReflectionCache[i].Name :=
        DiaxpInjectedSourceToReflectionDef[i].Name;
      DiaxpInjectedSourceToReflectionCache[i].Callback :=
        DiaxpInjectedSourceToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpInjectedSourceToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaFrameData to reflection'}

function DiaxFrameData_get_addressSection(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_addressSection(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxFrameData_get_addressOffset(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_addressOffset(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_relativeVirtualAddress(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_relativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_virtualAddress(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := FrameData.get_virtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_lengthBlock(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_lengthBlock(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_lengthLocals(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_lengthLocals(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_lengthParams(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_lengthParams(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_maxStack(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_maxStack(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_lengthProlog(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_lengthProlog(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_lengthSavedRegisters(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := FrameData.get_lengthSavedRegisters(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxFrameData_get_program(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := FrameData.get_program(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxFrameData_get_systemExceptionHandling(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := FrameData.get_systemExceptionHandling(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxFrameData_get_cplusplusExceptionHandling(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := FrameData.get_cplusplusExceptionHandling(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxFrameData_get_functionStart(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := FrameData.get_functionStart(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxFrameData_get_allocatesBasePointer(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: LongBool;
begin
  Result := FrameData.get_allocatesBasePointer(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxFrameData_get_type(
  const FrameData: IDiaFrameData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: TStackFrameTypeEnum;
begin
  Result := FrameData.get_type(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixPreserveEnumCase);
end;

type
  // HACK: redefine the type without generics to make the compiler happy with
  // the constant array defined below
  TDiaxFrameDataReflectionProperty = record
    Name: String;
    Callback: TDiaxReflectionPropertyCallback<IDiaFrameData>;
  end;

const
  DiaxpFrameDataToReflectionDef: array [0..15] of TDiaxFrameDataReflectionProperty = (
    (Name: 'Address Section'; Callback: DiaxFrameData_get_addressSection),
    (Name: 'Address Offset'; Callback: DiaxFrameData_get_addressOffset),
    (Name: 'Relative Virtual Address'; Callback: DiaxFrameData_get_relativeVirtualAddress),
    (Name: 'Virtual Address'; Callback: DiaxFrameData_get_virtualAddress),
    (Name: 'Length Block'; Callback: DiaxFrameData_get_lengthBlock),
    (Name: 'Length Locals'; Callback: DiaxFrameData_get_lengthLocals),
    (Name: 'Length Params'; Callback: DiaxFrameData_get_lengthParams),
    (Name: 'Max Stack'; Callback: DiaxFrameData_get_maxStack),
    (Name: 'Length Prolog'; Callback: DiaxFrameData_get_lengthProlog),
    (Name: 'Length Saved Registers'; Callback: DiaxFrameData_get_lengthSavedRegisters),
    (Name: 'Program'; Callback: DiaxFrameData_get_program),
    (Name: 'System Exception Handling'; Callback: DiaxFrameData_get_systemExceptionHandling),
    (Name: 'C++ Exception Handling'; Callback: DiaxFrameData_get_cplusplusExceptionHandling),
    (Name: 'Function Start'; Callback: DiaxFrameData_get_functionStart),
    (Name: 'Allocates Base Pointer'; Callback: DiaxFrameData_get_allocatesBasePointer),
    (Name: 'Type'; Callback: DiaxFrameData_get_type)
  );

var
  DiaxpFrameDataToReflectionCache: TArray<TDiaxReflectionProperty<IDiaFrameData>>;

function DiaxFrameDataToReflection;
var
  i: Integer;
begin
  if Length(DiaxpFrameDataToReflectionCache) <= 0 then
  begin
    SetLength(DiaxpFrameDataToReflectionCache,
      Length(DiaxpFrameDataToReflectionDef));

    for i := 0 to High(DiaxpFrameDataToReflectionCache) do
    begin
      DiaxpFrameDataToReflectionCache[i].Name :=
        DiaxpFrameDataToReflectionDef[i].Name;
      DiaxpFrameDataToReflectionCache[i].Callback :=
        DiaxpFrameDataToReflectionDef[i].Callback;
    end;
  end;

  Result := DiaxpFrameDataToReflectionCache;
end;

{$ENDREGION}
{$REGION 'IDiaFrameData to IDiaFrameData' }

function DiaxFrameData_get_functionParent(
  const FrameData: IDiaFrameData;
  out Parent: IDiaFrameData
): Boolean;
begin
  Result := FrameData.get_functionParent(Parent) = S_OK;
end;

function DiaxFrameDataToFrameData;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Function Parent';
  Result[0].Callback := DiaxFrameData_get_functionParent;
end;

{$ENDREGION}
{$REGION 'IDiaTable to reflection'}

function DiaxTable_get_name(
  const Table: IDiaTable;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := Table.get_name(Value) = S_OK;

  if Result then
  begin
    Reflection.ValidFormats := [rfText];
    Reflection.Text := RtlxStringOrDefault(Value, '(Empty)');
    Reflection.Hint := '';
  end;
end;

function DiaxTable_get_Count(
  const Table: IDiaTable;
  out Reflection: TRttixFullReflection
): Boolean;
var
  KnownTable: IUnknown;
  Value: Integer;
begin
  // Only show the count if it's not covered by known enumerators
  Result := (Table.QueryInterface(IDiaEnumSymbols, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumLineNumbers, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumSourceFiles, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumInputAssemblyFiles, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumSectionContribs, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumSegments, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumInjectedSources, KnownTable) <> S_OK) and
    (Table.QueryInterface(IDiaEnumFrameData, KnownTable) <> S_OK) and
    (Table.get_Count(Value) = S_OK);

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxTableToReflection;
begin
  SetLength(Result, 2);
  Result[0].Name := 'Name';
  Result[0].Callback := DiaxTable_get_name;
  Result[1].Name := 'Count';
  Result[1].Callback := DiaxTable_get_Count;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaSymbol>'}

function DiaxTable_AsSymbols(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaSymbol>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumSymbols, Enum) = S_OK;
end;

function DiaxTableToSymbolEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Symbols';
  Result[0].Callback := DiaxTable_AsSymbols;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaSourceFile>'}

function DiaxTable_AsSourceFiles(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaSourceFile>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumSourceFiles, Enum) = S_OK;
end;

function DiaxTableToSourceFileEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Source Files';
  Result[0].Callback := DiaxTable_AsSourceFiles;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaInputAssemblyFile>'}

function DiaxTable_AsAssemblyFiles(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaInputAssemblyFile>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumInputAssemblyFiles, Enum) = S_OK;
end;

function DiaxTableToAssemblyFileEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Assembly Files';
  Result[0].Callback := DiaxTable_AsAssemblyFiles;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaLineNumber>'}

function DiaxTable_AsLineNumbers(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaLineNumber>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumLineNumbers, Enum) = S_OK;
end;

function DiaxTableToLineNumberEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Line Numbers';
  Result[0].Callback := DiaxTable_AsLineNumbers;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaSectionContrib>'}

function DiaxTable_AsSections(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaSectionContrib>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumSectionContribs, Enum) = S_OK;
end;

function DiaxTableToSectionEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Section Contributions';
  Result[0].Callback := DiaxTable_AsSections;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaSegment>'}

function DiaxTable_AsSegments(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaSegment>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumSegments, Enum) = S_OK;
end;

function DiaxTableToSegmentEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Segments';
  Result[0].Callback := DiaxTable_AsSegments;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaInjectedSource>'}

function DiaxTable_AsInjectedSources(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaInjectedSource>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumInjectedSources, Enum) = S_OK;
end;

function DiaxTableToInjectedSourceEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Injected Sources';
  Result[0].Callback := DiaxTable_AsInjectedSources;
end;

{$ENDREGION}
{$REGION 'IDiaTable to IDiaEnum<IDiaFrameData>'}

function DiaxTable_AsFrameDatas(
  const Table: IDiaTable;
  out Enum: IDiaEnum<IDiaFrameData>
): Boolean;
begin
  Result := Table.QueryInterface(IDiaEnumFrameData, Enum) = S_OK;
end;

function DiaxTableToFrameDataEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Frame Data';
  Result[0].Callback := DiaxTable_AsFrameDatas;
end;

{$ENDREGION}
{$REGION 'IDiaEnumDebugStreamData to reflection'}

function DiaxDebugStream_get_name(
  const DebugStream: IDiaEnumDebugStreamData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: WideString;
begin
  Result := DebugStream.get_name(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value);
end;

function DiaxDebugStreamToReflection;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Name';
  Result[0].Callback := DiaxDebugStream_get_name;
end;

{$ENDREGION}
{$REGION 'IDiaEnumDebugStreamData to IDiaImageData'}

function DiaxDebugStream_AsImageData(
  const DebugStream: IDiaEnumDebugStreamData;
  out ImageData: IDiaImageData
): Boolean;
begin
  Result := DebugStream.QueryInterface(IDiaImageData, ImageData) = S_OK;
end;

function DiaxDebugStreamToImageData;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Image Data';
  Result[0].Callback := DiaxDebugStream_AsImageData;
end;

{$ENDREGION}
{$REGION 'IDiaEnumDebugStreamData to IDiaEnum<IBinaryData>'}

type
  TBinaryStreamData = class (TAutoInterfacedObject, IBinaryData)
    FData: IMemory;
    FType: IRttixType;
    function GetTypeInfo: IRttixType;
    function GetData: IMemory;
    function FormatProperties: TArray<TSimpleProperty>; virtual;
    constructor Create(
      const AType: IRttixType;
      const Data: IMemory
    );
  end;
  TBinaryStreamDataClass = class of TBinaryStreamData;

  TImageSectionHeaderStreamData = class (TBinaryStreamData, IBinaryData,
    IImageSectionHeader)
    function GetSectionName: String;
  end;

  TXFixupDataStreamData = class (TBinaryStreamData, IBinaryData, IXFixupData)
  end;

  TFpoDataStreamData = class (TBinaryStreamData, IBinaryData, IFpoData)
    function FormatProperties: TArray<TSimpleProperty>; override;
  end;

  TFrameDataStreamData = class (TBinaryStreamData, IBinaryData, IFrameData)
    function FormatProperties: TArray<TSimpleProperty>; override;
  end;

  TOmapDataStreamData = class (TBinaryStreamData, IBinaryData, IOmapData)
  end;

constructor TBinaryStreamData.Create;
begin
  FType := AType;
  FData := Data;
end;

function TBinaryStreamData.FormatProperties;
var
  Formatters: TArray<IRttixFieldFormatter>;
  i: Integer;
begin
  if not Assigned(FType) then
    Exit(nil);

  // Ask our reflection system to format all record fields
  Formatters := RttixMakeFieldFormattersForType(FType);
  SetLength(Result, Length(Formatters));

  for i := 0 to High(Formatters) do
  begin
    Result[i].Name := Formatters[i].Field.Name;
    Result[i].Value := Formatters[i].Format(FData.Data^, [rfText, rfHint]);
  end;
end;

function TBinaryStreamData.GetData;
begin
  Result := FData;
end;

function TBinaryStreamData.GetTypeInfo;
begin
  Result := FType;
end;

function TImageSectionHeaderStreamData.GetSectionName;
begin
  Result := String(PImageSectionHeader(FData.Data).Name)
end;

function TFpoDataStreamData.FormatProperties;
var
  Buffer: PFpoData;
begin
  // FPO_DATA makes uses bit fields and our reflection system is not yet
  // flexible enough to handle them automatically, so do formatting manually
  SetLength(Result, 9);
  Buffer := FData.Data;
  Result[0].Name := 'OffsetStart';
  Result[0].Value := Rttix.FormatFull(Buffer.OffsetStart, RttixAsHex);
  Result[1].Name := 'ProcedureSize';
  Result[1].Value := Rttix.FormatFull(Buffer.ProcSize, RttixAsHex);
  Result[2].Name := 'Locals';
  Result[2].Value := Rttix.FormatFull(Buffer.Locals, RttixAsHex);
  Result[3].Name := 'Parameters';
  Result[3].Value := Rttix.FormatFull(Buffer.Params, RttixAsHex);
  Result[4].Name := 'Prolog';
  Result[4].Value := Rttix.FormatFull(Buffer.Prolog, RttixAsHex);
  Result[5].Name := 'Registers';
  Result[5].Value := Rttix.FormatFull(Buffer.BitField and $07, RttixAsHex);
  Result[6].Name := 'HasSEH';
  Result[6].Value := Rttix.FormatFull(BitTest(Buffer.BitField and $08));
  Result[7].Name := 'UseBP';
  Result[7].Value := Rttix.FormatFull(BitTest(Buffer.BitField and $10));
  Result[8].Name := 'Frame';
  Result[8].Value := Rttix.FormatFull(TFpoDataFrame(
    (Buffer.BitField and $C0) shr 6), RttixPreserveEnumCase);
end;

function TFrameDataStreamData.FormatProperties;
var
  Buffer: PFrameData;
begin
  // FPO_DATA makes uses bit fields and our reflection system is not yet
  // flexible enough to handle them automatically, so do formatting manually
  SetLength(Result, 11);
  Buffer := FData.Data;
  Result[0].Name := 'RVAStart';
  Result[0].Value := Rttix.FormatFull(Buffer.RvaStart, RttixAsHex);
  Result[1].Name := 'Block';
  Result[1].Value := Rttix.FormatFull(Buffer.Block, RttixAsHex);
  Result[2].Name := 'Locals';
  Result[2].Value := Rttix.FormatFull(Buffer.Locals, RttixAsHex);
  Result[3].Name := 'Parameters';
  Result[3].Value := Rttix.FormatFull(Buffer.Params, RttixAsHex);
  Result[4].Name := 'StackMax';
  Result[4].Value := Rttix.FormatFull(Buffer.StkMax, RttixAsHex);
  Result[5].Name := 'FrameFunc';
  Result[5].Value := Rttix.FormatFull(Buffer.FrameFunc, RttixAsHex);
  Result[6].Name := 'Prolog';
  Result[6].Value := Rttix.FormatFull(Buffer.Prolog, RttixAsHex);
  Result[7].Name := 'SavedReg';
  Result[7].Value := Rttix.FormatFull(Buffer.SavedRegs, RttixAsHex);
  Result[8].Name := 'HasSEH';
  Result[8].Value := Rttix.FormatFull(BitTest(Buffer.BitField and $01));
  Result[9].Name := 'HasEH';
  Result[9].Value := Rttix.FormatFull(BitTest(Buffer.BitField and $02));
  Result[10].Name := 'IsFunctionStart';
  Result[10].Value := Rttix.FormatFull(BitTest(Buffer.BitField and $04));
end;

function DiaxDebugStream_AsBinaryDataEnum(
  const DebugStream: IDiaEnumDebugStreamData;
  out Enum: IDiaEnum<IBinaryData>
): Boolean;
var
  i, Count: Integer;
  Entries: TArray<IBinaryData>;
  Name: WideString;
  Buffer: IMemory;
  Size, ExpectedSize, Fetched: Cardinal;
  AType: IRttixType;
  BinaryClass: TBinaryStreamDataClass;
begin
  DebugStream.Reset;
  Result := DebugStream.get_Count(Count) = S_OK;

  if not Result then
    Exit;

  SetLength(Entries, Count);
  AType := nil;
  BinaryClass := TBinaryStreamData;
  ExpectedSize := 0;

  // Some streams store elements with known structure
  if DebugStream.get_name(Name) = S_OK then
  begin
    // IMAGE_SECTION_HEADER entries
    if RtlxEqualStrings(Name, 'SECTIONHEADERS') or
      RtlxEqualStrings(Name, 'SECTIONHEADERSORIG') then
    begin
      AType := RttixTypeInfo(TypeInfo(TImageSectionHeader));
      ExpectedSize := SizeOf(TImageSectionHeader);
      BinaryClass := TImageSectionHeaderStreamData;
    end

    // XFIXUP_DATA entries
    else if RtlxEqualStrings(Name, 'FIXUP') then
    begin
      AType := RttixTypeInfo(DiaxCurrentFixupDataTypeInfo, RttixPreserveEnumCase);
      ExpectedSize := SizeOf(TXFixupData);
      BinaryClass := TXFixupDataStreamData;
    end

    // FPO_DATA entries
    else if RtlxEqualStrings(Name, 'FPO') then
    begin
      AType := RttixTypeInfo(TypeInfo(TFpoData), RttixPreserveEnumCase);
      ExpectedSize := SizeOf(TFpoData);
      BinaryClass := TFpoDataStreamData;
    end

    // FRAMEDATA entries
    else if RtlxEqualStrings(Name, 'NEWFPO') then
    begin
      AType := RttixTypeInfo(TypeInfo(TFrameData), RttixPreserveEnumCase);
      ExpectedSize := SizeOf(TFrameData);
      BinaryClass := TFrameDataStreamData;
    end

    // OMAP_DATA entries
    else if RtlxEqualStrings(Name, 'OMAPTO') or
      RtlxEqualStrings(Name, 'OMAPFROM') then
    begin
      AType := RttixTypeInfo(TypeInfo(TOmapData), RttixPreserveEnumCase);
      ExpectedSize := SizeOf(TOmapData);
      BinaryClass := TOmapDataStreamData;
    end
  end;

  for i := 0 to High(Entries) do
  begin
    // Determine the entry's size
    Result := DebugStream.Next(1, 0, Size, nil, Fetched) = S_OK;

    if not Result then
      Exit;

    // Read it
    Buffer := Auto.AllocateDynamic(Size);
    Result := DebugStream.Next(1, Buffer.Size, Size, Buffer.Data, Fetched) = S_OK;

    if not Result then
      Exit;

    // Create a wrapper object
    if Buffer.Size >= ExpectedSize then
      Entries[i] := BinaryClass.Create(AType, Buffer)
    else
      Entries[i] := TBinaryStreamData.Create(AType, Buffer)
  end;

  // Put them into an enumerator
  Enum := TFakeDiaEnum<IBinaryData>.Create(Entries);
end;

function DiaxDebugStreamToBinaryDataEnum;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Items';
  Result[0].Callback := DiaxDebugStream_AsBinaryDataEnum;
end;

{$ENDREGION}
{$REGION 'IDiaImageData to reflection'}

function DiaxImageData_get_relativeVirtualAddress(
  const ImageData: IDiaImageData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: Cardinal;
begin
  Result := ImageData.get_relativeVirtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxImageData_get_virtualAddress(
  const ImageData: IDiaImageData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := ImageData.get_virtualAddress(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxImageData_get_imageBase(
  const ImageData: IDiaImageData;
  out Reflection: TRttixFullReflection
): Boolean;
var
  Value: UInt64;
begin
  Result := ImageData.get_imageBase(Value) = S_OK;

  if Result then
    Reflection := Rttix.FormatFull(Value, RttixAsHex);
end;

function DiaxImageDataToReflection;
begin
  SetLength(Result, 3);
  Result[0].Name := 'Relative Virtual Address';
  Result[0].Callback := DiaxImageData_get_relativeVirtualAddress;
  Result[1].Name := 'Virtual Address';
  Result[1].Callback := DiaxImageData_get_virtualAddress;
  Result[2].Name := 'Image Base';
  Result[2].Callback := DiaxImageData_get_imageBase;
end;

{$ENDREGION}
{$REGION 'IBinaryData to reflection'}

function DiaxBinaryData_GetData(
  const BinaryData: IBinaryData;
  out Reflection: TRttixFullReflection
): Boolean;
begin
  // Skip data with known type info (which is handled via RTTI)
  Result := not Assigned(BinaryData.TypeInfo);

  if Result then
    Reflection := FormatBuffer(BinaryData.GetData, False, True);
end;

function DiaxBinaryDataToReflection;
begin
  SetLength(Result, 1);
  Result[0].Name := 'Raw Data (As Hex)';
  Result[0].Callback := DiaxBinaryData_GetData;
end;

{$ENDREGION}

initialization
  RttixRegisterBasicFormatters;
  RttixRegisterTimeFormatters;
end.

```

`DiaSymbolView.dpr`:

```dpr
program DiaSymbolView;

uses
  Vcl.Forms,
  MainForm in 'MainForm.pas' {DiaSymbolViewMain},
  DiaNodes in 'DiaNodes.pas',
  DevirtualizedTree in 'NtUtilsUI\Components\DevirtualizedTree.pas',
  DevirtualizedTree.Provider in 'NtUtilsUI\Components\DevirtualizedTree.Provider.pas',
  VirtualTreesEx.DefaultMenu in 'NtUtilsUI\Components\VirtualTreesEx.DefaultMenu.pas',
  VirtualTreesEx in 'NtUtilsUI\Components\VirtualTreesEx.pas',
  NtUiCommon.Exceptions in 'NtUtilsUI\Common\NtUiCommon.Exceptions.pas',
  NtUiCommon.Helpers in 'NtUtilsUI\Common\NtUiCommon.Helpers.pas',
  DiaProperties in 'DiaProperties.pas',
  VclEx.Form in 'NtUtilsUI\VclEx\VclEx.Form.pas',
  VclEx.Edit in 'NtUtilsUI\VclEx\VclEx.Edit.pas',
  NtUiFrame in 'NtUtilsUI\Prototypes\NtUiFrame.pas' {BaseFrame: TFrame},
  NtUiFrame.Search in 'NtUtilsUI\Prototypes\NtUiFrame.Search.pas' {SearchFrame: TFrame},
  NtUiCommon.Interfaces in 'NtUtilsUI\Common\NtUiCommon.Interfaces.pas',
  TextHelpers in 'TextHelpers.pas',
  Settings in 'Settings.pas',
  RegisterNames in 'RegisterNames.pas';

{$R *.res}
{$WEAKLINKRTTI ON}

begin
  EnableNtUiLibExceptionHandling;
  Application.Initialize;
  Application.MainFormOnTaskbar := True;
  Application.HintHidePause := 20000;
  Application.CreateForm(TDiaSymbolViewMain, DiaSymbolViewMain);
  Application.Run;
end.

```

`DiaSymbolView.dproj`:

```dproj
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <ProjectGuid>{E19B3CFC-A774-4FE5-9100-4B9A4F6AC833}</ProjectGuid>
        <ProjectVersion>20.1</ProjectVersion>
        <FrameworkType>VCL</FrameworkType>
        <Base>True</Base>
        <Config Condition="'$(Config)'==''">Release</Config>
        <Platform Condition="'$(Platform)'==''">Win64</Platform>
        <ProjectName Condition="'$(ProjectName)'==''">DiaSymbolView</ProjectName>
        <TargetedPlatforms>3</TargetedPlatforms>
        <AppType>Application</AppType>
        <MainSource>DiaSymbolView.dpr</MainSource>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Config)'=='Base' or '$(Base)'!=''">
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="('$(Platform)'=='Win32' and '$(Base)'=='true') or '$(Base_Win32)'!=''">
        <Base_Win32>true</Base_Win32>
        <CfgParent>Base</CfgParent>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="('$(Platform)'=='Win64' and '$(Base)'=='true') or '$(Base_Win64)'!=''">
        <Base_Win64>true</Base_Win64>
        <CfgParent>Base</CfgParent>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Config)'=='Debug' or '$(Cfg_1)'!=''">
        <Cfg_1>true</Cfg_1>
        <CfgParent>Base</CfgParent>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="('$(Platform)'=='Win32' and '$(Cfg_1)'=='true') or '$(Cfg_1_Win32)'!=''">
        <Cfg_1_Win32>true</Cfg_1_Win32>
        <CfgParent>Cfg_1</CfgParent>
        <Cfg_1>true</Cfg_1>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="('$(Platform)'=='Win64' and '$(Cfg_1)'=='true') or '$(Cfg_1_Win64)'!=''">
        <Cfg_1_Win64>true</Cfg_1_Win64>
        <CfgParent>Cfg_1</CfgParent>
        <Cfg_1>true</Cfg_1>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Config)'=='Release' or '$(Cfg_2)'!=''">
        <Cfg_2>true</Cfg_2>
        <CfgParent>Base</CfgParent>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="('$(Platform)'=='Win32' and '$(Cfg_2)'=='true') or '$(Cfg_2_Win32)'!=''">
        <Cfg_2_Win32>true</Cfg_2_Win32>
        <CfgParent>Cfg_2</CfgParent>
        <Cfg_2>true</Cfg_2>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="('$(Platform)'=='Win64' and '$(Cfg_2)'=='true') or '$(Cfg_2_Win64)'!=''">
        <Cfg_2_Win64>true</Cfg_2_Win64>
        <CfgParent>Cfg_2</CfgParent>
        <Cfg_2>true</Cfg_2>
        <Base>true</Base>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Base)'!=''">
        <DCC_DcuOutput>.\$(Platform)\$(Config)</DCC_DcuOutput>
        <DCC_ExeOutput>.\$(Platform)\$(Config)</DCC_ExeOutput>
        <DCC_E>false</DCC_E>
        <DCC_N>false</DCC_N>
        <DCC_S>false</DCC_S>
        <DCC_F>false</DCC_F>
        <DCC_K>false</DCC_K>
        <DCC_Namespace>System;Xml;Data;Datasnap;Web;Soap;Vcl;Vcl.Imaging;Vcl.Touch;Vcl.Samples;Vcl.Shell;$(DCC_Namespace)</DCC_Namespace>
        <Icon_MainIcon>$(BDS)\bin\delphi_PROJECTICON.ico</Icon_MainIcon>
        <UWP_DelphiLogo44>$(BDS)\bin\Artwork\Windows\UWP\delphi_UwpDefault_44.png</UWP_DelphiLogo44>
        <UWP_DelphiLogo150>$(BDS)\bin\Artwork\Windows\UWP\delphi_UwpDefault_150.png</UWP_DelphiLogo150>
        <SanitizedProjectName>DiaSymbolView</SanitizedProjectName>
        <DCC_UnitSearchPath>.\NtUtilsUI\NtUtils\Headers;.\NtUtilsUI\NtUtils;.\NtUtilsUI\NtUtils\NtUiLib;$(DCC_UnitSearchPath)</DCC_UnitSearchPath>
        <VerInfo_Locale>2057</VerInfo_Locale>
        <VerInfo_Keys>CompanyName=diversenok;FileDescription=DiaSymbolView - PDB File Inspection Tool;FileVersion=1.0.0.0;InternalName=;LegalCopyright=diversenok;LegalTrademarks=;OriginalFilename=DiaSymbolView.exe;ProgramID=;ProductName=$(MSBuildProjectName);ProductVersion=1.0.0.0;Comments=https://github.com/diversenok/DiaSymbolView</VerInfo_Keys>
        <DCC_MapFile>3</DCC_MapFile>
        <PostBuildEventCancelOnError>false</PostBuildEventCancelOnError>
        <PostBuildEvent><![CDATA[cd $(OUTPUTDIR)
map2pdb.exe -bind $(OUTPUTNAME).map
$(PostBuildEvent)]]></PostBuildEvent>
        <PostBuildEventExecuteWhen>TargetOutOfDate</PostBuildEventExecuteWhen>
        <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>
        <DCC_DebugInfoInExe>true</DCC_DebugInfoInExe>
        <ImageDebugInfo>true</ImageDebugInfo>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Base_Win32)'!=''">
        <DCC_UsePackage>vclwinx;fmx;vclie;DbxCommonDriver;bindengine;IndyIPCommon;VCLRESTComponents;FireDACCommonODBC;FireDACCommonDriver;appanalytics;IndyProtocols;vclx;Skia.Package.RTL;IndyIPClient;dbxcds;vcledge;bindcompvclwinx;bindcompfmx;inetdb;FireDACSqliteDriver;DbxClientDriver;soapmidas;vclactnband;fmxFireDAC;dbexpress;DBXMySQLDriver;VclSmp;inet;vcltouch;fmxase;dbrtl;Skia.Package.FMX;fmxdae;FireDACMSAccDriver;CustomIPTransport;vcldsnap;DBXInterBaseDriver;IndySystem;Skia.Package.VCL;vcldb;vclFireDAC;bindcomp;FireDACCommon;IndyCore;RESTBackendComponents;VirtualTreesExtension;bindcompdbx;rtl;FireDACMySQLDriver;FireDACADSDriver;RESTComponents;DBXSqliteDriver;vcl;IndyIPServer;dsnapxml;dsnapcon;adortl;VirtualTreesDR;vclimg;FireDACPgDriver;FireDAC;inetdbxpress;VclExtension;xmlrtl;tethering;bindcompvcl;dsnap;CloudService;fmxobj;bindcompvclsmp;soaprtl;soapserver;FireDACIBDriver;$(DCC_UsePackage)</DCC_UsePackage>
        <DCC_Namespace>Winapi;System.Win;Data.Win;Datasnap.Win;Web.Win;Soap.Win;Xml.Win;Bde;$(DCC_Namespace)</DCC_Namespace>
        <BT_BuildType>Debug</BT_BuildType>
        <AppDPIAwarenessMode>none</AppDPIAwarenessMode>
        <Manifest_File>$(BDS)\bin\default_app.manifest</Manifest_File>
        <Icon_MainIcon>DiaSymbolView.ico</Icon_MainIcon>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Base_Win64)'!=''">
        <DCC_UsePackage>vclwinx;fmx;vclie;DbxCommonDriver;bindengine;IndyIPCommon;VCLRESTComponents;FireDACCommonODBC;FireDACCommonDriver;appanalytics;IndyProtocols;vclx;IndyIPClient;dbxcds;vcledge;bindcompvclwinx;bindcompfmx;inetdb;FireDACSqliteDriver;DbxClientDriver;soapmidas;vclactnband;fmxFireDAC;dbexpress;DBXMySQLDriver;VclSmp;inet;vcltouch;fmxase;dbrtl;fmxdae;FireDACMSAccDriver;CustomIPTransport;vcldsnap;DBXInterBaseDriver;IndySystem;Skia.Package.VCL;vcldb;vclFireDAC;bindcomp;FireDACCommon;IndyCore;RESTBackendComponents;VirtualTreesExtension;bindcompdbx;rtl;FireDACMySQLDriver;FireDACADSDriver;RESTComponents;DBXSqliteDriver;vcl;IndyIPServer;dsnapxml;dsnapcon;adortl;VirtualTreesDR;vclimg;FireDACPgDriver;FireDAC;inetdbxpress;VclExtension;xmlrtl;tethering;bindcompvcl;dsnap;CloudService;fmxobj;bindcompvclsmp;soaprtl;soapserver;FireDACIBDriver;$(DCC_UsePackage)</DCC_UsePackage>
        <DCC_Namespace>Winapi;System.Win;Data.Win;Datasnap.Win;Web.Win;Soap.Win;Xml.Win;$(DCC_Namespace)</DCC_Namespace>
        <BT_BuildType>Debug</BT_BuildType>
        <AppDPIAwarenessMode>none</AppDPIAwarenessMode>
        <Manifest_File>$(BDS)\bin\default_app.manifest</Manifest_File>
        <Icon_MainIcon>DiaSymbolView.ico</Icon_MainIcon>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Cfg_1)'!=''">
        <DCC_Define>DEBUG;$(DCC_Define)</DCC_Define>
        <DCC_DebugDCUs>true</DCC_DebugDCUs>
        <DCC_Optimize>false</DCC_Optimize>
        <DCC_GenerateStackFrames>true</DCC_GenerateStackFrames>
        <DCC_DebugInfoInExe>true</DCC_DebugInfoInExe>
        <DCC_RemoteDebug>true</DCC_RemoteDebug>
        <DCC_IntegerOverflowCheck>true</DCC_IntegerOverflowCheck>
        <DCC_RangeChecking>true</DCC_RangeChecking>
        <DCC_TypedAtParameter>true</DCC_TypedAtParameter>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Cfg_1_Win32)'!=''">
        <DCC_RemoteDebug>false</DCC_RemoteDebug>
        <AppDPIAwarenessMode>PerMonitorV2</AppDPIAwarenessMode>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Cfg_1_Win64)'!=''">
        <AppDPIAwarenessMode>PerMonitorV2</AppDPIAwarenessMode>
        <Icon_MainIcon>DiaSymbolView.ico</Icon_MainIcon>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Cfg_2)'!=''">
        <DCC_Define>RELEASE;$(DCC_Define)</DCC_Define>
        <DCC_SymbolReferenceInfo>0</DCC_SymbolReferenceInfo>
        <DCC_DebugInfoInExe>false</DCC_DebugInfoInExe>
        <DCC_AssertionsAtRuntime>false</DCC_AssertionsAtRuntime>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Cfg_2_Win32)'!=''">
        <AppDPIAwarenessMode>PerMonitorV2</AppDPIAwarenessMode>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Cfg_2_Win64)'!=''">
        <AppDPIAwarenessMode>PerMonitorV2</AppDPIAwarenessMode>
        <Icon_MainIcon>DiaSymbolView.ico</Icon_MainIcon>
    </PropertyGroup>
    <ItemGroup>
        <DelphiCompile Include="$(MainSource)">
            <MainSource>MainSource</MainSource>
        </DelphiCompile>
        <DCCReference Include="MainForm.pas">
            <Form>DiaSymbolViewMain</Form>
        </DCCReference>
        <DCCReference Include="DiaNodes.pas"/>
        <DCCReference Include="NtUtilsUI\Components\DevirtualizedTree.pas"/>
        <DCCReference Include="NtUtilsUI\Components\DevirtualizedTree.Provider.pas"/>
        <DCCReference Include="NtUtilsUI\Components\VirtualTreesEx.DefaultMenu.pas"/>
        <DCCReference Include="NtUtilsUI\Components\VirtualTreesEx.pas"/>
        <DCCReference Include="NtUtilsUI\Common\NtUiCommon.Exceptions.pas"/>
        <DCCReference Include="NtUtilsUI\Common\NtUiCommon.Helpers.pas"/>
        <DCCReference Include="DiaProperties.pas"/>
        <DCCReference Include="NtUtilsUI\VclEx\VclEx.Form.pas"/>
        <DCCReference Include="NtUtilsUI\VclEx\VclEx.Edit.pas"/>
        <DCCReference Include="NtUtilsUI\Prototypes\NtUiFrame.pas">
            <Form>BaseFrame</Form>
            <DesignClass>TFrame</DesignClass>
        </DCCReference>
        <DCCReference Include="NtUtilsUI\Prototypes\NtUiFrame.Search.pas">
            <Form>SearchFrame</Form>
            <DesignClass>TFrame</DesignClass>
        </DCCReference>
        <DCCReference Include="NtUtilsUI\Common\NtUiCommon.Interfaces.pas"/>
        <DCCReference Include="TextHelpers.pas"/>
        <DCCReference Include="Settings.pas"/>
        <DCCReference Include="RegisterNames.pas">
            <Form>$R *.res</Form>
        </DCCReference>
        <BuildConfiguration Include="Base">
            <Key>Base</Key>
        </BuildConfiguration>
        <BuildConfiguration Include="Debug">
            <Key>Cfg_1</Key>
            <CfgParent>Base</CfgParent>
        </BuildConfiguration>
        <BuildConfiguration Include="Release">
            <Key>Cfg_2</Key>
            <CfgParent>Base</CfgParent>
        </BuildConfiguration>
    </ItemGroup>
    <ProjectExtensions>
        <Borland.Personality>Delphi.Personality.12</Borland.Personality>
        <Borland.ProjectType>Application</Borland.ProjectType>
        <BorlandProject>
            <Delphi.Personality>
                <Source>
                    <Source Name="MainSource">DiaSymbolView.dpr</Source>
                </Source>
                <Excluded_Packages>
                    <Excluded_Packages Name="$(BDSBIN)\dcloffice2k290.bpl">Microsoft Office 2000 Sample Automation Server Wrapper Components</Excluded_Packages>
                    <Excluded_Packages Name="$(BDSBIN)\dclofficexp290.bpl">Microsoft Office XP Sample Automation Server Wrapper Components</Excluded_Packages>
                </Excluded_Packages>
            </Delphi.Personality>
            <Deployment Version="4">
                <DeployFile LocalName="Win32\Debug\DiaSymbolView.exe" Configuration="Debug" Class="ProjectOutput">
                    <Platform Name="Win32">
                        <RemoteName>DiaSymbolView.exe</RemoteName>
                        <Overwrite>true</Overwrite>
                    </Platform>
                </DeployFile>
                <DeployFile LocalName="Win64\Debug\DiaSymbolView.exe" Configuration="Debug" Class="ProjectOutput">
                    <Platform Name="Win64">
                        <RemoteName>DiaSymbolView.exe</RemoteName>
                        <Overwrite>true</Overwrite>
                    </Platform>
                </DeployFile>
                <DeployFile LocalName="Win64\Debug\DiaSymbolView.rsm" Configuration="Debug" Class="DebugSymbols">
                    <Platform Name="Win64">
                        <RemoteName>DiaSymbolView.rsm</RemoteName>
                        <Overwrite>true</Overwrite>
                    </Platform>
                </DeployFile>
                <DeployFile LocalName="Win64\Release\DiaSymbolView.exe" Configuration="Release" Class="ProjectOutput">
                    <Platform Name="Win64">
                        <RemoteName>DiaSymbolView.exe</RemoteName>
                        <Overwrite>true</Overwrite>
                    </Platform>
                </DeployFile>
                <DeployClass Name="AdditionalDebugSymbols">
                    <Platform Name="iOSSimulator">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidClasses">
                    <Platform Name="Android">
                        <RemoteDir>classes</RemoteDir>
                        <Operation>64</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>classes</RemoteDir>
                        <Operation>64</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidFileProvider">
                    <Platform Name="Android">
                        <RemoteDir>res\xml</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\xml</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidLibnativeArmeabiFile">
                    <Platform Name="Android">
                        <RemoteDir>library\lib\armeabi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\armeabi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidLibnativeArmeabiv7aFile">
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\armeabi-v7a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidLibnativeMipsFile">
                    <Platform Name="Android">
                        <RemoteDir>library\lib\mips</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\mips</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidServiceOutput">
                    <Platform Name="Android">
                        <RemoteDir>library\lib\armeabi-v7a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\arm64-v8a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidServiceOutput_Android32">
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\armeabi-v7a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidSplashImageDef">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidSplashImageDefV21">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-anydpi-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-anydpi-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidSplashStyles">
                    <Platform Name="Android">
                        <RemoteDir>res\values</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\values</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidSplashStylesV21">
                    <Platform Name="Android">
                        <RemoteDir>res\values-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\values-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="AndroidSplashStylesV31">
                    <Platform Name="Android">
                        <RemoteDir>res\values-v31</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\values-v31</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_AdaptiveIcon">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-anydpi-v26</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-anydpi-v26</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_AdaptiveIconBackground">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_AdaptiveIconForeground">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_AdaptiveIconMonochrome">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_AdaptiveIconV33">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-anydpi-v33</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-anydpi-v33</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_Colors">
                    <Platform Name="Android">
                        <RemoteDir>res\values</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\values</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_ColorsDark">
                    <Platform Name="Android">
                        <RemoteDir>res\values-night-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\values-night-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_DefaultAppIcon">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_LauncherIcon144">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_LauncherIcon192">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xxxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xxxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_LauncherIcon36">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-ldpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-ldpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_LauncherIcon48">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-mdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-mdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_LauncherIcon72">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-hdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-hdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_LauncherIcon96">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_NotificationIcon24">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-mdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-mdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_NotificationIcon36">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-hdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-hdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_NotificationIcon48">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_NotificationIcon72">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_NotificationIcon96">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xxxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xxxhdpi</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_SplashImage426">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-small</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-small</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_SplashImage470">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-normal</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-normal</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_SplashImage640">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-large</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-large</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_SplashImage960">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-xlarge</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-xlarge</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_Strings">
                    <Platform Name="Android">
                        <RemoteDir>res\values</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\values</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_VectorizedNotificationIcon">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-anydpi-v24</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-anydpi-v24</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_VectorizedSplash">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_VectorizedSplashDark">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-night-anydpi-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-night-anydpi-v21</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_VectorizedSplashV31">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-anydpi-v31</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-anydpi-v31</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="Android_VectorizedSplashV31Dark">
                    <Platform Name="Android">
                        <RemoteDir>res\drawable-night-anydpi-v31</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>res\drawable-night-anydpi-v31</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="DebugSymbols">
                    <Platform Name="iOSSimulator">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="DependencyFramework">
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.framework</Extensions>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.framework</Extensions>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.framework</Extensions>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="DependencyModule">
                    <Platform Name="iOSDevice32">
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                        <Extensions>.dll;.bpl</Extensions>
                    </Platform>
                </DeployClass>
                <DeployClass Required="true" Name="DependencyPackage">
                    <Platform Name="iOSDevice32">
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                        <Extensions>.dylib</Extensions>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                        <Extensions>.bpl</Extensions>
                    </Platform>
                </DeployClass>
                <DeployClass Name="File">
                    <Platform Name="Android">
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="iOSDevice32">
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\Resources\StartUp\</RemoteDir>
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents\Resources\StartUp\</RemoteDir>
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents\Resources\StartUp\</RemoteDir>
                        <Operation>0</Operation>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectAndroidManifest">
                    <Platform Name="Android">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectOSXDebug">
                    <Platform Name="OSX64">
                        <RemoteDir>..\$(PROJECTNAME).app.dSYM\Contents\Resources\DWARF</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>..\$(PROJECTNAME).app.dSYM\Contents\Resources\DWARF</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectOSXEntitlements">
                    <Platform Name="OSX32">
                        <RemoteDir>..\</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>..\</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>..\</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectOSXInfoPList">
                    <Platform Name="OSX32">
                        <RemoteDir>Contents</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectOSXResource">
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\Resources</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents\Resources</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents\Resources</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Required="true" Name="ProjectOutput">
                    <Platform Name="Android">
                        <RemoteDir>library\lib\armeabi-v7a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\arm64-v8a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSDevice32">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Linux64">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX32">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSX64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="OSXARM64">
                        <RemoteDir>Contents\MacOS</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win32">
                        <Operation>0</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectOutput_Android32">
                    <Platform Name="Android64">
                        <RemoteDir>library\lib\armeabi-v7a</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectUWPManifest">
                    <Platform Name="Win32">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win64">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win64x">
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectiOSDeviceDebug">
                    <Platform Name="iOSDevice32">
                        <RemoteDir>..\$(PROJECTNAME).app.dSYM\Contents\Resources\DWARF</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).app.dSYM\Contents\Resources\DWARF</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).app.dSYM\Contents\Resources\DWARF</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectiOSEntitlements">
                    <Platform Name="iOSDevice32">
                        <RemoteDir>..\</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectiOSInfoPList">
                    <Platform Name="iOSDevice32">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectiOSLaunchScreen">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen</RemoteDir>
                        <Operation>64</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen</RemoteDir>
                        <Operation>64</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="ProjectiOSResource">
                    <Platform Name="iOSDevice32">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSDevice64">
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="UWP_DelphiLogo150">
                    <Platform Name="Win32">
                        <RemoteDir>Assets</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win64">
                        <RemoteDir>Assets</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="UWP_DelphiLogo44">
                    <Platform Name="Win32">
                        <RemoteDir>Assets</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="Win64">
                        <RemoteDir>Assets</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iOS_AppStore1024">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_AppIcon152">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_AppIcon167">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_Launch2x">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_LaunchDark2x">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_Notification40">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_Setting58">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPad_SpotLight80">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_AppIcon120">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_AppIcon180">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Launch2x">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Launch3x">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_LaunchDark2x">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_LaunchDark3x">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\LaunchScreenImage.imageset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Notification40">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Notification60">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Setting58">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Setting87">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Spotlight120">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <DeployClass Name="iPhone_Spotlight80">
                    <Platform Name="iOSDevice64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                    <Platform Name="iOSSimARM64">
                        <RemoteDir>..\$(PROJECTNAME).launchscreen\Assets\AppIcon.appiconset</RemoteDir>
                        <Operation>1</Operation>
                    </Platform>
                </DeployClass>
                <ProjectRoot Platform="Android" Name="$(PROJECTNAME)"/>
                <ProjectRoot Platform="Android64" Name="$(PROJECTNAME)"/>
                <ProjectRoot Platform="iOSDevice32" Name="$(PROJECTNAME).app"/>
                <ProjectRoot Platform="iOSDevice64" Name="$(PROJECTNAME).app"/>
                <ProjectRoot Platform="iOSSimARM64" Name="$(PROJECTNAME).app"/>
                <ProjectRoot Platform="Linux64" Name="$(PROJECTNAME)"/>
                <ProjectRoot Platform="OSX32" Name="$(PROJECTNAME).app"/>
                <ProjectRoot Platform="OSX64" Name="$(PROJECTNAME).app"/>
                <ProjectRoot Platform="OSXARM64" Name="$(PROJECTNAME).app"/>
                <ProjectRoot Platform="Win32" Name="$(PROJECTNAME)"/>
                <ProjectRoot Platform="Win64" Name="$(PROJECTNAME)"/>
                <ProjectRoot Platform="Win64x" Name="$(PROJECTNAME)"/>
            </Deployment>
            <Platforms>
                <Platform value="Win32">True</Platform>
                <Platform value="Win64">True</Platform>
            </Platforms>
        </BorlandProject>
        <ProjectFileVersion>12</ProjectFileVersion>
    </ProjectExtensions>
    <Import Project="$(BDS)\Bin\CodeGear.Delphi.Targets" Condition="Exists('$(BDS)\Bin\CodeGear.Delphi.Targets')"/>
    <Import Project="$(APPDATA)\Embarcadero\$(BDSAPPDATABASEDIR)\$(PRODUCTVERSION)\UserTools.proj" Condition="Exists('$(APPDATA)\Embarcadero\$(BDSAPPDATABASEDIR)\$(PRODUCTVERSION)\UserTools.proj')"/>
    <Import Project="$(MSBuildProjectName).deployproj" Condition="Exists('$(MSBuildProjectName).deployproj')"/>
    <PropertyGroup Condition="'$(Config)'=='Debug' And '$(Platform)'=='Win32'">
        <PreBuildEvent/>
        <PreBuildEventIgnoreExitCode>False</PreBuildEventIgnoreExitCode>
        <PreLinkEvent/>
        <PreLinkEventIgnoreExitCode>False</PreLinkEventIgnoreExitCode>
        <PostBuildEvent>cd $(OUTPUTDIR)&amp;map2pdb.exe -bind $(OUTPUTNAME).map</PostBuildEvent>
        <PostBuildEventIgnoreExitCode>True</PostBuildEventIgnoreExitCode>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Config)'=='Debug' And '$(Platform)'=='Win64'">
        <PreBuildEvent/>
        <PreBuildEventIgnoreExitCode>False</PreBuildEventIgnoreExitCode>
        <PreLinkEvent/>
        <PreLinkEventIgnoreExitCode>False</PreLinkEventIgnoreExitCode>
        <PostBuildEvent>cd $(OUTPUTDIR)&amp;map2pdb.exe -bind $(OUTPUTNAME).map</PostBuildEvent>
        <PostBuildEventIgnoreExitCode>True</PostBuildEventIgnoreExitCode>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Config)'=='Release' And '$(Platform)'=='Win32'">
        <PreBuildEvent/>
        <PreBuildEventIgnoreExitCode>False</PreBuildEventIgnoreExitCode>
        <PreLinkEvent/>
        <PreLinkEventIgnoreExitCode>False</PreLinkEventIgnoreExitCode>
        <PostBuildEvent>cd $(OUTPUTDIR)&amp;map2pdb.exe -bind $(OUTPUTNAME).map</PostBuildEvent>
        <PostBuildEventIgnoreExitCode>True</PostBuildEventIgnoreExitCode>
    </PropertyGroup>
    <PropertyGroup Condition="'$(Config)'=='Release' And '$(Platform)'=='Win64'">
        <PreBuildEvent/>
        <PreBuildEventIgnoreExitCode>False</PreBuildEventIgnoreExitCode>
        <PreLinkEvent/>
        <PreLinkEventIgnoreExitCode>False</PreLinkEventIgnoreExitCode>
        <PostBuildEvent>cd $(OUTPUTDIR)&amp;map2pdb.exe -bind $(OUTPUTNAME).map</PostBuildEvent>
        <PostBuildEventIgnoreExitCode>True</PostBuildEventIgnoreExitCode>
    </PropertyGroup>
</Project>

```

`LICENSE.txt`:

```txt
MIT License

Copyright (c) 2025 diversenok

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

```

`MainForm.dfm`:

```dfm
object DiaSymbolViewMain: TDiaSymbolViewMain
  Left = 0
  Top = 0
  Caption = 'DiaSymbolView - PDB File Inspection Tool'
  ClientHeight = 441
  ClientWidth = 984
  Color = clBtnFace
  Constraints.MinHeight = 160
  Constraints.MinWidth = 320
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -12
  Font.Name = 'Segoe UI'
  Font.Style = []
  Menu = MainMenu
  ShowHint = True
  OnClose = FormClose
  OnCreate = FormCreate
  TextHeight = 15
  object Tree: TDevirtualizedTree
    Left = 0
    Top = 29
    Width = 984
    Height = 412
    Align = alClient
    ClipboardFormats.Strings = (
      'CSV'
      'Plain text'
      'Unicode text')
    Header.AutoSizeIndex = 0
    Header.DefaultHeight = 24
    Header.Height = 24
    Header.Options = [hoColumnResize, hoDblClickResize, hoDrag, hoHotTrack, hoRestrictDrag, hoVisible, hoDisableAnimatedResize, hoAutoColumnPopupMenu, hoAutoResizeInclCaption]
    TabOrder = 0
    TreeOptions.AutoOptions = [toAutoDropExpand, toAutoScrollOnExpand, toAutoTristateTracking, toAutoDeleteMovedNodes, toAutoChangeScale]
    TreeOptions.ExportMode = emSelected
    TreeOptions.MiscOptions = [toFullRepaintOnResize, toInitOnSave, toToggleOnDblClick, toWheelPanning]
    TreeOptions.PaintOptions = [toHideFocusRect, toHotTrack, toShowButtons, toShowDropmark, toShowRoot, toShowTreeLines, toThemeAware, toUseBlendedImages, toUseExplorerTheme]
    TreeOptions.SelectionOptions = [toFullRowSelect, toMultiSelect, toRightClickSelect]
    Touch.InteractiveGestures = [igPan, igPressAndTap]
    Touch.InteractiveGestureOptions = [igoPanSingleFingerHorizontal, igoPanSingleFingerVertical, igoPanInertia, igoPanGutter, igoParentPassthrough]
    NoItemsText = 'Go to File -> Open or drop a .pdb file here'
    Columns = <
      item
        Options = [coAllowClick, coDraggable, coEnabled, coParentBidiMode, coParentColor, coResizable, coVisible, coAutoSpring, coSmartResize, coAllowFocus, coDisableAnimatedResize, coEditable, coStyleColor]
        Position = 0
        Text = 'Property'
        Width = 450
      end
      item
        Options = [coAllowClick, coDraggable, coEnabled, coParentBidiMode, coParentColor, coResizable, coVisible, coAutoSpring, coSmartResize, coAllowFocus, coDisableAnimatedResize, coEditable, coStyleColor]
        Position = 1
        Text = 'Value'
        Width = 500
      end>
  end
  inline SearchBox: TSearchFrame
    AlignWithMargins = True
    Left = 0
    Top = 3
    Width = 984
    Height = 23
    Margins.Left = 0
    Margins.Right = 0
    Align = alTop
    Constraints.MinHeight = 21
    Constraints.MinWidth = 240
    DoubleBuffered = True
    ParentDoubleBuffered = False
    ParentShowHint = False
    ShowHint = True
    TabOrder = 1
    inherited Splitter: TSplitter
      Left = 818
    end
    inherited tbxSearchBox: TButtonedEditEx
      Width = 818
    end
    inherited cbxColumn: TComboBox
      Left = 824
    end
  end
  object MainMenu: TMainMenu
    Left = 48
    Top = 32
    object MenuFile: TMenuItem
      Caption = 'File'
      ShortCut = 16467
      object MenuOpenPdb: TMenuItem
        Caption = 'Open...'
        ShortCut = 16463
        OnClick = MenuOpenClick
      end
      object MenuClose: TMenuItem
        Caption = 'Close'
        ShortCut = 16499
        OnClick = MenuCloseClick
      end
      object MenuExit: TMenuItem
        Caption = 'Exit'
        OnClick = MenuExitClick
      end
    end
    object MenuOptions: TMenuItem
      Caption = 'Options'
      object MenuSetMsdiaPath: TMenuItem
        Caption = 'Set MSDIA DLL path...'
        OnClick = MenuSetMsdiaPathClick
      end
      object MenuSetSearchPath: TMenuItem
        Caption = 'Set symbol search path...'
        OnClick = MenuSetSearchPathClick
      end
      object MenuSorting: TMenuItem
        Caption = 'Entry sorting'
        object MenuNoSort: TMenuItem
          Caption = 'Preserve original order'
          RadioItem = True
          OnClick = MenuSortClick
        end
        object MenuSort: TMenuItem
          Caption = 'Smart sort'
          Checked = True
          RadioItem = True
          OnClick = MenuSortClick
        end
      end
      object MenuStackTraces: TMenuItem
        AutoCheck = True
        Caption = 'Display stack traces on errors'
        OnClick = MenuStackTracesClick
      end
    end
  end
  object OpenDialog: TOpenDialog
    Filter = 
      'PDB Files|*.pdb|PE Files|*.exe;*.dll;*.sys;*.scr;*.cpl|All Suppo' +
      'rted Files|*.pdb;*.exe;*.dll;*.sys;*.scr;*.cpl|All Files|*'
    Left = 120
    Top = 32
  end
end

```

`MainForm.pas`:

```pas
unit MainForm;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Classes,
  Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, VirtualTrees,
  VirtualTreesEx, DevirtualizedTree, Vcl.Menus, VclEx.Form, Ntapi.msdia,
  NtUiFrame.Search, NtUiFrame;

type
  TDiaxOpenMode = (opUnknown, omFromPdb, omFromExe);

  TDiaSymbolViewMain = class(TFormEx)
    MainMenu: TMainMenu;
    MenuFile: TMenuItem;
    MenuOpenPdb: TMenuItem;
    Tree: TDevirtualizedTree;
    OpenDialog: TOpenDialog;
    MenuSetMsdiaPath: TMenuItem;
    MenuOptions: TMenuItem;
    MenuSetSearchPath: TMenuItem;
    SearchBox: TSearchFrame;
    MenuSorting: TMenuItem;
    MenuNoSort: TMenuItem;
    MenuSort: TMenuItem;
    MenuStackTraces: TMenuItem;
    MenuClose: TMenuItem;
    MenuExit: TMenuItem;
    procedure MenuOpenClick(Sender: TObject);
    procedure MenuSetMsdiaPathClick(Sender: TObject);
    procedure MenuSetSearchPathClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure MenuSortClick(Sender: TObject);
    procedure MenuStackTracesClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure MenuExitClick(Sender: TObject);
    procedure MenuCloseClick(Sender: TObject);
  private
    procedure OpenFile(const FileName: String; Mode: TDiaxOpenMode = opUnknown);
    procedure WMDropFiles(var AMessage: TWMDropFiles); message WM_DROPFILES;
  protected
    procedure CreateParams(var Params: TCreateParams); override;
  end;

var
  DiaSymbolViewMain: TDiaSymbolViewMain;

implementation

uses
  NtUtils, NtUtils.DbgHelp.Dia, NtUiCommon.Helpers, NtUtils.SysUtils,
  NtUtils.WinUser, DiaNodes, DiaProperties, System.UITypes, Settings;

{$R *.dfm}

procedure TDiaSymbolViewMain.CreateParams;
begin
  inherited;
  Params.ExStyle := Params.ExStyle or WS_EX_ACCEPTFILES;
end;

procedure TDiaSymbolViewMain.FormClose;
begin
  TSettings.Save;
end;

procedure TDiaSymbolViewMain.FormCreate;
begin
  SearchBox.AttachToTree(Tree);
  TSettings.Load;
  MenuStackTraces.Checked := TSettings.ShowStackTraces;

  if TSettings.EnableSorting then
    MenuSort.Checked := True
  else
    MenuNoSort.Checked := True;

  if ParamCount >= 1 then
    OpenFile(ParamStr(1));
end;

procedure TDiaSymbolViewMain.MenuStackTracesClick;
begin
  TSettings.ShowStackTraces := MenuStackTraces.Checked;
end;

procedure TDiaSymbolViewMain.MenuCloseClick;
begin
  Tree.BeginUpdateAuto;
  Tree.Clear;
  SearchBox.ClearQuery;
  DiaxSetCurrentSession(nil);
  Tree.NoItemsText := 'Go to File -> Open or drop a .pdb file here';
  Caption := 'DiaSymbolView - PDB File Inspection Tool';
  Tree.SetFocus;
end;

procedure TDiaSymbolViewMain.MenuExitClick;
begin
  Close;
end;

procedure TDiaSymbolViewMain.MenuOpenClick;
var
  Mode: TDiaxOpenMode;
begin
  if not OpenDialog.Execute(Handle) then
    Exit;

  case OpenDialog.FilterIndex of
    1: Mode := omFromPdb;
    2: Mode := omFromExe;
  else
    Mode := opUnknown;
  end;

  OpenFile(OpenDialog.FileName, Mode);
end;

procedure TDiaSymbolViewMain.MenuSetMsdiaPathClick;
var
  Path: String;
begin
  Path := TSettings.MsdiaDllPath;
  InputQuery('MSDIA DLL', 'Path:', Path);
  TSettings.MsdiaDllPath := Path;
end;

procedure TDiaSymbolViewMain.MenuSetSearchPathClick;
var
  Path: String;
begin
  Path := TSettings.SymbolSearchPath;
  InputQuery('Symbol Search Path', 'Path:', Path);
  TSettings.SymbolSearchPath := Path;
end;

procedure TDiaSymbolViewMain.MenuSortClick;
begin
  if TSettings.EnableSorting = (Sender = MenuSort) then
    Exit;

  if Tree.RootNodeCount > 0 then
    TaskMessageDlg('Deferred setting effect', 'The change will take effect ' +
      'from the next symbol enumeration.',
      TMsgDlgType.mtWarning, [mbOK], 0);

  TSettings.EnableSorting := (Sender = MenuSort);
  (Sender as TMenuItem).Checked := True;
end;

procedure TDiaSymbolViewMain.OpenFile;
var
  Node: INodeProvider;
  Session: IDiaSession;
begin
  // If no mode already selected, choose it based on the extension
  case Mode of
    omFromPdb, omFromExe: ;
  else
    if RtlxEqualStrings(RtlxExtractExtensionPath(FileName), 'pdb') then
      Mode := omFromPdb
    else
      Mode := omFromExe;
  end;

  // Load the file
  case Mode of
    omFromPdb: DiaxRtlxLoadPdb(Session, FileName).RaiseOnError;
    omFromExe: DiaxRtlxLoadExe(Session, FileName,
      TSettings.SymbolSearchPath).RaiseOnError;
  else
    Exit;
  end;

  Tree.BeginUpdateAuto;
  Tree.Clear;
  SearchBox.ClearQuery;
  DiaxSetCurrentSession(Session);

  for Node in DiaxMakeSessionNodeChildren(Session) do
    Tree.AddChildEx(nil, Node);

  Tree.NoItemsText := 'Nothing to display';
  Caption := 'DiaSymbolView - ' + RtlxExtractNamePath(FileName);
end;

procedure TDiaSymbolViewMain.WMDropFiles;
begin
  ShlxDelayedFinishDrag(AMessage.Drop);
  OpenFile(ShlxQueryDragFile(AMessage.Drop, 0));
end;

end.

```

`Readme.md`:

```md
# DiaSymbolView

**DiaSymbolView** is a tool for visually inspecting debug information recorded in `.pdb` files. It relies on [MSDIA API](https://learn.microsoft.com/en-us/visualstudio/debugger/debug-interface-access/debug-interface-access-sdk) and presents a hierarchy of debug symbols and their 200+ properties.

You can download the binaries from the [releases page](https://github.com/diversenok/DiaSymbolView/releases). To build the tool yourself, follow instructions in Compiling.md

![DiaSymbolView screenshot](https://github.com/user-attachments/assets/51ff6745-a3d0-4c42-9f71-254050c3bd25)

```

`RegisterNames.pas`:

```pas
unit RegisterNames;

{
  This unit contains a database of names for known registers on main machine
  architectures.
}

interface

uses
  Ntapi.ImageHlp;

// Find a name for a known register or format it as an integer
function LookupRegisterName(
  RegisterId: Cardinal;
  MachineType: TImageMachine32
): String;

implementation

uses
  DelphiUtils.Arrays, NtUtils.SysUtils;

type
  TRegisterName = record
    Name: AnsiString;
    Value: Word;
  end;

var
  SharedRegisterNamesDef: array [0..12] of TRegisterName = (
    (Name: 'CV_ALLREG_ERR'; Value: 30000),
    (Name: 'CV_ALLREG_TEB'; Value: 30001),
    (Name: 'CV_ALLREG_TIMER'; Value: 30002),
    (Name: 'CV_ALLREG_EFAD1'; Value: 30003),
    (Name: 'CV_ALLREG_EFAD2'; Value: 30004),
    (Name: 'CV_ALLREG_EFAD3'; Value: 30005),
    (Name: 'CV_ALLREG_VFRAME'; Value: 30006),
    (Name: 'CV_ALLREG_HANDLE'; Value: 30007),
    (Name: 'CV_ALLREG_PARAMS'; Value: 30008),
    (Name: 'CV_ALLREG_LOCALS'; Value: 30009),
    (Name: 'CV_ALLREG_TID'; Value: 30010),
    (Name: 'CV_ALLREG_ENV'; Value: 30011),
    (Name: 'CV_ALLREG_CMDLN'; Value: 30012)
  );
  SharedRegisterNamesCache: TArray<TRegisterName>;

  X86RegisterNamesDef: array [0..361] of TRegisterName = (
    (Name: 'CV_REG_NONE'; Value: 0),
    (Name: 'CV_REG_AL'; Value: 1),
    (Name: 'CV_REG_CL'; Value: 2),
    (Name: 'CV_REG_DL'; Value: 3),
    (Name: 'CV_REG_BL'; Value: 4),
    (Name: 'CV_REG_AH'; Value: 5),
    (Name: 'CV_REG_CH'; Value: 6),
    (Name: 'CV_REG_DH'; Value: 7),
    (Name: 'CV_REG_BH'; Value: 8),
    (Name: 'CV_REG_AX'; Value: 9),
    (Name: 'CV_REG_CX'; Value: 10),
    (Name: 'CV_REG_DX'; Value: 11),
    (Name: 'CV_REG_BX'; Value: 12),
    (Name: 'CV_REG_SP'; Value: 13),
    (Name: 'CV_REG_BP'; Value: 14),
    (Name: 'CV_REG_SI'; Value: 15),
    (Name: 'CV_REG_DI'; Value: 16),
    (Name: 'CV_REG_EAX'; Value: 17),
    (Name: 'CV_REG_ECX'; Value: 18),
    (Name: 'CV_REG_EDX'; Value: 19),
    (Name: 'CV_REG_EBX'; Value: 20),
    (Name: 'CV_REG_ESP'; Value: 21),
    (Name: 'CV_REG_EBP'; Value: 22),
    (Name: 'CV_REG_ESI'; Value: 23),
    (Name: 'CV_REG_EDI'; Value: 24),
    (Name: 'CV_REG_ES'; Value: 25),
    (Name: 'CV_REG_CS'; Value: 26),
    (Name: 'CV_REG_SS'; Value: 27),
    (Name: 'CV_REG_DS'; Value: 28),
    (Name: 'CV_REG_FS'; Value: 29),
    (Name: 'CV_REG_GS'; Value: 30),
    (Name: 'CV_REG_IP'; Value: 31),
    (Name: 'CV_REG_FLAGS'; Value: 32),
    (Name: 'CV_REG_EIP'; Value: 33),
    (Name: 'CV_REG_EFLAGS'; Value: 34),
    (Name: 'CV_REG_TEMP'; Value: 40),
    (Name: 'CV_REG_TEMPH'; Value: 41),
    (Name: 'CV_REG_QUOTE'; Value: 42),
    (Name: 'CV_REG_PCDR3'; Value: 43),
    (Name: 'CV_REG_PCDR4'; Value: 44),
    (Name: 'CV_REG_PCDR5'; Value: 45),
    (Name: 'CV_REG_PCDR6'; Value: 46),
    (Name: 'CV_REG_PCDR7'; Value: 47),
    (Name: 'CV_REG_CR0'; Value: 80),
    (Name: 'CV_REG_CR1'; Value: 81),
    (Name: 'CV_REG_CR2'; Value: 82),
    (Name: 'CV_REG_CR3'; Value: 83),
    (Name: 'CV_REG_CR4'; Value: 84),
    (Name: 'CV_REG_DR0'; Value: 90),
    (Name: 'CV_REG_DR1'; Value: 91),
    (Name: 'CV_REG_DR2'; Value: 92),
    (Name: 'CV_REG_DR3'; Value: 93),
    (Name: 'CV_REG_DR4'; Value: 94),
    (Name: 'CV_REG_DR5'; Value: 95),
    (Name: 'CV_REG_DR6'; Value: 96),
    (Name: 'CV_REG_DR7'; Value: 97),
    (Name: 'CV_REG_GDTR'; Value: 110),
    (Name: 'CV_REG_GDTL'; Value: 111),
    (Name: 'CV_REG_IDTR'; Value: 112),
    (Name: 'CV_REG_IDTL'; Value: 113),
    (Name: 'CV_REG_LDTR'; Value: 114),
    (Name: 'CV_REG_TR'; Value: 115),
    (Name: 'CV_REG_PSEUDO1'; Value: 116),
    (Name: 'CV_REG_PSEUDO2'; Value: 117),
    (Name: 'CV_REG_PSEUDO3'; Value: 118),
    (Name: 'CV_REG_PSEUDO4'; Value: 119),
    (Name: 'CV_REG_PSEUDO5'; Value: 120),
    (Name: 'CV_REG_PSEUDO6'; Value: 121),
    (Name: 'CV_REG_PSEUDO7'; Value: 122),
    (Name: 'CV_REG_PSEUDO8'; Value: 123),
    (Name: 'CV_REG_PSEUDO9'; Value: 124),
    (Name: 'CV_REG_ST0'; Value: 128),
    (Name: 'CV_REG_ST1'; Value: 129),
    (Name: 'CV_REG_ST2'; Value: 130),
    (Name: 'CV_REG_ST3'; Value: 131),
    (Name: 'CV_REG_ST4'; Value: 132),
    (Name: 'CV_REG_ST5'; Value: 133),
    (Name: 'CV_REG_ST6'; Value: 134),
    (Name: 'CV_REG_ST7'; Value: 135),
    (Name: 'CV_REG_CTRL'; Value: 136),
    (Name: 'CV_REG_STAT'; Value: 137),
    (Name: 'CV_REG_TAG'; Value: 138),
    (Name: 'CV_REG_FPIP'; Value: 139),
    (Name: 'CV_REG_FPCS'; Value: 140),
    (Name: 'CV_REG_FPDO'; Value: 141),
    (Name: 'CV_REG_FPDS'; Value: 142),
    (Name: 'CV_REG_ISEM'; Value: 143),
    (Name: 'CV_REG_FPEIP'; Value: 144),
    (Name: 'CV_REG_FPEDO'; Value: 145),
    (Name: 'CV_REG_MM0'; Value: 146),
    (Name: 'CV_REG_MM1'; Value: 147),
    (Name: 'CV_REG_MM2'; Value: 148),
    (Name: 'CV_REG_MM3'; Value: 149),
    (Name: 'CV_REG_MM4'; Value: 150),
    (Name: 'CV_REG_MM5'; Value: 151),
    (Name: 'CV_REG_MM6'; Value: 152),
    (Name: 'CV_REG_MM7'; Value: 153),
    (Name: 'CV_REG_XMM0'; Value: 154),
    (Name: 'CV_REG_XMM1'; Value: 155),
    (Name: 'CV_REG_XMM2'; Value: 156),
    (Name: 'CV_REG_XMM3'; Value: 157),
    (Name: 'CV_REG_XMM4'; Value: 158),
    (Name: 'CV_REG_XMM5'; Value: 159),
    (Name: 'CV_REG_XMM6'; Value: 160),
    (Name: 'CV_REG_XMM7'; Value: 161),
    (Name: 'CV_REG_XMM00'; Value: 162),
    (Name: 'CV_REG_XMM01'; Value: 163),
    (Name: 'CV_REG_XMM02'; Value: 164),
    (Name: 'CV_REG_XMM03'; Value: 165),
    (Name: 'CV_REG_XMM10'; Value: 166),
    (Name: 'CV_REG_XMM11'; Value: 167),
    (Name: 'CV_REG_XMM12'; Value: 168),
    (Name: 'CV_REG_XMM13'; Value: 169),
    (Name: 'CV_REG_XMM20'; Value: 170),
    (Name: 'CV_REG_XMM21'; Value: 171),
    (Name: 'CV_REG_XMM22'; Value: 172),
    (Name: 'CV_REG_XMM23'; Value: 173),
    (Name: 'CV_REG_XMM30'; Value: 174),
    (Name: 'CV_REG_XMM31'; Value: 175),
    (Name: 'CV_REG_XMM32'; Value: 176),
    (Name: 'CV_REG_XMM33'; Value: 177),
    (Name: 'CV_REG_XMM40'; Value: 178),
    (Name: 'CV_REG_XMM41'; Value: 179),
    (Name: 'CV_REG_XMM42'; Value: 180),
    (Name: 'CV_REG_XMM43'; Value: 181),
    (Name: 'CV_REG_XMM50'; Value: 182),
    (Name: 'CV_REG_XMM51'; Value: 183),
    (Name: 'CV_REG_XMM52'; Value: 184),
    (Name: 'CV_REG_XMM53'; Value: 185),
    (Name: 'CV_REG_XMM60'; Value: 186),
    (Name: 'CV_REG_XMM61'; Value: 187),
    (Name: 'CV_REG_XMM62'; Value: 188),
    (Name: 'CV_REG_XMM63'; Value: 189),
    (Name: 'CV_REG_XMM70'; Value: 190),
    (Name: 'CV_REG_XMM71'; Value: 191),
    (Name: 'CV_REG_XMM72'; Value: 192),
    (Name: 'CV_REG_XMM73'; Value: 193),
    (Name: 'CV_REG_XMM0L'; Value: 194),
    (Name: 'CV_REG_XMM1L'; Value: 195),
    (Name: 'CV_REG_XMM2L'; Value: 196),
    (Name: 'CV_REG_XMM3L'; Value: 197),
    (Name: 'CV_REG_XMM4L'; Value: 198),
    (Name: 'CV_REG_XMM5L'; Value: 199),
    (Name: 'CV_REG_XMM6L'; Value: 200),
    (Name: 'CV_REG_XMM7L'; Value: 201),
    (Name: 'CV_REG_XMM0H'; Value: 202),
    (Name: 'CV_REG_XMM1H'; Value: 203),
    (Name: 'CV_REG_XMM2H'; Value: 204),
    (Name: 'CV_REG_XMM3H'; Value: 205),
    (Name: 'CV_REG_XMM4H'; Value: 206),
    (Name: 'CV_REG_XMM5H'; Value: 207),
    (Name: 'CV_REG_XMM6H'; Value: 208),
    (Name: 'CV_REG_XMM7H'; Value: 209),
    (Name: 'CV_REG_MXCSR'; Value: 211),
    (Name: 'CV_REG_EDXEAX'; Value: 212),
    (Name: 'CV_REG_EMM0L'; Value: 220),
    (Name: 'CV_REG_EMM1L'; Value: 221),
    (Name: 'CV_REG_EMM2L'; Value: 222),
    (Name: 'CV_REG_EMM3L'; Value: 223),
    (Name: 'CV_REG_EMM4L'; Value: 224),
    (Name: 'CV_REG_EMM5L'; Value: 225),
    (Name: 'CV_REG_EMM6L'; Value: 226),
    (Name: 'CV_REG_EMM7L'; Value: 227),
    (Name: 'CV_REG_EMM0H'; Value: 228),
    (Name: 'CV_REG_EMM1H'; Value: 229),
    (Name: 'CV_REG_EMM2H'; Value: 230),
    (Name: 'CV_REG_EMM3H'; Value: 231),
    (Name: 'CV_REG_EMM4H'; Value: 232),
    (Name: 'CV_REG_EMM5H'; Value: 233),
    (Name: 'CV_REG_EMM6H'; Value: 234),
    (Name: 'CV_REG_EMM7H'; Value: 235),
    (Name: 'CV_REG_MM00'; Value: 236),
    (Name: 'CV_REG_MM01'; Value: 237),
    (Name: 'CV_REG_MM10'; Value: 238),
    (Name: 'CV_REG_MM11'; Value: 239),
    (Name: 'CV_REG_MM20'; Value: 240),
    (Name: 'CV_REG_MM21'; Value: 241),
    (Name: 'CV_REG_MM30'; Value: 242),
    (Name: 'CV_REG_MM31'; Value: 243),
    (Name: 'CV_REG_MM40'; Value: 244),
    (Name: 'CV_REG_MM41'; Value: 245),
    (Name: 'CV_REG_MM50'; Value: 246),
    (Name: 'CV_REG_MM51'; Value: 247),
    (Name: 'CV_REG_MM60'; Value: 248),
    (Name: 'CV_REG_MM61'; Value: 249),
    (Name: 'CV_REG_MM70'; Value: 250),
    (Name: 'CV_REG_MM71'; Value: 251),
    (Name: 'CV_REG_YMM0'; Value: 252),
    (Name: 'CV_REG_YMM1'; Value: 253),
    (Name: 'CV_REG_YMM2'; Value: 254),
    (Name: 'CV_REG_YMM3'; Value: 255),
    (Name: 'CV_REG_YMM4'; Value: 256),
    (Name: 'CV_REG_YMM5'; Value: 257),
    (Name: 'CV_REG_YMM6'; Value: 258),
    (Name: 'CV_REG_YMM7'; Value: 259),
    (Name: 'CV_REG_YMM0H'; Value: 260),
    (Name: 'CV_REG_YMM1H'; Value: 261),
    (Name: 'CV_REG_YMM2H'; Value: 262),
    (Name: 'CV_REG_YMM3H'; Value: 263),
    (Name: 'CV_REG_YMM4H'; Value: 264),
    (Name: 'CV_REG_YMM5H'; Value: 265),
    (Name: 'CV_REG_YMM6H'; Value: 266),
    (Name: 'CV_REG_YMM7H'; Value: 267),
    (Name: 'CV_REG_YMM0I0'; Value: 268),
    (Name: 'CV_REG_YMM0I1'; Value: 269),
    (Name: 'CV_REG_YMM0I2'; Value: 270),
    (Name: 'CV_REG_YMM0I3'; Value: 271),
    (Name: 'CV_REG_YMM1I0'; Value: 272),
    (Name: 'CV_REG_YMM1I1'; Value: 273),
    (Name: 'CV_REG_YMM1I2'; Value: 274),
    (Name: 'CV_REG_YMM1I3'; Value: 275),
    (Name: 'CV_REG_YMM2I0'; Value: 276),
    (Name: 'CV_REG_YMM2I1'; Value: 277),
    (Name: 'CV_REG_YMM2I2'; Value: 278),
    (Name: 'CV_REG_YMM2I3'; Value: 279),
    (Name: 'CV_REG_YMM3I0'; Value: 280),
    (Name: 'CV_REG_YMM3I1'; Value: 281),
    (Name: 'CV_REG_YMM3I2'; Value: 282),
    (Name: 'CV_REG_YMM3I3'; Value: 283),
    (Name: 'CV_REG_YMM4I0'; Value: 284),
    (Name: 'CV_REG_YMM4I1'; Value: 285),
    (Name: 'CV_REG_YMM4I2'; Value: 286),
    (Name: 'CV_REG_YMM4I3'; Value: 287),
    (Name: 'CV_REG_YMM5I0'; Value: 288),
    (Name: 'CV_REG_YMM5I1'; Value: 289),
    (Name: 'CV_REG_YMM5I2'; Value: 290),
    (Name: 'CV_REG_YMM5I3'; Value: 291),
    (Name: 'CV_REG_YMM6I0'; Value: 292),
    (Name: 'CV_REG_YMM6I1'; Value: 293),
    (Name: 'CV_REG_YMM6I2'; Value: 294),
    (Name: 'CV_REG_YMM6I3'; Value: 295),
    (Name: 'CV_REG_YMM7I0'; Value: 296),
    (Name: 'CV_REG_YMM7I1'; Value: 297),
    (Name: 'CV_REG_YMM7I2'; Value: 298),
    (Name: 'CV_REG_YMM7I3'; Value: 299),
    (Name: 'CV_REG_YMM0F0'; Value: 300),
    (Name: 'CV_REG_YMM0F1'; Value: 301),
    (Name: 'CV_REG_YMM0F2'; Value: 302),
    (Name: 'CV_REG_YMM0F3'; Value: 303),
    (Name: 'CV_REG_YMM0F4'; Value: 304),
    (Name: 'CV_REG_YMM0F5'; Value: 305),
    (Name: 'CV_REG_YMM0F6'; Value: 306),
    (Name: 'CV_REG_YMM0F7'; Value: 307),
    (Name: 'CV_REG_YMM1F0'; Value: 308),
    (Name: 'CV_REG_YMM1F1'; Value: 309),
    (Name: 'CV_REG_YMM1F2'; Value: 310),
    (Name: 'CV_REG_YMM1F3'; Value: 311),
    (Name: 'CV_REG_YMM1F4'; Value: 312),
    (Name: 'CV_REG_YMM1F5'; Value: 313),
    (Name: 'CV_REG_YMM1F6'; Value: 314),
    (Name: 'CV_REG_YMM1F7'; Value: 315),
    (Name: 'CV_REG_YMM2F0'; Value: 316),
    (Name: 'CV_REG_YMM2F1'; Value: 317),
    (Name: 'CV_REG_YMM2F2'; Value: 318),
    (Name: 'CV_REG_YMM2F3'; Value: 319),
    (Name: 'CV_REG_YMM2F4'; Value: 320),
    (Name: 'CV_REG_YMM2F5'; Value: 321),
    (Name: 'CV_REG_YMM2F6'; Value: 322),
    (Name: 'CV_REG_YMM2F7'; Value: 323),
    (Name: 'CV_REG_YMM3F0'; Value: 324),
    (Name: 'CV_REG_YMM3F1'; Value: 325),
    (Name: 'CV_REG_YMM3F2'; Value: 326),
    (Name: 'CV_REG_YMM3F3'; Value: 327),
    (Name: 'CV_REG_YMM3F4'; Value: 328),
    (Name: 'CV_REG_YMM3F5'; Value: 329),
    (Name: 'CV_REG_YMM3F6'; Value: 330),
    (Name: 'CV_REG_YMM3F7'; Value: 331),
    (Name: 'CV_REG_YMM4F0'; Value: 332),
    (Name: 'CV_REG_YMM4F1'; Value: 333),
    (Name: 'CV_REG_YMM4F2'; Value: 334),
    (Name: 'CV_REG_YMM4F3'; Value: 335),
    (Name: 'CV_REG_YMM4F4'; Value: 336),
    (Name: 'CV_REG_YMM4F5'; Value: 337),
    (Name: 'CV_REG_YMM4F6'; Value: 338),
    (Name: 'CV_REG_YMM4F7'; Value: 339),
    (Name: 'CV_REG_YMM5F0'; Value: 340),
    (Name: 'CV_REG_YMM5F1'; Value: 341),
    (Name: 'CV_REG_YMM5F2'; Value: 342),
    (Name: 'CV_REG_YMM5F3'; Value: 343),
    (Name: 'CV_REG_YMM5F4'; Value: 344),
    (Name: 'CV_REG_YMM5F5'; Value: 345),
    (Name: 'CV_REG_YMM5F6'; Value: 346),
    (Name: 'CV_REG_YMM5F7'; Value: 347),
    (Name: 'CV_REG_YMM6F0'; Value: 348),
    (Name: 'CV_REG_YMM6F1'; Value: 349),
    (Name: 'CV_REG_YMM6F2'; Value: 350),
    (Name: 'CV_REG_YMM6F3'; Value: 351),
    (Name: 'CV_REG_YMM6F4'; Value: 352),
    (Name: 'CV_REG_YMM6F5'; Value: 353),
    (Name: 'CV_REG_YMM6F6'; Value: 354),
    (Name: 'CV_REG_YMM6F7'; Value: 355),
    (Name: 'CV_REG_YMM7F0'; Value: 356),
    (Name: 'CV_REG_YMM7F1'; Value: 357),
    (Name: 'CV_REG_YMM7F2'; Value: 358),
    (Name: 'CV_REG_YMM7F3'; Value: 359),
    (Name: 'CV_REG_YMM7F4'; Value: 360),
    (Name: 'CV_REG_YMM7F5'; Value: 361),
    (Name: 'CV_REG_YMM7F6'; Value: 362),
    (Name: 'CV_REG_YMM7F7'; Value: 363),
    (Name: 'CV_REG_YMM0D0'; Value: 364),
    (Name: 'CV_REG_YMM0D1'; Value: 365),
    (Name: 'CV_REG_YMM0D2'; Value: 366),
    (Name: 'CV_REG_YMM0D3'; Value: 367),
    (Name: 'CV_REG_YMM1D0'; Value: 368),
    (Name: 'CV_REG_YMM1D1'; Value: 369),
    (Name: 'CV_REG_YMM1D2'; Value: 370),
    (Name: 'CV_REG_YMM1D3'; Value: 371),
    (Name: 'CV_REG_YMM2D0'; Value: 372),
    (Name: 'CV_REG_YMM2D1'; Value: 373),
    (Name: 'CV_REG_YMM2D2'; Value: 374),
    (Name: 'CV_REG_YMM2D3'; Value: 375),
    (Name: 'CV_REG_YMM3D0'; Value: 376),
    (Name: 'CV_REG_YMM3D1'; Value: 377),
    (Name: 'CV_REG_YMM3D2'; Value: 378),
    (Name: 'CV_REG_YMM3D3'; Value: 379),
    (Name: 'CV_REG_YMM4D0'; Value: 380),
    (Name: 'CV_REG_YMM4D1'; Value: 381),
    (Name: 'CV_REG_YMM4D2'; Value: 382),
    (Name: 'CV_REG_YMM4D3'; Value: 383),
    (Name: 'CV_REG_YMM5D0'; Value: 384),
    (Name: 'CV_REG_YMM5D1'; Value: 385),
    (Name: 'CV_REG_YMM5D2'; Value: 386),
    (Name: 'CV_REG_YMM5D3'; Value: 387),
    (Name: 'CV_REG_YMM6D0'; Value: 388),
    (Name: 'CV_REG_YMM6D1'; Value: 389),
    (Name: 'CV_REG_YMM6D2'; Value: 390),
    (Name: 'CV_REG_YMM6D3'; Value: 391),
    (Name: 'CV_REG_YMM7D0'; Value: 392),
    (Name: 'CV_REG_YMM7D1'; Value: 393),
    (Name: 'CV_REG_YMM7D2'; Value: 394),
    (Name: 'CV_REG_YMM7D3'; Value: 395),
    (Name: 'CV_REG_BND0'; Value: 396),
    (Name: 'CV_REG_BND1'; Value: 397),
    (Name: 'CV_REG_BND2'; Value: 398),
    (Name: 'CV_REG_BND3'; Value: 399),
    (Name: 'CV_REG_BNDCFGU'; Value: 400),
    (Name: 'CV_REG_BNDSTATUS'; Value: 401),
    (Name: 'CV_REG_ZMM0'; Value: 402),
    (Name: 'CV_REG_ZMM1'; Value: 403),
    (Name: 'CV_REG_ZMM2'; Value: 404),
    (Name: 'CV_REG_ZMM3'; Value: 405),
    (Name: 'CV_REG_ZMM4'; Value: 406),
    (Name: 'CV_REG_ZMM5'; Value: 407),
    (Name: 'CV_REG_ZMM6'; Value: 408),
    (Name: 'CV_REG_ZMM7'; Value: 409),
    (Name: 'CV_REG_ZMM0H'; Value: 410),
    (Name: 'CV_REG_ZMM1H'; Value: 411),
    (Name: 'CV_REG_ZMM2H'; Value: 412),
    (Name: 'CV_REG_ZMM3H'; Value: 413),
    (Name: 'CV_REG_ZMM4H'; Value: 414),
    (Name: 'CV_REG_ZMM5H'; Value: 415),
    (Name: 'CV_REG_ZMM6H'; Value: 416),
    (Name: 'CV_REG_ZMM7H'; Value: 417),
    (Name: 'CV_REG_K0'; Value: 418),
    (Name: 'CV_REG_K1'; Value: 419),
    (Name: 'CV_REG_K2'; Value: 420),
    (Name: 'CV_REG_K3'; Value: 421),
    (Name: 'CV_REG_K4'; Value: 422),
    (Name: 'CV_REG_K5'; Value: 423),
    (Name: 'CV_REG_K6'; Value: 424),
    (Name: 'CV_REG_K7'; Value: 425),
    (Name: 'CV_REG_SSP'; Value: 426)
  );
  X86RegisterNamesCache: TArray<TRegisterName>;

  X64RegisterNamesDef: array [0..779] of TRegisterName = (
    (Name: 'CV_AMD64_AL'; Value: 1),
    (Name: 'CV_AMD64_CL'; Value: 2),
    (Name: 'CV_AMD64_DL'; Value: 3),
    (Name: 'CV_AMD64_BL'; Value: 4),
    (Name: 'CV_AMD64_AH'; Value: 5),
    (Name: 'CV_AMD64_CH'; Value: 6),
    (Name: 'CV_AMD64_DH'; Value: 7),
    (Name: 'CV_AMD64_BH'; Value: 8),
    (Name: 'CV_AMD64_AX'; Value: 9),
    (Name: 'CV_AMD64_CX'; Value: 10),
    (Name: 'CV_AMD64_DX'; Value: 11),
    (Name: 'CV_AMD64_BX'; Value: 12),
    (Name: 'CV_AMD64_SP'; Value: 13),
    (Name: 'CV_AMD64_BP'; Value: 14),
    (Name: 'CV_AMD64_SI'; Value: 15),
    (Name: 'CV_AMD64_DI'; Value: 16),
    (Name: 'CV_AMD64_EAX'; Value: 17),
    (Name: 'CV_AMD64_ECX'; Value: 18),
    (Name: 'CV_AMD64_EDX'; Value: 19),
    (Name: 'CV_AMD64_EBX'; Value: 20),
    (Name: 'CV_AMD64_ESP'; Value: 21),
    (Name: 'CV_AMD64_EBP'; Value: 22),
    (Name: 'CV_AMD64_ESI'; Value: 23),
    (Name: 'CV_AMD64_EDI'; Value: 24),
    (Name: 'CV_AMD64_ES'; Value: 25),
    (Name: 'CV_AMD64_CS'; Value: 26),
    (Name: 'CV_AMD64_SS'; Value: 27),
    (Name: 'CV_AMD64_DS'; Value: 28),
    (Name: 'CV_AMD64_FS'; Value: 29),
    (Name: 'CV_AMD64_GS'; Value: 30),
    (Name: 'CV_AMD64_FLAGS'; Value: 32),
    (Name: 'CV_AMD64_RIP'; Value: 33),
    (Name: 'CV_AMD64_EFLAGS'; Value: 34),
    (Name: 'CV_AMD64_CR0'; Value: 80),
    (Name: 'CV_AMD64_CR1'; Value: 81),
    (Name: 'CV_AMD64_CR2'; Value: 82),
    (Name: 'CV_AMD64_CR3'; Value: 83),
    (Name: 'CV_AMD64_CR4'; Value: 84),
    (Name: 'CV_AMD64_CR8'; Value: 88),
    (Name: 'CV_AMD64_DR0'; Value: 90),
    (Name: 'CV_AMD64_DR1'; Value: 91),
    (Name: 'CV_AMD64_DR2'; Value: 92),
    (Name: 'CV_AMD64_DR3'; Value: 93),
    (Name: 'CV_AMD64_DR4'; Value: 94),
    (Name: 'CV_AMD64_DR5'; Value: 95),
    (Name: 'CV_AMD64_DR6'; Value: 96),
    (Name: 'CV_AMD64_DR7'; Value: 97),
    (Name: 'CV_AMD64_DR8'; Value: 98),
    (Name: 'CV_AMD64_DR9'; Value: 99),
    (Name: 'CV_AMD64_DR10'; Value: 100),
    (Name: 'CV_AMD64_DR11'; Value: 101),
    (Name: 'CV_AMD64_DR12'; Value: 102),
    (Name: 'CV_AMD64_DR13'; Value: 103),
    (Name: 'CV_AMD64_DR14'; Value: 104),
    (Name: 'CV_AMD64_DR15'; Value: 105),
    (Name: 'CV_AMD64_GDTR'; Value: 110),
    (Name: 'CV_AMD64_GDTL'; Value: 111),
    (Name: 'CV_AMD64_IDTR'; Value: 112),
    (Name: 'CV_AMD64_IDTL'; Value: 113),
    (Name: 'CV_AMD64_LDTR'; Value: 114),
    (Name: 'CV_AMD64_TR'; Value: 115),
    (Name: 'CV_AMD64_ST0'; Value: 128),
    (Name: 'CV_AMD64_ST1'; Value: 129),
    (Name: 'CV_AMD64_ST2'; Value: 130),
    (Name: 'CV_AMD64_ST3'; Value: 131),
    (Name: 'CV_AMD64_ST4'; Value: 132),
    (Name: 'CV_AMD64_ST5'; Value: 133),
    (Name: 'CV_AMD64_ST6'; Value: 134),
    (Name: 'CV_AMD64_ST7'; Value: 135),
    (Name: 'CV_AMD64_CTRL'; Value: 136),
    (Name: 'CV_AMD64_STAT'; Value: 137),
    (Name: 'CV_AMD64_TAG'; Value: 138),
    (Name: 'CV_AMD64_FPIP'; Value: 139),
    (Name: 'CV_AMD64_FPCS'; Value: 140),
    (Name: 'CV_AMD64_FPDO'; Value: 141),
    (Name: 'CV_AMD64_FPDS'; Value: 142),
    (Name: 'CV_AMD64_ISEM'; Value: 143),
    (Name: 'CV_AMD64_FPEIP'; Value: 144),
    (Name: 'CV_AMD64_FPEDO'; Value: 145),
    (Name: 'CV_AMD64_MM0'; Value: 146),
    (Name: 'CV_AMD64_MM1'; Value: 147),
    (Name: 'CV_AMD64_MM2'; Value: 148),
    (Name: 'CV_AMD64_MM3'; Value: 149),
    (Name: 'CV_AMD64_MM4'; Value: 150),
    (Name: 'CV_AMD64_MM5'; Value: 151),
    (Name: 'CV_AMD64_MM6'; Value: 152),
    (Name: 'CV_AMD64_MM7'; Value: 153),
    (Name: 'CV_AMD64_XMM0'; Value: 154),
    (Name: 'CV_AMD64_XMM1'; Value: 155),
    (Name: 'CV_AMD64_XMM2'; Value: 156),
    (Name: 'CV_AMD64_XMM3'; Value: 157),
    (Name: 'CV_AMD64_XMM4'; Value: 158),
    (Name: 'CV_AMD64_XMM5'; Value: 159),
    (Name: 'CV_AMD64_XMM6'; Value: 160),
    (Name: 'CV_AMD64_XMM7'; Value: 161),
    (Name: 'CV_AMD64_XMM0_0'; Value: 162),
    (Name: 'CV_AMD64_XMM0_1'; Value: 163),
    (Name: 'CV_AMD64_XMM0_2'; Value: 164),
    (Name: 'CV_AMD64_XMM0_3'; Value: 165),
    (Name: 'CV_AMD64_XMM1_0'; Value: 166),
    (Name: 'CV_AMD64_XMM1_1'; Value: 167),
    (Name: 'CV_AMD64_XMM1_2'; Value: 168),
    (Name: 'CV_AMD64_XMM1_3'; Value: 169),
    (Name: 'CV_AMD64_XMM2_0'; Value: 170),
    (Name: 'CV_AMD64_XMM2_1'; Value: 171),
    (Name: 'CV_AMD64_XMM2_2'; Value: 172),
    (Name: 'CV_AMD64_XMM2_3'; Value: 173),
    (Name: 'CV_AMD64_XMM3_0'; Value: 174),
    (Name: 'CV_AMD64_XMM3_1'; Value: 175),
    (Name: 'CV_AMD64_XMM3_2'; Value: 176),
    (Name: 'CV_AMD64_XMM3_3'; Value: 177),
    (Name: 'CV_AMD64_XMM4_0'; Value: 178),
    (Name: 'CV_AMD64_XMM4_1'; Value: 179),
    (Name: 'CV_AMD64_XMM4_2'; Value: 180),
    (Name: 'CV_AMD64_XMM4_3'; Value: 181),
    (Name: 'CV_AMD64_XMM5_0'; Value: 182),
    (Name: 'CV_AMD64_XMM5_1'; Value: 183),
    (Name: 'CV_AMD64_XMM5_2'; Value: 184),
    (Name: 'CV_AMD64_XMM5_3'; Value: 185),
    (Name: 'CV_AMD64_XMM6_0'; Value: 186),
    (Name: 'CV_AMD64_XMM6_1'; Value: 187),
    (Name: 'CV_AMD64_XMM6_2'; Value: 188),
    (Name: 'CV_AMD64_XMM6_3'; Value: 189),
    (Name: 'CV_AMD64_XMM7_0'; Value: 190),
    (Name: 'CV_AMD64_XMM7_1'; Value: 191),
    (Name: 'CV_AMD64_XMM7_2'; Value: 192),
    (Name: 'CV_AMD64_XMM7_3'; Value: 193),
    (Name: 'CV_AMD64_XMM0L'; Value: 194),
    (Name: 'CV_AMD64_XMM1L'; Value: 195),
    (Name: 'CV_AMD64_XMM2L'; Value: 196),
    (Name: 'CV_AMD64_XMM3L'; Value: 197),
    (Name: 'CV_AMD64_XMM4L'; Value: 198),
    (Name: 'CV_AMD64_XMM5L'; Value: 199),
    (Name: 'CV_AMD64_XMM6L'; Value: 200),
    (Name: 'CV_AMD64_XMM7L'; Value: 201),
    (Name: 'CV_AMD64_XMM0H'; Value: 202),
    (Name: 'CV_AMD64_XMM1H'; Value: 203),
    (Name: 'CV_AMD64_XMM2H'; Value: 204),
    (Name: 'CV_AMD64_XMM3H'; Value: 205),
    (Name: 'CV_AMD64_XMM4H'; Value: 206),
    (Name: 'CV_AMD64_XMM5H'; Value: 207),
    (Name: 'CV_AMD64_XMM6H'; Value: 208),
    (Name: 'CV_AMD64_XMM7H'; Value: 209),
    (Name: 'CV_AMD64_MXCSR'; Value: 211),
    (Name: 'CV_AMD64_EMM0L'; Value: 220),
    (Name: 'CV_AMD64_EMM1L'; Value: 221),
    (Name: 'CV_AMD64_EMM2L'; Value: 222),
    (Name: 'CV_AMD64_EMM3L'; Value: 223),
    (Name: 'CV_AMD64_EMM4L'; Value: 224),
    (Name: 'CV_AMD64_EMM5L'; Value: 225),
    (Name: 'CV_AMD64_EMM6L'; Value: 226),
    (Name: 'CV_AMD64_EMM7L'; Value: 227),
    (Name: 'CV_AMD64_EMM0H'; Value: 228),
    (Name: 'CV_AMD64_EMM1H'; Value: 229),
    (Name: 'CV_AMD64_EMM2H'; Value: 230),
    (Name: 'CV_AMD64_EMM3H'; Value: 231),
    (Name: 'CV_AMD64_EMM4H'; Value: 232),
    (Name: 'CV_AMD64_EMM5H'; Value: 233),
    (Name: 'CV_AMD64_EMM6H'; Value: 234),
    (Name: 'CV_AMD64_EMM7H'; Value: 235),
    (Name: 'CV_AMD64_MM00'; Value: 236),
    (Name: 'CV_AMD64_MM01'; Value: 237),
    (Name: 'CV_AMD64_MM10'; Value: 238),
    (Name: 'CV_AMD64_MM11'; Value: 239),
    (Name: 'CV_AMD64_MM20'; Value: 240),
    (Name: 'CV_AMD64_MM21'; Value: 241),
    (Name: 'CV_AMD64_MM30'; Value: 242),
    (Name: 'CV_AMD64_MM31'; Value: 243),
    (Name: 'CV_AMD64_MM40'; Value: 244),
    (Name: 'CV_AMD64_MM41'; Value: 245),
    (Name: 'CV_AMD64_MM50'; Value: 246),
    (Name: 'CV_AMD64_MM51'; Value: 247),
    (Name: 'CV_AMD64_MM60'; Value: 248),
    (Name: 'CV_AMD64_MM61'; Value: 249),
    (Name: 'CV_AMD64_MM70'; Value: 250),
    (Name: 'CV_AMD64_MM71'; Value: 251),
    (Name: 'CV_AMD64_XMM8'; Value: 252),
    (Name: 'CV_AMD64_XMM9'; Value: 253),
    (Name: 'CV_AMD64_XMM10'; Value: 254),
    (Name: 'CV_AMD64_XMM11'; Value: 255),
    (Name: 'CV_AMD64_XMM12'; Value: 256),
    (Name: 'CV_AMD64_XMM13'; Value: 257),
    (Name: 'CV_AMD64_XMM14'; Value: 258),
    (Name: 'CV_AMD64_XMM15'; Value: 259),
    (Name: 'CV_AMD64_XMM8_0'; Value: 260),
    (Name: 'CV_AMD64_XMM8_1'; Value: 261),
    (Name: 'CV_AMD64_XMM8_2'; Value: 262),
    (Name: 'CV_AMD64_XMM8_3'; Value: 263),
    (Name: 'CV_AMD64_XMM9_0'; Value: 264),
    (Name: 'CV_AMD64_XMM9_1'; Value: 265),
    (Name: 'CV_AMD64_XMM9_2'; Value: 266),
    (Name: 'CV_AMD64_XMM9_3'; Value: 267),
    (Name: 'CV_AMD64_XMM10_0'; Value: 268),
    (Name: 'CV_AMD64_XMM10_1'; Value: 269),
    (Name: 'CV_AMD64_XMM10_2'; Value: 270),
    (Name: 'CV_AMD64_XMM10_3'; Value: 271),
    (Name: 'CV_AMD64_XMM11_0'; Value: 272),
    (Name: 'CV_AMD64_XMM11_1'; Value: 273),
    (Name: 'CV_AMD64_XMM11_2'; Value: 274),
    (Name: 'CV_AMD64_XMM11_3'; Value: 275),
    (Name: 'CV_AMD64_XMM12_0'; Value: 276),
    (Name: 'CV_AMD64_XMM12_1'; Value: 277),
    (Name: 'CV_AMD64_XMM12_2'; Value: 278),
    (Name: 'CV_AMD64_XMM12_3'; Value: 279),
    (Name: 'CV_AMD64_XMM13_0'; Value: 280),
    (Name: 'CV_AMD64_XMM13_1'; Value: 281),
    (Name: 'CV_AMD64_XMM13_2'; Value: 282),
    (Name: 'CV_AMD64_XMM13_3'; Value: 283),
    (Name: 'CV_AMD64_XMM14_0'; Value: 284),
    (Name: 'CV_AMD64_XMM14_1'; Value: 285),
    (Name: 'CV_AMD64_XMM14_2'; Value: 286),
    (Name: 'CV_AMD64_XMM14_3'; Value: 287),
    (Name: 'CV_AMD64_XMM15_0'; Value: 288),
    (Name: 'CV_AMD64_XMM15_1'; Value: 289),
    (Name: 'CV_AMD64_XMM15_2'; Value: 290),
    (Name: 'CV_AMD64_XMM15_3'; Value: 291),
    (Name: 'CV_AMD64_XMM8L'; Value: 292),
    (Name: 'CV_AMD64_XMM9L'; Value: 293),
    (Name: 'CV_AMD64_XMM10L'; Value: 294),
    (Name: 'CV_AMD64_XMM11L'; Value: 295),
    (Name: 'CV_AMD64_XMM12L'; Value: 296),
    (Name: 'CV_AMD64_XMM13L'; Value: 297),
    (Name: 'CV_AMD64_XMM14L'; Value: 298),
    (Name: 'CV_AMD64_XMM15L'; Value: 299),
    (Name: 'CV_AMD64_XMM8H'; Value: 300),
    (Name: 'CV_AMD64_XMM9H'; Value: 301),
    (Name: 'CV_AMD64_XMM10H'; Value: 302),
    (Name: 'CV_AMD64_XMM11H'; Value: 303),
    (Name: 'CV_AMD64_XMM12H'; Value: 304),
    (Name: 'CV_AMD64_XMM13H'; Value: 305),
    (Name: 'CV_AMD64_XMM14H'; Value: 306),
    (Name: 'CV_AMD64_XMM15H'; Value: 307),
    (Name: 'CV_AMD64_EMM8L'; Value: 308),
    (Name: 'CV_AMD64_EMM9L'; Value: 309),
    (Name: 'CV_AMD64_EMM10L'; Value: 310),
    (Name: 'CV_AMD64_EMM11L'; Value: 311),
    (Name: 'CV_AMD64_EMM12L'; Value: 312),
    (Name: 'CV_AMD64_EMM13L'; Value: 313),
    (Name: 'CV_AMD64_EMM14L'; Value: 314),
    (Name: 'CV_AMD64_EMM15L'; Value: 315),
    (Name: 'CV_AMD64_EMM8H'; Value: 316),
    (Name: 'CV_AMD64_EMM9H'; Value: 317),
    (Name: 'CV_AMD64_EMM10H'; Value: 318),
    (Name: 'CV_AMD64_EMM11H'; Value: 319),
    (Name: 'CV_AMD64_EMM12H'; Value: 320),
    (Name: 'CV_AMD64_EMM13H'; Value: 321),
    (Name: 'CV_AMD64_EMM14H'; Value: 322),
    (Name: 'CV_AMD64_EMM15H'; Value: 323),
    (Name: 'CV_AMD64_SIL'; Value: 324),
    (Name: 'CV_AMD64_DIL'; Value: 325),
    (Name: 'CV_AMD64_BPL'; Value: 326),
    (Name: 'CV_AMD64_SPL'; Value: 327),
    (Name: 'CV_AMD64_RAX'; Value: 328),
    (Name: 'CV_AMD64_RBX'; Value: 329),
    (Name: 'CV_AMD64_RCX'; Value: 330),
    (Name: 'CV_AMD64_RDX'; Value: 331),
    (Name: 'CV_AMD64_RSI'; Value: 332),
    (Name: 'CV_AMD64_RDI'; Value: 333),
    (Name: 'CV_AMD64_RBP'; Value: 334),
    (Name: 'CV_AMD64_RSP'; Value: 335),
    (Name: 'CV_AMD64_R8'; Value: 336),
    (Name: 'CV_AMD64_R9'; Value: 337),
    (Name: 'CV_AMD64_R10'; Value: 338),
    (Name: 'CV_AMD64_R11'; Value: 339),
    (Name: 'CV_AMD64_R12'; Value: 340),
    (Name: 'CV_AMD64_R13'; Value: 341),
    (Name: 'CV_AMD64_R14'; Value: 342),
    (Name: 'CV_AMD64_R15'; Value: 343),
    (Name: 'CV_AMD64_R8B'; Value: 344),
    (Name: 'CV_AMD64_R9B'; Value: 345),
    (Name: 'CV_AMD64_R10B'; Value: 346),
    (Name: 'CV_AMD64_R11B'; Value: 347),
    (Name: 'CV_AMD64_R12B'; Value: 348),
    (Name: 'CV_AMD64_R13B'; Value: 349),
    (Name: 'CV_AMD64_R14B'; Value: 350),
    (Name: 'CV_AMD64_R15B'; Value: 351),
    (Name: 'CV_AMD64_R8W'; Value: 352),
    (Name: 'CV_AMD64_R9W'; Value: 353),
    (Name: 'CV_AMD64_R10W'; Value: 354),
    (Name: 'CV_AMD64_R11W'; Value: 355),
    (Name: 'CV_AMD64_R12W'; Value: 356),
    (Name: 'CV_AMD64_R13W'; Value: 357),
    (Name: 'CV_AMD64_R14W'; Value: 358),
    (Name: 'CV_AMD64_R15W'; Value: 359),
    (Name: 'CV_AMD64_R8D'; Value: 360),
    (Name: 'CV_AMD64_R9D'; Value: 361),
    (Name: 'CV_AMD64_R10D'; Value: 362),
    (Name: 'CV_AMD64_R11D'; Value: 363),
    (Name: 'CV_AMD64_R12D'; Value: 364),
    (Name: 'CV_AMD64_R13D'; Value: 365),
    (Name: 'CV_AMD64_R14D'; Value: 366),
    (Name: 'CV_AMD64_R15D'; Value: 367),
    (Name: 'CV_AMD64_YMM0'; Value: 368),
    (Name: 'CV_AMD64_YMM1'; Value: 369),
    (Name: 'CV_AMD64_YMM2'; Value: 370),
    (Name: 'CV_AMD64_YMM3'; Value: 371),
    (Name: 'CV_AMD64_YMM4'; Value: 372),
    (Name: 'CV_AMD64_YMM5'; Value: 373),
    (Name: 'CV_AMD64_YMM6'; Value: 374),
    (Name: 'CV_AMD64_YMM7'; Value: 375),
    (Name: 'CV_AMD64_YMM8'; Value: 376),
    (Name: 'CV_AMD64_YMM9'; Value: 377),
    (Name: 'CV_AMD64_YMM10'; Value: 378),
    (Name: 'CV_AMD64_YMM11'; Value: 379),
    (Name: 'CV_AMD64_YMM12'; Value: 380),
    (Name: 'CV_AMD64_YMM13'; Value: 381),
    (Name: 'CV_AMD64_YMM14'; Value: 382),
    (Name: 'CV_AMD64_YMM15'; Value: 383),
    (Name: 'CV_AMD64_YMM0H'; Value: 384),
    (Name: 'CV_AMD64_YMM1H'; Value: 385),
    (Name: 'CV_AMD64_YMM2H'; Value: 386),
    (Name: 'CV_AMD64_YMM3H'; Value: 387),
    (Name: 'CV_AMD64_YMM4H'; Value: 388),
    (Name: 'CV_AMD64_YMM5H'; Value: 389),
    (Name: 'CV_AMD64_YMM6H'; Value: 390),
    (Name: 'CV_AMD64_YMM7H'; Value: 391),
    (Name: 'CV_AMD64_YMM8H'; Value: 392),
    (Name: 'CV_AMD64_YMM9H'; Value: 393),
    (Name: 'CV_AMD64_YMM10H'; Value: 394),
    (Name: 'CV_AMD64_YMM11H'; Value: 395),
    (Name: 'CV_AMD64_YMM12H'; Value: 396),
    (Name: 'CV_AMD64_YMM13H'; Value: 397),
    (Name: 'CV_AMD64_YMM14H'; Value: 398),
    (Name: 'CV_AMD64_YMM15H'; Value: 399),
    (Name: 'CV_AMD64_XMM0IL'; Value: 400),
    (Name: 'CV_AMD64_XMM1IL'; Value: 401),
    (Name: 'CV_AMD64_XMM2IL'; Value: 402),
    (Name: 'CV_AMD64_XMM3IL'; Value: 403),
    (Name: 'CV_AMD64_XMM4IL'; Value: 404),
    (Name: 'CV_AMD64_XMM5IL'; Value: 405),
    (Name: 'CV_AMD64_XMM6IL'; Value: 406),
    (Name: 'CV_AMD64_XMM7IL'; Value: 407),
    (Name: 'CV_AMD64_XMM8IL'; Value: 408),
    (Name: 'CV_AMD64_XMM9IL'; Value: 409),
    (Name: 'CV_AMD64_XMM10IL'; Value: 410),
    (Name: 'CV_AMD64_XMM11IL'; Value: 411),
    (Name: 'CV_AMD64_XMM12IL'; Value: 412),
    (Name: 'CV_AMD64_XMM13IL'; Value: 413),
    (Name: 'CV_AMD64_XMM14IL'; Value: 414),
    (Name: 'CV_AMD64_XMM15IL'; Value: 415),
    (Name: 'CV_AMD64_XMM0IH'; Value: 416),
    (Name: 'CV_AMD64_XMM1IH'; Value: 417),
    (Name: 'CV_AMD64_XMM2IH'; Value: 418),
    (Name: 'CV_AMD64_XMM3IH'; Value: 419),
    (Name: 'CV_AMD64_XMM4IH'; Value: 420),
    (Name: 'CV_AMD64_XMM5IH'; Value: 421),
    (Name: 'CV_AMD64_XMM6IH'; Value: 422),
    (Name: 'CV_AMD64_XMM7IH'; Value: 423),
    (Name: 'CV_AMD64_XMM8IH'; Value: 424),
    (Name: 'CV_AMD64_XMM9IH'; Value: 425),
    (Name: 'CV_AMD64_XMM10IH'; Value: 426),
    (Name: 'CV_AMD64_XMM11IH'; Value: 427),
    (Name: 'CV_AMD64_XMM12IH'; Value: 428),
    (Name: 'CV_AMD64_XMM13IH'; Value: 429),
    (Name: 'CV_AMD64_XMM14IH'; Value: 430),
    (Name: 'CV_AMD64_XMM15IH'; Value: 431),
    (Name: 'CV_AMD64_YMM0I0'; Value: 432),
    (Name: 'CV_AMD64_YMM0I1'; Value: 433),
    (Name: 'CV_AMD64_YMM0I2'; Value: 434),
    (Name: 'CV_AMD64_YMM0I3'; Value: 435),
    (Name: 'CV_AMD64_YMM1I0'; Value: 436),
    (Name: 'CV_AMD64_YMM1I1'; Value: 437),
    (Name: 'CV_AMD64_YMM1I2'; Value: 438),
    (Name: 'CV_AMD64_YMM1I3'; Value: 439),
    (Name: 'CV_AMD64_YMM2I0'; Value: 440),
    (Name: 'CV_AMD64_YMM2I1'; Value: 441),
    (Name: 'CV_AMD64_YMM2I2'; Value: 442),
    (Name: 'CV_AMD64_YMM2I3'; Value: 443),
    (Name: 'CV_AMD64_YMM3I0'; Value: 444),
    (Name: 'CV_AMD64_YMM3I1'; Value: 445),
    (Name: 'CV_AMD64_YMM3I2'; Value: 446),
    (Name: 'CV_AMD64_YMM3I3'; Value: 447),
    (Name: 'CV_AMD64_YMM4I0'; Value: 448),
    (Name: 'CV_AMD64_YMM4I1'; Value: 449),
    (Name: 'CV_AMD64_YMM4I2'; Value: 450),
    (Name: 'CV_AMD64_YMM4I3'; Value: 451),
    (Name: 'CV_AMD64_YMM5I0'; Value: 452),
    (Name: 'CV_AMD64_YMM5I1'; Value: 453),
    (Name: 'CV_AMD64_YMM5I2'; Value: 454),
    (Name: 'CV_AMD64_YMM5I3'; Value: 455),
    (Name: 'CV_AMD64_YMM6I0'; Value: 456),
    (Name: 'CV_AMD64_YMM6I1'; Value: 457),
    (Name: 'CV_AMD64_YMM6I2'; Value: 458),
    (Name: 'CV_AMD64_YMM6I3'; Value: 459),
    (Name: 'CV_AMD64_YMM7I0'; Value: 460),
    (Name: 'CV_AMD64_YMM7I1'; Value: 461),
    (Name: 'CV_AMD64_YMM7I2'; Value: 462),
    (Name: 'CV_AMD64_YMM7I3'; Value: 463),
    (Name: 'CV_AMD64_YMM8I0'; Value: 464),
    (Name: 'CV_AMD64_YMM8I1'; Value: 465),
    (Name: 'CV_AMD64_YMM8I2'; Value: 466),
    (Name: 'CV_AMD64_YMM8I3'; Value: 467),
    (Name: 'CV_AMD64_YMM9I0'; Value: 468),
    (Name: 'CV_AMD64_YMM9I1'; Value: 469),
    (Name: 'CV_AMD64_YMM9I2'; Value: 470),
    (Name: 'CV_AMD64_YMM9I3'; Value: 471),
    (Name: 'CV_AMD64_YMM10I0'; Value: 472),
    (Name: 'CV_AMD64_YMM10I1'; Value: 473),
    (Name: 'CV_AMD64_YMM10I2'; Value: 474),
    (Name: 'CV_AMD64_YMM10I3'; Value: 475),
    (Name: 'CV_AMD64_YMM11I0'; Value: 476),
    (Name: 'CV_AMD64_YMM11I1'; Value: 477),
    (Name: 'CV_AMD64_YMM11I2'; Value: 478),
    (Name: 'CV_AMD64_YMM11I3'; Value: 479),
    (Name: 'CV_AMD64_YMM12I0'; Value: 480),
    (Name: 'CV_AMD64_YMM12I1'; Value: 481),
    (Name: 'CV_AMD64_YMM12I2'; Value: 482),
    (Name: 'CV_AMD64_YMM12I3'; Value: 483),
    (Name: 'CV_AMD64_YMM13I0'; Value: 484),
    (Name: 'CV_AMD64_YMM13I1'; Value: 485),
    (Name: 'CV_AMD64_YMM13I2'; Value: 486),
    (Name: 'CV_AMD64_YMM13I3'; Value: 487),
    (Name: 'CV_AMD64_YMM14I0'; Value: 488),
    (Name: 'CV_AMD64_YMM14I1'; Value: 489),
    (Name: 'CV_AMD64_YMM14I2'; Value: 490),
    (Name: 'CV_AMD64_YMM14I3'; Value: 491),
    (Name: 'CV_AMD64_YMM15I0'; Value: 492),
    (Name: 'CV_AMD64_YMM15I1'; Value: 493),
    (Name: 'CV_AMD64_YMM15I2'; Value: 494),
    (Name: 'CV_AMD64_YMM15I3'; Value: 495),
    (Name: 'CV_AMD64_YMM0F0'; Value: 496),
    (Name: 'CV_AMD64_YMM0F1'; Value: 497),
    (Name: 'CV_AMD64_YMM0F2'; Value: 498),
    (Name: 'CV_AMD64_YMM0F3'; Value: 499),
    (Name: 'CV_AMD64_YMM0F4'; Value: 500),
    (Name: 'CV_AMD64_YMM0F5'; Value: 501),
    (Name: 'CV_AMD64_YMM0F6'; Value: 502),
    (Name: 'CV_AMD64_YMM0F7'; Value: 503),
    (Name: 'CV_AMD64_YMM1F0'; Value: 504),
    (Name: 'CV_AMD64_YMM1F1'; Value: 505),
    (Name: 'CV_AMD64_YMM1F2'; Value: 506),
    (Name: 'CV_AMD64_YMM1F3'; Value: 507),
    (Name: 'CV_AMD64_YMM1F4'; Value: 508),
    (Name: 'CV_AMD64_YMM1F5'; Value: 509),
    (Name: 'CV_AMD64_YMM1F6'; Value: 510),
    (Name: 'CV_AMD64_YMM1F7'; Value: 511),
    (Name: 'CV_AMD64_YMM2F0'; Value: 512),
    (Name: 'CV_AMD64_YMM2F1'; Value: 513),
    (Name: 'CV_AMD64_YMM2F2'; Value: 514),
    (Name: 'CV_AMD64_YMM2F3'; Value: 515),
    (Name: 'CV_AMD64_YMM2F4'; Value: 516),
    (Name: 'CV_AMD64_YMM2F5'; Value: 517),
    (Name: 'CV_AMD64_YMM2F6'; Value: 518),
    (Name: 'CV_AMD64_YMM2F7'; Value: 519),
    (Name: 'CV_AMD64_YMM3F0'; Value: 520),
    (Name: 'CV_AMD64_YMM3F1'; Value: 521),
    (Name: 'CV_AMD64_YMM3F2'; Value: 522),
    (Name: 'CV_AMD64_YMM3F3'; Value: 523),
    (Name: 'CV_AMD64_YMM3F4'; Value: 524),
    (Name: 'CV_AMD64_YMM3F5'; Value: 525),
    (Name: 'CV_AMD64_YMM3F6'; Value: 526),
    (Name: 'CV_AMD64_YMM3F7'; Value: 527),
    (Name: 'CV_AMD64_YMM4F0'; Value: 528),
    (Name: 'CV_AMD64_YMM4F1'; Value: 529),
    (Name: 'CV_AMD64_YMM4F2'; Value: 530),
    (Name: 'CV_AMD64_YMM4F3'; Value: 531),
    (Name: 'CV_AMD64_YMM4F4'; Value: 532),
    (Name: 'CV_AMD64_YMM4F5'; Value: 533),
    (Name: 'CV_AMD64_YMM4F6'; Value: 534),
    (Name: 'CV_AMD64_YMM4F7'; Value: 535),
    (Name: 'CV_AMD64_YMM5F0'; Value: 536),
    (Name: 'CV_AMD64_YMM5F1'; Value: 537),
    (Name: 'CV_AMD64_YMM5F2'; Value: 538),
    (Name: 'CV_AMD64_YMM5F3'; Value: 539),
    (Name: 'CV_AMD64_YMM5F4'; Value: 540),
    (Name: 'CV_AMD64_YMM5F5'; Value: 541),
    (Name: 'CV_AMD64_YMM5F6'; Value: 542),
    (Name: 'CV_AMD64_YMM5F7'; Value: 543),
    (Name: 'CV_AMD64_YMM6F0'; Value: 544),
    (Name: 'CV_AMD64_YMM6F1'; Value: 545),
    (Name: 'CV_AMD64_YMM6F2'; Value: 546),
    (Name: 'CV_AMD64_YMM6F3'; Value: 547),
    (Name: 'CV_AMD64_YMM6F4'; Value: 548),
    (Name: 'CV_AMD64_YMM6F5'; Value: 549),
    (Name: 'CV_AMD64_YMM6F6'; Value: 550),
    (Name: 'CV_AMD64_YMM6F7'; Value: 551),
    (Name: 'CV_AMD64_YMM7F0'; Value: 552),
    (Name: 'CV_AMD64_YMM7F1'; Value: 553),
    (Name: 'CV_AMD64_YMM7F2'; Value: 554),
    (Name: 'CV_AMD64_YMM7F3'; Value: 555),
    (Name: 'CV_AMD64_YMM7F4'; Value: 556),
    (Name: 'CV_AMD64_YMM7F5'; Value: 557),
    (Name: 'CV_AMD64_YMM7F6'; Value: 558),
    (Name: 'CV_AMD64_YMM7F7'; Value: 559),
    (Name: 'CV_AMD64_YMM8F0'; Value: 560),
    (Name: 'CV_AMD64_YMM8F1'; Value: 561),
    (Name: 'CV_AMD64_YMM8F2'; Value: 562),
    (Name: 'CV_AMD64_YMM8F3'; Value: 563),
    (Name: 'CV_AMD64_YMM8F4'; Value: 564),
    (Name: 'CV_AMD64_YMM8F5'; Value: 565),
    (Name: 'CV_AMD64_YMM8F6'; Value: 566),
    (Name: 'CV_AMD64_YMM8F7'; Value: 567),
    (Name: 'CV_AMD64_YMM9F0'; Value: 568),
    (Name: 'CV_AMD64_YMM9F1'; Value: 569),
    (Name: 'CV_AMD64_YMM9F2'; Value: 570),
    (Name: 'CV_AMD64_YMM9F3'; Value: 571),
    (Name: 'CV_AMD64_YMM9F4'; Value: 572),
    (Name: 'CV_AMD64_YMM9F5'; Value: 573),
    (Name: 'CV_AMD64_YMM9F6'; Value: 574),
    (Name: 'CV_AMD64_YMM9F7'; Value: 575),
    (Name: 'CV_AMD64_YMM10F0'; Value: 576),
    (Name: 'CV_AMD64_YMM10F1'; Value: 577),
    (Name: 'CV_AMD64_YMM10F2'; Value: 578),
    (Name: 'CV_AMD64_YMM10F3'; Value: 579),
    (Name: 'CV_AMD64_YMM10F4'; Value: 580),
    (Name: 'CV_AMD64_YMM10F5'; Value: 581),
    (Name: 'CV_AMD64_YMM10F6'; Value: 582),
    (Name: 'CV_AMD64_YMM10F7'; Value: 583),
    (Name: 'CV_AMD64_YMM11F0'; Value: 584),
    (Name: 'CV_AMD64_YMM11F1'; Value: 585),
    (Name: 'CV_AMD64_YMM11F2'; Value: 586),
    (Name: 'CV_AMD64_YMM11F3'; Value: 587),
    (Name: 'CV_AMD64_YMM11F4'; Value: 588),
    (Name: 'CV_AMD64_YMM11F5'; Value: 589),
    (Name: 'CV_AMD64_YMM11F6'; Value: 590),
    (Name: 'CV_AMD64_YMM11F7'; Value: 591),
    (Name: 'CV_AMD64_YMM12F0'; Value: 592),
    (Name: 'CV_AMD64_YMM12F1'; Value: 593),
    (Name: 'CV_AMD64_YMM12F2'; Value: 594),
    (Name: 'CV_AMD64_YMM12F3'; Value: 595),
    (Name: 'CV_AMD64_YMM12F4'; Value: 596),
    (Name: 'CV_AMD64_YMM12F5'; Value: 597),
    (Name: 'CV_AMD64_YMM12F6'; Value: 598),
    (Name: 'CV_AMD64_YMM12F7'; Value: 599),
    (Name: 'CV_AMD64_YMM13F0'; Value: 600),
    (Name: 'CV_AMD64_YMM13F1'; Value: 601),
    (Name: 'CV_AMD64_YMM13F2'; Value: 602),
    (Name: 'CV_AMD64_YMM13F3'; Value: 603),
    (Name: 'CV_AMD64_YMM13F4'; Value: 604),
    (Name: 'CV_AMD64_YMM13F5'; Value: 605),
    (Name: 'CV_AMD64_YMM13F6'; Value: 606),
    (Name: 'CV_AMD64_YMM13F7'; Value: 607),
    (Name: 'CV_AMD64_YMM14F0'; Value: 608),
    (Name: 'CV_AMD64_YMM14F1'; Value: 609),
    (Name: 'CV_AMD64_YMM14F2'; Value: 610),
    (Name: 'CV_AMD64_YMM14F3'; Value: 611),
    (Name: 'CV_AMD64_YMM14F4'; Value: 612),
    (Name: 'CV_AMD64_YMM14F5'; Value: 613),
    (Name: 'CV_AMD64_YMM14F6'; Value: 614),
    (Name: 'CV_AMD64_YMM14F7'; Value: 615),
    (Name: 'CV_AMD64_YMM15F0'; Value: 616),
    (Name: 'CV_AMD64_YMM15F1'; Value: 617),
    (Name: 'CV_AMD64_YMM15F2'; Value: 618),
    (Name: 'CV_AMD64_YMM15F3'; Value: 619),
    (Name: 'CV_AMD64_YMM15F4'; Value: 620),
    (Name: 'CV_AMD64_YMM15F5'; Value: 621),
    (Name: 'CV_AMD64_YMM15F6'; Value: 622),
    (Name: 'CV_AMD64_YMM15F7'; Value: 623),
    (Name: 'CV_AMD64_YMM0D0'; Value: 624),
    (Name: 'CV_AMD64_YMM0D1'; Value: 625),
    (Name: 'CV_AMD64_YMM0D2'; Value: 626),
    (Name: 'CV_AMD64_YMM0D3'; Value: 627),
    (Name: 'CV_AMD64_YMM1D0'; Value: 628),
    (Name: 'CV_AMD64_YMM1D1'; Value: 629),
    (Name: 'CV_AMD64_YMM1D2'; Value: 630),
    (Name: 'CV_AMD64_YMM1D3'; Value: 631),
    (Name: 'CV_AMD64_YMM2D0'; Value: 632),
    (Name: 'CV_AMD64_YMM2D1'; Value: 633),
    (Name: 'CV_AMD64_YMM2D2'; Value: 634),
    (Name: 'CV_AMD64_YMM2D3'; Value: 635),
    (Name: 'CV_AMD64_YMM3D0'; Value: 636),
    (Name: 'CV_AMD64_YMM3D1'; Value: 637),
    (Name: 'CV_AMD64_YMM3D2'; Value: 638),
    (Name: 'CV_AMD64_YMM3D3'; Value: 639),
    (Name: 'CV_AMD64_YMM4D0'; Value: 640),
    (Name: 'CV_AMD64_YMM4D1'; Value: 641),
    (Name: 'CV_AMD64_YMM4D2'; Value: 642),
    (Name: 'CV_AMD64_YMM4D3'; Value: 643),
    (Name: 'CV_AMD64_YMM5D0'; Value: 644),
    (Name: 'CV_AMD64_YMM5D1'; Value: 645),
    (Name: 'CV_AMD64_YMM5D2'; Value: 646),
    (Name: 'CV_AMD64_YMM5D3'; Value: 647),
    (Name: 'CV_AMD64_YMM6D0'; Value: 648),
    (Name: 'CV_AMD64_YMM6D1'; Value: 649),
    (Name: 'CV_AMD64_YMM6D2'; Value: 650),
    (Name: 'CV_AMD64_YMM6D3'; Value: 651),
    (Name: 'CV_AMD64_YMM7D0'; Value: 652),
    (Name: 'CV_AMD64_YMM7D1'; Value: 653),
    (Name: 'CV_AMD64_YMM7D2'; Value: 654),
    (Name: 'CV_AMD64_YMM7D3'; Value: 655),
    (Name: 'CV_AMD64_YMM8D0'; Value: 656),
    (Name: 'CV_AMD64_YMM8D1'; Value: 657),
    (Name: 'CV_AMD64_YMM8D2'; Value: 658),
    (Name: 'CV_AMD64_YMM8D3'; Value: 659),
    (Name: 'CV_AMD64_YMM9D0'; Value: 660),
    (Name: 'CV_AMD64_YMM9D1'; Value: 661),
    (Name: 'CV_AMD64_YMM9D2'; Value: 662),
    (Name: 'CV_AMD64_YMM9D3'; Value: 663),
    (Name: 'CV_AMD64_YMM10D0'; Value: 664),
    (Name: 'CV_AMD64_YMM10D1'; Value: 665),
    (Name: 'CV_AMD64_YMM10D2'; Value: 666),
    (Name: 'CV_AMD64_YMM10D3'; Value: 667),
    (Name: 'CV_AMD64_YMM11D0'; Value: 668),
    (Name: 'CV_AMD64_YMM11D1'; Value: 669),
    (Name: 'CV_AMD64_YMM11D2'; Value: 670),
    (Name: 'CV_AMD64_YMM11D3'; Value: 671),
    (Name: 'CV_AMD64_YMM12D0'; Value: 672),
    (Name: 'CV_AMD64_YMM12D1'; Value: 673),
    (Name: 'CV_AMD64_YMM12D2'; Value: 674),
    (Name: 'CV_AMD64_YMM12D3'; Value: 675),
    (Name: 'CV_AMD64_YMM13D0'; Value: 676),
    (Name: 'CV_AMD64_YMM13D1'; Value: 677),
    (Name: 'CV_AMD64_YMM13D2'; Value: 678),
    (Name: 'CV_AMD64_YMM13D3'; Value: 679),
    (Name: 'CV_AMD64_YMM14D0'; Value: 680),
    (Name: 'CV_AMD64_YMM14D1'; Value: 681),
    (Name: 'CV_AMD64_YMM14D2'; Value: 682),
    (Name: 'CV_AMD64_YMM14D3'; Value: 683),
    (Name: 'CV_AMD64_YMM15D0'; Value: 684),
    (Name: 'CV_AMD64_YMM15D1'; Value: 685),
    (Name: 'CV_AMD64_YMM15D2'; Value: 686),
    (Name: 'CV_AMD64_YMM15D3'; Value: 687),
    (Name: 'CV_AMD64_BND0'; Value: 688),
    (Name: 'CV_AMD64_BND1'; Value: 689),
    (Name: 'CV_AMD64_BND2'; Value: 690),
    (Name: 'CV_AMD64_BND3'; Value: 691),
    (Name: 'CV_AMD64_BNDCFGU'; Value: 692),
    (Name: 'CV_AMD64_BNDSTATUS'; Value: 693),
    (Name: 'CV_AMD64_XMM16'; Value: 694),
    (Name: 'CV_AMD64_XMM17'; Value: 695),
    (Name: 'CV_AMD64_XMM18'; Value: 696),
    (Name: 'CV_AMD64_XMM19'; Value: 697),
    (Name: 'CV_AMD64_XMM20'; Value: 698),
    (Name: 'CV_AMD64_XMM21'; Value: 699),
    (Name: 'CV_AMD64_XMM22'; Value: 700),
    (Name: 'CV_AMD64_XMM23'; Value: 701),
    (Name: 'CV_AMD64_XMM24'; Value: 702),
    (Name: 'CV_AMD64_XMM25'; Value: 703),
    (Name: 'CV_AMD64_XMM26'; Value: 704),
    (Name: 'CV_AMD64_XMM27'; Value: 705),
    (Name: 'CV_AMD64_XMM28'; Value: 706),
    (Name: 'CV_AMD64_XMM29'; Value: 707),
    (Name: 'CV_AMD64_XMM30'; Value: 708),
    (Name: 'CV_AMD64_XMM31'; Value: 709),
    (Name: 'CV_AMD64_YMM16'; Value: 710),
    (Name: 'CV_AMD64_YMM17'; Value: 711),
    (Name: 'CV_AMD64_YMM18'; Value: 712),
    (Name: 'CV_AMD64_YMM19'; Value: 713),
    (Name: 'CV_AMD64_YMM20'; Value: 714),
    (Name: 'CV_AMD64_YMM21'; Value: 715),
    (Name: 'CV_AMD64_YMM22'; Value: 716),
    (Name: 'CV_AMD64_YMM23'; Value: 717),
    (Name: 'CV_AMD64_YMM24'; Value: 718),
    (Name: 'CV_AMD64_YMM25'; Value: 719),
    (Name: 'CV_AMD64_YMM26'; Value: 720),
    (Name: 'CV_AMD64_YMM27'; Value: 721),
    (Name: 'CV_AMD64_YMM28'; Value: 722),
    (Name: 'CV_AMD64_YMM29'; Value: 723),
    (Name: 'CV_AMD64_YMM30'; Value: 724),
    (Name: 'CV_AMD64_YMM31'; Value: 725),
    (Name: 'CV_AMD64_ZMM0'; Value: 726),
    (Name: 'CV_AMD64_ZMM1'; Value: 727),
    (Name: 'CV_AMD64_ZMM2'; Value: 728),
    (Name: 'CV_AMD64_ZMM3'; Value: 729),
    (Name: 'CV_AMD64_ZMM4'; Value: 730),
    (Name: 'CV_AMD64_ZMM5'; Value: 731),
    (Name: 'CV_AMD64_ZMM6'; Value: 732),
    (Name: 'CV_AMD64_ZMM7'; Value: 733),
    (Name: 'CV_AMD64_ZMM8'; Value: 734),
    (Name: 'CV_AMD64_ZMM9'; Value: 735),
    (Name: 'CV_AMD64_ZMM10'; Value: 736),
    (Name: 'CV_AMD64_ZMM11'; Value: 737),
    (Name: 'CV_AMD64_ZMM12'; Value: 738),
    (Name: 'CV_AMD64_ZMM13'; Value: 739),
    (Name: 'CV_AMD64_ZMM14'; Value: 740),
    (Name: 'CV_AMD64_ZMM15'; Value: 741),
    (Name: 'CV_AMD64_ZMM16'; Value: 742),
    (Name: 'CV_AMD64_ZMM17'; Value: 743),
    (Name: 'CV_AMD64_ZMM18'; Value: 744),
    (Name: 'CV_AMD64_ZMM19'; Value: 745),
    (Name: 'CV_AMD64_ZMM20'; Value: 746),
    (Name: 'CV_AMD64_ZMM21'; Value: 747),
    (Name: 'CV_AMD64_ZMM22'; Value: 748),
    (Name: 'CV_AMD64_ZMM23'; Value: 749),
    (Name: 'CV_AMD64_ZMM24'; Value: 750),
    (Name: 'CV_AMD64_ZMM25'; Value: 751),
    (Name: 'CV_AMD64_ZMM26'; Value: 752),
    (Name: 'CV_AMD64_ZMM27'; Value: 753),
    (Name: 'CV_AMD64_ZMM28'; Value: 754),
    (Name: 'CV_AMD64_ZMM29'; Value: 755),
    (Name: 'CV_AMD64_ZMM30'; Value: 756),
    (Name: 'CV_AMD64_ZMM31'; Value: 757),
    (Name: 'CV_AMD64_K0'; Value: 758),
    (Name: 'CV_AMD64_K1'; Value: 759),
    (Name: 'CV_AMD64_K2'; Value: 760),
    (Name: 'CV_AMD64_K3'; Value: 761),
    (Name: 'CV_AMD64_K4'; Value: 762),
    (Name: 'CV_AMD64_K5'; Value: 763),
    (Name: 'CV_AMD64_K6'; Value: 764),
    (Name: 'CV_AMD64_K7'; Value: 765),
    (Name: 'CV_AMD64_ZMM0H'; Value: 766),
    (Name: 'CV_AMD64_ZMM1H'; Value: 767),
    (Name: 'CV_AMD64_ZMM2H'; Value: 768),
    (Name: 'CV_AMD64_ZMM3H'; Value: 769),
    (Name: 'CV_AMD64_ZMM4H'; Value: 770),
    (Name: 'CV_AMD64_ZMM5H'; Value: 771),
    (Name: 'CV_AMD64_ZMM6H'; Value: 772),
    (Name: 'CV_AMD64_ZMM7H'; Value: 773),
    (Name: 'CV_AMD64_ZMM8H'; Value: 774),
    (Name: 'CV_AMD64_ZMM9H'; Value: 775),
    (Name: 'CV_AMD64_ZMM10H'; Value: 776),
    (Name: 'CV_AMD64_ZMM11H'; Value: 777),
    (Name: 'CV_AMD64_ZMM12H'; Value: 778),
    (Name: 'CV_AMD64_ZMM13H'; Value: 779),
    (Name: 'CV_AMD64_ZMM14H'; Value: 780),
    (Name: 'CV_AMD64_ZMM15H'; Value: 781),
    (Name: 'CV_AMD64_XMM16L'; Value: 782),
    (Name: 'CV_AMD64_XMM17L'; Value: 783),
    (Name: 'CV_AMD64_XMM18L'; Value: 784),
    (Name: 'CV_AMD64_XMM19L'; Value: 785),
    (Name: 'CV_AMD64_XMM20L'; Value: 786),
    (Name: 'CV_AMD64_XMM21L'; Value: 787),
    (Name: 'CV_AMD64_XMM22L'; Value: 788),
    (Name: 'CV_AMD64_XMM23L'; Value: 789),
    (Name: 'CV_AMD64_XMM24L'; Value: 790),
    (Name: 'CV_AMD64_XMM25L'; Value: 791),
    (Name: 'CV_AMD64_XMM26L'; Value: 792),
    (Name: 'CV_AMD64_XMM27L'; Value: 793),
    (Name: 'CV_AMD64_XMM28L'; Value: 794),
    (Name: 'CV_AMD64_XMM29L'; Value: 795),
    (Name: 'CV_AMD64_XMM30L'; Value: 796),
    (Name: 'CV_AMD64_XMM31L'; Value: 797),
    (Name: 'CV_AMD64_XMM16_0'; Value: 798),
    (Name: 'CV_AMD64_XMM17_0'; Value: 799),
    (Name: 'CV_AMD64_XMM18_0'; Value: 800),
    (Name: 'CV_AMD64_XMM19_0'; Value: 801),
    (Name: 'CV_AMD64_XMM20_0'; Value: 802),
    (Name: 'CV_AMD64_XMM21_0'; Value: 803),
    (Name: 'CV_AMD64_XMM22_0'; Value: 804),
    (Name: 'CV_AMD64_XMM23_0'; Value: 805),
    (Name: 'CV_AMD64_XMM24_0'; Value: 806),
    (Name: 'CV_AMD64_XMM25_0'; Value: 807),
    (Name: 'CV_AMD64_XMM26_0'; Value: 808),
    (Name: 'CV_AMD64_XMM27_0'; Value: 809),
    (Name: 'CV_AMD64_XMM28_0'; Value: 810),
    (Name: 'CV_AMD64_XMM29_0'; Value: 811),
    (Name: 'CV_AMD64_XMM30_0'; Value: 812),
    (Name: 'CV_AMD64_XMM31_0'; Value: 813),
    (Name: 'CV_AMD64_XMM16H'; Value: 814),
    (Name: 'CV_AMD64_XMM17H'; Value: 815),
    (Name: 'CV_AMD64_XMM18H'; Value: 816),
    (Name: 'CV_AMD64_XMM19H'; Value: 817),
    (Name: 'CV_AMD64_XMM20H'; Value: 818),
    (Name: 'CV_AMD64_XMM21H'; Value: 819),
    (Name: 'CV_AMD64_XMM22H'; Value: 820),
    (Name: 'CV_AMD64_XMM23H'; Value: 821),
    (Name: 'CV_AMD64_XMM24H'; Value: 822),
    (Name: 'CV_AMD64_XMM25H'; Value: 823),
    (Name: 'CV_AMD64_XMM26H'; Value: 824),
    (Name: 'CV_AMD64_XMM27H'; Value: 825),
    (Name: 'CV_AMD64_XMM28H'; Value: 826),
    (Name: 'CV_AMD64_XMM29H'; Value: 827),
    (Name: 'CV_AMD64_XMM30H'; Value: 828),
    (Name: 'CV_AMD64_XMM31H'; Value: 829),
    (Name: 'CV_AMD64_EMM16H'; Value: 830),
    (Name: 'CV_AMD64_EMM17H'; Value: 831),
    (Name: 'CV_AMD64_EMM18H'; Value: 832),
    (Name: 'CV_AMD64_EMM19H'; Value: 833),
    (Name: 'CV_AMD64_EMM20H'; Value: 834),
    (Name: 'CV_AMD64_EMM21H'; Value: 835),
    (Name: 'CV_AMD64_EMM22H'; Value: 836),
    (Name: 'CV_AMD64_EMM23H'; Value: 837),
    (Name: 'CV_AMD64_EMM24H'; Value: 838),
    (Name: 'CV_AMD64_EMM25H'; Value: 839),
    (Name: 'CV_AMD64_EMM26H'; Value: 840),
    (Name: 'CV_AMD64_EMM27H'; Value: 841),
    (Name: 'CV_AMD64_EMM28H'; Value: 842),
    (Name: 'CV_AMD64_EMM29H'; Value: 843),
    (Name: 'CV_AMD64_EMM30H'; Value: 844),
    (Name: 'CV_AMD64_EMM31H'; Value: 845),
    (Name: 'CV_AMD64_SSP'; Value: 846),
    (Name: 'CV_AMD64_TMM0'; Value: 847),
    (Name: 'CV_AMD64_TMM1'; Value: 848),
    (Name: 'CV_AMD64_TMM2'; Value: 849),
    (Name: 'CV_AMD64_TMM3'; Value: 850),
    (Name: 'CV_AMD64_TMM4'; Value: 851),
    (Name: 'CV_AMD64_TMM5'; Value: 852),
    (Name: 'CV_AMD64_TMM6'; Value: 853),
    (Name: 'CV_AMD64_TMM7'; Value: 854),
    (Name: 'CV_AMD64_TILECFG'; Value: 855)
  );
  X64RegisterNamesCache: TArray<TRegisterName>;

  ArmRegisterNamesDef: array [0..172] of TRegisterName = (
    (Name: 'CV_ARM_NOREG'; Value: 0),
    (Name: 'CV_ARM_R0'; Value: 10),
    (Name: 'CV_ARM_R1'; Value: 11),
    (Name: 'CV_ARM_R2'; Value: 12),
    (Name: 'CV_ARM_R3'; Value: 13),
    (Name: 'CV_ARM_R4'; Value: 14),
    (Name: 'CV_ARM_R5'; Value: 15),
    (Name: 'CV_ARM_R6'; Value: 16),
    (Name: 'CV_ARM_R7'; Value: 17),
    (Name: 'CV_ARM_R8'; Value: 18),
    (Name: 'CV_ARM_R9'; Value: 19),
    (Name: 'CV_ARM_R10'; Value: 20),
    (Name: 'CV_ARM_R11'; Value: 21),
    (Name: 'CV_ARM_R12'; Value: 22),
    (Name: 'CV_ARM_SP'; Value: 23),
    (Name: 'CV_ARM_LR'; Value: 24),
    (Name: 'CV_ARM_PC'; Value: 25),
    (Name: 'CV_ARM_CPSR'; Value: 26),
    (Name: 'CV_ARM_ACC0'; Value: 27),
    (Name: 'CV_ARM_FPSCR'; Value: 40),
    (Name: 'CV_ARM_FPEXC'; Value: 41),
    (Name: 'CV_ARM_FS0'; Value: 50),
    (Name: 'CV_ARM_FS1'; Value: 51),
    (Name: 'CV_ARM_FS2'; Value: 52),
    (Name: 'CV_ARM_FS3'; Value: 53),
    (Name: 'CV_ARM_FS4'; Value: 54),
    (Name: 'CV_ARM_FS5'; Value: 55),
    (Name: 'CV_ARM_FS6'; Value: 56),
    (Name: 'CV_ARM_FS7'; Value: 57),
    (Name: 'CV_ARM_FS8'; Value: 58),
    (Name: 'CV_ARM_FS9'; Value: 59),
    (Name: 'CV_ARM_FS10'; Value: 60),
    (Name: 'CV_ARM_FS11'; Value: 61),
    (Name: 'CV_ARM_FS12'; Value: 62),
    (Name: 'CV_ARM_FS13'; Value: 63),
    (Name: 'CV_ARM_FS14'; Value: 64),
    (Name: 'CV_ARM_FS15'; Value: 65),
    (Name: 'CV_ARM_FS16'; Value: 66),
    (Name: 'CV_ARM_FS17'; Value: 67),
    (Name: 'CV_ARM_FS18'; Value: 68),
    (Name: 'CV_ARM_FS19'; Value: 69),
    (Name: 'CV_ARM_FS20'; Value: 70),
    (Name: 'CV_ARM_FS21'; Value: 71),
    (Name: 'CV_ARM_FS22'; Value: 72),
    (Name: 'CV_ARM_FS23'; Value: 73),
    (Name: 'CV_ARM_FS24'; Value: 74),
    (Name: 'CV_ARM_FS25'; Value: 75),
    (Name: 'CV_ARM_FS26'; Value: 76),
    (Name: 'CV_ARM_FS27'; Value: 77),
    (Name: 'CV_ARM_FS28'; Value: 78),
    (Name: 'CV_ARM_FS29'; Value: 79),
    (Name: 'CV_ARM_FS30'; Value: 80),
    (Name: 'CV_ARM_FS31'; Value: 81),
    (Name: 'CV_ARM_FPEXTRA0'; Value: 90),
    (Name: 'CV_ARM_FPEXTRA1'; Value: 91),
    (Name: 'CV_ARM_FPEXTRA2'; Value: 92),
    (Name: 'CV_ARM_FPEXTRA3'; Value: 93),
    (Name: 'CV_ARM_FPEXTRA4'; Value: 94),
    (Name: 'CV_ARM_FPEXTRA5'; Value: 95),
    (Name: 'CV_ARM_FPEXTRA6'; Value: 96),
    (Name: 'CV_ARM_FPEXTRA7'; Value: 97),
    (Name: 'CV_ARM_WR0'; Value: 128),
    (Name: 'CV_ARM_WR1'; Value: 129),
    (Name: 'CV_ARM_WR2'; Value: 130),
    (Name: 'CV_ARM_WR3'; Value: 131),
    (Name: 'CV_ARM_WR4'; Value: 132),
    (Name: 'CV_ARM_WR5'; Value: 133),
    (Name: 'CV_ARM_WR6'; Value: 134),
    (Name: 'CV_ARM_WR7'; Value: 135),
    (Name: 'CV_ARM_WR8'; Value: 136),
    (Name: 'CV_ARM_WR9'; Value: 137),
    (Name: 'CV_ARM_WR10'; Value: 138),
    (Name: 'CV_ARM_WR11'; Value: 139),
    (Name: 'CV_ARM_WR12'; Value: 140),
    (Name: 'CV_ARM_WR13'; Value: 141),
    (Name: 'CV_ARM_WR14'; Value: 142),
    (Name: 'CV_ARM_WR15'; Value: 143),
    (Name: 'CV_ARM_WCID'; Value: 144),
    (Name: 'CV_ARM_WCON'; Value: 145),
    (Name: 'CV_ARM_WCSSF'; Value: 146),
    (Name: 'CV_ARM_WCASF'; Value: 147),
    (Name: 'CV_ARM_WC4'; Value: 148),
    (Name: 'CV_ARM_WC5'; Value: 149),
    (Name: 'CV_ARM_WC6'; Value: 150),
    (Name: 'CV_ARM_WC7'; Value: 151),
    (Name: 'CV_ARM_WCGR0'; Value: 152),
    (Name: 'CV_ARM_WCGR1'; Value: 153),
    (Name: 'CV_ARM_WCGR2'; Value: 154),
    (Name: 'CV_ARM_WCGR3'; Value: 155),
    (Name: 'CV_ARM_WC12'; Value: 156),
    (Name: 'CV_ARM_WC13'; Value: 157),
    (Name: 'CV_ARM_WC14'; Value: 158),
    (Name: 'CV_ARM_WC15'; Value: 159),
    (Name: 'CV_ARM_FS32'; Value: 200),
    (Name: 'CV_ARM_FS33'; Value: 201),
    (Name: 'CV_ARM_FS34'; Value: 202),
    (Name: 'CV_ARM_FS35'; Value: 203),
    (Name: 'CV_ARM_FS36'; Value: 204),
    (Name: 'CV_ARM_FS37'; Value: 205),
    (Name: 'CV_ARM_FS38'; Value: 206),
    (Name: 'CV_ARM_FS39'; Value: 207),
    (Name: 'CV_ARM_FS40'; Value: 208),
    (Name: 'CV_ARM_FS41'; Value: 209),
    (Name: 'CV_ARM_FS42'; Value: 210),
    (Name: 'CV_ARM_FS43'; Value: 211),
    (Name: 'CV_ARM_FS44'; Value: 212),
    (Name: 'CV_ARM_FS45'; Value: 213),
    (Name: 'CV_ARM_FS46'; Value: 214),
    (Name: 'CV_ARM_FS47'; Value: 215),
    (Name: 'CV_ARM_FS48'; Value: 216),
    (Name: 'CV_ARM_FS49'; Value: 217),
    (Name: 'CV_ARM_FS50'; Value: 218),
    (Name: 'CV_ARM_FS51'; Value: 219),
    (Name: 'CV_ARM_FS52'; Value: 220),
    (Name: 'CV_ARM_FS53'; Value: 221),
    (Name: 'CV_ARM_FS54'; Value: 222),
    (Name: 'CV_ARM_FS55'; Value: 223),
    (Name: 'CV_ARM_FS56'; Value: 224),
    (Name: 'CV_ARM_FS57'; Value: 225),
    (Name: 'CV_ARM_FS58'; Value: 226),
    (Name: 'CV_ARM_FS59'; Value: 227),
    (Name: 'CV_ARM_FS60'; Value: 228),
    (Name: 'CV_ARM_FS61'; Value: 229),
    (Name: 'CV_ARM_FS62'; Value: 230),
    (Name: 'CV_ARM_FS63'; Value: 231),
    (Name: 'CV_ARM_ND0'; Value: 300),
    (Name: 'CV_ARM_ND1'; Value: 301),
    (Name: 'CV_ARM_ND2'; Value: 302),
    (Name: 'CV_ARM_ND3'; Value: 303),
    (Name: 'CV_ARM_ND4'; Value: 304),
    (Name: 'CV_ARM_ND5'; Value: 305),
    (Name: 'CV_ARM_ND6'; Value: 306),
    (Name: 'CV_ARM_ND7'; Value: 307),
    (Name: 'CV_ARM_ND8'; Value: 308),
    (Name: 'CV_ARM_ND9'; Value: 309),
    (Name: 'CV_ARM_ND10'; Value: 310),
    (Name: 'CV_ARM_ND11'; Value: 311),
    (Name: 'CV_ARM_ND12'; Value: 312),
    (Name: 'CV_ARM_ND13'; Value: 313),
    (Name: 'CV_ARM_ND14'; Value: 314),
    (Name: 'CV_ARM_ND15'; Value: 315),
    (Name: 'CV_ARM_ND16'; Value: 316),
    (Name: 'CV_ARM_ND17'; Value: 317),
    (Name: 'CV_ARM_ND18'; Value: 318),
    (Name: 'CV_ARM_ND19'; Value: 319),
    (Name: 'CV_ARM_ND20'; Value: 320),
    (Name: 'CV_ARM_ND21'; Value: 321),
    (Name: 'CV_ARM_ND22'; Value: 322),
    (Name: 'CV_ARM_ND23'; Value: 323),
    (Name: 'CV_ARM_ND24'; Value: 324),
    (Name: 'CV_ARM_ND25'; Value: 325),
    (Name: 'CV_ARM_ND26'; Value: 326),
    (Name: 'CV_ARM_ND27'; Value: 327),
    (Name: 'CV_ARM_ND28'; Value: 328),
    (Name: 'CV_ARM_ND29'; Value: 329),
    (Name: 'CV_ARM_ND30'; Value: 330),
    (Name: 'CV_ARM_ND31'; Value: 331),
    (Name: 'CV_ARM_NQ0'; Value: 400),
    (Name: 'CV_ARM_NQ1'; Value: 401),
    (Name: 'CV_ARM_NQ2'; Value: 402),
    (Name: 'CV_ARM_NQ3'; Value: 403),
    (Name: 'CV_ARM_NQ4'; Value: 404),
    (Name: 'CV_ARM_NQ5'; Value: 405),
    (Name: 'CV_ARM_NQ6'; Value: 406),
    (Name: 'CV_ARM_NQ7'; Value: 407),
    (Name: 'CV_ARM_NQ8'; Value: 408),
    (Name: 'CV_ARM_NQ9'; Value: 409),
    (Name: 'CV_ARM_NQ10'; Value: 410),
    (Name: 'CV_ARM_NQ11'; Value: 411),
    (Name: 'CV_ARM_NQ12'; Value: 412),
    (Name: 'CV_ARM_NQ13'; Value: 413),
    (Name: 'CV_ARM_NQ14'; Value: 414),
    (Name: 'CV_ARM_NQ15'; Value: 415)
  );
  ArmRegisterNamesCache: TArray<TRegisterName>;

  Arm64RegisterNamesDef: array [0..343] of TRegisterName = (
    (Name: 'CV_ARM64_NOREG'; Value: 0),
    (Name: 'CV_ARM64_W0'; Value: 10),
    (Name: 'CV_ARM64_W1'; Value: 11),
    (Name: 'CV_ARM64_W2'; Value: 12),
    (Name: 'CV_ARM64_W3'; Value: 13),
    (Name: 'CV_ARM64_W4'; Value: 14),
    (Name: 'CV_ARM64_W5'; Value: 15),
    (Name: 'CV_ARM64_W6'; Value: 16),
    (Name: 'CV_ARM64_W7'; Value: 17),
    (Name: 'CV_ARM64_W8'; Value: 18),
    (Name: 'CV_ARM64_W9'; Value: 19),
    (Name: 'CV_ARM64_W10'; Value: 20),
    (Name: 'CV_ARM64_W11'; Value: 21),
    (Name: 'CV_ARM64_W12'; Value: 22),
    (Name: 'CV_ARM64_W13'; Value: 23),
    (Name: 'CV_ARM64_W14'; Value: 24),
    (Name: 'CV_ARM64_W15'; Value: 25),
    (Name: 'CV_ARM64_W16'; Value: 26),
    (Name: 'CV_ARM64_W17'; Value: 27),
    (Name: 'CV_ARM64_W18'; Value: 28),
    (Name: 'CV_ARM64_W19'; Value: 29),
    (Name: 'CV_ARM64_W20'; Value: 30),
    (Name: 'CV_ARM64_W21'; Value: 31),
    (Name: 'CV_ARM64_W22'; Value: 32),
    (Name: 'CV_ARM64_W23'; Value: 33),
    (Name: 'CV_ARM64_W24'; Value: 34),
    (Name: 'CV_ARM64_W25'; Value: 35),
    (Name: 'CV_ARM64_W26'; Value: 36),
    (Name: 'CV_ARM64_W27'; Value: 37),
    (Name: 'CV_ARM64_W28'; Value: 38),
    (Name: 'CV_ARM64_W29'; Value: 39),
    (Name: 'CV_ARM64_W30'; Value: 40),
    (Name: 'CV_ARM64_WZR'; Value: 41),
    (Name: 'CV_ARM64_X0'; Value: 50),
    (Name: 'CV_ARM64_X1'; Value: 51),
    (Name: 'CV_ARM64_X2'; Value: 52),
    (Name: 'CV_ARM64_X3'; Value: 53),
    (Name: 'CV_ARM64_X4'; Value: 54),
    (Name: 'CV_ARM64_X5'; Value: 55),
    (Name: 'CV_ARM64_X6'; Value: 56),
    (Name: 'CV_ARM64_X7'; Value: 57),
    (Name: 'CV_ARM64_X8'; Value: 58),
    (Name: 'CV_ARM64_X9'; Value: 59),
    (Name: 'CV_ARM64_X10'; Value: 60),
    (Name: 'CV_ARM64_X11'; Value: 61),
    (Name: 'CV_ARM64_X12'; Value: 62),
    (Name: 'CV_ARM64_X13'; Value: 63),
    (Name: 'CV_ARM64_X14'; Value: 64),
    (Name: 'CV_ARM64_X15'; Value: 65),
    (Name: 'CV_ARM64_IP0'; Value: 66),
    (Name: 'CV_ARM64_IP1'; Value: 67),
    (Name: 'CV_ARM64_X18'; Value: 68),
    (Name: 'CV_ARM64_X19'; Value: 69),
    (Name: 'CV_ARM64_X20'; Value: 70),
    (Name: 'CV_ARM64_X21'; Value: 71),
    (Name: 'CV_ARM64_X22'; Value: 72),
    (Name: 'CV_ARM64_X23'; Value: 73),
    (Name: 'CV_ARM64_X24'; Value: 74),
    (Name: 'CV_ARM64_X25'; Value: 75),
    (Name: 'CV_ARM64_X26'; Value: 76),
    (Name: 'CV_ARM64_X27'; Value: 77),
    (Name: 'CV_ARM64_X28'; Value: 78),
    (Name: 'CV_ARM64_FP'; Value: 79),
    (Name: 'CV_ARM64_LR'; Value: 80),
    (Name: 'CV_ARM64_SP'; Value: 81),
    (Name: 'CV_ARM64_ZR'; Value: 82),
    (Name: 'CV_ARM64_PC'; Value: 83),
    (Name: 'CV_ARM64_NZCV'; Value: 90),
    (Name: 'CV_ARM64_CPSR'; Value: 91),
    (Name: 'CV_ARM64_S0'; Value: 100),
    (Name: 'CV_ARM64_S1'; Value: 101),
    (Name: 'CV_ARM64_S2'; Value: 102),
    (Name: 'CV_ARM64_S3'; Value: 103),
    (Name: 'CV_ARM64_S4'; Value: 104),
    (Name: 'CV_ARM64_S5'; Value: 105),
    (Name: 'CV_ARM64_S6'; Value: 106),
    (Name: 'CV_ARM64_S7'; Value: 107),
    (Name: 'CV_ARM64_S8'; Value: 108),
    (Name: 'CV_ARM64_S9'; Value: 109),
    (Name: 'CV_ARM64_S10'; Value: 110),
    (Name: 'CV_ARM64_S11'; Value: 111),
    (Name: 'CV_ARM64_S12'; Value: 112),
    (Name: 'CV_ARM64_S13'; Value: 113),
    (Name: 'CV_ARM64_S14'; Value: 114),
    (Name: 'CV_ARM64_S15'; Value: 115),
    (Name: 'CV_ARM64_S16'; Value: 116),
    (Name: 'CV_ARM64_S17'; Value: 117),
    (Name: 'CV_ARM64_S18'; Value: 118),
    (Name: 'CV_ARM64_S19'; Value: 119),
    (Name: 'CV_ARM64_S20'; Value: 120),
    (Name: 'CV_ARM64_S21'; Value: 121),
    (Name: 'CV_ARM64_S22'; Value: 122),
    (Name: 'CV_ARM64_S23'; Value: 123),
    (Name: 'CV_ARM64_S24'; Value: 124),
    (Name: 'CV_ARM64_S25'; Value: 125),
    (Name: 'CV_ARM64_S26'; Value: 126),
    (Name: 'CV_ARM64_S27'; Value: 127),
    (Name: 'CV_ARM64_S28'; Value: 128),
    (Name: 'CV_ARM64_S29'; Value: 129),
    (Name: 'CV_ARM64_S30'; Value: 130),
    (Name: 'CV_ARM64_S31'; Value: 131),
    (Name: 'CV_ARM64_D0'; Value: 140),
    (Name: 'CV_ARM64_D1'; Value: 141),
    (Name: 'CV_ARM64_D2'; Value: 142),
    (Name: 'CV_ARM64_D3'; Value: 143),
    (Name: 'CV_ARM64_D4'; Value: 144),
    (Name: 'CV_ARM64_D5'; Value: 145),
    (Name: 'CV_ARM64_D6'; Value: 146),
    (Name: 'CV_ARM64_D7'; Value: 147),
    (Name: 'CV_ARM64_D8'; Value: 148),
    (Name: 'CV_ARM64_D9'; Value: 149),
    (Name: 'CV_ARM64_D10'; Value: 150),
    (Name: 'CV_ARM64_D11'; Value: 151),
    (Name: 'CV_ARM64_D12'; Value: 152),
    (Name: 'CV_ARM64_D13'; Value: 153),
    (Name: 'CV_ARM64_D14'; Value: 154),
    (Name: 'CV_ARM64_D15'; Value: 155),
    (Name: 'CV_ARM64_D16'; Value: 156),
    (Name: 'CV_ARM64_D17'; Value: 157),
    (Name: 'CV_ARM64_D18'; Value: 158),
    (Name: 'CV_ARM64_D19'; Value: 159),
    (Name: 'CV_ARM64_D20'; Value: 160),
    (Name: 'CV_ARM64_D21'; Value: 161),
    (Name: 'CV_ARM64_D22'; Value: 162),
    (Name: 'CV_ARM64_D23'; Value: 163),
    (Name: 'CV_ARM64_D24'; Value: 164),
    (Name: 'CV_ARM64_D25'; Value: 165),
    (Name: 'CV_ARM64_D26'; Value: 166),
    (Name: 'CV_ARM64_D27'; Value: 167),
    (Name: 'CV_ARM64_D28'; Value: 168),
    (Name: 'CV_ARM64_D29'; Value: 169),
    (Name: 'CV_ARM64_D30'; Value: 170),
    (Name: 'CV_ARM64_D31'; Value: 171),
    (Name: 'CV_ARM64_Q0'; Value: 180),
    (Name: 'CV_ARM64_Q1'; Value: 181),
    (Name: 'CV_ARM64_Q2'; Value: 182),
    (Name: 'CV_ARM64_Q3'; Value: 183),
    (Name: 'CV_ARM64_Q4'; Value: 184),
    (Name: 'CV_ARM64_Q5'; Value: 185),
    (Name: 'CV_ARM64_Q6'; Value: 186),
    (Name: 'CV_ARM64_Q7'; Value: 187),
    (Name: 'CV_ARM64_Q8'; Value: 188),
    (Name: 'CV_ARM64_Q9'; Value: 189),
    (Name: 'CV_ARM64_Q10'; Value: 190),
    (Name: 'CV_ARM64_Q11'; Value: 191),
    (Name: 'CV_ARM64_Q12'; Value: 192),
    (Name: 'CV_ARM64_Q13'; Value: 193),
    (Name: 'CV_ARM64_Q14'; Value: 194),
    (Name: 'CV_ARM64_Q15'; Value: 195),
    (Name: 'CV_ARM64_Q16'; Value: 196),
    (Name: 'CV_ARM64_Q17'; Value: 197),
    (Name: 'CV_ARM64_Q18'; Value: 198),
    (Name: 'CV_ARM64_Q19'; Value: 199),
    (Name: 'CV_ARM64_Q20'; Value: 200),
    (Name: 'CV_ARM64_Q21'; Value: 201),
    (Name: 'CV_ARM64_Q22'; Value: 202),
    (Name: 'CV_ARM64_Q23'; Value: 203),
    (Name: 'CV_ARM64_Q24'; Value: 204),
    (Name: 'CV_ARM64_Q25'; Value: 205),
    (Name: 'CV_ARM64_Q26'; Value: 206),
    (Name: 'CV_ARM64_Q27'; Value: 207),
    (Name: 'CV_ARM64_Q28'; Value: 208),
    (Name: 'CV_ARM64_Q29'; Value: 209),
    (Name: 'CV_ARM64_Q30'; Value: 210),
    (Name: 'CV_ARM64_Q31'; Value: 211),
    (Name: 'CV_ARM64_FPSR'; Value: 220),
    (Name: 'CV_ARM64_FPCR'; Value: 221),
    (Name: 'CV_ARM64_B0'; Value: 230),
    (Name: 'CV_ARM64_B1'; Value: 231),
    (Name: 'CV_ARM64_B2'; Value: 232),
    (Name: 'CV_ARM64_B3'; Value: 233),
    (Name: 'CV_ARM64_B4'; Value: 234),
    (Name: 'CV_ARM64_B5'; Value: 235),
    (Name: 'CV_ARM64_B6'; Value: 236),
    (Name: 'CV_ARM64_B7'; Value: 237),
    (Name: 'CV_ARM64_B8'; Value: 238),
    (Name: 'CV_ARM64_B9'; Value: 239),
    (Name: 'CV_ARM64_B10'; Value: 240),
    (Name: 'CV_ARM64_B11'; Value: 241),
    (Name: 'CV_ARM64_B12'; Value: 242),
    (Name: 'CV_ARM64_B13'; Value: 243),
    (Name: 'CV_ARM64_B14'; Value: 244),
    (Name: 'CV_ARM64_B15'; Value: 245),
    (Name: 'CV_ARM64_B16'; Value: 246),
    (Name: 'CV_ARM64_B17'; Value: 247),
    (Name: 'CV_ARM64_B18'; Value: 248),
    (Name: 'CV_ARM64_B19'; Value: 249),
    (Name: 'CV_ARM64_B20'; Value: 250),
    (Name: 'CV_ARM64_B21'; Value: 251),
    (Name: 'CV_ARM64_B22'; Value: 252),
    (Name: 'CV_ARM64_B23'; Value: 253),
    (Name: 'CV_ARM64_B24'; Value: 254),
    (Name: 'CV_ARM64_B25'; Value: 255),
    (Name: 'CV_ARM64_B26'; Value: 256),
    (Name: 'CV_ARM64_B27'; Value: 257),
    (Name: 'CV_ARM64_B28'; Value: 258),
    (Name: 'CV_ARM64_B29'; Value: 259),
    (Name: 'CV_ARM64_B30'; Value: 260),
    (Name: 'CV_ARM64_B31'; Value: 261),
    (Name: 'CV_ARM64_H0'; Value: 270),
    (Name: 'CV_ARM64_H1'; Value: 271),
    (Name: 'CV_ARM64_H2'; Value: 272),
    (Name: 'CV_ARM64_H3'; Value: 273),
    (Name: 'CV_ARM64_H4'; Value: 274),
    (Name: 'CV_ARM64_H5'; Value: 275),
    (Name: 'CV_ARM64_H6'; Value: 276),
    (Name: 'CV_ARM64_H7'; Value: 277),
    (Name: 'CV_ARM64_H8'; Value: 278),
    (Name: 'CV_ARM64_H9'; Value: 279),
    (Name: 'CV_ARM64_H10'; Value: 280),
    (Name: 'CV_ARM64_H11'; Value: 281),
    (Name: 'CV_ARM64_H12'; Value: 282),
    (Name: 'CV_ARM64_H13'; Value: 283),
    (Name: 'CV_ARM64_H14'; Value: 284),
    (Name: 'CV_ARM64_H15'; Value: 285),
    (Name: 'CV_ARM64_H16'; Value: 286),
    (Name: 'CV_ARM64_H17'; Value: 287),
    (Name: 'CV_ARM64_H18'; Value: 288),
    (Name: 'CV_ARM64_H19'; Value: 289),
    (Name: 'CV_ARM64_H20'; Value: 290),
    (Name: 'CV_ARM64_H21'; Value: 291),
    (Name: 'CV_ARM64_H22'; Value: 292),
    (Name: 'CV_ARM64_H23'; Value: 293),
    (Name: 'CV_ARM64_H24'; Value: 294),
    (Name: 'CV_ARM64_H25'; Value: 295),
    (Name: 'CV_ARM64_H26'; Value: 296),
    (Name: 'CV_ARM64_H27'; Value: 297),
    (Name: 'CV_ARM64_H28'; Value: 298),
    (Name: 'CV_ARM64_H29'; Value: 299),
    (Name: 'CV_ARM64_H30'; Value: 300),
    (Name: 'CV_ARM64_H31'; Value: 301),
    (Name: 'CV_ARM64_V0'; Value: 310),
    (Name: 'CV_ARM64_V1'; Value: 311),
    (Name: 'CV_ARM64_V2'; Value: 312),
    (Name: 'CV_ARM64_V3'; Value: 313),
    (Name: 'CV_ARM64_V4'; Value: 314),
    (Name: 'CV_ARM64_V5'; Value: 315),
    (Name: 'CV_ARM64_V6'; Value: 316),
    (Name: 'CV_ARM64_V7'; Value: 317),
    (Name: 'CV_ARM64_V8'; Value: 318),
    (Name: 'CV_ARM64_V9'; Value: 319),
    (Name: 'CV_ARM64_V10'; Value: 320),
    (Name: 'CV_ARM64_V11'; Value: 321),
    (Name: 'CV_ARM64_V12'; Value: 322),
    (Name: 'CV_ARM64_V13'; Value: 323),
    (Name: 'CV_ARM64_V14'; Value: 324),
    (Name: 'CV_ARM64_V15'; Value: 325),
    (Name: 'CV_ARM64_V16'; Value: 326),
    (Name: 'CV_ARM64_V17'; Value: 327),
    (Name: 'CV_ARM64_V18'; Value: 328),
    (Name: 'CV_ARM64_V19'; Value: 329),
    (Name: 'CV_ARM64_V20'; Value: 330),
    (Name: 'CV_ARM64_V21'; Value: 331),
    (Name: 'CV_ARM64_V22'; Value: 332),
    (Name: 'CV_ARM64_V23'; Value: 333),
    (Name: 'CV_ARM64_V24'; Value: 334),
    (Name: 'CV_ARM64_V25'; Value: 335),
    (Name: 'CV_ARM64_V26'; Value: 336),
    (Name: 'CV_ARM64_V27'; Value: 337),
    (Name: 'CV_ARM64_V28'; Value: 338),
    (Name: 'CV_ARM64_V29'; Value: 339),
    (Name: 'CV_ARM64_V30'; Value: 340),
    (Name: 'CV_ARM64_V31'; Value: 341),
    (Name: 'CV_ARM64_Q0H'; Value: 350),
    (Name: 'CV_ARM64_Q1H'; Value: 351),
    (Name: 'CV_ARM64_Q2H'; Value: 352),
    (Name: 'CV_ARM64_Q3H'; Value: 353),
    (Name: 'CV_ARM64_Q4H'; Value: 354),
    (Name: 'CV_ARM64_Q5H'; Value: 355),
    (Name: 'CV_ARM64_Q6H'; Value: 356),
    (Name: 'CV_ARM64_Q7H'; Value: 357),
    (Name: 'CV_ARM64_Q8H'; Value: 358),
    (Name: 'CV_ARM64_Q9H'; Value: 359),
    (Name: 'CV_ARM64_Q10H'; Value: 360),
    (Name: 'CV_ARM64_Q11H'; Value: 361),
    (Name: 'CV_ARM64_Q12H'; Value: 362),
    (Name: 'CV_ARM64_Q13H'; Value: 363),
    (Name: 'CV_ARM64_Q14H'; Value: 364),
    (Name: 'CV_ARM64_Q15H'; Value: 365),
    (Name: 'CV_ARM64_Q16H'; Value: 366),
    (Name: 'CV_ARM64_Q17H'; Value: 367),
    (Name: 'CV_ARM64_Q18H'; Value: 368),
    (Name: 'CV_ARM64_Q19H'; Value: 369),
    (Name: 'CV_ARM64_Q20H'; Value: 370),
    (Name: 'CV_ARM64_Q21H'; Value: 371),
    (Name: 'CV_ARM64_Q22H'; Value: 372),
    (Name: 'CV_ARM64_Q23H'; Value: 373),
    (Name: 'CV_ARM64_Q24H'; Value: 374),
    (Name: 'CV_ARM64_Q25H'; Value: 375),
    (Name: 'CV_ARM64_Q26H'; Value: 376),
    (Name: 'CV_ARM64_Q27H'; Value: 377),
    (Name: 'CV_ARM64_Q28H'; Value: 378),
    (Name: 'CV_ARM64_Q29H'; Value: 379),
    (Name: 'CV_ARM64_Q30H'; Value: 380),
    (Name: 'CV_ARM64_Q31H'; Value: 381),
    (Name: 'CV_ARM64_Z0'; Value: 382),
    (Name: 'CV_ARM64_Z1'; Value: 383),
    (Name: 'CV_ARM64_Z2'; Value: 384),
    (Name: 'CV_ARM64_Z3'; Value: 385),
    (Name: 'CV_ARM64_Z4'; Value: 386),
    (Name: 'CV_ARM64_Z5'; Value: 387),
    (Name: 'CV_ARM64_Z6'; Value: 388),
    (Name: 'CV_ARM64_Z7'; Value: 389),
    (Name: 'CV_ARM64_Z8'; Value: 390),
    (Name: 'CV_ARM64_Z9'; Value: 391),
    (Name: 'CV_ARM64_Z10'; Value: 392),
    (Name: 'CV_ARM64_Z11'; Value: 393),
    (Name: 'CV_ARM64_Z12'; Value: 394),
    (Name: 'CV_ARM64_Z13'; Value: 395),
    (Name: 'CV_ARM64_Z14'; Value: 396),
    (Name: 'CV_ARM64_Z15'; Value: 397),
    (Name: 'CV_ARM64_Z16'; Value: 398),
    (Name: 'CV_ARM64_Z17'; Value: 399),
    (Name: 'CV_ARM64_Z18'; Value: 400),
    (Name: 'CV_ARM64_Z19'; Value: 401),
    (Name: 'CV_ARM64_Z20'; Value: 402),
    (Name: 'CV_ARM64_Z21'; Value: 403),
    (Name: 'CV_ARM64_Z22'; Value: 404),
    (Name: 'CV_ARM64_Z23'; Value: 405),
    (Name: 'CV_ARM64_Z24'; Value: 406),
    (Name: 'CV_ARM64_Z25'; Value: 407),
    (Name: 'CV_ARM64_Z26'; Value: 408),
    (Name: 'CV_ARM64_Z27'; Value: 409),
    (Name: 'CV_ARM64_Z28'; Value: 410),
    (Name: 'CV_ARM64_Z29'; Value: 411),
    (Name: 'CV_ARM64_Z30'; Value: 412),
    (Name: 'CV_ARM64_Z31'; Value: 413),
    (Name: 'CV_ARM64_P0'; Value: 414),
    (Name: 'CV_ARM64_P1'; Value: 415),
    (Name: 'CV_ARM64_P2'; Value: 416),
    (Name: 'CV_ARM64_P3'; Value: 417),
    (Name: 'CV_ARM64_P4'; Value: 418),
    (Name: 'CV_ARM64_P5'; Value: 419),
    (Name: 'CV_ARM64_P6'; Value: 420),
    (Name: 'CV_ARM64_P7'; Value: 421),
    (Name: 'CV_ARM64_P8'; Value: 422),
    (Name: 'CV_ARM64_P9'; Value: 423),
    (Name: 'CV_ARM64_P10'; Value: 424),
    (Name: 'CV_ARM64_P11'; Value: 425),
    (Name: 'CV_ARM64_P12'; Value: 426),
    (Name: 'CV_ARM64_P13'; Value: 427),
    (Name: 'CV_ARM64_P14'; Value: 428),
    (Name: 'CV_ARM64_P15'; Value: 429),
    (Name: 'CV_ARM64_FFR'; Value: 430)
  );
  Arm64RegisterNamesCache: TArray<TRegisterName>;

function ArrayDefToArray(
  const Input: array of TRegisterName
): TArray<TRegisterName>;
var
  i: Integer;
begin
  SetLength(Result, Length(Input));

  for i := Low(Result) to High(Result) do
    Result[i] := Input[i - Low(Result) + Low(Input)];
end;

function SelectNameArray(
  MachineType: TImageMachine32
): TArray<TRegisterName>;
begin
  case MachineType of
    IMAGE_FILE_MACHINE_I386:
    begin
      if Length(X86RegisterNamesCache) <= 0 then
        X86RegisterNamesCache := ArrayDefToArray(X86RegisterNamesDef) +
          SelectNameArray(0);

      Result := X86RegisterNamesCache;
    end;

    IMAGE_FILE_MACHINE_AMD64:
    begin
      if Length(X64RegisterNamesCache) <= 0 then
        X64RegisterNamesCache := ArrayDefToArray(X64RegisterNamesDef) +
          SelectNameArray(0);

      Result := X64RegisterNamesCache;
    end;

    IMAGE_FILE_MACHINE_ARM, IMAGE_FILE_MACHINE_THUMB, IMAGE_FILE_MACHINE_ARMNT:
    begin
      if Length(ArmRegisterNamesCache) <= 0 then
        ArmRegisterNamesCache := ArrayDefToArray(ArmRegisterNamesDef) +
          SelectNameArray(0);

      Result := ArmRegisterNamesCache;
    end;

    IMAGE_FILE_MACHINE_ARM64:
    begin
      if Length(Arm64RegisterNamesCache) <= 0 then
        Arm64RegisterNamesCache := ArrayDefToArray(Arm64RegisterNamesDef) +
          SelectNameArray(0);

      Result := Arm64RegisterNamesCache;
    end;

  else
    if Length(SharedRegisterNamesCache) <= 0 then
      SharedRegisterNamesCache := ArrayDefToArray(SharedRegisterNamesDef);

    Result := SharedRegisterNamesCache;
  end;
end;

function LookupRegisterName;
var
  KnownNames: TArray<TRegisterName>;
  Index: Integer;
begin
  KnownNames := SelectNameArray(MachineType);

  Index := TArray.BinarySearchEx<TRegisterName>(KnownNames,
    function (const Entry: TRegisterName): Integer
    begin
      {$R-}{$Q-}
      Result := Integer(Entry.Value) - Integer(RegisterId);
      {$IFDEF Q+}{$Q+}{$ENDIF}{$IFDEF R+}{$R+}{$ENDIF}
    end
  );

  if Index >= 0 then
    Result := String(KnownNames[Index].Name)
  else
    Result := RtlxIntToDec(RegisterId);
end;

end.

```

`Settings.pas`:

```pas
unit Settings;

{
  This module provides logic for persisting program settings.
}

interface

type
  TSettings = class abstract
  private
    class procedure SetSymbolSearchPath(const Value: String); static;
    type TSettingValue = (svMsdiaDllPath, svSymbolSearchPath, svEnableSorting,
      svShowStackTraces);
    class var FModified: array [TSettingValue] of Boolean;
    class var FSymbolSearchPath: String;
    class function GetMsdiaDllPath: String; static;
    class procedure SetMsdiaDllPath(const Value: String); static;
    class function GetShowStackTraces: Boolean; static;
    class procedure SetShowStackTraces(const Value: Boolean); static;
    class function GetEnableSorting: Boolean; static;
    class procedure SetEnableSorting(const Value: Boolean); static;
  public
    class property MsdiaDllPath: String read GetMsdiaDllPath write SetMsdiaDllPath;
    class property SymbolSearchPath: String read FSymbolSearchPath write SetSymbolSearchPath;
    class property EnableSorting: Boolean read GetEnableSorting write SetEnableSorting;
    class property ShowStackTraces: Boolean read GetShowStackTraces write SetShowStackTraces;
    class constructor Create;
    class procedure Load; static;
    class procedure Save; static;
  end;

implementation

uses
  Ntapi.ntregapi, Ntapi.ntseapi, NtUtils, NtUtils.Registry, NtUtils.Tokens.Info,
  NtUtils.Security.Sid, NtUtils.DbgHelp.Dia, NtUiLib.Errors.Dialog, DiaNodes;

function OpenSettingsKey(
  out hxKey: IHandle;
  WriteAccess: Boolean
): TNtxStatus;
var
  User: ISid;
  Path: String;
begin
  // Determine the SID for HKCU
  Result := NtxQuerySidToken(NtxCurrentProcessToken, TokenUser, User);

  if not Result.IsSuccess then
    Exit;

  Result := RtlxSidToString(User, Path);

  if not Result.IsSuccess then
    Exit;

  // Settings are per-user
  Path := REG_PATH_USER + '\' + Path + '\Software\DiaSymbolView';

  if WriteAccess then
    Result := NtxCreateKey(hxKey, Path, KEY_SET_VALUE)
  else
    Result := NtxOpenKey(hxKey, Path, KEY_QUERY_VALUE);
end;

const
  SETTING_NAMES: array [TSettings.TSettingValue] of String = ('MsdiaPath',
    'SymbolPath', 'EnableSorting', 'ShowStackTraces');

class constructor TSettings.Create;
begin
  // Defaults
  FSymbolSearchPath := 'C:\Symbols';
end;

class function TSettings.GetEnableSorting;
begin
  Result := DiaNodes.EnableSorting;
end;

class function TSettings.GetMsdiaDllPath;
begin
  Result := NtUtils.DbgHelp.Dia.MsdiaDllPath;
end;

class function TSettings.GetShowStackTraces;
begin
  Result := NtUtils.CaptureStackTraces;
end;

class procedure TSettings.Load;
var
  hxKey: IHandle;
  StringValue: String;
  CardinalValue: Cardinal;
begin
  if OpenSettingsKey(hxKey, False).IsSuccess then
  begin
    // Msdia DLL path
    if NtxQueryValueKeyString(hxKey, SETTING_NAMES[svMsdiaDllPath],
      StringValue).IsSuccess then
    begin
      MsdiaDllPath := StringValue;
      FModified[svMsdiaDllPath] := False;
    end;

    // Symbol search path
    if NtxQueryValueKeyString(hxKey, SETTING_NAMES[svSymbolSearchPath],
      StringValue).IsSuccess then
    begin
      SymbolSearchPath := StringValue;
      FModified[svSymbolSearchPath] := False;
    end;

    // Sorting
    if NtxQueryValueKeyUInt32(hxKey, SETTING_NAMES[svEnableSorting],
      CardinalValue).IsSuccess then
    begin
      EnableSorting := CardinalValue <> 0;
      FModified[svEnableSorting] := False;
    end;

    // Show stack traces
    if NtxQueryValueKeyUInt32(hxKey, SETTING_NAMES[svShowStackTraces],
      CardinalValue).IsSuccess then
    begin
      ShowStackTraces := CardinalValue <> 0;
      FModified[svShowStackTraces] := False;
    end;
  end;
end;

class procedure TSettings.Save;
var
  hxKey: IHandle;
begin
  // Is anything modifed?
  if not FModified[svMsdiaDllPath] and not FModified[svSymbolSearchPath] and
    not FModified[svEnableSorting] and not FModified[svShowStackTraces] then
    Exit;

  if OpenSettingsKey(hxKey, True).IsSuccess then
  begin
    if FModified[svMsdiaDllPath] then
      NtxSetValueKeyString(hxKey, SETTING_NAMES[svMsdiaDllPath], MsdiaDllPath);

    if FModified[svSymbolSearchPath] then
      NtxSetValueKeyString(hxKey, SETTING_NAMES[svSymbolSearchPath],
        SymbolSearchPath);

    if FModified[svEnableSorting] then
      NtxSetValueKeyUInt32(hxKey, SETTING_NAMES[svEnableSorting],
        Cardinal(EnableSorting));

    if FModified[svShowStackTraces] then
      NtxSetValueKeyUInt32(hxKey, SETTING_NAMES[svShowStackTraces],
        Cardinal(ShowStackTraces));
  end;
end;

class procedure TSettings.SetEnableSorting;
begin
  if DiaNodes.EnableSorting <> Value then
  begin
    DiaNodes.EnableSorting := Value;
    FModified[svEnableSorting] := True;
  end;
end;

class procedure TSettings.SetMsdiaDllPath;
begin
  if NtUtils.DbgHelp.Dia.MsdiaDllPath <> Value then
  begin
    NtUtils.DbgHelp.Dia.MsdiaDllPath := Value;
    FModified[svMsdiaDllPath] := True;
  end;
end;

class procedure TSettings.SetShowStackTraces;
begin
  if (NtUtils.CaptureStackTraces <> Value) or
    (NtUiLib.Errors.Dialog.DisplayStackTraces <> Value) then
  begin
    NtUtils.CaptureStackTraces := Value;
    NtUiLib.Errors.Dialog.DisplayStackTraces := Value;
    System.ReportMemoryLeaksOnShutdown := Value;
    FModified[svShowStackTraces] := True
  end;
end;

class procedure TSettings.SetSymbolSearchPath;
begin
  if FSymbolSearchPath <> Value then
  begin
    FSymbolSearchPath := Value;
    FModified[svSymbolSearchPath] := True;
  end;
end;

end.

```

`TextHelpers.pas`:

```pas
unit TextHelpers;

{
  This module provides helper functions for faster node text manipulation.
}

interface

uses
  Ntapi.DbgHelp, Ntapi.msdia, DiaProperties, NtUtils,
  DelphiUiLib.LiteReflection;

// Prepare a string for a symbol tag
function FormatSymbolTag(
  Tag: TSymTagEnum
): String;

// Prepare a string for a basic type kind
function FormatBasicType(
  Basic: TBasicType
): String;

// Prepare a string with an array index
function FormatArrayIndex(
  Index: Integer
): String;

// Prepare a string with an binary buffer
function FormatBuffer(
  const Buffer: IMemory;
  PrefixSize: Boolean;
  SpaceBytes: Boolean
): TRttixFullReflection;

// Prepare a string with a human-readable symbol name
function DiaxFormatSymbolName(
  const Symbol: IDiaSymbol
): String;

// Prepare a string with a human-readable line number name
function DiaxFormatLineNumberName(
  const Line: IDiaLineNumber
): String;

// Prepare a string with a human-readable source file name
function DiaxFormatSourceFileName(
  const SourceFile: IDiaSourceFile
): String;

// Prepare a string with a human-readable input assembly name
function DiaxFormatInputAssemblyName(
  const AssemblyFile: IDiaInputAssemblyFile
): String;

// Prepare a string with a human-readable section name
function DiaxFormatSectionName(
  const Section: IDiaSectionContrib
): String;

// Prepare a string with a human-readable segment name
function DiaxFormatSegmentName(
  const Segment: IDiaSegment
): String;

// Prepare a string with a human-readable injected source name
function DiaxFormatInjectedSourceName(
  const InjectedSource: IDiaInjectedSource
): String;

// Prepare a string with a human-readable injected source name
function DiaxFormatFrameDataName(
  const FrameData: IDiaFrameData
): String;

// Prepare a string with a human-readable table name
function DiaxFormatTableName(
  const Table: IDiaTable
): String;

// Prepare a string with a human-readable debug stream name
function DiaxFormatDebugStreamName(
  const DebugStream: IDiaEnumDebugStreamData
): String;

// Prepare a string with a human-readable image data object name
function DiaxFormatImageData(
  const ImageData: IDiaImageData
): String;

// Prepare a string with a human-readable binary data object name
function DiaxFormatBinaryData(
  const BinaryData: IBinaryData
): String;

implementation

uses
  NtUtils.SysUtils, DelphiUtils.LiteRTTI, DelphiUiLib.Strings, Ntapi.ImageHlp;

var
  TagNamesCacheInitialized: Boolean;
  TagNamesCache: array [TSymTagEnum] of String;

procedure InitializeTagNamesCache;
var
  Tag: TSymTagEnum;
  Formatter: IRttixTypeFormatter;
begin
  Formatter := RttixMakeTypeFormatter(TypeInfo(TSymTagEnum));

  for Tag := Low(TSymTagEnum) to High(TSymTagEnum) do
    TagNamesCache[Tag] := Formatter.FormatText(Tag);

  TagNamesCacheInitialized := True;
end;

function FormatSymbolTag;
begin
  if Tag > High(TSymTagEnum) then
    Exit('Unknown Symbol Tag (' + RtlxIntToDec(Cardinal(Tag)) + ')');

  if not TagNamesCacheInitialized then
    InitializeTagNamesCache;

  Result := TagNamesCache[Tag];
end;

var
  BasicTypeNamesCacheInitialized: Boolean;
  BasicTypeNamesCache: array [TBasicType] of String;

procedure InitializeBasicTypeNamesCache;
var
  Basic: TBasicType;
  Formatter: IRttixTypeFormatter;
begin
  Formatter := RttixMakeTypeFormatter(TypeInfo(TBasicType),
    RttixPreserveEnumCase);

  for Basic := Low(TBasicType) to High(TBasicType) do
    BasicTypeNamesCache[Basic] := Formatter.FormatText(Basic);

  BasicTypeNamesCacheInitialized := True;
end;

function FormatBasicType;
begin
  if Basic > High(TBasicType) then
    Exit('Unknown Basic Type (' + RtlxIntToDec(Cardinal(Basic)) + ')');

  if not BasicTypeNamesCacheInitialized then
    InitializeBasicTypeNamesCache;

  Result := BasicTypeNamesCache[Basic];
end;

function FormatArrayIndex;
var
  Short: ShortString;
begin
  Str(Index, Short);
  Insert('[', Short, 0);
  Insert(']', Short, Length(Short) + 1);
  Result := String(Short);
end;

function FormatBuffer;
begin
  Result.ValidFormats := [rfText, rfHint];

  if Buffer.Size = 0 then
    Result.Text := '(Empty)'
  else if PrefixSize then
    Result.Text := UiLibBytesToString(Buffer.Size) + ' as Hex: '
  else
    Result.Text := '';

  Result.Text := Result.Text + RtlxBytesToHexStr(Buffer.Data, Buffer.Size,
    SpaceBytes);
  Result.Hint := BuildHint([
    THintSection.New('Size (decimal)', UiLibUIntToDec(Buffer.Size)),
    THintSection.New('Size (hex)', UiLibUIntToHex(Buffer.Size))
  ]);
end;

function DiaxFormatSymbolName;
var
  Name: String;
  WideName: WideString;
  Tag: TSymTagEnum;
  Basic: TBasicType;
  NameKnown, TagKnown: Boolean;
  Parent: IDiaSymbol;
begin
  NameKnown := (Symbol.get_name(WideName) = S_OK) and (WideName <> '');
  TagKnown := Symbol.get_symTag(Tag) = S_OK;

  if NameKnown and TagKnown then
  begin
    // Shorten compiland names by removing the path
    if Tag = SymTagCompiland then
      Name := RtlxExtractNamePath(WideName)
    else
      Name := WideName;

    if Name <> '' then
      Result := FormatSymbolTag(Tag) + ' "' + Name + '"'
    else
      Result := FormatSymbolTag(Tag);
  end
  else if TagKnown then
  begin
    Result := FormatSymbolTag(Tag);

    case Tag of
      SymTagBaseType:
        if Symbol.get_baseType(Basic) = S_OK then
          Result := Result + ' ' + FormatBasicType(Basic);

      SymTagHeapAllocationSite:
        if (Symbol.get_lexicalParent(Parent) = S_OK) and
          (Parent.get_name(WideName) = S_OK) and (WideName <> '') then
          Result := Result + ' In "' + WideName + '"';
    end;
  end
  else
    Result := 'Symbol';

  Result := '(' + Result + ')';
end;

function UIntToStr(Value: Cardinal): String;
var
  ShortResult: ShortString;
begin
  Str(Value, ShortResult);
  Result := String(ShortResult);
end;

function DiaxFormatLineNumberName;
var
  Number: Cardinal;
  SourceFile: IDiaSourceFile;
  SourceFileName: WideString;
begin
  if Line.get_lineNumber(Number) = S_OK then
  begin
    Result := '(Line Number ' + UIntToStr(Number);

    if (Line.get_sourceFile(SourceFile) = S_OK) and
      (SourceFile.get_fileName(SourceFileName) = S_OK) and
      (SourceFileName <> '') then
      Result := Result + ' in "' + RtlxExtractNamePath(SourceFileName) + '")'
    else
      Result := Result + ')';
  end
  else
    Result := '(Line Number)';
end;

function DiaxFormatSourceFileName;
var
  Name: WideString;
begin
  if (SourceFile.get_fileName(Name) = S_OK) and (Name <> '') then
    Result := '(Source File "' + RtlxExtractNamePath(Name) + '")'
  else
    Result := '(Source File)';
end;

function DiaxFormatInputAssemblyName;
var
  Name: WideString;
begin
  if (AssemblyFile.get_fileName(Name) = S_OK) and (Name <> '') then
    Result := '(Input Assembly File "' + RtlxExtractNamePath(Name) + '")'
  else
    Result := '(Input Assembly File)';
end;

function DiaxFormatSectionName;
var
  RVA: Cardinal;
begin
  if Section.get_relativeVirtualAddress(RVA) = S_OK then
    Result := '(Section Contribution at ' +
      RtlxIntToHex(RVA, NUMERIC_WIDTH_ROUND_TO_GROUP, True, npSpace) + ')'
  else
    Result := '(Section Contribution)';
end;

function DiaxFormatSegmentName;
var
  RVA: Cardinal;
  Access: LongBool;
  Permissions: String;
begin
  if Segment.get_relativeVirtualAddress(RVA) = S_OK then
  begin
    Permissions := '';

    if (Segment.get_read(Access) = S_OK) and Access then
      Permissions := Permissions + 'R';

    if (Segment.get_write(Access) = S_OK) and Access then
      Permissions := Permissions + 'W';

    if (Segment.get_execute(Access) = S_OK) and Access then
      Permissions := Permissions + 'X';

    if Permissions = '' then
      Permissions := 'NA';

    Result := '(Segment at ' + RtlxIntToHex(RVA, NUMERIC_WIDTH_ROUND_TO_GROUP,
      True, npSpace) + ' [' + Permissions + '])';
  end
  else
    Result := '(Segment)';
end;

function DiaxFormatInjectedSourceName;
var
  Name: WideString;
begin
  if (InjectedSource.get_filename(Name) = S_OK) and (Name <> '') then
    Result := '(Injected Source "' + RtlxExtractNamePath(Name) + '")'
  else
    Result := '(Injected Source)';
end;

function DiaxFormatFrameDataName;
var
  RVA: Cardinal;
begin
  if FrameData.get_relativeVirtualAddress(RVA) = S_OK then
    Result := '(Frame Data at ' + UiLibUIntToHex(RVA) + ')'
  else
    Result := '(Frame Data)';
end;

function DiaxFormatTableName;
var
  Name: WideString;
begin
  if (Table.get_name(Name) = S_OK) and (Name <> '') then
    Result := '(Table "' + RtlxExtractNamePath(Name) + '")'
  else
    Result := '(Table)';
end;

function DiaxFormatDebugStreamName;
var
  Name: WideString;
begin
  if (DebugStream.get_name(Name) = S_OK) and (Name <> '') then
    Result := '(Debug Stream "' + Name + '")'
  else
    Result := '(Debug Stream)';
end;

function DiaxFormatImageData;
begin
  Result := '(Image Data)';
end;

function DiaxFormatBinaryData;
var
  ImageSection: IImageSectionHeader;
  Dummy: IUnknown;
  Name: String;
begin
  if BinaryData.QueryInterface(IImageSectionHeader, ImageSection) = S_OK then
  begin
    Name := ImageSection.SectionName;
    if Name <> '' then
      Result := '(Image Section Header "' + Name + '")'
    else
      Result := '(Image Section Header)';
  end
  else if BinaryData.QueryInterface(IXFixupData, Dummy) = S_OK then
    Result := '(Fixup Data)'
  else if BinaryData.QueryInterface(IFpoData, Dummy) = S_OK then
    Result := '(Frame Pointer Omission Data)'
  else if BinaryData.QueryInterface(IFrameData, Dummy) = S_OK then
    Result := '(Frame Data)'
  else if BinaryData.QueryInterface(IOmapData, Dummy) = S_OK then
    Result := '(OMAP Data)'
  else
    Result := '(Binary Data of ' + UiLibBytesToString(BinaryData.GetData.Size) + ')'
end;

end.

```