Project Path: arc_gmh5225_BEClient_hhpfq12e

Source Tree:

```txt
arc_gmh5225_BEClient_hhpfq12e
├── BEClient
│   ├── BEClient.cpp
│   ├── BEClient.vcxproj
│   ├── BEClient.vcxproj.filters
│   └── Structs
│       ├── BECL_DATA.h
│       └── BECL_GAME_DATA.h
├── BEClient.sln
└── README.md

```

`BEClient.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "BEClient", "BEClient\BEClient.vcxproj", "{55153341-85C5-4249-B122-C7E1E89FF1A7}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Win32 = Debug|Win32
		Debug|x64 = Debug|x64
		Release|Win32 = Release|Win32
		Release|x64 = Release|x64
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Debug|Win32.ActiveCfg = Debug|Win32
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Debug|Win32.Build.0 = Debug|Win32
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Debug|x64.ActiveCfg = Debug|x64
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Debug|x64.Build.0 = Debug|x64
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Release|Win32.ActiveCfg = Release|Win32
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Release|Win32.Build.0 = Release|Win32
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Release|x64.ActiveCfg = Release|x64
		{55153341-85C5-4249-B122-C7E1E89FF1A7}.Release|x64.Build.0 = Release|x64
	EndGlobalSection
EndGlobal

```

`BEClient/BEClient.cpp`:

```cpp
#include <iostream>
#include <ostream>

#include "Structs/BECL_DATA.h"
#include "Structs/BECL_GAME_DATA.h"

enum class EInstanceStatus
{
    none,
    not_initialized,
    successfully_initialized,
    destroying,
    destroyed
};

typedef bool (__cdecl *battleclient_init_func)(int ver, uint64_t game_data, uint64_t out_be_data);

int main()
{
    const HMODULE lib = LoadLibraryA("BEClient_x64.dll");
    
    char addressBytes[] = { 192, 168, 1, 1 };

    BECL_GAME_DATA game_data;
    game_data.game_version = "Escape from Tarkov 0.12.11.1.13323";
    game_data.server_address = (uint32_t)((int32_t)addressBytes[0] << 24 | (int32_t)addressBytes[1] << 16 | (int32_t)addressBytes[2] << 8) | (int32_t)addressBytes[3];
    game_data.server_port = 0;

    game_data.print_message_fn = [](char* pstrMessage) {
        std::printf("[+] Print Message: [ Message: %s ]\n", pstrMessage);
    };
    game_data.send_packet_fn = [](uint64_t pv_packet, int32_t n_length) {
        std::printf("[+] Send Packet: [ Length: %i ]\n", n_length);
    };
    game_data.request_restart_fn = [](int32_t i_reason) {
        std::string reason;
        switch (static_cast<be_restart_reason>(i_reason))
        {
        case be_restart_reason::unknown_restart_reason:
            reason = "Unknown Restart Reason";
            break;
        case be_restart_reason::service_needs_to_be_updated:
            reason = "Service Needs To Update";
            break;
        case be_restart_reason::service_not_running_properly:
            reason = "Service Not Running Properly";
            break;
        }
        
        std::printf("[+] Request Restart: [ Reason: %s ]\n", reason);
    };
    game_data.disconnect_peer_fn = [](uint64_t pv_peer_guid, int32_t n_guid_length, LPSTR pstr_reason) {
        std::printf("[-] Disconnect Peer [ GUID Length: %i, Reason: %s ]\n", n_guid_length, pstr_reason);
    };

    const char enc_key[256] = { 0 };

    BECL_BE_DATA be_data;
    be_data.pv_encryption_key = (uint64_t)enc_key;
    be_data.n_encryption_key_length = 256;
    const bool ret = reinterpret_cast<battleclient_init_func>(GetProcAddress(lib, "Init"))(4, (uint64_t)&game_data, (uint64_t)&be_data);
    if (ret)
    {
        Beep(1000, 100);
        
        std::printf("[+] Encryption Key: [ Key Size: %i ]\n", be_data.n_encryption_key_length);
        be_data.be_run();
        be_data.be_command("guid");
        be_data.be_exit();

        std::getchar();
    }
    else
    {
        std::printf("[-] BattlEye failed to initialize\n");
        exit(-1);
    }

    return 0;
}

```

`BEClient/BEClient.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>15.0</VCProjectVersion>
    <ProjectGuid>{55153341-85C5-4249-B122-C7E1E89FF1A7}</ProjectGuid>
    <Keyword>Win32Proj</Keyword>
    <RootNamespace>BEClient</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup>
    <PreferredToolArchitecture>x64</PreferredToolArchitecture>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>MultiByte</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <LinkIncremental>true</LinkIncremental>
    <TargetName>EscapeFromTarkov</TargetName>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <LinkIncremental>false</LinkIncremental>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <PrecompiledHeader>NotUsing</PrecompiledHeader>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>Disabled</Optimization>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <PrecompiledHeader>NotUsing</PrecompiledHeader>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>Disabled</Optimization>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <PrecompiledHeader>NotUsing</PrecompiledHeader>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>MaxSpeed</Optimization>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <PrecompiledHeader>NotUsing</PrecompiledHeader>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>MaxSpeed</Optimization>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <PrecompiledHeaderFile>pch.h</PrecompiledHeaderFile>
    </ClCompile>
    <Link>
      <SubSystem>Windows</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="BEClient.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Structs\BECL_DATA.h" />
    <ClInclude Include="Structs\BECL_GAME_DATA.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`BEClient/BEClient.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="BEClient.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Structs\BECL_DATA.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="Structs\BECL_GAME_DATA.h">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`BEClient/Structs/BECL_DATA.h`:

```h
#pragma once
#include <Windows.h>

enum class be_restart_reason
{
    unknown_restart_reason = -1,
    service_not_running_properly = 0,
    service_needs_to_be_updated = 1,
};

typedef void (__cdecl *exit_fn_t)();
typedef void (__cdecl *run_fn_t)();
typedef void (__cdecl *command_fn_t)(const char* pstr_command);
typedef void (__cdecl *received_packet_fn_t)(uint64_t pvPacket, int32_t nLength);
typedef void (__cdecl *on_receive_auth_ticket_fn_t)(uint64_t pvPacket, int32_t nTicketLength);
typedef void (__cdecl *add_peer_fn_t)(uint64_t pvPeerGUID, int32_t nGUIDLength);
typedef void (__cdecl *remove_peer_fn_t)(uint64_t pvPeerGUID, int32_t nGUIDLength);
typedef void (__cdecl *encrypt_client_packet_fn)(uint64_t pvPacket, int32_t nLength, uint64_t pvEncryptedPacket, uint64_t pnEncryptedLength);
typedef void (__cdecl *decrypt_client_packet_fn)(uint64_t pvPacket, int32_t nLength, uint64_t pvEncryptedPacket, uint64_t pnEncryptedLength);

class BECL_BE_DATA
{
public:
    exit_fn_t be_exit;
    run_fn_t be_run;
    command_fn_t be_command;
    received_packet_fn_t be_received_packet;
    on_receive_auth_ticket_fn_t be_on_receive_auth_ticket;
    add_peer_fn_t be_add_peer;
    remove_peer_fn_t be_remove_peer;

    uint64_t pv_encryption_key;
    int32_t n_encryption_key_length;

    encrypt_client_packet_fn be_encrypt_client_packet;
    decrypt_client_packet_fn be_decrypt_server_packet;
};

```

`BEClient/Structs/BECL_GAME_DATA.h`:

```h
#pragma once
#include <Windows.h>

typedef void (__cdecl *pfn_print_message_t)(char* pstr_message);
typedef void (__cdecl *pfn_send_packet_t)(uint64_t pv_packet, int32_t n_length);
typedef void (__cdecl *pfn_request_restart_t)(int32_t i_reason);
typedef void (__cdecl *pfn_disconnect_peer_t)(uint64_t pv_peer_guid, int32_t n_guid_length, char* pstr_reason);

class BECL_GAME_DATA
{
public:
    const char* game_version;
    uint32_t server_address;
    uint16_t server_port;
    
    pfn_print_message_t print_message_fn;
    pfn_request_restart_t request_restart_fn;
    pfn_send_packet_t send_packet_fn;
    pfn_disconnect_peer_t disconnect_peer_fn;
};
```

`README.md`:

```md
BEClient

```