Project Path: arc_gmh5225_x64dbgScript_0m7n2hz6

Source Tree:

```txt
arc_gmh5225_x64dbgScript_0m7n2hz6
├── README.md
├── Sample
│   ├── Export Fun_cmt from ida to x64dbg
│   │   ├── export_Func_cmt.py
│   │   ├── readme.md
│   │   └── script.txt
│   ├── Use Global Variable too Run Multipal Script
│   │   ├── Execute multiple commands.jpg
│   │   ├── Main.txt
│   │   └── stepMe.txt
│   └── test
│       └── screen.jpg
├── manual.pdf
├── v1.0
│   ├── Plugin_XP.zip
│   ├── plugins_x32.zip
│   ├── pluginsx_x64.zip
│   └── x64dbgScript v1.0.zip
└── v2.0
    ├── X64dbgScript plugin v2.jpg
    └── v2.0.zip

```

`README.md`:

```md
# x64dbg
This is just a x64dbg script system support.
on youtube:

Export Functions Comments Labels from IDA inside x64dbg.
https://youtu.be/PE1RgHLpWC8

Use Global Variable too Run Multipal Script
https://youtu.be/WlfqNp7E650

![manual_Page_1](https://user-images.githubusercontent.com/7176580/158775845-9c440394-15f8-4488-a700-ae7bb3f47122.jpg)
![manual_Page_2](https://user-images.githubusercontent.com/7176580/158775852-2f5e0477-6f2c-449c-b86f-1ee5c4419683.jpg)
![manual_Page_3](https://user-images.githubusercontent.com/7176580/158775854-ab131a24-0dde-4745-9c01-a65f2b4a9648.jpg)
![manual_Page_4](https://user-images.githubusercontent.com/7176580/158775856-3acce673-5406-4a59-a76f-5d70aa3ed686.jpg)
![manual_Page_5](https://user-images.githubusercontent.com/7176580/158775858-adb6ed08-34b9-422a-9fb6-c71eb71e771e.jpg)
![manual_Page_6](https://user-images.githubusercontent.com/7176580/158775862-7c2aa14e-725a-4cd8-a7b9-6ebcade5fcab.jpg)

```

`Sample/Export Fun_cmt from ida to x64dbg/export_Func_cmt.py`:

```py
import idautils
import idaapi

ea = BeginEA()
module =idaapi.get_root_filename()
imagebase = idaapi.get_imagebase()

f  = open("D:\\Func.txt", "w+")
# here we will export all functions name and (start,End)
for funcea in Functions(SegStart(ea), SegEnd(ea)):
    functionName = GetFunctionName(funcea)
    functionStart = "0x%08x"% (funcea - idaapi.get_imagebase())
    functionEnd = "0x%08x"%( idc.find_func_end(funcea)  - idaapi.get_imagebase())
    print functionName,functionStart,functionEnd   
    output="lable"+";" + functionName+";" + functionStart + ";" + functionEnd + "\n" 
    f.write(output)
# here we will export all comments    
for function in idautils.Functions():
    for address in idautils.FuncItems(function):
        if idc.get_cmt(address,0) is not None:
             output= "comments"+";" + idc.get_cmt(address,0) + ";" + "0x%08x"%(address-imagebase) +";" + "none" + "\n"
             print (output)
             f.write(output) 
        if idc.get_cmt(address,1) is not None:#           
             output= "comments"+";" + idc.get_cmt(address,0) + ";" + "0x%08x"%(address-imagebase) +";" + "none" + "\n"
             print (output)
             f.write(output) 
f.close()
```

`Sample/Export Fun_cmt from ida to x64dbg/readme.md`:

```md
watch the move on 
https://youtu.be/TbbBPPh-vf4

Export Functions Comments Labels from IDA inside x64dbg 
using x64dbgScript plugins

```

`Sample/Export Fun_cmt from ida to x64dbg/script.txt`:

```txt
strarr re[1]  // this will used to fill data from ReadFile function it will resized auto
strarr r[4]   // this will fill the strcture of the Func.txt
re=ReadFile  'D:\Func.txt'
int i,0  // counter for loop
logs $mod.main()  // will log base address of the main module
if.1 i<$ArrayLen(re)  // now will check if i reach array length
strAlign {r[0],r[1],r[2],r[3]},re[i],';'  // check manual this will devide string by seperator ;
//in case functions r[0] lable; r[1]lablename; r[2] FunctionBeginAddress; r[3] FunctionEndAddress
if.2 r[0]=='lable'
r[2]=r[2]+$mod.main()
r[3]=r[3]+$mod.main() -1 // -1 IDA is end func at the begin in next function
functionadd r[2],r[3]
labelset r[2],r[1]
logs 'function' + r[2] + ' add at : ' + r[1]
End.2
// in case comments r[0] comments; r[1] text comments ; r[2] comments Address
if.4 r[0]=='comments'
r[2]=r[2] +$mod.main()
commentset r[2],r[1]
logs 'commentset ' + r[2] +' add at ' + r[1]
End.4
i=i+1
repeat.1
End.1
ret
```

`Sample/Use Global Variable too Run Multipal Script/Main.txt`:

```txt
int stepCount,4  // this will be global variable will used in other script stepMe
int FinishScript,0  // same as above
bp 2E26 + $mod.main()  // set BP where we want to finish
bp 2E0F +$mod.main()   // set BP at 00000000FFCE2E04 | 0F85 164B0 | jne notepad.FFCE7920                              |
SetBreakpointCommand 2E0F +$mod.main(),'"Call stepMe"'  // set command at BP
run
if.1 CIP !=2E26 + $mod.main()
if.2 FinishScript==1  // to check if the script finish
FinishScript=0
run
End.2
repeat.1
End.1
logs 'we reach where we want to stop' + 'RAX=' + RAX
ret

```

`Sample/Use Global Variable too Run Multipal Script/stepMe.txt`:

```txt
int instLength,0
stepCount=stepCount-1
logs stepCount
if.1 stepCount!=0  // this will check if we pass 4 time and then no more set BP
instLength=$dis.len(CIP)  // measure cmd length so we will set BP after
bp CIP + instLength   // set BP at next instraction
SetBreakpointCommand CIP + instLength,'"Call stepMe"'
logs 'RAX=' + RAX
End.1
bpc CIP   // remove current BP
FinishScript=1
//run
ret
```