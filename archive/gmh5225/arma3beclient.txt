Project Path: arc_gmh5225_arma3beclient_t2nceup8

Source Tree:

```txt
arc_gmh5225_arma3beclient_t2nceup8
├── BattleNET
├── LICENSE
├── README.md
├── appveyor.yml
├── arma3beclient.wiki
├── desc
│   ├── 1.PNG
│   ├── 2.PNG
│   ├── 3.PNG
│   ├── 4.PNG
│   ├── 5.PNG
│   ├── 6.PNG
│   ├── 7.PNG
│   ├── 8.PNG
│   ├── 9.PNG
│   ├── AddingServer.gif
│   └── SetupNameAndTimeZone.gif
└── src
    ├── Arma3BE.Client
    │   ├── App.Debug.config
    │   ├── App.Release.config
    │   ├── App.config
    │   ├── App.xaml
    │   ├── App.xaml.cs
    │   ├── Arma3BE.Client.csproj
    │   ├── Bootstrapper.cs
    │   ├── Properties
    │   │   ├── Resources.Designer.cs
    │   │   ├── Resources.resx
    │   │   ├── Settings.Designer.cs
    │   │   └── Settings.settings
    │   ├── Shell.xaml
    │   ├── Shell.xaml.cs
    │   ├── SplashScreen.png
    │   ├── control.ps1
    │   ├── main.ico
    │   └── packages.config
    ├── Arma3BE.Client.Infrastructure
    │   ├── Arma3BE.Client.Infrastructure.csproj
    │   ├── Commands
    │   │   ├── ActionCommand.cs
    │   │   └── BaseCommand.cs
    │   ├── Contracts
    │   │   └── DisposableViewModelBase.cs
    │   ├── Converters
    │   │   ├── BisyBoolToColorConverter.cs
    │   │   ├── BoolToVisibilityConverter .cs
    │   │   ├── BoolToVisibilityConverterInverse.cs
    │   │   ├── BrushColorConverter.cs
    │   │   ├── InverseBooleanConverter.cs
    │   │   ├── PlayerNumberToColorConverter.cs
    │   │   └── UtcToLocalDateTimeConverter.cs
    │   ├── Events
    │   │   ├── BE
    │   │   │   ├── BEAdminLogMessage.cs
    │   │   │   ├── BEBanLogMessage.cs
    │   │   │   ├── BEChatMessage.cs
    │   │   │   ├── BECommand.cs
    │   │   │   ├── BEItemsMessage.cs
    │   │   │   ├── BELogMessage.cs
    │   │   │   ├── BEMessageBase.cs
    │   │   │   ├── BEMessageEvent.cs
    │   │   │   ├── BEPlayerLogMessage.cs
    │   │   │   ├── CloseServerEvent.cs
    │   │   │   └── RunServerEvent.cs
    │   │   ├── BEServersChangedEvent.cs
    │   │   ├── BanUserEvent.cs
    │   │   ├── KickUserEvent.cs
    │   │   ├── Models
    │   │   │   ├── BanUserModel.cs
    │   │   │   ├── KickUserModel.cs
    │   │   │   └── ShowUserModel.cs
    │   │   ├── SettingsChangedEvent.cs
    │   │   ├── ShowOptionsEvent.cs
    │   │   └── ShowUserInfoEvent.cs
    │   ├── Extensions
    │   │   ├── DateTimeExtension.cs
    │   │   ├── GridHelper.cs
    │   │   └── WindowExtension.cs
    │   ├── Helpers
    │   │   ├── IBanHelper.cs
    │   │   ├── ServerTabViewHelper.cs
    │   │   ├── StateHelper.cs
    │   │   └── Views
    │   │       └── BanView.cs
    │   ├── IIpService.cs
    │   ├── Models
    │   │   ├── ServerMonitorBaseViewModel.cs
    │   │   └── ViewModelBase.cs
    │   ├── RegionNames.cs
    │   ├── Settings
    │   │   └── ServerSettings.cs
    │   ├── Windows
    │   │   └── WindowBase.cs
    │   └── packages.config
    ├── Arma3BE.Client.Libs
    │   ├── App.config
    │   ├── Arma3BE.Client.Libs.csproj
    │   ├── Context
    │   │   ├── Arma3BEClientContext.cs
    │   │   └── Arma3BeClientContextObsolete.cs
    │   ├── Migrations
    │   │   ├── 201608261724176_Kick_Ban_Times_Reasons_Migration.Designer.cs
    │   │   ├── 201608261724176_Kick_Ban_Times_Reasons_Migration.cs
    │   │   ├── 201608261724176_Kick_Ban_Times_Reasons_Migration.resx
    │   │   ├── 201609011936124_AddSteamPortToServerInfo.Designer.cs
    │   │   ├── 201609011936124_AddSteamPortToServerInfo.cs
    │   │   ├── 201609011936124_AddSteamPortToServerInfo.resx
    │   │   ├── 201609111835579_Added_SteamId.Designer.cs
    │   │   ├── 201609111835579_Added_SteamId.cs
    │   │   ├── 201609111835579_Added_SteamId.resx
    │   │   ├── 201612040948573_Added_custom_settings.Designer.cs
    │   │   ├── 201612040948573_Added_custom_settings.cs
    │   │   ├── 201612040948573_Added_custom_settings.resx
    │   │   ├── 201706202056450_BadNicknames_ImportantWords.Designer.cs
    │   │   ├── 201706202056450_BadNicknames_ImportantWords.cs
    │   │   ├── 201706202056450_BadNicknames_ImportantWords.resx
    │   │   ├── 201803012256245_Table_Indexes.Designer.cs
    │   │   ├── 201803012256245_Table_Indexes.cs
    │   │   ├── 201803012256245_Table_Indexes.resx
    │   │   └── Configuration.cs
    │   ├── ModelCompact
    │   │   ├── Admin.cs
    │   │   ├── Ban.cs
    │   │   ├── ChatLog.cs
    │   │   ├── Note.cs
    │   │   ├── Player.cs
    │   │   ├── PlayerHistory.cs
    │   │   ├── Reason.cs
    │   │   ├── ServerInfo.cs
    │   │   ├── Sessions.cs
    │   │   └── Settings.cs
    │   ├── Repositories
    │   │   ├── AdminRepository.cs
    │   │   ├── BanRepository.cs
    │   │   ├── ChatRepository.cs
    │   │   ├── Players
    │   │   │   ├── IPlayerRepository.cs
    │   │   │   ├── PlayerDto.cs
    │   │   │   ├── PlayerRepository.cs
    │   │   │   ├── PlayerRepositoryCache.cs
    │   │   │   └── PlayerRepositoryCacheV2.cs
    │   │   ├── ReasonRepository.cs
    │   │   └── ServerInfoRepository.cs
    │   ├── Tools
    │   │   ├── ConnectionFactory.cs
    │   │   ├── ISettingsStore.cs
    │   │   ├── ISteamService.cs
    │   │   └── Settings.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.AdminsModule
    │   ├── AdminsModuleInit.cs
    │   ├── Arma3BE.Client.Modules.AdminsModule.csproj
    │   ├── Grids
    │   │   ├── AdminsControl.xaml
    │   │   └── AdminsControl.xaml.cs
    │   ├── Helpers
    │   │   └── AdminHelper.cs
    │   ├── Models
    │   │   └── ServerMonitorAdminsViewModel.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.BEServerModule
    │   ├── Arma3BE.Client.Modules.BEServerModule.csproj
    │   ├── BELogic.cs
    │   ├── BELogicItems
    │   │   └── LobbyKicker.cs
    │   ├── BEServerModuleInit.cs
    │   ├── BEService.cs
    │   ├── BEServiceLogic.cs
    │   ├── IBELogic.cs
    │   ├── IBELogicItem.cs
    │   ├── IBEService.cs
    │   ├── app.config
    │   └── packages.config
    ├── Arma3BE.Client.Modules.BEServerModule.Tests
    │   ├── Arma3BE.Client.Modules.BEServerModule.Tests.csproj
    │   ├── BEServiceLogicTests.cs
    │   ├── Properties
    │   │   └── AssemblyInfo.cs
    │   ├── app.config
    │   └── packages.config
    ├── Arma3BE.Client.Modules.BanModule
    │   ├── Arma3BE.Client.Modules.BanModule.csproj
    │   ├── BanModuleInit.cs
    │   ├── BanService.cs
    │   ├── Boxes
    │   │   ├── BanPlayerWindow.xaml
    │   │   ├── BanPlayerWindow.xaml.cs
    │   │   ├── KickPlayerWindow.xaml
    │   │   └── KickPlayerWindow.xaml.cs
    │   ├── Grids
    │   │   ├── BansControl.xaml
    │   │   └── BansControl.xaml.cs
    │   ├── Models
    │   │   └── ServerMonitorBansViewModel.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.ChatModule
    │   ├── Arma3BE.Client.Modules.ChatModule.csproj
    │   ├── Boxes
    │   │   ├── ChatHistory.xaml
    │   │   ├── ChatHistory.xaml.cs
    │   │   ├── ColoredItemsControl.xaml
    │   │   ├── ColoredItemsControl.xaml.cs
    │   │   ├── ColoredTextControl.xaml
    │   │   ├── ColoredTextControl.xaml.cs
    │   │   ├── Converters
    │   │   │   ├── ConnectTextConverter.cs
    │   │   │   ├── FullCHatMessageToColorConverter.cs
    │   │   │   ├── FullCHatMessageToStringConverter.cs
    │   │   │   ├── FullCHatMessageToWeightConverter.cs
    │   │   │   └── PlayerMessageToColorConverter.cs
    │   │   ├── IColoredTextControl.cs
    │   │   ├── RTBControl.xaml
    │   │   └── RTBControl.xaml.cs
    │   ├── Chat
    │   │   ├── ChatControl.xaml
    │   │   └── ChatControl.xaml.cs
    │   ├── ChatModuleInit.cs
    │   ├── Helpers
    │   │   └── ChatHelper.cs
    │   ├── Models
    │   │   ├── ChatHistoryViewModel.cs
    │   │   └── ServerMonitorChatViewModel.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.CoreModule
    │   ├── Arma3BE.Client.Modules.CoreModule.csproj
    │   ├── CoreModuleInit.cs
    │   ├── Helpers
    │   │   ├── BanHelper.cs
    │   │   └── MessageHelper.cs
    │   ├── StringTemplater.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.CoreModule.Tests
    │   ├── Arma3BE.Client.Modules.CoreModule.Tests.csproj
    │   ├── StringTemplaterTests.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.DevTools
    │   ├── Arma3BE.Client.Modules.DevTools.csproj
    │   ├── DevToolsModuleInit.cs
    │   ├── Models
    │   │   └── LogViewerViewModel.cs
    │   ├── Properties
    │   │   ├── AssemblyInfo.cs
    │   │   ├── Resources.Designer.cs
    │   │   ├── Resources.resx
    │   │   ├── Settings.Designer.cs
    │   │   └── Settings.settings
    │   ├── Windows
    │   │   ├── LogViewer.xaml
    │   │   └── LogViewer.xaml.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.IndicatorsModule
    │   ├── Arma3BE.Client.Modules.IndicatorsModule.csproj
    │   ├── IndicatorsModuleInit.cs
    │   ├── LastUpdateIndicator.xaml
    │   ├── LastUpdateIndicator.xaml.cs
    │   ├── LastUpdateIndicatorViewModel.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.MainModule
    │   ├── About.xaml
    │   ├── About.xaml.cs
    │   ├── Arma3BE.Client.Modules.MainModule.csproj
    │   ├── AvalonDockRegionAdapter.cs
    │   ├── MainModuleInit.cs
    │   ├── MainWindow.xaml
    │   ├── MainWindow.xaml.cs
    │   ├── Properties
    │   │   └── Annotations.cs
    │   ├── ServerInfoControl.xaml
    │   ├── ServerInfoControl.xaml.cs
    │   ├── ViewModel
    │   │   ├── MainViewModel.cs
    │   │   └── ServerMonitorModel.cs
    │   ├── app.config
    │   └── packages.config
    ├── Arma3BE.Client.Modules.ManageServerModule
    │   ├── Arma3BE.Client.Modules.ManageServerModule.csproj
    │   ├── Grids
    │   │   ├── ManageServer.xaml
    │   │   └── ManageServer.xaml.cs
    │   ├── ManageServerModuleInit.cs
    │   ├── Models
    │   │   └── ServerMonitorManageServerViewModel.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.NetModule
    │   ├── Arma3BE.Client.Modules.NetModule.csproj
    │   ├── IPDatabase
    │   │   ├── COPYRIGHT.txt
    │   │   ├── GeoLite2-City.mmdb
    │   │   └── LICENSE.txt
    │   ├── IpService.cs
    │   ├── NetModuleInit.cs
    │   ├── app.config
    │   └── packages.config
    ├── Arma3BE.Client.Modules.OnlinePlayersModule
    │   ├── Arma3BE.Client.Modules.OnlinePlayersModule.csproj
    │   ├── Grids
    │   │   ├── OnlinePlayers.xaml
    │   │   └── OnlinePlayers.xaml.cs
    │   ├── Helpers
    │   │   ├── PlayerHelper.cs
    │   │   └── Views
    │   │       └── PlayerView.cs
    │   ├── Models
    │   │   └── ServerMonitorPlayerViewModel.cs
    │   ├── OnlinePlayersModuleInit.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.OptionsModule
    │   ├── Arma3BE.Client.Modules.OptionsModule.csproj
    │   ├── Options.xaml
    │   ├── Options.xaml.cs
    │   ├── OptionsModuleInit.cs
    │   ├── ViewModel
    │   │   └── OptionsModel.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.OptionsModule.Tests
    │   ├── Arma3BE.Client.Modules.OptionsModule.Tests.csproj
    │   └── packages.config
    ├── Arma3BE.Client.Modules.PlayersModule
    │   ├── Arma3BE.Client.Modules.PlayersModule.csproj
    │   ├── Boxes
    │   │   ├── PlayerViewWindow.xaml
    │   │   └── PlayerViewWindow.xaml.cs
    │   ├── Grids
    │   │   ├── PlayersControl.xaml
    │   │   └── PlayersControl.xaml.cs
    │   ├── Models
    │   │   ├── PlayerView.cs
    │   │   └── PlayerViewModel.cs
    │   ├── PlayerService.cs
    │   ├── PlayersModuleInit.cs
    │   ├── ViewModel
    │   │   └── PlayerListModelView.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.SteamModule
    │   ├── Arma3BE.Client.Modules.SteamModule.csproj
    │   ├── Core
    │   │   ├── FileReaderWriterFactory.cs
    │   │   ├── IMd5Provider.cs
    │   │   ├── IdByHashSearcher.cs
    │   │   ├── OptimizedHashProvider.cs
    │   │   ├── StandardHashProvider.cs
    │   │   ├── SteamService.cs
    │   │   └── Uint32ToTiont32AllHashesFileGenerator.cs
    │   ├── Grids
    │   │   ├── SteamDiscovery.xaml
    │   │   ├── SteamDiscovery.xaml.cs
    │   │   ├── SteamQuery.xaml
    │   │   ├── SteamQuery.xaml.cs
    │   │   ├── SteamService.xaml
    │   │   └── SteamService.xaml.cs
    │   ├── Models
    │   │   ├── ServerMonitorSteamQueryViewModel.cs
    │   │   ├── SteamDiscoveryViewModel.cs
    │   │   └── SteamServiceViewModel.cs
    │   ├── SteamModuleInit.cs
    │   └── packages.config
    ├── Arma3BE.Client.Modules.ToolsModule
    │   ├── Arma3BE.Client.Modules.ToolsModule.csproj
    │   ├── Exporter.cs
    │   ├── Importer.cs
    │   ├── PlayerXML.cs
    │   ├── ToolsModuleInit.cs
    │   ├── Virtual
    │   │   └── VirtualServerFactory.cs
    │   ├── VirtualServerWindow.xaml
    │   ├── VirtualServerWindow.xaml.cs
    │   └── packages.config
    ├── Arma3BE.Client.Styles
    │   ├── Arma3BE.Client.Styles.csproj
    │   ├── Icons
    │   │   ├── add.ico
    │   │   ├── bg_header.jpg
    │   │   ├── delete.ico
    │   │   ├── download.ico
    │   │   ├── gear.png
    │   │   ├── main.ico
    │   │   ├── refresh.ico
    │   │   ├── save.ico
    │   │   ├── site_logo.png
    │   │   └── tehgam.jpg
    │   ├── Icons.xaml
    │   └── Styles.xaml
    ├── Arma3BE.Client.Updater
    │   ├── App.config
    │   ├── App.xaml
    │   ├── App.xaml.cs
    │   ├── Arma3BE.Client.Updater.csproj
    │   ├── MainWindow.xaml
    │   ├── MainWindow.xaml.cs
    │   ├── main.ico
    │   └── packages.config
    ├── Arma3BE.Common
    │   ├── Arma3BE.Common.csproj
    │   ├── Attributes
    │   │   └── ShowInUIAttribute.cs
    │   ├── Core
    │   │   ├── DisposeObject.cs
    │   │   └── ICache.cs
    │   ├── Extensions
    │   │   ├── EnumerableExtensions.cs
    │   │   ├── IntExtensions.cs
    │   │   ├── LogExtensions.cs
    │   │   └── StringExtensions.cs
    │   ├── Logging
    │   │   ├── ILog.cs
    │   │   ├── Log.cs
    │   │   └── LogFactory.cs
    │   └── packages.config
    ├── Arma3BE.Server
    │   ├── Abstract
    │   │   ├── IBEServer.cs
    │   │   ├── IBattlEyeServer.cs
    │   │   ├── IBattlEyeServerFactory.cs
    │   │   └── IServerMessageRecognizer.cs
    │   ├── Arma3BE.Server.csproj
    │   ├── BEServer.cs
    │   ├── CommandType.cs
    │   ├── Messaging
    │   │   └── ServerMessageType.cs
    │   ├── Mocks
    │   │   └── MockBattleEyeServer.cs
    │   ├── Models
    │   │   ├── Admin.cs
    │   │   ├── AdminList.cs
    │   │   ├── Ban.cs
    │   │   ├── BanList.cs
    │   │   ├── ChatMessage.cs
    │   │   ├── Mission.cs
    │   │   ├── MissionList.cs
    │   │   ├── Player.cs
    │   │   ├── PlayerList.cs
    │   │   ├── ServerMessage.cs
    │   │   └── StateList.cs
    │   ├── Recognizers
    │   │   ├── AdminListRecognizer.cs
    │   │   ├── BanListRecognizer.cs
    │   │   ├── BanLogRecognizer.cs
    │   │   ├── ChatMessageRecognizer.cs
    │   │   ├── Core
    │   │   │   ├── GUIDValidator.cs
    │   │   │   └── IPAndPortValidator.cs
    │   │   ├── MissionsListRecognizer.cs
    │   │   ├── PlayerListRecognizer.cs
    │   │   ├── PlayerLogRecognizer.cs
    │   │   └── RconAdminLogRecognizer.cs
    │   ├── ServerDecorators
    │   │   ├── BEConnectedWatcher.cs
    │   │   ├── BattlEyeServerProxy.cs
    │   │   └── ThreadSafeBattleEyeServer.cs
    │   └── ServerFactory
    │       ├── BattlEyeServerFactory.cs
    │       └── WatcherBEServerFactory.cs
    ├── Arma3BE.Steam
    │   ├── Arma3BE.Steam.csproj
    │   ├── GetServerInfoSettings.cs
    │   ├── ResponseParser.cs
    │   ├── Server.cs
    │   ├── ServerInfoResult.cs
    │   ├── ServerPlayers.cs
    │   └── ServerRulesResult.cs
    ├── Arma3BE.Tests
    │   ├── Arma3BE.Tests.csproj
    │   ├── PlayerUpaterTest.cs
    │   ├── Properties
    │   │   └── AssemblyInfo.cs
    │   ├── ServerMessages
    │   │   └── Recognizers
    │   │       ├── AdminListLineRecognizerTest.cs
    │   │       ├── AdminListRecognizerTest.cs
    │   │       ├── BanListLineRecognizerTest.cs
    │   │       ├── BanListRecognizerTest.cs
    │   │       ├── PlayerListLineRecognizerTest.cs
    │   │       └── PlayerListRecognizerTest.cs
    │   └── packages.config
    ├── Arma3BE.sln
    ├── Arma3BE.sln.DotSettings
    ├── Arma3BEClient.sln.DotSettings
    ├── Arma3BEClient.sln.GhostDoc.xml
    ├── GlobalAssemblyInfo.cs
    └── build.bat

```

`LICENSE`:

```
Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "{}"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright {yyyy} {name of copyright owner}

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.


```

`README.md`:

```md
# Arma 3 BattlEye Tool

This program is designed specifically for the [TEHGAM](http://tehgam.com/) community, with the main intended purpose of managing players and bans through the BattlEye protocol.


 [![Build status](https://ci.appveyor.com/api/projects/status/vvhqm0ma4rb6pk5h?svg=true)](https://ci.appveyor.com/project/ArtemMuradov/arma3beclient)

## Screenshots

![Main interface](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/1.PNG) Main interface |![Search function](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/2.PNG) Search function |![Player info](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/3.PNG) Player info
:-:|:-:|:-:
![Player Nicknames and IP's](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/4.PNG) Player Nicknames and IP's |![Player notes](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/5.PNG) Player notes |![Chat history](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/6.PNG) Chat history
![Server settings](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/7.PNG) Server settings |![Select mission](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/8.PNG) Select mission |![Steam query support](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/9.PNG) Steam query support

## Up and run for 2 steps: 

1. Setup name and timezone
![Setup name and timezone](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/SetupNameAndTimeZone.gif)

2. Add your first server and connect
![Setup name and timezone](https://raw.githubusercontent.com/tym32167/arma3beclient/master/desc/AddingServer.gif)
```

`appveyor.yml`:

```yml
# Notes:
#   - Minimal appveyor.yml file is an empty file. All sections are optional.
#   - Indent each level of configuration with 2 spaces. Do not use tabs!
#   - All section names are case-sensitive.
#   - Section names should be unique on each level.

#---------------------------------#
#      general configuration      #
#---------------------------------#

# version format
version: 0.8.{build}

assembly_info:
  patch: true
  file: src\GlobalAssemblyInfo.cs
  assembly_version: '{version}'
  assembly_file_version: '{version}'

# you can use {branch} name in version format too
# version: 1.0.{build}-{branch}

# branches to build
branches:
  # whitelist
  only:
    - master
    - develop


#---------------------------------#
#    environment configuration    #
#---------------------------------#

# Build worker image (VM template)
image: Visual Studio 2017



#---------------------------------#
#       build configuration       #
#---------------------------------#

# build platform, i.e. x86, x64, Any CPU. This setting is optional.
platform: Any CPU

# to add several platforms to build matrix:
#platform:
#  - x86
#  - Any CPU

# build Configuration, i.e. Debug, Release, etc.
configuration: Release


install:
  - git submodule update --init --recursive

build:  
  project: src\Arma3BE.sln     # path to Visual Studio solution or project  
  # MSBuild verbosity level
  verbosity: normal

# scripts to run before build
before_build:
  - nuget restore "src\Arma3BE.sln"

after_build:
  - del src\Arma3BE.Client\bin\Release\*.xml
  - del src\Arma3BE.Client\bin\Release\*.pdb
  - del src\Arma3BE.Client\bin\Release\*.manifest
  - del src\Arma3BE.Client\bin\Release\Arma3BEClient.application
  - del src\Arma3BE.Client\bin\Release\control.ps1   
  - rd src\Arma3BE.Client\bin\Release\app.publish /s /q 
  - rd src\Arma3BE.Client\bin\Release\de /s /q 
  - rd src\Arma3BE.Client\bin\Release\es /s /q 
  - rd src\Arma3BE.Client\bin\Release\fr /s /q 
  - rd src\Arma3BE.Client\bin\Release\hu /s /q   
  - rd src\Arma3BE.Client\bin\Release\it /s /q 
  - rd src\Arma3BE.Client\bin\Release\pt-BR /s /q 
  - rd src\Arma3BE.Client\bin\Release\ro /s /q 
  - rd src\Arma3BE.Client\bin\Release\ru /s /q 
  - rd src\Arma3BE.Client\bin\Release\sv /s /q   
  - rd src\Arma3BE.Client\bin\Release\zh-Hans /s /q   


#---------------------------------#
#      artifacts configuration    #
#---------------------------------#

artifacts:
  - path: src\Arma3BE.Client\bin\$(configuration)\
    name: Arma3BEClient

#---------------------------------#
#         notifications           #
#---------------------------------#
  
notifications:

  # Email
  - provider: Email
    to:
      - tym32167@gmail.com
      

```

`src/Arma3BE.Client.Infrastructure/Arma3BE.Client.Infrastructure.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{B58670E5-011F-4318-964E-35C8B63870A5}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Infrastructure</RootNamespace>
    <AssemblyName>Arma3BE.Client.Infrastructure</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Commands\ActionCommand.cs" />
    <Compile Include="Commands\BaseCommand.cs" />
    <Compile Include="Contracts\DisposableViewModelBase.cs" />
    <Compile Include="Converters\BisyBoolToColorConverter.cs" />
    <Compile Include="Converters\BoolToVisibilityConverter .cs" />
    <Compile Include="Converters\BoolToVisibilityConverterInverse.cs" />
    <Compile Include="Converters\BrushColorConverter.cs" />
    <Compile Include="Converters\InverseBooleanConverter.cs" />
    <Compile Include="Converters\PlayerNumberToColorConverter.cs" />
    <Compile Include="Converters\UtcToLocalDateTimeConverter.cs" />
    <Compile Include="Events\BanUserEvent.cs" />
    <Compile Include="Events\BEServersChangedEvent.cs" />
    <Compile Include="Events\BE\BEAdminLogMessage.cs" />
    <Compile Include="Events\BE\BEBanLogMessage.cs" />
    <Compile Include="Events\BE\BEChatMessage.cs" />
    <Compile Include="Events\BE\BECommand.cs" />
    <Compile Include="Events\BE\BEItemsMessage.cs" />
    <Compile Include="Events\BE\BELogMessage.cs" />
    <Compile Include="Events\BE\BEMessageBase.cs" />
    <Compile Include="Events\BE\BEMessageEvent.cs" />
    <Compile Include="Events\BE\BEPlayerLogMessage.cs" />
    <Compile Include="Events\BE\CloseServerEvent.cs" />
    <Compile Include="Events\BE\RunServerEvent.cs" />
    <Compile Include="Events\KickUserEvent.cs" />
    <Compile Include="Events\Models\BanUserModel.cs" />
    <Compile Include="Events\Models\KickUserModel.cs" />
    <Compile Include="Events\Models\ShowUserModel.cs" />
    <Compile Include="Events\SettingsChangedEvent.cs" />
    <Compile Include="Events\ShowOptionsEvent.cs" />
    <Compile Include="Events\ShowUserInfoEvent.cs" />
    <Compile Include="Extensions\DateTimeExtension.cs" />
    <Compile Include="Extensions\GridHelper.cs" />
    <Compile Include="Extensions\WindowExtension.cs" />
    <Compile Include="Helpers\IBanHelper.cs" />
    <Compile Include="Helpers\ServerTabViewHelper.cs" />
    <Compile Include="Helpers\StateHelper.cs" />
    <Compile Include="Helpers\Views\BanView.cs" />
    <Compile Include="IIpService.cs" />
    <Compile Include="Models\ServerMonitorBaseViewModel.cs" />
    <Compile Include="Models\ViewModelBase.cs" />
    <Compile Include="RegionNames.cs" />
    <Compile Include="Settings\ServerSettings.cs" />
    <Compile Include="Windows\WindowBase.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Infrastructure/Commands/ActionCommand.cs`:

```cs
using System;

namespace Arma3BE.Client.Infrastructure.Commands
{
    public class ActionCommand : BaseCommand
    {
        private readonly Action _action;
        private readonly Func<bool> _canExecute;

        public ActionCommand(Action action, Func<bool> canExecute = null)
        {
            _action = action;
            _canExecute = canExecute;
        }

        public override bool CanExecute(object parameter)
        {
            if (_canExecute == null)
                return base.CanExecute(parameter);
            return _canExecute();
        }

        public override void Execute(object parameter)
        {
            _action();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Commands/BaseCommand.cs`:

```cs
using System;
using System.Windows.Input;

namespace Arma3BE.Client.Infrastructure.Commands
{
    public abstract class BaseCommand : ICommand
    {
        public virtual bool CanExecute(object parameter)
        {
            return true;
        }

        public abstract void Execute(object parameter);
        public event EventHandler CanExecuteChanged;

        protected virtual void OnCanExecuteChanged()
        {
            var handler = CanExecuteChanged;
            if (handler != null) handler(this, EventArgs.Empty);
        }

        public void RaiseCanExecuteChanged()
        {
            OnCanExecuteChanged();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Contracts/DisposableViewModelBase.cs`:

```cs
using Arma3BE.Client.Infrastructure.Models;
using System;

namespace Arma3BE.Client.Infrastructure.Contracts
{
    public abstract class DisposableViewModelBase : ViewModelBase, IDisposable
    {
        private bool _disposed;

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        ~DisposableViewModelBase()
        {
            Dispose(false);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (_disposed)
                return;

            if (disposing)
            {
                DisposeManagedResources();
            }
            DisposeUnManagedResources();
            _disposed = true;
        }

        protected virtual void DisposeManagedResources()
        {
        }

        protected virtual void DisposeUnManagedResources()
        {
        }

        // TODO: do not forget about cleaning!
        public virtual void Cleanup()
        {
            //base.Cleanup();
            Dispose();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/BisyBoolToColorConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;

namespace Arma3BE.Client.Infrastructure.Converters
{
    public class BisyBoolToColorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value != null && (bool)value ? new SolidColorBrush { Color = Colors.Red } : new SolidColorBrush { Color = Colors.Transparent };
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/BoolToVisibilityConverter .cs`:

```cs
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace Arma3BE.Client.Infrastructure.Converters
{
    public class BoolToVisibilityConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value != null && (bool)value ? Visibility.Visible : Visibility.Collapsed;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/BoolToVisibilityConverterInverse.cs`:

```cs
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace Arma3BE.Client.Infrastructure.Converters
{
    public class BoolToVisibilityConverterInverse : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value != null && (bool)value ? Visibility.Collapsed : Visibility.Visible;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/BrushColorConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;

namespace Arma3BE.Client.Infrastructure.Converters
{
    [ValueConversion(typeof(bool), typeof(SolidColorBrush))]
    // ReSharper disable once UnusedMember.Global
    public class BrushColorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null && (bool)value)
            {
                {
                    return new SolidColorBrush(Colors.Black);
                }
            }
            return new SolidColorBrush(Colors.Red);
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/InverseBooleanConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;

namespace Arma3BE.Client.Infrastructure.Converters
{
    [ValueConversion(typeof(bool), typeof(bool))]
    public class InverseBooleanConverter : IValueConverter
    {
        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter,
            CultureInfo culture)
        {
            if (targetType != typeof(bool))
                throw new InvalidOperationException("The target must be a boolean");

            return value != null && !(bool)value;
        }

        public object ConvertBack(object value, Type targetType, object parameter,
            CultureInfo culture)
        {
            throw new NotSupportedException();
        }

        #endregion
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/PlayerNumberToColorConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;

namespace Arma3BE.Client.Infrastructure.Converters
{
    [ValueConversion(typeof(int), typeof(SolidColorBrush))]
    public class PlayerNumberToColorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value == null) return new SolidColorBrush(Colors.Black);
            var num = (int)value;
            if (num  < 0) return new SolidColorBrush(Colors.Brown);
            return new SolidColorBrush(Colors.Black);
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Converters/UtcToLocalDateTimeConverter.cs`:

```cs
using Arma3BE.Client.Infrastructure.Extensions;
using System;
using System.Globalization;
using System.Windows.Data;
// ReSharper disable HeuristicUnreachableCode

namespace Arma3BE.Client.Infrastructure.Converters
{
    [ValueConversion(typeof(DateTime), typeof(DateTime))]
    [ValueConversion(typeof(DateTime?), typeof(DateTime?))]
    public class UtcToLocalDateTimeConverter : IValueConverter
    {
        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter,
            CultureInfo culture)
        {
            // ReSharper disable once CanBeReplacedWithTryCastAndCheckForNull
            if (value is DateTime?) return ((DateTime?)value).UtcToLocalFromSettings();
            // ReSharper disable once ConditionIsAlwaysTrueOrFalse
            // ReSharper disable once UseNullPropagation
            if (value is DateTime) return ((DateTime)value).UtcToLocalFromSettings();

            return null;
        }

        public object ConvertBack(object value, Type targetType, object parameter,
            CultureInfo culture)
        {
            throw new NotSupportedException();
        }

        #endregion
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEAdminLogMessage.cs`:

```cs
using System;
using Arma3BE.Server.Models;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BEAdminLogMessage : BELogMessage
    {
        public BEAdminLogMessage(LogMessage message, Guid serverId) : base(message, serverId)
        {
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEBanLogMessage.cs`:

```cs
using System;
using Arma3BE.Server.Models;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BEBanLogMessage : BELogMessage
    {
        public BEBanLogMessage(LogMessage message, Guid serverId) : base(message, serverId)
        {
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEChatMessage.cs`:

```cs
using Arma3BE.Server.Models;
using System;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BEChatMessage : BEMessageBase<ChatMessage>
    {
        public ChatMessage Message { get; }

        public BEChatMessage(ChatMessage message, Guid serverId) : base(serverId)
        {
            Message = message;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BECommand.cs`:

```cs
using Arma3BE.Server;
using System;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BECommand : BEMessageBase<object>
    {
        public BECommand(Guid serverId, CommandType commandType, string parameters = null) : base(serverId)
        {
            Parameters = parameters;
            CommandType = commandType;
        }

        public string Parameters { get; }
        public CommandType CommandType { get; }
    }

    public class BECustomCommand : BEMessageBase<object>
    {
        public string Command { get; }

        public BECustomCommand(Guid serverId, string command) : base(serverId)
        {
            Command = command;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEItemsMessage.cs`:

```cs
using System;
using System.Collections.Generic;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BEItemsMessage<T> : BEMessageBase<IEnumerable<T>>
    {
        public BEItemsMessage(IEnumerable<T> items, Guid serverId) : base(serverId)
        {
            Items = items;
        }

        public IEnumerable<T> Items { get; }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BELogMessage.cs`:

```cs
using Arma3BE.Server.Models;
using System;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public abstract class BELogMessage : BEMessageBase<LogMessage>
    {
        public LogMessage Message { get; }

        protected BELogMessage(LogMessage message, Guid serverId) : base(serverId)
        {
            Message = message;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEMessageBase.cs`:

```cs
using System;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    // ReSharper disable once UnusedTypeParameter
    public abstract class BEMessageBase<T> : BEMessageBase
    {
        protected BEMessageBase(Guid serverId) : base(serverId)
        {
        }
    }

    public abstract class BEMessageBase
    {
        protected BEMessageBase(Guid serverId)
        {
            ServerId = serverId;
        }

        public Guid ServerId { get; }
    }

    public class BEMessage : BEMessageBase
    {
        public BEMessage(Guid serverId) : base(serverId)
        {
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEMessageEvent.cs`:

```cs
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BEMessageEvent<T> : PubSubEvent<T>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/BEPlayerLogMessage.cs`:

```cs
using System;
using Arma3BE.Server.Models;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class BEPlayerLogMessage : BELogMessage
    {
        public BEPlayerLogMessage(LogMessage message, Guid serverId) : base(message, serverId)
        {
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/CloseServerEvent.cs`:

```cs
using Arma3BEClient.Libs.Repositories;
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class CloseServerEvent : PubSubEvent<ServerInfoDto>
    {

    }


    public class ConnectServerEvent : PubSubEvent<ServerInfoDto>
    {

    }

    public class DisConnectServerEvent : PubSubEvent<ServerInfoDto>
    {

    }

    public class ConnectingServerEvent : PubSubEvent<ServerInfoDto>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BE/RunServerEvent.cs`:

```cs
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events.BE
{
    public class RunServerEvent : PubSubEvent<ServerInfoDto>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BEServersChangedEvent.cs`:

```cs
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events
{
    public class BEServersChangedEvent : PubSubEvent<object>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/BanUserEvent.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.Models;
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events
{
    public class BanUserEvent : PubSubEvent<BanUserModel>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/KickUserEvent.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.Models;
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events
{
    public class KickUserEvent : PubSubEvent<KickUserModel>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/Models/BanUserModel.cs`:

```cs
using System;

namespace Arma3BE.Client.Infrastructure.Events.Models
{
    public class BanUserModel
    {
        public Guid? ServerId { get; }
        public string PlayerGuid { get; }
        public string PlayerNum { get; }
        public bool IsOnline { get; }
        public string PlayerName { get; }

        public BanUserModel(Guid? serverId, string playerGuid, bool isOnline, string playerName,
            string playerNum)
        {
            ServerId = serverId;
            PlayerGuid = playerGuid;
            PlayerNum = playerNum;
            IsOnline = isOnline;
            PlayerName = playerName;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/Models/KickUserModel.cs`:

```cs
using System;

namespace Arma3BE.Client.Infrastructure.Events.Models
{
    public class KickUserModel
    {
        public Guid ServerId { get; }
        public string PlayerGuid { get; }
        public int PlayerNum { get; }
        public string PlayerName { get; }

        public KickUserModel(Guid serverId, string playerGuid, string playerName,
            int playerNum)
        {
            ServerId = serverId;
            PlayerGuid = playerGuid;
            PlayerNum = playerNum;
            PlayerName = playerName;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/Models/ShowUserModel.cs`:

```cs
namespace Arma3BE.Client.Infrastructure.Events.Models
{
    public class ShowUserModel
    {
        public string UserGuid { get; }

        public ShowUserModel(string userGuid)
        {
            UserGuid = userGuid;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/SettingsChangedEvent.cs`:

```cs
using Arma3BEClient.Libs.Tools;
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events
{
    public class SettingsChangedEvent : PubSubEvent<ISettingsStore>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/ShowOptionsEvent.cs`:

```cs
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events
{
    public class ShowOptionsEvent : PubSubEvent<object>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Events/ShowUserInfoEvent.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.Models;
using Prism.Events;

namespace Arma3BE.Client.Infrastructure.Events
{
    public class ShowUserInfoEvent : PubSubEvent<ShowUserModel>
    {

    }
}
```

`src/Arma3BE.Client.Infrastructure/Extensions/DateTimeExtension.cs`:

```cs
using Arma3BEClient.Libs.Tools;
using System;

namespace Arma3BE.Client.Infrastructure.Extensions
{
    public static class DateTimeExtensions
    {
        private static ISettingsStore SettingsStore => new SettingsStoreSource().GetSettingsStore();

        public static DateTime UtcToLocalFromSettings(this DateTime source)
        {
            var zone = SettingsStore.TimeZoneInfo;
            return TimeZoneInfo.ConvertTimeFromUtc(source, zone);
        }


        private static DateTime LocalToUtcFromSettings(this DateTime source)
        {
            var zone = SettingsStore.TimeZoneInfo;
            return TimeZoneInfo.ConvertTimeToUtc(source, zone);
        }


        public static DateTime? UtcToLocalFromSettings(this DateTime? source)
        {
            return source?.UtcToLocalFromSettings();
        }


        public static DateTime? LocalToUtcFromSettings(this DateTime? source)
        {
            return source?.LocalToUtcFromSettings();
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Extensions/GridHelper.cs`:

```cs
using Arma3BEClient.Common.Attributes;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Tools;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using Xceed.Wpf.DataGrid;

namespace Arma3BE.Client.Infrastructure.Extensions
{
    public static class GridHelper
    {
        public static ContextMenu Generate<T>(this DataGridControl dgcGridControl) where T : class
        {
            var menu = new ContextMenu();

            dgcGridControl.GenerateColumnsVisibilityMenu(menu);

            var root = new MenuItem { Header = "Copy" };
            menu.Items.Add(root);

            var type = typeof(T);
            var members = type.GetProperties();
            foreach (var propertyInfo in members)
            {
                var attr = Attribute.GetCustomAttribute(propertyInfo, typeof(EnableCopyAttribute));
                if (attr != null)
                {
                    var item = new MenuItem { Header = propertyInfo.Name };

                    var info = propertyInfo;
                    item.Click += (s, e) =>
                    {
                        var si = dgcGridControl.SelectedItem as T;

                        if (si != null)
                            try
                            {
                                var val = info.GetValue(si);

                                if (val != null)
                                {
                                    Clipboard.Clear();
                                    Clipboard.SetText(val.ToString());
                                }
                            }
                            catch (Exception ex)
                            {
                                var log = LogFactory.Create(typeof(GridHelper));
                                log.Error(ex);
                            }
                    };

                    root.Items.Add(item);
                }
            }

            return menu;
        }

        private static void GenerateColumnsVisibilityMenu(this DataGridControl dgcGridControl, ContextMenu menu)
        {
            var root = new MenuItem { Header = "Columns" };
            menu.Items.Add(root);

            var columns = dgcGridControl.Columns.OfType<CustomColumn>().ToArray();

            foreach (var column in columns)
            {
                var checkBox = new CheckBox() { Content = column.FieldName };
                Binding myBinding = new Binding();
                myBinding.Source = column;
                myBinding.Path = new PropertyPath(nameof(Column.Visible));
                myBinding.Mode = BindingMode.TwoWay;
                BindingOperations.SetBinding(checkBox, CheckBox.IsCheckedProperty, myBinding);
                var cmenu = new MenuItem() { Header = checkBox };
                root.Items.Add(cmenu);
            }

        }

        public static void LoadState<T>(this DataGridControl source, string key)
        {
            foreach (var generateColumn in GenerateColumns<T>())
                source.Columns.Add(generateColumn);

            source.Load(key);


            source.Unloaded += (s, e) =>
            {
                var columns = source.Columns.OfType<CustomColumn>().ToArray();

                if (columns.Any(c => c.HasChanges))
                {
                    source.Save(key);

                    foreach (var customColumn in columns)
                    {
                        customColumn.Reset();
                    }
                }
            };
        }

        private static IEnumerable<Column> GenerateColumns<T>()
        {
            var list = new List<Column>();
            var type = typeof(T);
            var members = type.GetProperties();
            foreach (var propertyInfo in members)
            {
                var attr = Attribute.GetCustomAttribute(propertyInfo, typeof(ShowInUiAttribute));
                if (attr != null)
                {
                    var c = new CustomColumn();
                    c.FieldName = propertyInfo.Name;
                    c.AllowGroup = false;
                    c.Title = propertyInfo.Name;


                    if ((propertyInfo.PropertyType == typeof(DateTime)) ||
                        (propertyInfo.PropertyType == typeof(DateTime?)))
                    {
                        var newTextBlock = new FrameworkElementFactory(typeof(TextBlock));
                        newTextBlock.SetBinding(TextBlock.TextProperty,
                            new Binding(".") { StringFormat = @"{0:dd.MM.yy HH:mm:ss}" });
                        var newDataTemplate = new DataTemplate { VisualTree = newTextBlock };

                        c.CellContentTemplate = newDataTemplate;
                    }

                    list.Add(c);
                }
            }
            return list;
        }


        private static void Load(this DataGridControl dgcGridControl, string key)
        {
            var cols = GetColumns(key)?.ToArray();
            if (cols == null) return;
            var colums = dgcGridControl.Columns.ToDictionary(x => x.FieldName);

            foreach (var source in cols.OrderBy(x => x.Order))
                if (colums.ContainsKey(source.OriginalName))
                {
                    var column = colums[source.OriginalName];

                    column.VisiblePosition = source.Order;
                    column.Width = source.Width;
                    column.Visible = source.Visible;

                    (column as CustomColumn)?.Reset();
                }
        }

        private static IEnumerable<ColumnInfo> GetColumns(string key)
        {
            try
            {
                var store = new SettingsStoreSource().GetCustomSettingsStore();
                var data = store.Load<ColumnInfo[]>(key);
                return data;
            }
            catch (Exception e)
            {
                var log = LogFactory.Create(typeof(GridHelper));
                log.Error(e);
                return null;
            }
        }


        private static void Save(this DataGridControl dgcGridControl, string key)
        {
            var cols =
                dgcGridControl.Columns.Select(
                    (c, i) =>
                        new ColumnInfo
                        {
                            Width = c.ActualWidth,
                            Order = c.VisiblePosition,
                            OriginalName = c.FieldName,
                            Visible = c.Visible
                        }).ToArray();
            SaveColumns(key, cols);
        }

        private static void SaveColumns(string key, IEnumerable<ColumnInfo> infos)
        {
            try
            {
                var array = infos.ToArray();
                var store = new SettingsStoreSource().GetCustomSettingsStore();
                store.Save(key, array);
            }
            catch (Exception e)
            {
                var log = LogFactory.Create(typeof(GridHelper));
                log.Error(e);
            }
        }

        private class CustomColumn : Column
        {
            public CustomColumn()
            {
                HasChanges = false;
                Changed += (s, e) => { HasChanges = true; };
            }

            public void Reset()
            {
                HasChanges = false;
            }

            public bool HasChanges { get; private set; }
        }
    }

    public class ColumnInfo
    {
        public string OriginalName { get; set; }
        public int Order { get; set; }
        public double Width { get; set; }
        public bool Visible { get; set; }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Extensions/WindowExtension.cs`:

```cs
using System;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Interop;

namespace Arma3BE.Client.Infrastructure.Extensions
{
    public static class WindowExtension
    {
        private const UInt32 FLASHW_STOP = 0; //Stop flashing. The system restores the window to its original state.        private const UInt32 FLASHW_CAPTION = 1; //Flash the window caption.        
        private const UInt32 FLASHW_TRAY = 2; //Flash the taskbar button.        
        private const UInt32 FLASHW_ALL = 3; //Flash both the window caption and taskbar button.        
        private const UInt32 FLASHW_TIMER = 4; //Flash continuously, until the FLASHW_STOP flag is set.        
        private const UInt32 FLASHW_TIMERNOFG = 12; //Flash continuously until the window comes to the foreground.  


        [StructLayout(LayoutKind.Sequential)]
        private struct FLASHWINFO
        {
            public UInt32 cbSize; //The size of the structure in bytes.            
            public IntPtr hwnd; //A Handle to the Window to be Flashed. The window can be either opened or minimized.


            public UInt32 dwFlags; //The Flash Status.            
            public UInt32 uCount; // number of times to flash the window            
            public UInt32 dwTimeout; //The rate at which the Window is to be flashed, in milliseconds. If Zero, the function uses the default cursor blink rate.        
        }

        [DllImport("user32.dll")]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool FlashWindowEx(ref FLASHWINFO pwfi);



        public static void FlashWindow(this Window win, UInt32 count = UInt32.MaxValue)
        {
            //Don't flash if the window is active            
            if (win.IsActive) return;
            WindowInteropHelper h = new WindowInteropHelper(win);
            FLASHWINFO info = new FLASHWINFO
            {
                hwnd = h.Handle,
                dwFlags = FLASHW_ALL | FLASHW_TIMER,
                uCount = count,
                dwTimeout = 0
            };

            info.cbSize = Convert.ToUInt32(Marshal.SizeOf(info));
            FlashWindowEx(ref info);
        }

        public static void StopFlashingWindow(this Window win)
        {
            WindowInteropHelper h = new WindowInteropHelper(win);
            FLASHWINFO info = new FLASHWINFO();
            info.hwnd = h.Handle;
            info.cbSize = Convert.ToUInt32(Marshal.SizeOf(info));
            info.dwFlags = FLASHW_STOP;
            info.uCount = UInt32.MaxValue;
            info.dwTimeout = 0;
            FlashWindowEx(ref info);
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Helpers/IBanHelper.cs`:

```cs
using Arma3BE.Client.Infrastructure.Helpers.Views;
using Arma3BE.Server.Models;
using System;
using System.Collections.Generic;
using System.Threading.Tasks;

namespace Arma3BE.Client.Infrastructure.Helpers
{
    public interface IBanHelper
    {
        Task BanGUIDOfflineAsync(Guid serverId, string guid, string reason, long minutes, bool syncMode = false);

        Task BanGUIDOfflineAsync(Guid serverId, BanView[] bans, bool syncMode = false);

        Task BanGuidOnlineAsync(Guid serverId, string num, string guid, string reason, long minutes);
        Task<IEnumerable<BanView>> GetBanViewAsync(IEnumerable<Ban> list);
        Task KickAsync(Guid serverId, int playerNum, string playerGuid, string reason, bool isAuto = false);
        Task RegisterBans(IEnumerable<Ban> list, Guid currentServerId);
    }
}
```

`src/Arma3BE.Client.Infrastructure/Helpers/ServerTabViewHelper.cs`:

```cs
using Microsoft.Practices.Unity;
using Prism.Common;
using Prism.Regions;
using System.Windows;

namespace Arma3BE.Client.Infrastructure.Helpers
{
    public static class ServerTabViewHelper
    {
        public static TView RegisterView<TView, TViewParameter, TViewModel>(IUnityContainer container, string parameterName)
            where TView : FrameworkElement where TViewParameter : class
        {
            var view = container.Resolve<TView>();
            var context = RegionContext.GetObservableContext(view);
            context.PropertyChanged += (s, e) =>
            {
                var obs = s as ObservableObject<object>;
                if (obs != null)
                {
                    var serverInfo = obs.Value as TViewParameter;
                    var vm = container.Resolve<TViewModel>(new ParameterOverride(parameterName, serverInfo));
                    view.DataContext = vm;
                }
            };
            return view;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Helpers/StateHelper.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Client.Infrastructure.Helpers
{
    public class StateHelper<T> where T : class
    {
        private List<T> _previousRequest;

        protected bool HaveChanges<TK>(List<T> newList, Func<T, TK> orderer, Func<T, T, bool> comparer = null)
        {
            var temp = _previousRequest;
            _previousRequest = newList;

            if (temp != null && temp.Count == newList.Count)
            {
                var count = temp.Count;
                var po = temp.OrderBy(orderer).ToList();
                var no = newList.OrderBy(orderer).ToList();


                for (var i = 0; i < count; i++)
                {
                    var p = po[i];
                    var n = no[i];

                    if (comparer != null)
                    {
                        if (!comparer(p, n))
                        {
                            return true;
                        }
                    }
                    else
                    {
                        if (!p.Equals(n))
                        {
                            return true;
                        }
                    }
                }
                return false;
            }

            return true;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Helpers/Views/BanView.cs`:

```cs
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Common.Attributes;
using System;
// ReSharper disable UnusedMember.Global
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ExplicitCallerInfoArgument

namespace Arma3BE.Client.Infrastructure.Helpers.Views
{
    public sealed class BanView : ViewModelBase
    {
        private int _num;
        private string _playerName;
        private string _steamId;
        private int _minutesleft;
        private string _reason;
        private string _playerComment;
        private string _guidIp;

        [ShowInUi]
        [EnableCopy]
        public int Num
        {
            get { return _num; }
            set
            {
                SetProperty(ref _num, value);
            }
        }

        [ShowInUi]
        [EnableCopy]
        public string PlayerName
        {
            get { return _playerName; }
            set
            {
                SetProperty(ref _playerName, value);
            }
        }

        [ShowInUi]
        [EnableCopy]
        public string SteamId
        {
            get { return _steamId; }
            set
            {
                SetProperty(ref _steamId, value);
            }
        }

        [ShowInUi]
        [EnableCopy]
        public int Minutesleft
        {
            get { return _minutesleft; }
            set
            {
                if (SetProperty(ref _minutesleft, value))
                {
                    RaisePropertyChanged(nameof(TimeLeft));
                }
            }
        }

        [ShowInUi]
        [EnableCopy]
        public TimeSpan TimeLeft => TimeSpan.FromMinutes(Minutesleft);

        [ShowInUi]
        [EnableCopy]
        public string Reason
        {
            get { return _reason; }
            set
            {
                SetProperty(ref _reason, value);
            }
        }

        [ShowInUi]
        [EnableCopy]
        public string PlayerComment
        {
            get { return _playerComment; }
            set
            {
                SetProperty(ref _playerComment, value);
            }
        }

        [ShowInUi]
        [EnableCopy]
        public string GuidIp
        {
            get { return _guidIp; }
            set
            {
                SetProperty(ref _guidIp, value);
            }
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/IIpService.cs`:

```cs
using System.Threading.Tasks;

namespace Arma3BE.Client.Infrastructure
{
    public interface IIpService
    {
        string GetIpAddress(string host);

        Task<string> Get(string ip);
        GeoInfo GetGeoInfoLocal(string ip);
    }

    public class GeoInfo
    {
        public GeoInfo(string country, string city)
        {
            City = city;
            Country = country;
        }

        public string City { get; }
        public string Country { get; }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Models/ServerMonitorBaseViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;

// ReSharper disable MemberCanBeProtected.Global
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable UnusedMember.Global

namespace Arma3BE.Client.Infrastructure.Models
{
    public abstract class ServerMonitorBaseViewModel<T, TK> : ViewModelBase where T : class where TK : class
    {
        private readonly IEqualityComparer<TK> _comparer;

        // ReSharper disable once InconsistentNaming
        protected IEnumerable<TK> _data;

        private TK _selectedItem;
        private bool _waitingForEvent = true;
        protected ObservableCollection<TK> FilteredData;

        protected ServerMonitorBaseViewModel(ICommand refreshCommand, IEqualityComparer<TK> comparer)
        {
            _comparer = comparer;
            RefreshCommand = new CommandWrapper(refreshCommand, this);
            FilterCommand = new ActionCommand(UpdateData);
        }

        public bool WaitingForEvent
        {
            get { return _waitingForEvent; }
            set
            {
                _waitingForEvent = value;
                RaisePropertyChanged();
            }
        }

        public TK SelectedItem
        {
            get { return _selectedItem; }
            set
            {
                _selectedItem = value;
                RaisePropertyChanged();
            }
        }

        public ObservableCollection<TK> Data => FilteredData;

        // ReSharper disable once UnusedAutoPropertyAccessor.Global
        public string Filter { get; set; }

        public int DataCount => Data?.Count ?? 0;

        public ICommand RefreshCommand { get; }

        public ICommand FilterCommand { get; private set; }

        public virtual async Task SetDataAsync(IEnumerable<T> initialData)
        {
            _data = await RegisterDataAsync(initialData);

            UpdateData();
        }

        public virtual void UpdateData()
        {
            var newData = FilterData(_data).ToArray();
            UpdateFilteredData(newData);

            RaisePropertyChanged(nameof(Data));
            RaisePropertyChanged(nameof(DataCount));
        }


        protected virtual void UpdateExisting(TK old, TK @new)
        {
            var props = typeof(TK).GetProperties().Where(x => x.SetMethod != null && x.GetMethod != null);
            foreach (var prop in props)
            {
                var value = prop.GetValue(@new);
                prop.SetValue(old, value);
            }
        }

        private void UpdateFilteredData(TK[] newData)
        {
            if (Application.Current.Dispatcher.CheckAccess())
            {
                if (FilteredData == null)
                {
                    FilteredData = new ObservableCollection<TK>(newData);
                    return;
                }

                var exists = FilteredData.ToArray();

                var todelete = exists.Where(x => newData.All(n => _comparer.Equals(n, x) == false)).ToArray();
                var toAdd = newData.Where(x => exists.All(n => _comparer.Equals(n, x) == false)).ToArray();

                foreach (var dataItem in exists)
                {
                    var newItem = newData.FirstOrDefault(x => _comparer.Equals(dataItem, x));
                    if (newItem != null)
                    {
                        UpdateExisting(dataItem, newItem);
                    }
                }

                foreach (var d in todelete)
                {
                    FilteredData.Remove(d);
                }

                foreach (var a in toAdd)
                {
                    FilteredData.Add(a);
                }
            }
            else
            {
                Application.Current.Dispatcher.Invoke(() => UpdateFilteredData(newData));
            }
        }

        protected abstract Task<IEnumerable<TK>> RegisterDataAsync(IEnumerable<T> initialData);

        protected virtual ObservableCollection<TK> FilterData(IEnumerable<TK> initialData)
        {
            if (initialData == null) return null;
            return new ObservableCollection<TK>(initialData.Where(x => F(x, Filter)));
        }

        private bool F(TK element, string initialFilter)
        {
            if (string.IsNullOrEmpty(initialFilter)) return true;
            var filter = initialFilter.ToLower();

            var type = typeof(TK);


            var members = type.GetProperties();
            foreach (var propertyInfo in members)
            {
                var value = propertyInfo.GetValue(element);
                if (value != null)
                {
                    string valueAsString;
                    if (value is string)
                    {
                        valueAsString = value as string;
                    }
                    else
                    {
                        valueAsString = value.ToString();
                    }

                    if (!string.IsNullOrEmpty(valueAsString))
                    {
                        if (valueAsString.ToLower().Contains(filter)) return true;
                    }
                }
            }


            return false;
        }

        private class CommandWrapper : ICommand
        {
            private readonly ICommand _command;
            private readonly ServerMonitorBaseViewModel<T, TK> _viewModel;

            public CommandWrapper(ICommand command, ServerMonitorBaseViewModel<T, TK> viewModel)
            {
                _command = command;
                _viewModel = viewModel;
            }

            public bool CanExecute(object parameter)
            {
                return _command.CanExecute(parameter);
            }

            public void Execute(object parameter)
            {
                _viewModel.WaitingForEvent = true;
                _command.Execute(parameter);
            }

            public event EventHandler CanExecuteChanged
            {
                add { _command.CanExecuteChanged += value; }
                remove { _command.CanExecuteChanged -= value; }
            }
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Models/ViewModelBase.cs`:

```cs
using System;
using Prism.Mvvm;

namespace Arma3BE.Client.Infrastructure.Models
{
    public abstract class ViewModelBase : BindableBase
    {

    }

    public abstract class DisposableViewModelBase : ViewModelBase, IDisposable
    {
        private bool _disposed;

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        ~DisposableViewModelBase()
        {
            Dispose(false);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (_disposed)
                return;

            if (disposing)
            {
                DisposeManagedResources();
            }
            DisposeUnManagedResources();
            _disposed = true;
        }

        protected virtual void DisposeManagedResources()
        {
        }

        protected virtual void DisposeUnManagedResources()
        {
        }
    }

    public interface ITitledItem
    {
        string Title { get; }
    }
}
```

`src/Arma3BE.Client.Infrastructure/RegionNames.cs`:

```cs
namespace Arma3BE.Client.Infrastructure
{
    public static class RegionNames
    {
        public static string MainRegionRegion = "MainRegion";
        public static string BottomUpdateIndicatorRegion = "BottomUpdateIndicatorRegion";
        public static string ServerTabPartRegion = "ServerTabPartRegion";
        public static string ServerSidePartRegion = "ServerSidePartRegion";
        public static string ServerTabRegion = "ServerTabRegion";


        public static string MenuToolsRegion = "MenuToolsRegion";
        public static string MenuFileToolsRegion = "MenuFileToolsRegion";
    }
}
```

`src/Arma3BE.Client.Infrastructure/Settings/ServerSettings.cs`:

```cs
using System;

namespace Arma3BE.Client.Infrastructure.Settings
{
    public class ServerSettings
    {
        public string IdleKickReason { get; set; }
        public int IdleTimeInMins { get; set; }
        public bool KickIdlePlayers { get; set; }

        public Guid ServerId { get; set; }
    }
}
```

`src/Arma3BE.Client.Infrastructure/Windows/WindowBase.cs`:

```cs
using Arma3BEClient.Libs.Tools;
using System.Windows;

namespace Arma3BE.Client.Infrastructure.Windows
{
    public abstract class WindowBase : Window
    {
        public WindowBase(ISettingsStoreSource settingsStoreSource)
        {
            this.Topmost = settingsStoreSource.GetSettingsStore().TopMost;
        }
    }
}
```

`src/Arma3BE.Client.Infrastructure/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net45" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Libs/App.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false"/>
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
  </configSections>
  <connectionStrings>
    <!--<add name="Arma3BEClientEntities" connectionString="metadata=res://*/Model.DbModel.csdl|res://*/Model.DbModel.ssdl|res://*/Model.DbModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=serv;initial catalog=Arma3BEClient;persist security info=True;user id=sa;password=12qw!@QW;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />-->

    <add name="Arma3BEClientEntities" providerName="System.Data.SqlServerCe.4.0" connectionString="Data Source=D:\\Database.sdf"/>
  </connectionStrings>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1"/>
  </startup>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="System.Data.SqlServerCe.4.0"/>
      </parameters>
    </defaultConnectionFactory>
    <providers>
      <provider invariantName="System.Data.SqlServerCe.4.0" type="System.Data.Entity.SqlServerCompact.SqlCeProviderServices, EntityFramework.SqlServerCompact"/>
      <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer"/>
    </providers>
  </entityFramework>
  <system.data>
    <DbProviderFactories>
      <remove invariant="System.Data.SqlServerCe.4.0"/>
      <add name="Microsoft SQL Server Compact Data Provider 4.0" invariant="System.Data.SqlServerCe.4.0" description=".NET Framework Data Provider for Microsoft SQL Server Compact" type="System.Data.SqlServerCe.SqlCeProviderFactory, System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"/>
    </DbProviderFactories>
  </system.data>
</configuration>

```

`src/Arma3BE.Client.Libs/Arma3BE.Client.Libs.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{E5240A50-E944-4F50-A353-2E3C9E547447}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BEClient.Libs</RootNamespace>
    <AssemblyName>Arma3BEClient.Libs</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <SccProjectName>SAK</SccProjectName>
    <SccLocalPath>SAK</SccLocalPath>
    <SccAuxPath>SAK</SccAuxPath>
    <SccProvider>SAK</SccProvider>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\</SolutionDir>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <RunCodeAnalysis>false</RunCodeAnalysis>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Context\Arma3BEClientContext.cs" />
    <Compile Include="Context\Arma3BeClientContextObsolete.cs" />
    <Compile Include="Migrations\201608261724176_Kick_Ban_Times_Reasons_Migration.cs" />
    <Compile Include="Migrations\201608261724176_Kick_Ban_Times_Reasons_Migration.Designer.cs">
      <DependentUpon>201608261724176_Kick_Ban_Times_Reasons_Migration.cs</DependentUpon>
    </Compile>
    <Compile Include="Migrations\201609011936124_AddSteamPortToServerInfo.cs" />
    <Compile Include="Migrations\201609011936124_AddSteamPortToServerInfo.Designer.cs">
      <DependentUpon>201609011936124_AddSteamPortToServerInfo.cs</DependentUpon>
    </Compile>
    <Compile Include="Migrations\201609111835579_Added_SteamId.cs" />
    <Compile Include="Migrations\201609111835579_Added_SteamId.Designer.cs">
      <DependentUpon>201609111835579_Added_SteamId.cs</DependentUpon>
    </Compile>
    <Compile Include="Migrations\201612040948573_Added_custom_settings.cs" />
    <Compile Include="Migrations\201612040948573_Added_custom_settings.Designer.cs">
      <DependentUpon>201612040948573_Added_custom_settings.cs</DependentUpon>
    </Compile>
    <Compile Include="Migrations\201706202056450_BadNicknames_ImportantWords.cs" />
    <Compile Include="Migrations\201706202056450_BadNicknames_ImportantWords.Designer.cs">
      <DependentUpon>201706202056450_BadNicknames_ImportantWords.cs</DependentUpon>
    </Compile>
    <Compile Include="Migrations\201803012256245_Table_Indexes.cs" />
    <Compile Include="Migrations\201803012256245_Table_Indexes.Designer.cs">
      <DependentUpon>201803012256245_Table_Indexes.cs</DependentUpon>
    </Compile>
    <Compile Include="Migrations\Configuration.cs" />
    <Compile Include="ModelCompact\Reason.cs" />
    <Compile Include="Repositories\AdminRepository.cs" />
    <Compile Include="Repositories\BanRepository.cs" />
    <Compile Include="Repositories\ChatRepository.cs" />
    <Compile Include="Repositories\Players\IPlayerRepository.cs" />
    <Compile Include="Repositories\Players\PlayerDto.cs" />
    <Compile Include="Repositories\Players\PlayerRepository.cs" />
    <Compile Include="Repositories\Players\PlayerRepositoryCache.cs" />
    <Compile Include="Repositories\Players\PlayerRepositoryCacheV2.cs" />
    <Compile Include="Repositories\ReasonRepository.cs" />
    <Compile Include="Repositories\ServerInfoRepository.cs" />
    <Compile Include="ModelCompact\Admin.cs" />
    <Compile Include="ModelCompact\Ban.cs" />
    <Compile Include="ModelCompact\ChatLog.cs" />
    <Compile Include="ModelCompact\Note.cs" />
    <Compile Include="ModelCompact\Player.cs" />
    <Compile Include="ModelCompact\PlayerHistory.cs" />
    <Compile Include="ModelCompact\ServerInfo.cs" />
    <Compile Include="ModelCompact\Sessions.cs" />
    <Compile Include="ModelCompact\Settings.cs" />
    <Compile Include="Tools\ConnectionFactory.cs" />
    <Compile Include="Tools\ISettingsStore.cs" />
    <Compile Include="Tools\ISteamService.cs" />
    <Compile Include="Tools\Settings.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Reference Include="EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
      <HintPath>..\packages\EntityFramework.6.1.3\lib\net45\EntityFramework.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="EntityFramework.SqlServer, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
      <HintPath>..\packages\EntityFramework.6.1.3\lib\net45\EntityFramework.SqlServer.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="EntityFramework.SqlServerCompact, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
      <HintPath>..\packages\EntityFramework.SqlServerCompact.6.1.3\lib\net45\EntityFramework.SqlServerCompact.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.ComponentModel.DataAnnotations" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Data" />
    <Reference Include="System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.SqlServer.Compact.4.0.8876.1\lib\net40\System.Data.SqlServerCe.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Runtime.Serialization" />
    <Reference Include="System.Security" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Service Include="{508349B6-6B84-4DF5-91F0-309BEEBAD82D}" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Migrations\201608261724176_Kick_Ban_Times_Reasons_Migration.resx">
      <DependentUpon>201608261724176_Kick_Ban_Times_Reasons_Migration.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Migrations\201609011936124_AddSteamPortToServerInfo.resx">
      <DependentUpon>201609011936124_AddSteamPortToServerInfo.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Migrations\201609111835579_Added_SteamId.resx">
      <DependentUpon>201609111835579_Added_SteamId.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Migrations\201612040948573_Added_custom_settings.resx">
      <DependentUpon>201612040948573_Added_custom_settings.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Migrations\201706202056450_BadNicknames_ImportantWords.resx">
      <DependentUpon>201706202056450_BadNicknames_ImportantWords.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Migrations\201803012256245_Table_Indexes.resx">
      <DependentUpon>201803012256245_Table_Indexes.cs</DependentUpon>
    </EmbeddedResource>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <PropertyGroup>
    <PostBuildEvent>
    if not exist "$(TargetDir)x86" md "$(TargetDir)x86"
    xcopy /s /y "$(SolutionDir)packages\Microsoft.SqlServer.Compact.4.0.8876.1\NativeBinaries\x86\*.*" "$(TargetDir)x86"
    if not exist "$(TargetDir)amd64" md "$(TargetDir)amd64"
    xcopy /s /y "$(SolutionDir)packages\Microsoft.SqlServer.Compact.4.0.8876.1\NativeBinaries\amd64\*.*" "$(TargetDir)amd64"</PostBuildEvent>
  </PropertyGroup>
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Libs/Context/Arma3BEClientContext.cs`:

```cs
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Tools;
using System.Data.Entity;
using System.Diagnostics;
using Configuration = Arma3BEClient.Libs.Migrations.Configuration;

// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BEClient.Libs.Context
{
    public class Arma3BeClientContext : DbContext
    {
        static Arma3BeClientContext()
        {
            // ensuring obsolette schema initialization.
            new Arma3BeClientContextObsolete.ObsoletteRepository().EnsureDatabase();

            Database.SetInitializer(new ProjectInitializer());
            using (var db = new Arma3BeClientContext())
                db.Database.Initialize(false);
        }

        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        public Arma3BeClientContext() : base(new ConnectionFactory().Create(), true)
        {
            var debugServerKey = "DebugServerEnabled";
            //if (ConfigurationManager.AppSettings[debugServerKey] == bool.TrueString)
            {
                this.Database.Log = s =>
                {
                    _log.Info(s);
                };
            }
        }

        public DbSet<ChatLog> ChatLog { get; set; }
        public DbSet<Note> Comments { get; set; }
        public DbSet<Player> Player { get; set; }
        public DbSet<ServerInfo> ServerInfo { get; set; }
        public DbSet<Settings> Settings { get; set; }
        public DbSet<CustomSettings> CustomSettings { get; set; }
        public DbSet<Ban> Bans { get; set; }
        public DbSet<Admin> Admins { get; set; }
        public DbSet<PlayerHistory> PlayerHistory { get; set; }


        public DbSet<BanReason> BanReasons { get; set; }
        public DbSet<KickReason> KickReasons { get; set; }
        public DbSet<BanTime> BanTimes { get; set; }

        public DbSet<BadNickname> BadNicknames { get; set; }
        public DbSet<ImportantWord> ImportantWords { get; set; }
    }
    internal class ProjectInitializer : MigrateDatabaseToLatestVersion<Arma3BeClientContext, Configuration>
    {
    }
}
```

`src/Arma3BE.Client.Libs/Context/Arma3BeClientContextObsolete.cs`:

```cs
using Arma3BEClient.Common.Attributes;
using Arma3BEClient.Libs.Tools;
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Data.Entity;
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable UnusedMember.Global
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ClassNeverInstantiated.Global
// ReSharper disable MemberCanBeProtected.Global
// ReSharper disable VirtualMemberCallInConstructor
// ReSharper disable MemberHidesStaticFromOuterClass

namespace Arma3BEClient.Libs.Context
{
    public class Arma3BeClientContextObsolete : DbContext
    {
        static Arma3BeClientContextObsolete()
        {
            Database.SetInitializer(new DbInitializer());
            using (var db = new Arma3BeClientContextObsolete())
                db.Database.Initialize(false);
        }

        public Arma3BeClientContextObsolete() : base(new ConnectionFactory().Create(), true)
        {
        }

        public DbSet<Dtos.ChatLog> ChatLog { get; set; }
        public DbSet<Dtos.Note> Comments { get; set; }
        public DbSet<Dtos.Player> Player { get; set; }
        public DbSet<Dtos.ServerInfo> ServerInfo { get; set; }
        public DbSet<Dtos.Settings> Settings { get; set; }
        public DbSet<Dtos.Ban> Bans { get; set; }
        public DbSet<Dtos.Admin> Admins { get; set; }
        public DbSet<Dtos.PlayerHistory> PlayerHistory { get; set; }


        internal class DbInitializer : CreateDatabaseIfNotExists<Arma3BeClientContext>
        {
        }

        internal class ObsoletteRepository
        {
            public void EnsureDatabase()
            {
                using (var dc = new Arma3BeClientContextObsolete())
                {
                    dc.Database.CreateIfNotExists();
                }
            }
        }
    }

    public class Dtos
    {
        public class ChatLog
        {
            [Key]
            public int Id { get; set; }

            public string Text { get; set; }
            public Guid ServerId { get; set; }
            public DateTime Date { get; set; }

            [ForeignKey("ServerId")]
            public virtual ServerInfo ServerInfo { get; set; }
        }

        public class Note
        {
            public Note()
            {
                Id = Guid.NewGuid();
                Date = DateTime.UtcNow;
            }

            [Key]
            public Guid Id { get; set; }

            public Guid PlayerId { get; set; }

            [ShowInUi]
            [EnableCopy]
            public string Text { get; set; }

            [ShowInUi]
            [EnableCopy]
            public DateTime Date { get; set; }

            [ForeignKey("PlayerId")]
            public virtual Player Player { get; set; }
        }


        public class PlayerDto
        {
            public PlayerDto()
            {
                LastSeen = DateTime.UtcNow;
            }

            [Key]
            public Guid Id { get; set; }

            public string GUID { get; set; }
            public string Name { get; set; }
            public string Comment { get; set; }

            public string LastIp { get; set; }
            public DateTime LastSeen { get; set; }
        }

        public class Player : PlayerDto
        {
            public Player()
            {
                Notes = new HashSet<Note>();
                PlayerHistory = new HashSet<PlayerHistory>();
                // this.Sessions = new HashSet<Sessions>();
            }

            public virtual ICollection<Note> Notes { get; set; }
            public virtual ICollection<Ban> Bans { get; set; }
            public virtual ICollection<PlayerHistory> PlayerHistory { get; set; }
        }

        public class ServerInfo
        {
            public ServerInfo()
            {
                ChatLog = new HashSet<ChatLog>();
                PlayerHistory = new HashSet<PlayerHistory>();
                Admins = new HashSet<Admin>();
            }

            [Key]
            public Guid Id { get; set; }

            [Required]
            public string Host { get; set; }

            [Required]
            public int Port { get; set; }

            [Required]
            public string Password { get; set; }

            [Required]
            public string Name { get; set; }

            [Required]
            public bool Active { get; set; }


            public virtual ICollection<ChatLog> ChatLog { get; set; }

            public virtual ICollection<Ban> Bans { get; set; }

            public virtual ICollection<Admin> Admins { get; set; }

            public virtual ICollection<PlayerHistory> PlayerHistory { get; set; }
        }


        public class Settings
        {
            //[Key]
            public int Id { get; set; }
            public string Value { get; set; }
        }

        public class Ban
        {
            public Ban()
            {
                CreateDate = DateTime.UtcNow;
                IsActive = true;
            }

            [Key]
            public int Id { get; set; }

            public Guid? PlayerId { get; set; }
            public int Num { get; set; }
            public Guid ServerId { get; set; }
            public string GuidIp { get; set; }
            public int Minutes { get; set; }

            [ShowInUi]
            [EnableCopy]
            public int MinutesLeft { get; set; }

            [ShowInUi]
            [EnableCopy]
            public string Reason { get; set; }

            public DateTime CreateDate { get; set; }
            public bool IsActive { get; set; }

            [ForeignKey("PlayerId")]
            public virtual Player Player { get; set; }

            [ForeignKey("ServerId")]
            public virtual ServerInfo ServerInfo { get; set; }
        }

        public class Admin
        {
            [Key]
            public int Id { get; set; }

            public int Num { get; set; }
            public string IP { get; set; }
            public int Port { get; set; }
            public Guid ServerId { get; set; }

            [ForeignKey("ServerId")]
            public virtual ServerInfo ServerInfo { get; set; }
        }

        public class PlayerHistory
        {
            public PlayerHistory()
            {
                Date = DateTime.UtcNow;
            }

            [Key]
            public int Id { get; set; }

            [Required]
            public Guid PlayerId { get; set; }

            [ShowInUi]
            [EnableCopy]
            public string Name { get; set; }

            [ShowInUi]
            [EnableCopy]
            public string IP { get; set; }

            [ShowInUi]
            [EnableCopy]
            public DateTime Date { get; set; }

            public Guid ServerId { get; set; }

            [ForeignKey("PlayerId")]
            public virtual Player Player { get; set; }

            [ForeignKey("ServerId")]
            public virtual ServerInfo ServerInfo { get; set; }
        }
    }
}
```

`src/Arma3BE.Client.Libs/Migrations/201608261724176_Kick_Ban_Times_Reasons_Migration.Designer.cs`:

```cs
// <auto-generated />
namespace Arma3BEClient.Libs.Migrations
{
    using System.CodeDom.Compiler;
    using System.Data.Entity.Migrations;
    using System.Data.Entity.Migrations.Infrastructure;
    using System.Resources;
    
    [GeneratedCode("EntityFramework.Migrations", "6.1.3-40302")]
    public sealed partial class Kick_Ban_Times_Reasons_Migration : IMigrationMetadata
    {
        private readonly ResourceManager Resources = new ResourceManager(typeof(Kick_Ban_Times_Reasons_Migration));
        
        string IMigrationMetadata.Id
        {
            get { return "201608261724176_Kick_Ban_Times_Reasons_Migration"; }
        }
        
        string IMigrationMetadata.Source
        {
            get { return null; }
        }
        
        string IMigrationMetadata.Target
        {
            get { return Resources.GetString("Target"); }
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201608261724176_Kick_Ban_Times_Reasons_Migration.cs`:

```cs
using System.Data.Entity.Migrations;

namespace Arma3BEClient.Libs.Migrations
{
    // ReSharper disable once UnusedMember.Global
    // ReSharper disable once InconsistentNaming
    public partial class Kick_Ban_Times_Reasons_Migration : DbMigration
    {
        public override void Up()
        {
            CreateTable(
                "dbo.BanReasons",
                c => new
                {
                    Id = c.Int(false, true),
                    Text = c.String(false, 4000)
                })
                .PrimaryKey(t => t.Id);

            CreateTable(
                "dbo.BanTimes",
                c => new
                {
                    Id = c.Int(false, true),
                    Title = c.String(false, 4000),
                    TimeInMinutes = c.Int(false)
                })
                .PrimaryKey(t => t.Id);

            CreateTable(
                "dbo.KickReasons",
                c => new
                {
                    Id = c.Int(false, true),
                    Text = c.String(false, 4000)
                })
                .PrimaryKey(t => t.Id);
        }

        public override void Down()
        {
            DropTable("dbo.KickReasons");
            DropTable("dbo.BanTimes");
            DropTable("dbo.BanReasons");
        }
    }
}
```

`src/Arma3BE.Client.Libs/Migrations/201608261724176_Kick_Ban_Times_Reasons_Migration.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="Target" xml:space="preserve">
    <value>H4sIAAAAAAAEAO1d227cOBJ9X2D/QdDjItPdTrKLGaN7Bkk7mTHGsY20M9i3gG7RbWF06ZEoj43Fftk+7CftLywp6sKrRF1b7fghgU2KxSLrVLFYJMv/+89/lz89+p71AKPYDYOVfTJb2BYMtqHjBruVnaC77763f/rxr39ZfnD8R+u3/Ls35DvcMohX9j1C+9P5PN7eQx/EM9/dRmEc3qHZNvTnwAnnrxeLH+YnJ3OISdiYlmUtPycBcn2Y/oJ/XYfBFu5RArxPoQO9OCvHNZuUqnUJfBjvwRau7HeRD968/7D2XBig2YV7G89wcwQfkW2981yAOdpA7862QBCECCDM7+mXGG5QFAa7zR4XAO/maQ/xd3fAi2E2jtPyc9MhLV6TIc3LhjmpbRKj0G9I8ORNNkdzsXmrmbaLOcSz+AHPNnoio05nEk+i47uYrtjT6dqLyFfKWU5Fsw59LAY0Swm8suTPXhUgWcz+PvvH4vvXszdvf3i9eGWtEw8lEVwFMEER8F5Z18mt525/hU834e8wWAWJ57FcY75xHVeAi66jcA8j9PQZ3mVjOXdsa863m4sNi2ZMGzrQ8wC9eW1bl7hzcOvBAhTMpGxQGMGfYQAjgKBzDRCCUUBowHRapd6Fvi4Tv66zagLn13l7DGKsl7b1CTxewGCH7lf228UCq+JH9xE6eVFG9EvgYj3GrVCU1PZxHUaoG5cbGGEzUk7sz4nr1BO5BA/uLp1mNbngLrStz9BLP4nv3T3V7llZ/TWFYoznIAr9z6HHtc0qv96AaAfJAEPdF5swibYCf8t5qTiV6sQy216nSirPQbHM5C80/yWMUR9gb9htd/Rfgzj+M4ycAzBP/j9At++2yH0oOn4fYr0CQQeFz9W4u7LnqqxX9twcmPL2Hmg4wxVfWeUv2eJrJAMkVKusTxVD63uALsKdkqesTsOXXCvxpvikKX/XHniC0S8uNoXRk5JL7gsNr7pvJI61H3ay6u9BJxcJN38Odnx4B4lKT1w5Bnaq2rkrAhHS6Hw/vHf2yQ0SBONuI86IXMC7jmvdZwhisisZetTrCGI8neF/eV/k5xvXb75Yncd9L1cUtBWm7StdNERrlhZrDBita2prazxl4yVKXDY1K1grU5rPVntrSik8B4PaztJ8OT8bXuP6ciVr9Dr0fSy84Tu6ADEawzyTfjYQBs3NVHOP08C4iIqsMjymfFyG6bqjYITUfM31umSEKZasHFs3tEcpc6aqr/EkK3g1Nn1k0F0MH2n/zZo9tWvYkMhNGhse2gi081Pa+BcGmieaAJVWdljICzXsup5nhJ4Dvg+1TzpQtOjwIeteNgY9R61rdwUNlyf1Uq5Zw3raMHSKzFQz3Nd2ogh/tbc/GYkXy2NiecZZQXsJyfS8DNfoSuNYq6gfFeHYtjHLPDzTKXJJibxox6G0o4nAKcQ7iZuQeBG2kbBd5I3gQBGBnAct4r7GwPnV3f7e3VSUVF7gM3lbsYEI4R7jbpcUKI0XcZuI+zfgJb1bC52838VxuHVTviXvJT8457n9EDhW7Sk65Z0/h8eDwBJ191iGmJGVfWKLsroKzqAHEbTIwQu5ArcG8RY4suHDg3HMuSridSVX2V02nqG/Sf1g0MCISA1gLAcxhqEbIBlhbrB198CrmxahoSE4yXCLLsSaM7iHAcFV3eBN+i59aZmDoiNBEHUztJwzCKsGHhul1glXGbIuxZrvkHm5LmazE0m0apoKqKQn+oMARTGYESCiGK5Jr2Ug6SDgYOOXOkEqg5mlIGlQvU6SanIKXKix1qtRa4UqBdsjoEox90eAKmV8rdpO6IJtIjCKcLc54KoPm6aPvCr+RzNsavkcHRYZt8kMLqp4Ue+YVF2nG93V6wGb8jhGx6csryNw0YR7QTrQ6C4JNXSqtASPDHtq7kdAnFoOR4AzRYhcB42qeHkJj+LwxxxzVZeejwN3+hGMgD29XCaHPxoZIQ8CcQsY5W8L0lAVpKGq4rWgFAT7EsMsDhZncRcRUIT4BiLhyUIZjuFDEhIe+eYs3iQSbGUNHXoXTKKQ2uWaprn7KTXOK2raZ1f5VN3TLZpR/4Uvo2GjqK/jJrcMEp2ipn4qaTRbM6F5wLyeDAnga4jQ85oaEmVgXUWFDd7XoiwP+iowllcJNBjlUsG1eIXDfKd9qiPqvEnMsRgDrySS/TCJFDK0crZFE80P12AquEuY8iRoo1+18S+GWbUG1ka7GAqUvc6D5a6byYPVRnNq4zkMq6UdqRiuKohTO2GtpSve1NGJuSriYB5zkMahsXnmQYbhZ4ZVzbrZ0Xl/zXbBPcySwgU0sjYtZkt8eSHPUdUezGQXVqPsJvuuoQavuhkjT0Dd5sB0e8CaEvVSb7of6Dof+eFc4YIWdcs5TWaRFSznmqwXy09gvyfLctkyK7E2NAXG+rtN85wQPqUx33JrkugwFz1hZQE7KNQSQ+3Aj24UozOAwC0gJ5Vrx5c+UzrcGj8l75LzqWXZ5b5L/jn5mfXuVRlBMkdc3qVkRD7iMZJ1Jx0uFD0FuZ1FEpIAD0SKI+V16CV+oN9v6VunbxnZ5mmBeXty2Zbr/bpJa/r2nW1PS8wplBs8lop+20ewLwhA2hhK8pZ21Tx6jLBVaWVa4UtP0QBkVY2HQRpNr8C2pyVjoqXMlMBRKUob6E16lZ1THCDvrKoo5I9CWRp52WRQq9lGtMIriQk0B6qy1TAILQ9uOHRoj3Mq0NHRqja3ajpK+Stxlk5eZk6luAvIkikKG9Ohz8AVtGiFOb08DMGSUocmqqiwb71ZSmx5gxUxVml2WToZ3dZuGltpt5qagYLrGg6j4/QtM6cNacmYlr94g8yBLS80p5M/MWbJ5GXNqNAHxCIdWjoZvBZxmp4QmwaJm+NV3WzqKxK9+8tSoSXmFGT7qLOMB7VneVSmV7OmIWps3bTtpw6b7sau2wbRHHRHv0HMY0c9AVdDzgCy2pbDgLW7ZerPW568jWPOCPvblWUec6u9ma7tobFyOPnQw9f+pJOe2LaSjbrlQJKhT9M40dCiJjS4d2c8La5qMvJmT8p7EjlzvN5c6lWNv1GVLC4a9BZ2VdMzCrrqmg4jm+wFGEsgKxpZOtLBlPhJ0XtxQCUcRC2zQ6H6HO3SKRH9xLbw5Dy4Djkh2jzFCPoz8sFs84dHPYU1nL0lmeXzzz6BwL2DMaKPBO20jsvxPp186/M4drgnjLqk67zERnjl6JKIRu07xqZpZMr8myn91inNgwcQbe9BpHgWWdJsmsG8DUti9okkcP9IoJtO0J2rTF54HjjwcWX/K6Vwap3/Mz9Qdl5ZVxHG76m1sP7d14Nt7QXaETAkT0aHxN5GIm+ct7uNzMWs3f1xRrfofVPlk5jeunUjbpTq+HkYJjFJVis1zono1Ngol2Y3C3kocyRzwic57s1eC7kt2syRIqNxGzJ8PuPeBiinL3bwz6iP9MU9ar7yoeQxrChsRtzeZNbYbLfId9sbXT69ba9k2Wy2hqhtlhD1+PA2ysLSOJ9pb1JvYadaJg198TP6hcMgNmuADVovK+Hkd2nKk5ujRfkgpmY6ru2QRk9zMPMtQ6FxUsNnMnNsysDetEiZIbB++9MmP+AzEcOIAFafMhzt1HFp7Hqeu36y1h02T1323lt+AT5wUroxHv/rntBMLtGEec657nnm0rf1TXOgdEh2M1KGkWPIrWSSPc5YzAPZA5r7QEqGcOQA0VzWnRxCWmSCOxxUhHfM+twXRw6euku8E0eRQfaiqTgjh0XUuM5Jc1QdR9a1qWBpPD9nXNyY+jrHkzttKogp0i+osi89A+To7/RPMvOZnK9BFByfLSrbt5ZbdX4/S+/xrWznlsCMbvU1WZVEysbZzlR9lPXy1WNV9i1dOjQVbWWaJJFmbaI0FWVaV0+c7g4k0rRYRTj7q5xGPBsnV9OPgH7iGnRpkIFN1U1WaSTa/LaGSsB5nUbMRT61+l5ojjZVH7RG00OW9a2GPpu9TeqCrVT1wiWGq9U5g9xvan2bSGa4NrngOBvGpHORlrFD5n1rmuuNMWpFTobuA+olt1u7AbFGr3zU25eMBsre1i5Dn2CC6/OXTS81WzeNHG8aesy51m3Iw+jrAFnVug1TWPCrMrD1kzRNfoOCfeYkICf39LczGLu7ksQS0wzglvOWi2/I8HK3XeAo/0S8cgoRcLAr/S5C7h3YIly9hXGc/l2n9JRsZX/wb6FzHlwlaJ8gPGTo33octInzX9V/mhmO53l5tU//8mQfQ8BsuuSyw1XwPnE9p+D7o+KwWEOC7Cqy40UiS0SOGXdPBaXLMDAklE1fsRm6gf7ew8Tiq2ADyH3X5rx9ieEF3IHtU/6ISE+kXhD8tC/PXLCLgB9nNMr2+FeMYcd//PH/ar6j6FSTAAA=</value>
  </data>
  <data name="DefaultSchema" xml:space="preserve">
    <value>dbo</value>
  </data>
</root>
```

`src/Arma3BE.Client.Libs/Migrations/201609011936124_AddSteamPortToServerInfo.Designer.cs`:

```cs
// <auto-generated />
namespace Arma3BEClient.Libs.Migrations
{
    using System.CodeDom.Compiler;
    using System.Data.Entity.Migrations;
    using System.Data.Entity.Migrations.Infrastructure;
    using System.Resources;
    
    [GeneratedCode("EntityFramework.Migrations", "6.1.3-40302")]
    public sealed partial class AddSteamPortToServerInfo : IMigrationMetadata
    {
        private readonly ResourceManager Resources = new ResourceManager(typeof(AddSteamPortToServerInfo));
        
        string IMigrationMetadata.Id
        {
            get { return "201609011936124_AddSteamPortToServerInfo"; }
        }
        
        string IMigrationMetadata.Source
        {
            get { return null; }
        }
        
        string IMigrationMetadata.Target
        {
            get { return Resources.GetString("Target"); }
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201609011936124_AddSteamPortToServerInfo.cs`:

```cs
using System.Data.Entity.Migrations;

namespace Arma3BEClient.Libs.Migrations
{
    // ReSharper disable once UnusedMember.Global
    public partial class AddSteamPortToServerInfo : DbMigration
    {
        public override void Up()
        {
            AddColumn("dbo.ServerInfoes", "SteamPort", c => c.Int(false, defaultValue: 2303));
        }

        public override void Down()
        {
            DropColumn("dbo.ServerInfoes", "SteamPort");
        }
    }
}
```

`src/Arma3BE.Client.Libs/Migrations/201609011936124_AddSteamPortToServerInfo.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="Target" xml:space="preserve">
    <value>H4sIAAAAAAAEAO1d3W7bOBa+X2DfQfDlomM7zeyiG9gzaJ12Jpg0Cep0sHcFYzGOMPrxSFQ3wWKfbC7mkfYVlhT1w1+JkijZTnPRIiHFw0Oej4fkIfnlf3/8ufjxMfCdrzBOvChcTk6m84kDw03keuF2OUnR/XdvJj/+8Ne/LN67waPza/HdKfkOlwyT5eQBod3ZbJZsHmAAkmngbeIoie7RdBMFM+BGs9fz+T9nJycziEVMsCzHWXxKQ+QFMPsF/7qKwg3coRT4HyMX+kmejnPWmVTnCgQw2YENXE7exgE4ffd+5XswRNNL7y6Z4uIIPqKJ89b3ANZoDf37iQPCMEIAYX3PPidwjeIo3K53OAH4t087iL+7B34C83acVZ+bNmn+mjRpVhUsRG3SBEVBS4Enp3kfzcTinXp6UvYh7sX3uLfRE2l11pO4E93Aw3LFms5Wfky+UvZyZppVFGAzoGkm4JUjf/aqBMl8+vfpP+Zv3kxP37w5nb9yVqmP0hguQ5iiGPivnJv0zvc2v8Cn2+g3GC7D1PdZrbHeOI9LwEk3cbSDMXr6BO/ztly4E2fGl5uJBctiTBna0IsQnb6eOFe4cnDnwxIUTKesURTDn2AIY4CgewMQgnFIZMCsW6Xahbqu0qCpsnoBFzdFeQxiPC4nzkfweAnDLXpYTr6fz/FQ/OA9QrdIyoV+Dj08jnEpFKeNddxEMeqn5RrG2I1UHftT6rnNQq7AV2+bdbNaXHgfTZxP0M8+SR68HR3d0yr7SwbFBPdBHAWfIp8rm2d+uQXxFpIGRrov1lEabwT9FrNq4NQOJ1bZ7mOqkvIcBpaZ/YXiP0cJsgH2ltVaQD+CIOgv5gYkyb+j2N1DH5D/91Dt2w3yvpYVv4vw8ARhD79ReIP+PqPwCHqfUXgVU93eAY1mOOML60MqtfgcyY8J2SonVqfQ6gGgy2ir1CnP0+gl50q6KT5pq9+ND55g/LOHPWr8pNSS+0Kjq+4bSWPth70mh3eg10oLF38O08Hw6yxqPXECGnht1m3VIwghhS52wy/yPnphimDSr8W5kEt433Ou+wRBQjY3Q7d6FUOMp3P8r6iL/HzrBe0nq4vE9nRFQVvj2r7QSUP0ZlmyxoHRvLa+tmHBbTxFidOmZgbr5EqL3uruTamE5+BQu3mazxfnw484W0vJhnEdBQE23vAVXYIEjeGeST1rCMP2bqr9itPAuYgDWeV4TPW4irJ5R6EIyflSjOtKESZZ8nJs3tArSlkzVX7DSrJGV2PXRxrdx/GR8t+s21MvDVsKuc1CzEM7gW7rlC7rC4ORJ7oA1ajsMZGXw7DvfJ4Leg743tc+aU/Rov1Hvq1sDCwHvxt3BS2nJ/VUrpnDLG0YekVm6hW2tZ0ow1/d/U8u4sXzmHiecWZQKyEZy9Nww1hpHWsVx0dNOLZrzLIIz/SKXFIhL6NjX6OjjcEpxHuZm4h4MbaRsT3kj7CAIga5CDvEfY2B84u3+a2/q6ikvMDn4H3FGiKEa0z63XWgMl7MbWLuX4GfWvcWOnu/TZJo42V6S6uX4uCc1/Z96DqNp+hUd/4cHjcCW9TbYRtiRZaTk4loq+vwHPoQQYccvJCbdCuQbIArOz7cGNdcqzJeV2mVX4njFfqbVA8GDYyJ1QDGcphgGHohkhHmhRtvB/ymbhEKGoKTNLesQsw5hzsYElw1Nd6k7motLWtQViQYoqmHFjMGYfXAY6PUOuMqQ9aVWYsdMm/X+XR6IplWLVMBlexEfxCgKBozAkQUzTWptQok7QUcbPxSZ0hlMLMyJA2qN1lSLU6BCzXWrDq1TqhSqD0CqhR9fwSoUsbX6v2ELtgmAqMMd5sDrv6w6fCRV6f/aI5NbZ+jwyKzbDKDiypeZB2Tqut0oy/1LGBTbsfo+JTtdQRLNOFekA40uktCLRdVWoFHhj219iMgTm2HI8CZIkSug0ZdvLyCR3n4Y465ukvPx4E7fQtGwJ7eLgeHPxoZIe8KcQkYF28LslAVpKGq8tGhFAT7nMA8DpbkcRcRUET4GiLhyUIVjuFDEhIe+eIs3iQRbGaDHHoXTJKQ+eWGosXyUypcZDSUz6/yqaqnWzSj+su1jEaNMr9Jm8IzSHLKnOaupNFsTYcWAfNmMSSArxFCz2saRFSBdZUUNnjfiLIi6KvAWJElyGAGlwqu5Ssc5jvtUx1xzJvEHMs28INE8h8mkUJGVqG26KL55hp0BXcJU+4EbfSrMf7FKKsegY3RLkYCVa93Y7nrZnJjtdGcxngOo2rlR2qaqwriNHZYZ+uKN3V0Zq6LOJjHHKR2aHyeeZBh+J5hh2ZT7+hWf+12wRZ6SbEENPI2HXpLfHkh91HdHsxkF9Yw2E32XUM1XnUzRu6Aps2B6faAdSXqqd50P9C3P4rDuXIJWuYtZpQTI09YzDTkGYuPYLcj03JVMk9x1pRJY/Xduj21REBlzDbcnCQumMua8GABWyjkEkftwg9enKBzgMAdICeVKzeQPlMuuDXrlKJKbk0t265YuxSfk5/Z1b2KWCRfiMu7lFzIB9xGMu9kzYXiSkEu5xBeE+CDWHGkvIr8NAj1+y196ewtI1s8SzAvTy7bcrXftClN376z5WmKuYRqg8dK0W/7CPYFA0gbQ8ne0q6aR48Rtmq9TCd86SUagKyu8DBIoywNbHmaMipaKsIFDi5VcgttStYFTqMytcUYzK7Fc4MQyLu0OgnFA1NWRpF2MCNAsyXphH0SX2gPemWpYdBeHQJx6NAeDdWgo6eHbu8hdZKKF+esnCLNXEp5r5AVUya2lkOflCtk0QxzeUVIgxWlDnPUSWHfjbOS2PQWs2uiGtlV6sGMbe0GtNPoVkszGOC6gsOMcfoumhsNWcqYnr98z8yBrUg0l1M8V2bFFGntpNDHyKIcmnoweC1jPpYQmwWc2+NVXezQZyR6j5iVQlPMJcj+UecZ9+rPigiPVbemEWrs3bTlDx02/Z1dv82mOeiOfrNZxKEsAVcjzgCy2pLDgLW/Z7K3Wj54H8ecN9rbleUr5k57M13ZfWNlf/ahB7n2rJOd/nayjbrkQJahz9w409CkNjK4N2y8LC7rYOzNnrpbMjlzVN/e6nWFv9EhWV5asBbCVcszCuDqig5jm/w1GSsgTxrZOtIhl/hJWXt52CUcai3yA6Zm2njpxIl+MnFw53z1XHLatH5KEAym5IPp+nefrhRWcPo9IbsvPvsIQu8eJog+OJxkeRzt/OFQwM+SxOWeQ+p44HmLjfBi0iMRjcY3kW0paSouz0x+Z5b18CuINw8gVjyxrGS2JVXvopLIZJGG3u8p9LIOuveURIgXoQsfl5P/ZBLOnIt/FYfT7ivnOsb4PXPmzn9tPf7WXsYdAUNyZ/TgGjcyeWsq8U42F4nEuwgRacTtNY/u821L5VlV77ymFrfiXn4e3k1k7erkCwohOl9gRO7Zz83uy6fJmvCsy9acvkC20aWPFBTLXcTwBMvWGijzKbv4Z2SDT9niyFe+3DyGaYml6LVms9ZuuwMBrzW5PN+uVbEsva4hatsxtB4f3kaZWFoTrFqzegc/1ZHF9GWdYRcOg/isAXZ5VmbCg9/qKY9/jhblg7iaw1naDun0NKc73zIUWrMsPpOeYzkMrY0iJWVh8/anC2HhMzHDiABWH1UcbddxvHqW+84Ojd5+ifPyB+jyk/SBWfLGYCPQvek5OOYLcxK8/sR32WP/tqQsPdh3RqI8OQayJxM6O2MzD+QPKBmDxM5w5ADR3Pg9OIR0oKbbH1SEh9V6Mo4jB0/TTeADR5EBndKhLEb2i6hxFyftUXUcNHCHgqXx1jnj4sZ0rXM8ZG6HgpiSD0JFB/UMkKN/GLBn9AhXBMuzR5FAQjQcT1+V71urrTq/n6WXAZcT947AjG71NTRPomRj+jVVHVW+fH9ZRQem42dTyVbyNokyG5nbVJJpXrNwujuQRNNkleD8z4Qa6WzM9qZvAf3EM6jSgBJOVU2eaWTa4raGysBFnsbMJcFbcy2UNE5VB83R1JDT0DXIZ+nkpCrYTFUtHFNd45gzIKNTj7cDoarrQk7H+TCGX0aaxvZJRNeWfI5xaiWxQ/8GWSGb69Yg1ulVL4Nt2WggOrlulIGCC24mVDs8rrh+I3K8brBIAtevycOM1wFo3vo1U5jw6yjh7LC4yQ9Z8Jo5DcnJPf3tHCbethKxwDJDuOFWy+U3pHnFsl3QqPhEvHIKEXDxUvptjLx7sEE4ewOTJPtDU9kp2XLyPriD7kV4naJdinCTYXDnc9Ami/+6+jOqOl7nxfUu+1OYNpqA1fTIZYfr8F3q+W6p9wfFYbFGBNlV5MeLxJaIHDNun0pJV1FoKCjvvnIzdAuDnY+FJdfhGpD7ru11+5zAS7gFm6fiJZJeSLMh+G5fnHtgG4MgyWVU5fGvGMNu8PjD/wH5wxjDLJQAAA==</value>
  </data>
  <data name="DefaultSchema" xml:space="preserve">
    <value>dbo</value>
  </data>
</root>
```

`src/Arma3BE.Client.Libs/Migrations/201609111835579_Added_SteamId.Designer.cs`:

```cs
// <auto-generated />
namespace Arma3BEClient.Libs.Migrations
{
    using System.CodeDom.Compiler;
    using System.Data.Entity.Migrations;
    using System.Data.Entity.Migrations.Infrastructure;
    using System.Resources;
    
    [GeneratedCode("EntityFramework.Migrations", "6.1.3-40302")]
    public sealed partial class Added_SteamId : IMigrationMetadata
    {
        private readonly ResourceManager Resources = new ResourceManager(typeof(Added_SteamId));
        
        string IMigrationMetadata.Id
        {
            get { return "201609111835579_Added_SteamId"; }
        }
        
        string IMigrationMetadata.Source
        {
            get { return null; }
        }
        
        string IMigrationMetadata.Target
        {
            get { return Resources.GetString("Target"); }
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201609111835579_Added_SteamId.cs`:

```cs
using System.Data.Entity.Migrations;

namespace Arma3BEClient.Libs.Migrations
{
    // ReSharper disable once UnusedMember.Global
    // ReSharper disable once InconsistentNaming
    public partial class Added_SteamId : DbMigration
    {
        public override void Up()
        {
            AddColumn("dbo.Players", "SteamId", c => c.String(maxLength: 4000));
        }

        public override void Down()
        {
            DropColumn("dbo.Players", "SteamId");
        }
    }
}
```

`src/Arma3BE.Client.Libs/Migrations/201609111835579_Added_SteamId.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="Target" xml:space="preserve">
    <value>H4sIAAAAAAAEAO1dW2/cNhZ+X2D/gzCPi3RmnLTd1phpkYyTdlDHNjJOsW8BPaJtobpMJcprY7G/bB/2J+1fWFLUhVeJkijNjOOHBDYpHl7Ox8PDQ/Lz//7z38XPj4HvPMA48aJwOTmZzicODLeR64V3y0mKbr/5YfLzT3/9y+K9Gzw6vxffvSHf4ZJhspzcI7Q7nc2S7T0MQDINvG0cJdEtmm6jYAbcaPZ6Pv9xdnIyg1jEBMtynMWnNEReALNf8K+rKNzCHUqB/zFyoZ/k6Thnk0l1LkAAkx3YwuXkbRyAN+/er3wPhmh67t0kU1wcwUc0cd76HsAt2kD/duKAMIwQQLi9p58TuEFxFN5tdjgB+NdPO4i/uwV+AvN+nFafm3Zp/pp0aVYVLERt0wRFQUuBJ2/yMZqJxTuN9KQcQzyK7/FooyfS62wk8SC6gYflijWdrvyYfKUc5Uw1qyjAakDTTMArR/7sVQmS+fS76ffzH3+Yvvn7/PvvXjmr1EdpDJchTFEM/FfOVXrje9vf4NN19AcMl2Hq+2yrcbtxHpeAk67iaAdj9PQJ3uZ9WbsTZ8aXm4kFy2JMGdrRdYjevJ44F7hycOPDEhTMoGxQFMNfYAhjgKB7BRCCcUhkwGxYpdqFui7SoKmyegHrq6I8BjGelxPnI3g8h+Edul9Ovp3P8VT84D1Ct0jKhX4OPTyPcSkUp411XEUx6tfKDYyxGakG9pfUc5uFXIAH7y4bZrW48DaaOJ+gn32S3Hs7OrunVfaXDIoJHoM4Cj5FPlc2z/xyDeI7SDoY6b7YRGm8Fdq3mFUTp3Y6sY3tPqcqKc9hYpnpXyj+a5QgG2BvWa0F9CMIgv5irkCS/DOK3T2MAfl/D9W+3SLvoaz4XYSnJwh72I3CGvS3GYVF0NuMwqqYtu0d0LQMZ3xhbUjVLD5HsmNCtsqI1TVodQ/QeXSnbFOep2mXnCu1TfFJ2/Zd+eAJxr962KLGT8pWcl9o2qr7Rmqx9sNei8M70MvTwsWfw3IwvJ9FtScuQAP7Zt28HkEIKbTeDe/kffTCFMGkX49zIefwtuda9wmChGxuhu71KoYYT2f4X1EX+fnaC9ovVuvE9nJFQVtj2r7QRUO0ZlmyxoDRvLa2tsHhNl6ixGVTs4J1MqXFaHW3plTCczCo3SzN5/XZ8DMuc4bXVpzYcXzWBgMSBQFGyfAVnYMEjbEOkHo2EIbt7WF719bAiokWQ2XhTNtxEWULnKIhJOdLYUCqhjDJkjll84Z2XeWWqfIbXNaathrbWNLpPhaWlP9q7avaB20p5DqLZQ9tBLo5RF0cGYOZJ5oA1azs4TGU07Cv45ALeg743teGbE9hqf2H2K3sQCxH2Ru3Hy2XJ/VSrlnDLO1MeoWA6htsa99Sxtm6259cxIvlMbE846ygVmI/lpfhhrnSOqgrzo+auG/X4GgRB+oVIqVCXmbHvmZHG4VTiPdSNxHxomwjZXvIH8GBIgpZhx0CzMbA+c3b/tHfVFRSXuBz8LZiAxHCNSb9LlVQGS/qNlH378BPrVsLnb7fJkm09bJ2S95LcULPt/Z96DqNx/W07fyBP+4E1qi3wzrEDVlOTiairi7DM+hDBB1ywkOu7K1AsgWubPhwZ1zzVpXxuqpV+d07vkF/k+rBoIEx0RrAWA4TDEMvRDLCvHDr7YDfNCxCQUNwku6WVYg5Z3AHQ4Krps6b1F350nILyooERTSN0GLGIKweeGyUWqdcZci6UmuxQ+b1Op9OTyTVqmUqoJJdHRgEKIrOjAARRXdNaq0CSXsBBxu/1ClSGcysFEmD6k2aVItT4EKNNatGrROqFM0eAVWKsT8CVCnja/V2QhdsE4FRhrvNAVd/2HT4yKtr/2iGTa2fo8Mi4zaZwUUVL7KOSdW9vdFdPQvYlPsxOj5lfR2BiyZcQNKBRncbqaVTpRV4ZNhTt34ExKn1cAQ4U4TIddCoi5dX8CgPf8wxV3e7+jhwp+/BCNjT6+Xg8EcjI+QBIy4B4+IRQxaqgjRUVb5ulIJgnxOYx8GSPO4iAooI30AkvI2owjF8SELCI1+cxZskgs1skEPvgkkSMrvcULRwP6XCRUZD+fwqn6p6ukUzqr/0ZTTNKPObWlNYBklOmdM8lDSarRnQImDeLIYE8DVC6HlNg4gqsK6SwgbvG1FWBH0VGCuyBBnM5FLBtXzuw3ynfRMkznmTmGPZB36SSPbDJFLIyCqaLZpovrsGQ8FdwpQHQRv9aox/MY1Vz8DGaBcjgTavd2e562ZyZ7XRnMZ4DtPUyo7UdFcVxGkcsM7aFW/q6NRcF3EwjzlI/dDYPPMgw/Ajw07NptHReX/tdsEWRknhAhpZmw6jJT7xkMeobg9msgtrmOwm+66hOq+6GSMPQNPmwHR7wJoS9VJvuh/oOx7F4VzpgpZ5ixkl38gTFjMNS8fiI9jtyLJclcxTnA2l7Fh9s2nPYRFQGbMttyaJDnNZE54s4A4KucRQu/CDFyfoDCBwA8hJ5coNpM+UDrfGTymq5HxqWXeF71J8Tn5mvXsVg0nuiMu7lFzIB9xHsu5k3YWipyCXcwiBCvBBrDhSXkV+GoT6/Za+dPZoki2eJZiXJ5dtudqv2pSmj+zZ8jTFXEK1wWOl6Ld9BPuCAqSNoaRvaVfNo8cIW7VWphO+9BINQFZXeBikUToItjxNGRUtFbMDB5cquUVrSnoHrkVlaos5mF2L5yYhkHdpdRKKl6ysjCLtYGaAZkvSCfskvtAe9MpSw6C9OgTi0KE9GqpBR08L3d5C6iQVT9tZOUWauZTyXiErpkxsLYe+XVfIohnm8oqQBitKHeaok8I+UGclsektVtdENbOr1IOZ29oNaKfZrZZmMMF1BYeZ4/QBNjcbspSW65E0NYvEMVeQ8l00B9oi0VxO8eyZFVOktZNCHzWLcmjqweC+jB1ZQn4WuG6Pe3WxQ1/Z6H1kVgpNMZcg21mdhd2rXSwiRVbNo0aosZXUlj902PQ3dv02reagO/pNaxHPsgRcjTgDyGpLDgPW/pbJntd98DaOObe0t7vLPe9Oezxd2X1jZX/6oQfC9rSTnSJ30o265ECaoc/lONXQpDYyuLdwvCwu62D0zZ7eW1I5c+TfXut1hb/SKVlefrAWClbLMwoE64oOo5v8VRorIE8aWTvSYZn4SVl7eWgmHI4t8oOqZp576eSKfjJx8OA8eC45tdo8JQgGU/LBdPOnTz2FFZx+S9j5i88+gtC7hQmiDxcnWR7Hk384nPWzJHG5Z5U64npeYyO8vPRIRKPxbWVbapuKfDST35kWPnwA8fYexIqnmpXMtizwXZokMmKkofdnCr1sgG49JXPjOnTh43Lyr0zCqbP+R3HI7b5yLmOM31Nn7vzb1iNy7aXeETAkD0YPcnQjlbfmPu+kc5H5vIsQkffcXvfoPt+2VJ4G9sZr6nErsujnYd1E9q9OtqAQorMFRiSh/czsvmya3BKeJtqa0RdIO7qMkYITuosYnhHaWgdlAmgX/4xsEEBbnPnKF6DHsCyxnMLWdCZQCFuT23o56EAQbE0uzwdsVSxL/2s4G9oxyB4fjkdZsFoTwFrTegf715Fl9cV/sQuHQWzWALtHKyvswW8hlcdKR4vyQUzN4bjMQxo9zanR1wyF1iyQz2TkWI5Fa7NISanYvK3qQqj4TNQwIoDVRyBHO3Qc75/lsbND87dfYr/8gbz8ZH5gFr8x2BJ0b44OjpnDnKSvPzFfRkbQljSmBzvQSJQsx0BGZUK3Z6zmgewBJYuQ2COOHCCam8QHh5AO1Hn7g4rw8FtPFnLk4Gm6YXzgKDKgezoUZ2S/iBrXOWmPquOgqTsULI3n54yLG1Nf53jI5g4FMSVfhYqu6hkgR//gYM/oEa4elmePIsGFqDieXivft1ZbdX4/Sy8ZLifuDYEZ3epraKhEycb0cKo6qnz5XrSKrkzHH6eSreSVEmU2MsupJNO8ZuF0dyCJpskqwfmfMTVqszEbnb4H9BPPoEoDyjpVNXmmkWqLWyAqBRd5GjWXBHTNtVBSO1UdNEdTQ06T1yCfpbuTqmAzVbVwTHqNc86ALE893w6ESq8LeR5nwxj+G2kZ2ydRXltyPMaolcQT/TtkhQyvW4dYo1e9OLalo4Ho7rpRGgomuJnw7fC47PrNyPGGwSJJXb8uDzNfB6Ch69dNYcGvo6yzwzInP5DBPnMakpN7+tsZTLy7SsQCywzhlvOWy29I9wq3XWhR8Yl4lRUi4GJX+m2MvFuwRTh7C5Mk+0NY2SnZcvI+uIHuOrxM0S5FuMswuPE5aBPnv67+jEqPb/Picpf9qU4bXcDN9Mhlh8vwXer5btnuD4rDYo0IsqvIjxeJLhE5Zrx7KiVdRKGhoHz4ys3QNQx2PhaWXIYbQO7Rtm/b5wSewzuwfSpeOOmFNCuCH/bFmQfuYhAkuYyqPP4VY9gNHn/6PxNuZSU1lQAA</value>
  </data>
  <data name="DefaultSchema" xml:space="preserve">
    <value>dbo</value>
  </data>
</root>
```

`src/Arma3BE.Client.Libs/Migrations/201612040948573_Added_custom_settings.Designer.cs`:

```cs
// <auto-generated />
namespace Arma3BEClient.Libs.Migrations
{
    using System.CodeDom.Compiler;
    using System.Data.Entity.Migrations;
    using System.Data.Entity.Migrations.Infrastructure;
    using System.Resources;
    
    [GeneratedCode("EntityFramework.Migrations", "6.1.3-40302")]
    public sealed partial class Added_custom_settings : IMigrationMetadata
    {
        private readonly ResourceManager Resources = new ResourceManager(typeof(Added_custom_settings));
        
        string IMigrationMetadata.Id
        {
            get { return "201612040948573_Added_custom_settings"; }
        }
        
        string IMigrationMetadata.Source
        {
            get { return null; }
        }
        
        string IMigrationMetadata.Target
        {
            get { return Resources.GetString("Target"); }
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201612040948573_Added_custom_settings.cs`:

```cs
namespace Arma3BEClient.Libs.Migrations
{
    using System.Data.Entity.Migrations;

    // ReSharper disable once UnusedMember.Global
    // ReSharper disable once InconsistentNaming
    public partial class Added_custom_settings : DbMigration
    {
        public override void Up()
        {
            CreateTable(
                "dbo.CustomSettings",
                c => new
                {
                    Id = c.String(nullable: false, maxLength: 400),
                    Value = c.String(),
                })
                .PrimaryKey(t => t.Id);

        }

        public override void Down()
        {
            DropTable("dbo.CustomSettings");
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201612040948573_Added_custom_settings.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="Target" xml:space="preserve">
    <value>H4sIAAAAAAAEAO1d3W7cNha+X2DfQdDlIp2xk263NWZaJOOkHdSxjYxT7F1Aj2hbqH6mEpXaWOyT7cU+0r7CkqJ++CtREqWZcXLRIibFw0Oej4fkIfnN//7z38VPj2HgfIZJ6sfR0j2dnbgOjLax50f3SzdDd9987/7041//snjrhY/Ob+V3r8h3uGSULt0HhHZn83m6fYAhSGehv03iNL5Ds20czoEXz1+enPwwPz2dQyzCxbIcZ/Ehi5AfwvwP/OcqjrZwhzIQvI89GKRFOs7Z5FKdSxDCdAe2cOm+TkLw6s3bVeDDCM0u/Nt0hosj+Ihc53XgA6zRBgZ3rgOiKEYAYX3PPqZwg5I4ut/scAIIbp52EH93B4IUFu04qz83bdLJS9KkeV2wFLXNUhSHHQWevir6aC4W79XTbtWHuBff4t5GT6TVeU/iTvRCH8sVazpbBQn5StnLuWlWcYjNgGa5gBeO/NmLCiQns3/Mvjv9/uXs9Idvv/v7C2eVBShL4DKCGUpA8MK5zm4Df/srfLqJf4fRMsqCgNUa643zuAScdJ3EO5igpw/wrmjL2nOdOV9uLhasijFlaEPXEXr10nUuceXgNoAVKJhO2aA4gT/DCCYAQe8aIASTiMiAebdKtQt1XWZhW2XNAtbXZXkMYjwuXec9eLyA0T16WLrfnpzgofjOf4RemVQI/Rj5eBzjUijJWuu4jhM0TMsNTLAbqTv258z32oVcgs/+fd7NanHRXew6H2CQf5I++Ds6umd19qcciinugyQOP8QBV7bI/HQDkntIGhjrvtjEWbIV9FvM64HTOJxYZfuPqVrKcxhYZvYXiv8Sp8gG2DtWawH9CIJwuJhrkKZ/xom3hz4g/99Dta+3yP9cVfwmxsMTRAP8RukNhvuM0iPofUbpVUx1ewM0muGMT6wPqdXicyQ/JmSrnFiTQqsHgC7ie6VORZ5GLzlX0k3xSVf9rgPwBJNffOxRkyelltwXGl1130gaaz8cNDm8AYNWWrj4c5gOxl9nUeuJE9DIa7N+qx5BCCm03o2/yHvvRxmC6bAWF0Iu4N3Aue4DBCnZ3Izd6lUCMZ7O8X9lXeTfN37YfbJap7anKwraBtf2iU4aojfLkzUOjOZ19bUtC27jKUqcNjUzWC9XWvZWf29KJTwHh9rP03xcn48/4vLF8NrKInaaNWuLA4nDEKNk/IouQIqmmAdIPRsIo+7+sPvS1sCLiR5D5eFM9biM8wlOoQjJ+VQ6kFoRJllyp2ze2EtXWTNVfsuStUFXYx9LGj3Ew5LyX6x/Va9BOwq5yWPZYzuBfguiPgsZg5EnugDVqBywYqiG4dCFQyHoOeB7XxuyPYWl9h9it7IDsRxlb91+dJye1FO5Zg6ztDMZFAJqVtjWvqWKs/X3P4WIr57HxPNMM4Naif1YnoZbxkrnoK44Phrivn2Do2UcaFCIlAr5Ojr2NTq6GJxCfJC5iYivxjYyto+CCRZQxCDrqEeA2XwOzfGygQjhJqSDplJO0nOA0YTntb+BILOOJ2MQ/Opvfx8+X9RSnoPxn/mEYWPEP6exPr65Jx3ir9M03vq53tIStrymwWv7NvKc1jsbVHf+1gduBLaov8M2xIos3VNXtNVVdA4DiKBDjvnIvc0VSLfAk50iboxnrlUVtK21Ki5g8gr9TaoHgwYmxGoAYzlKMQz9CMkI86OtvwNBW7cIBQ3BSZpbVSHmnMMdjAiu2hpvUne9oZI1qCoSDNHWQ4s5g7Bm4LFHFTrjKs8tarOWYRLeriez2alkWrVMBVTy+yOjAEXRmAkgomiuSa11NHEv4GCD2DpDKiPatSHpyUqbJdXiFLhQY82qU+uFKoXaE6BK0fdHgCplkLXZT+giriIwqjMPc8A1nzgePvKa9J/Msantc3RYZJZNZnBRBQ2tY1J1eXPypZ4FbMrtmByfsr2OYIkm3ELTgUZ3Ja3jokor8Miwp9Z+AsSp7XAEOFOck+ig0XRoUsOjOgE0x1zTFfvjwJ2+BRNgT2+Xg8MfjYyQV6y4BEzKlyx5qArSUFX1xFUKgn1MYREHS4u4iwgoInwDkfBApg7H8CEJCY98cRZvkgg2s0UOvRAoScj9ckvRcvkpFS4zWsoX9zlV1dMtmlH91VpGo0aV36ZN6RkkOVVOe1fSaLamQ8uAebsYcoqjEUIP7draIpzRyE0SPmiRVwfqVcLYw4BW1GpV0irDDFYV/Ks3ZMx32odmog8xiWFWbeAHneSPTCKPjKxSbdHl88016AruZq/cCdpoWms8jVFWPaJbo2eMBKre4MZydxjlxmqjQ63xIUbV2i81NFcVFGrtsN7WFa9/6czcFMEwj2FI7dD4UPOgxfg9ww7Ntt7RrSa77aot9JJiSWnkbXr0lvhuSO6jpj2dya6uZbCb7OPGarzqupXcAW2bDdPtButK1EsH0/3F0P4oD/uqJW2Vt5hTRpciYTHXUL8s3oPdjkzLdckixdlQHpjVN5vuxCghlTHfcnOSuACvasKDBdxDIZc4ag++85MUnQMEbgE5+Vx5ofSZcgGvWaeUVXJrdNl25dql/Jz8m90tqGhxioW9vOsphLzDbSTzTt5cKK4U5HIOYeUBAUgUR9SrOMjCSL9/05fOX+KyxfME8/LkBjdX+3WX0pS5gS1PU8wl1BtGVop+G0mwLxhA2mhK9pZ26Tx6jLDV6GV64Usv0QBkTYXHQRrlGGHL05RJ0VLThXBwqZM7aFNxhnAaVakdxmD+1oIbhEDe9TVJKJ9HszLKtIMZAZotSS/sk3hFd9ArS42D9vpQiUOH9qipAR0DPXR3D6mTVPIlsHLKNHMp1WVVVkyV2FkOJURQyKIZ5vLKkAYrSh3maJLCsh6wktj0DrNrqhrZderBjG3tBrTX6FZLMxjguoLjjHH6qp8bDXlKx/lIGppl4pQzSPXYngNtmWgup3xLz4op07pJoS/lRTk09WBwX8WOLCE/D4R3x7262KHPbPR+MyuFpphLkP2szsPu1S+WkSKr7lEj1NhLassfOmyGO7thm1Zz0B39prWMZ1kCrkacAWS1JccB63DPZG/VffA+jjkHtbe7K1bevfZ4urL7xsr+7EMPmO1ZJz+V7mUbdcmRLEPfYHKmoUldZHAPLHlZXNbB2Fs47LfluxulmrjwFgHjYKB4VMUKKJIOxl7sbQtLxmKuaHQ3VFPhL9SF2h5MA4bRFzuApMNN8ZOq9iKl+rs63CwOFtt/7EI6aaSfuA7unM++R04ZN08pguGMfDDb/BHQld0Kzr4lP9FRfvYeRP4dTBF9uOrmedyPZRzOD1fM09TjntXqfr2Ct9gEL299EoFqfVvbld+qZiDO5ff+bYjoM0i2DyBRPNWtZXb9KYg+Kom0OFnk/5FBP++gO19J37qOPPi4dP+VSzhz1v8sLyV4L5yrBOP3zDlx/m2LSUJ7qXsCDMmdMeAXEoxM3vkHEHrZXPz5gz5CxB8/sNc8GpexLZXngr7121rciTH+eXg3kQKwly8oheh8gRFT8DA3uy+fJmvCc8Vbc/oCc0+fPlIQw/cRw9PCW2ugzALv4X8jGyzwFke+8gXwMUxLLLG4NZsJPOLW5HaeDnqwhFuTy5OCWxXLcoAbjoZuNNLHh+NJJqzOLNDWrN7D//WkWv66frELh1F81gi7Rysz7MFvIZXHgEeL8lFczeEsmcd0eppTvi8ZCp2pYJ9Jz7FEq9ZGkZJXtX1b1ZdVdXJT2IvGcKyFY0NXdzR1vOidcNzvD22jdN2YwLPDjrlfPsyCV0JmmhiZ/HIKkhHd07qDI7Qx57YczmeZc3iInB4jElhOxGR0DBxuJiyVxmYeyR9QjhWJdOXIAaK5MH9wCOnBOLk/qAj8BnqOnSMHT9tF+gNHkQFL2qEsRvaLqGkXJ91RdRzsjoeCpenWOdPixnStczwcjYeCmIqWhVHCmBnyCJCjf1ezZ/QINzarI1uRx0U0HM8iV+xb6606v5+ldzOXrndLYEa3+hq2NVGyMauiqo46X77+r2L509EuqmQr6dNEma2EjCrJNK9dON0dSKJpskpw8RPQRjobkzjqW0A/8Q2qNGB6VFVTZBqZtrw8ozJwmacxc8Wz2F4L5YJU1UFzNDUU7JJtvdSVQ1LZZ315JltoJlV1cSSVrePcgIdSPcYPhKWyDy8l5zcZailp6twnB2VX3knGkVacLsMbZIVnsl+DWEdbP+a3ZaORmCT7sYUKbr+dS/HwaCKHjcjpusEi/+OwJo8zXkdgeBzWTGGR0cQGaYfAUX7LhNfpWUQuWdC/zmHq39ciFlhmBLfcCr36hjSv3CoIGpWfiLeOIQIeXr6/TpB/B7YIZ29hmua/WZefzC3dt+Et9NbRVYZ2GcJNhuFtwEGbbDia6s9ZKnmdF1e7/KeVbTQBq+mTeylX0ZvMD7xK73eKc32NCLKTKY40iS0ROdq8f6okXcaRoaCi+6oN2A0MdwEWll5FG0CuPHfX7WMKL+A92D6Vj9H0QtoNwXf74twH9wkI00JGXR7/iTHshY8//h/+uvzA5ZoAAA==</value>
  </data>
  <data name="DefaultSchema" xml:space="preserve">
    <value>dbo</value>
  </data>
</root>
```

`src/Arma3BE.Client.Libs/Migrations/201706202056450_BadNicknames_ImportantWords.Designer.cs`:

```cs
// <auto-generated />
namespace Arma3BEClient.Libs.Migrations
{
    using System.CodeDom.Compiler;
    using System.Data.Entity.Migrations;
    using System.Data.Entity.Migrations.Infrastructure;
    using System.Resources;
    
    [GeneratedCode("EntityFramework.Migrations", "6.1.3-40302")]
    public sealed partial class BadNicknames_ImportantWords : IMigrationMetadata
    {
        private readonly ResourceManager Resources = new ResourceManager(typeof(BadNicknames_ImportantWords));
        
        string IMigrationMetadata.Id
        {
            get { return "201706202056450_BadNicknames_ImportantWords"; }
        }
        
        string IMigrationMetadata.Source
        {
            get { return null; }
        }
        
        string IMigrationMetadata.Target
        {
            get { return Resources.GetString("Target"); }
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201706202056450_BadNicknames_ImportantWords.cs`:

```cs
namespace Arma3BEClient.Libs.Migrations
{
    using System.Data.Entity.Migrations;

    public partial class BadNicknames_ImportantWords : DbMigration
    {
        public override void Up()
        {
            CreateTable(
                "dbo.BadNicknames",
                c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Text = c.String(maxLength: 4000),
                })
                .PrimaryKey(t => t.Id);

            CreateTable(
                "dbo.ImportantWords",
                c => new
                {
                    Id = c.Int(nullable: false, identity: true),
                    Text = c.String(maxLength: 4000),
                })
                .PrimaryKey(t => t.Id);
        }

        public override void Down()
        {
            DropTable("dbo.ImportantWords");
            DropTable("dbo.BadNicknames");
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201706202056450_BadNicknames_ImportantWords.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="Target" xml:space="preserve">
    <value>H4sIAAAAAAAEAO1d227cuBm+L9B3EOayyM7YcdDdGvYuknGyO1jHNjLOtncBPaJtYXWYlTiujaJP1os+Ul+hpKgDjyIlUZoZ2xcJPKT48Sf/jz/PP//3n/+e/PQYhd4DTLMgiU8nh9ODiQfjVeIH8d3pZINuv/th8tOPf/7TyUc/evR+K787It/hlHF2OrlHaH08m2WrexiBbBoFqzTJkls0XSXRDPjJ7O3Bwd9mh4cziCEmGMvzTr5sYhREMP+Bf86TeAXXaAPCz4kPw6wIxzHLHNW7ABHM1mAFTyfv0wgcffg4DwMYo+l5cJNNcXIEH9HEex8GAEu0hOHtxANxnCCAsLzHXzO4RGkS3y3XOACE109riL+7BWEGi3Ic15/bFungLSnSrE5YQq02GUqiloCHR0UdzcTknWp6UtUhrsWPuLbREyl1XpO4Ev0owLhiTsfzMCVfKWs5V808ibAa0DQHeOPJn72pSHIw/X7616MfDqbvDo8ODt94802INik8jeEGpSB8411tbsJg9St8uk5+h/FpvAlDVmosN47jAnDQVZqsYYqevsDboiwLf+LN+HQzMWGVjElDC7qI0dHbiXeBMwc3IaxIwVTKEiUp/BnGMAUI+lcAIZjGBAPm1SrlLuR1sYlMmTUDLK7K9JjEuF1OvM/g8RzGd+j+dPLu4AA3xU/BI/TLoAL0axzgdoxToXRjzOMqSVE/KZcwxWakrtifN4FvBrkAD8FdXs1quPg2mXhfYJh/kt0Ha9q6p3X0t5yKGa6DNIm+JCGXtoj8dg3SO0gKmOi+WCabdCXIdzKrG05jc2KF7d6mapTn0LDs9C8k/yXJkAuyt8zWAfsRBFF/mCuQZf9MUn8LdUD+30K271coeKgy/pDg5gniHnajtAb9bUZpEfQ2o7QqtrJ9ABrJcMQ31obUYvExkh0TolVGrEmg+T1A58mdUqYiTiOXHCvJpvikrXxXIXiC6S8Btqjpk1JK7guNrLpvJIm1H/bqHD6AXiMtnPw5dAfDj7Oo9sQOaOCxWbdRjwBCEi3Www/yPgfxBsGsX4kLkHN427Ov+wJBRiY3Q5d6nkLMpzP8r8yL/H0dRO07q0XmuruipG0wbd9opyFaszxYY8BoXFtbaxhwW3dRYrep6cE6mdKytrpbU4rwHAxqN0vzdXE2fIvLB8MLJ4PYccasBgOSRBFmyfAZnYMMjdEPkHyWEMbt7WH7oa2FFRMthsrC2cpxkeQdnEIQEvOtNCC1IEywZE7ZuKGHrrJkqnjDkLVBVmsbSwrdx8KS9C/WvqrHoC1BrvO17KGNQLcBUZeBjEXLE02AqlX2GDFUzbDvwKEAeg783taEbEvLUttfYncyA3G8ym6cfrTsntRduaYPczQz6bUE1Cywq3lLtc7W3f4UEK+Wx8byjNODOln7cdwNG9pK60VdsX00rPt2XBz1L4LV73Fu5fssklYwry1kWy2kzYp4ufjXa12cgrwqfB8UTu1aL3UTiFdlWyk7QOEIo2aikEXcYVfBfuCU82UJEcJFyHqNnzik50CjETfpfwPhxjmfrEmwiNZJikCM/p6fjOjOAQ7oOVDgmXcbv+IhXf+BQo3yqvKdV7kLU/+cjPzw6h7Vtr/PsmQV5HJLE9byUBYv7cfY94wntKjs/BkvXAis0WCNdYgFOZ0cTkRdXcZnMIQIemRTn5zSnoNsBXy5N8SF8e2lqrZoaqmK49a8QH+R8sGkgSnRGsBcjjNMwyBGMsOCeBWsQWiqFiGhJTlJcassxJgzuIYx4ZWp8DZ518snsgRVRoIiTDV0MmMY1kw8dmNSp1zlLmWt1nJRlNfrwXR6KKlWjamgSn5abBCiKAozAkUUxbXJtd472Ao52C0rnSKV+1e1Iuk+qkmTajgFL9Rcc2rUOrFKIfYIrFLU/R6wSrml0mwndPsrIjGqHU57wjWfL9h95jXJP5phU+tn77jIDJvs6KLaInDOSdVR7dGHeg64KZdjdH7K+tqDIZpw5lRHGt0B1JaDKi3gnnFPLf0IjFPrYQ94ptgV1VGjaYu0pke132/PuaYLNfvBO30JRuCeXi87xz+6MkLurOMUMC3vreVLVZAuVVUX2qVFsK8ZLNbBsmLdRSQUAV9CJFyHq5dj+CUJiY98cpZvEgQbacChx38lhNwuG5KWw08pcRlhSF+c3lZlT6doVvlXYxmNGFW8SZrSMkg4VYyxKqujDuoqZQ5UmLVCF8Y1uinX3s0wZCdQA0I3fk3VIuzzybUjfGDA43Z6VHjCnpIBrt5CUGGx2xTG9qQtobZsjBlRNczqLivznfbCq2jdbFZXqzLw5kCylDZrogxWKbbYGfHFtagK7oaBXAnadT7jSh8jrNrWGNf1GAQqXu/Ccmep5cJq162MK1eMqLXFbCiuarnKWGGdtSseQ9WpuWltxX51RSqHxrrbL6cMXzNs0zTVjm6c226+76CWFINdK2vTobbE+4tyHTXNNm3mm4bGbjPDHKrwqmOfcgWYpkG2EyHWlKgHNbYzn771UW5DVoPtKu5kRj1LFQEnM40LqpPPYL0m3XKdsgjxltQf1fy7ZXsHTRHFmK24PkmcGlQ54cYC7qAQSwy1Dz8FaYbOAAI3gOzJzv1I+kw5tdCMU8osudmDrLty7FJ+Tv5m5zEq91zFlEOejxUgn3AZSb+TFxeKIwU5nUe8g4EQpIrN83kSbqJYP7PUp849ArDJ8wD79OQmCZf7VZvU1IMMm56G2CPUU1kWRT/BJdwXFCBNgSV9S+sHPHusuNVoZTrxS49oQbKmxMMwjfo6YtPTkFHZUrst4uhSB7eQpvJdxElUhbZog/nklWuEiulsE0LppoHFKMN2pgVopiSduE9WUtqTXplqGLbX210cO7SbYA3s6Gmh21tIHVLpt4XFKcPsUarz0yxMFdgahzpmUWDRCHu8ckmDhVIvczShsN5XWCQ2vEXvmqladh26M21bOwHt1LrVaBYNXJdwmDZOvYtwrSEPadkfSU2zDByzB6mcfnCkLQPtcUqfHixMGdYOhXrsEHFo6M7wvlo7csT8fIm+Pe/VyXa9Z6Mnr1kUGmKPINtZnYXdql0sV4qcmkcNqLWV1Kbfddr0N3b9Jq32pNv7SWu5nuWIuBo4C8pqUw5D1v6Wyd2oe+dtHLdD62x+V2/rdpnnNaTeNmO2N/sut3TdzcGL+VGnmbgu7cvVDz1V4E47+VGETrpRpxxIM/TyNqcaGtQGg7uZzWNxUTujb+GEh6sethHVpqM1AAzDgeJSHgtQBO2MvoQjNo70xZ/Laa8uQ/oXakvZ80uOFMUcemqvpabEL1RFrg1fD5P3Yo2ddFxA/KTKvQipflfHBYqtevMzVtLePf1k4uHKeQh8sm+/fMoQjKbkg+nyj5DOleZw+o48vlV+9hnEwS3MEL2kPsnjuGewdudJqlmW+dwVet27VLzGRrhlH5A1XeM9+raeK+u3BXL8zq8+xQ8gXd2DVHEtv8Zs+8hTF5FEh3ebOPhjA4O8gm4DpWP2RezDx9PJv3KEY2/xj/KYj//Gu0wxf4+9A+/frtwFaS9wjMAhuTJ6vH1kpfLWTxt10rn4sFEXEPFZI3fFoyudrlH5Vx5uAlOJW70F8zysm+jct5MtKEF0tsDqDYB+ZnZbNk2WhH8FxpnRF9yzdakjxZMvXWD4B1+cFVB+38XHfyMX77s4bPnK2/770C2xT4Y405nwQogz3NbdQYf3P5zh8s99OIVlX/ewbA3tHojYPx6P0mG1ft/BmdY72L+Ojyi8jl/c0mEQmzXA7NFJD7vzU0jlxvresnwQU7M7Q+YhjZ52z/wlk6GDi/fXuutQd/J+8/7WHOuL3JkNUroeN09KuzoeH10V7tayOP+uQ1O3Yft1fwk8YtPXbYy+Vl4b39HPo+qGbLhu/DBv1/Ny4cGIEWEcN8tjuLPSXZWWM9obL8r9PSfn3qIYkKFdJY/kM28fvIXa+EO2VvNA9oB682Jyt/PAvOME0VyA2jmGdPBtvD2qCP5qJDGsPdfuOHlMF6N2nEUW/jh3ZTCyXUaNOzhpz6r98CO8K1wab5wzLm9sxzr74w14VxhTudlihLD2QbwHzNHfk9wye4TzwtWBAdEvl6i44ggyd+pV66OXngw+nfg3hGZ0qq/xnikiW/vvVeVRx8sXhVROYHUOflXYSneYIqbR9a8KmcaZwensQIKmwSpgEmMrs7W7YH0J6CeBRZYWPoVV2RSRNqplXAorVMzEqlXNOiw206g8JqYiUxmnoVTlo9ecC3VLrMqDxmhyKBwdmzTS1p2xUj89XB6bPR6rchS9JhtyZP0eS9mxkaq8OJfKRitm4TVZbcF2xKdyFy/KXK/AOEKUBgbb9Jjc1ksy001UHsj6F8iJV+RuBWK7kdr1jCsdDeT3uJtva6FTM3v+3T2nxv1a5HjV4NBbcb8iD9NeB/BH3K+YwhCqyXexG3fD8j1BPAvZxOQAE/11BrPgroY4wZgxXHHzj+obUrxyIiRIVH4inuiHCPh4cvI+RcEtWCEcvYJZlr/9mu87nk4+RjfQX8SXG7TeIFxkGN2EHLXJdKop/9ynMi/zyeWa/MpcFAGLGZAzX5fxh00Q+pXcnxSnPjQQZJ5WbNgSXSKycXv3VCFdJLElUFF91fTyGkbrEINll/ESkOsE7WX7msFzeAdWT+VFTz2IWRF8tZ+cBeAuBVFWYNTp8U/MYT96/PH/Dw5MHBumAAA=</value>
  </data>
  <data name="DefaultSchema" xml:space="preserve">
    <value>dbo</value>
  </data>
</root>
```

`src/Arma3BE.Client.Libs/Migrations/201803012256245_Table_Indexes.Designer.cs`:

```cs
// <auto-generated />
namespace Arma3BEClient.Libs.Migrations
{
    using System.CodeDom.Compiler;
    using System.Data.Entity.Migrations;
    using System.Data.Entity.Migrations.Infrastructure;
    using System.Resources;
    
    [GeneratedCode("EntityFramework.Migrations", "6.1.3-40302")]
    public sealed partial class Table_Indexes : IMigrationMetadata
    {
        private readonly ResourceManager Resources = new ResourceManager(typeof(Table_Indexes));
        
        string IMigrationMetadata.Id
        {
            get { return "201803012256245_Table_Indexes"; }
        }
        
        string IMigrationMetadata.Source
        {
            get { return null; }
        }
        
        string IMigrationMetadata.Target
        {
            get { return Resources.GetString("Target"); }
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201803012256245_Table_Indexes.cs`:

```cs
namespace Arma3BEClient.Libs.Migrations
{
    using System;
    using System.Data.Entity.Migrations;
    
    public partial class Table_Indexes : DbMigration
    {
        public override void Up()
        {
            DropIndex("dbo.Bans", new[] { "PlayerId" });
            DropIndex("dbo.Bans", new[] { "ServerId" });
            DropIndex("dbo.ChatLogs", new[] { "ServerId" });
            CreateIndex("dbo.ServerInfoes", "Active");
            CreateIndex("dbo.Bans", "PlayerId");
            CreateIndex("dbo.Bans", "ServerId");
            CreateIndex("dbo.Bans", "GuidIp");
            CreateIndex("dbo.Bans", "Minutes");
            CreateIndex("dbo.Bans", "MinutesLeft");
            CreateIndex("dbo.Bans", "CreateDate");
            CreateIndex("dbo.Bans", "IsActive");
            CreateIndex("dbo.Players", "GUID");
            CreateIndex("dbo.Players", "SteamId");
            CreateIndex("dbo.Players", "LastSeen");
            CreateIndex("dbo.ChatLogs", "Text");
            CreateIndex("dbo.ChatLogs", "ServerId");
            CreateIndex("dbo.ChatLogs", "Date");
        }
        
        public override void Down()
        {
            DropIndex("dbo.ChatLogs", new[] { "Date" });
            DropIndex("dbo.ChatLogs", new[] { "ServerId" });
            DropIndex("dbo.ChatLogs", new[] { "Text" });
            DropIndex("dbo.Players", new[] { "LastSeen" });
            DropIndex("dbo.Players", new[] { "SteamId" });
            DropIndex("dbo.Players", new[] { "GUID" });
            DropIndex("dbo.Bans", new[] { "IsActive" });
            DropIndex("dbo.Bans", new[] { "CreateDate" });
            DropIndex("dbo.Bans", new[] { "MinutesLeft" });
            DropIndex("dbo.Bans", new[] { "Minutes" });
            DropIndex("dbo.Bans", new[] { "GuidIp" });
            DropIndex("dbo.Bans", new[] { "ServerId" });
            DropIndex("dbo.Bans", new[] { "PlayerId" });
            DropIndex("dbo.ServerInfoes", new[] { "Active" });
            CreateIndex("dbo.ChatLogs", "ServerId");
            CreateIndex("dbo.Bans", "ServerId");
            CreateIndex("dbo.Bans", "PlayerId");
        }
    }
}

```

`src/Arma3BE.Client.Libs/Migrations/201803012256245_Table_Indexes.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="Target" xml:space="preserve">
    <value>H4sIAAAAAAAEAO1d3W7cNha+X2DfQZjLRTpjx0GRNewWyThpB3VsI+N09y6gR7QtVD9TiZO1seiT7UUfqa+wpKgf/oqURGlmbF8k8JDi4SHPx0OeQ/Lwr//9efLjQxR632CaBUl8OjmcHkw8GK8SP4jvTicbdPvd28mPP/z9bycf/OjB+7X87oh8h0vG2enkHqH18WyWre5hBLJpFKzSJEtu0XSVRDPgJ7PXBwf/nB0eziAmMcG0PO/k8yZGQQTzH/jnPIlXcI02IPyU+DDMinScs8ypehcggtkarODp5F0agaP3H+ZhAGM0PQ9usikujuADmnjvwgBgjpYwvJ14II4TBBDm9/hLBpcoTeK75RongPD6cQ3xd7cgzGDRjuP6c9smHbwmTZrVBUtSq02GkqglwcOjoo9mYvFOPT2p+hD34gfc2+iRtDrvSdyJfhRgumJNx/MwJV8pezkXzTyJsBjQNCfwypM/e1WB5GD6dvr990dvpm+ODt4evvLmmxBtUngaww1KQfjKu9rchMHqF/h4nfwG49N4E4Ys15hvnMcl4KSrNFnDFD1+hrdFWxb+xJvx5WZiwaoYU4Y2dBGjo9cT7wJXDm5CWIGC6ZQlSlL4E4xhChD0rwBCMI0JDZh3q1S7UNfFJjJV1kxgcVWWxyDG43LifQIP5zC+Q/enkzcHB3gofgweoF8mFUS/xAEex7gUSjfGOq6SFPXjcglTrEbqjv1pE/hmIhfgW3CXd7OaXHybTLzPMMw/ye6DNR3d0zr7aw7FDPdBmkSfk5ArW2R+vQbpHSQNTHRfLJNNuhL4O5nVA6dxOLHMdh9TNZWnMLDs5C8U/znJkAuwt6zWAfoRBFF/Mlcgy/6TpP4W+oD8v4Vq361Q8K2q+H2ChyeIe+iNUhv01xmlRtDrjFKr2PL2Hmg4wxlfWR1Ss8XnSHpMyFYpsSaG5vcAnSd3Sp6KPA1fcq7Em+KTtvxdheARpj8HWKOmj0ouuS80vOq+kTjWfthrcngPeq20cPGnMB0Mv86i0hMnoIHXZt1WPQIRUmixHn6R9ymINwhm/VpcEDmHtz3nus8QZMS4GbrV8xRiPJ3hf2Vd5O/rIGo/WS0y19MVBW2DavtKJw1Rm+XJGgVG89rqWsOC23qKEqdNzQzWSZWWvdVdm1IKT0GhdtM0XxZnw4+4fDG8cLKIHWfNalAgSRRhlAxf0TnI0BjzAKlnCWHcXh+2X9paaDFRY6g0nC0fF0k+wSkYITlfSwVSM8IkS+qUzRt66Spzpso3LFkbeLXWsaTRfTQsKf9s9at6DdqSyHXuyx5aCXRbEHVZyFiMPFEFqEZljxVDNQz7LhwKQk8B39syyLbkltq+i92JBeLYy240P1pOT+qpXDOHObJMermAmhl2ZbdUfrbu+qcg8aJ5bDTPODOoE9+P42nYMFZaO3XF8dHg9+3oHPUvgtVvca7l+zhJKzIvI2RbI6SNR7x0/vXyi1MiLwLfB4FTvdZL3ITEi7CthB2gcIRVMxHIIu6wq2C/cMrxsoQI4SZkvdZPHKWnAKMRN+l/BeHGOZ6sQbCI1kmKQIz+lZ+M6I4BjtBTgMATnzZ+wUu6/guFmsqLyHde5C5U/VNS8sOLe1Td/i7LklWQ8y0ZrOWhLJ7bD7HvGU9oUd75M164EViiwRrLEDNyOjmciLK6jM9gCBH0yKY+OaU9B9kK+PJsiBvj23NVbdHUXBXHrXmG/iHVg0EDUyI1gLEcZxiGQYxkhAXxKliD0NQtQkFLcJLmVlWIOWdwDWOCK1Pjbequ3ScyB1VFgiBMPXQyYxDWDDx2Y1InXOUuZS3W0inKy/VgOj2URKumqYBKflpsEKAoGjMCRBTNtam13jvYCjjYLSudIJX7V7Ug6T6qSZJqcgpcqLHmVKl1QpWC7RFQpej7PUCVckulWU/o9ldEYFQ7nPaAaz5fsPvIa+J/NMWmls/eYZFZNtnBRbVF4ByTqqPaoy/1HGBTbsfo+JTltQdLNOHMqQ40ugOoLRdVWoJ7hj019yMgTi2HPcCZYldUB42mLdIaHtV+vz3mmi7U7Afu9C0YAXt6uewc/qhnhNxZxyVgWt5by11VkLqqqgvtkhPsSwYLP1hW+F1EQBHiS4iE63C1O4Z3SUh45IuzeJNIsJkGOvT4r0Qh18uGouXyUypcZhjKF6e3VdVTE82q/moto2GjyjdxU2oGiU6VY+zK6qiDukuZAxVmqVDHuEY2pe/dTIbsBGqI0I1fU7cI+3xy7wgfGOhxOz0qesKekoFcvYWgosVuUxjHk7aF2rYxakQ1MKu7rMx32guvonaz8a5WbeDVgaQpbXyiDK2SbXEy4ptr0RXcDQO5E7R+PqOnj2FWrWuMfj2GAmWvd2O5s9RyY7V+K6PnimG11pgNzVW5q4wd1lm64jFUnZibfCv23hWpHRrtbu9OGb5n2KFp6h3dOredve+glxSLXStt06G3xPuLch81WZs29qZhsNtYmEM1XnXsU+4AkxlkawixqkS9qLG1fPr2R7kNWS22q7yTGY0sVSSczDQhqE4+gfWaTMt1ySLFW9J4VPPvlu0DNEWUxmzFzUmiaVDVhAcLuINCLlHUPvwYpBk6AwjcALInO/cj6TOlaaFZp5RVctaDLLty7VJ+Tv5m7RhVeK7C5JDtsYLIR9xGMu/kzYXiSkEu55HoYCAEqWLzfJ6EmyjWW5b60nlEALZ4nmBfntwk4Wq/alOaRpBhy9MUewq1KctS0Ru4BPuCACQTWJK35D/g0WOFrUYt0wlfeooWIGsqPAzSaKwjtjxNGRUtddgiDi51cgtuqthFHEdVaosxmBuv3CBUmLNNFMowDSyNMm1nRoDGJOmEfeJJaQ96Zalh0F5vd3Ho0G6CNaCjp4ZuryF1lMq4LSydMs2eSnV+miVTJbamQwOzKGjRDHt6pUuDJaV2czRRYaOvsJTY9Baza6Ya2XXqzoxtrQHaaXSrqVkMcF3BYcY4jS7CjYY8peV8JA3NMnHMGaQK+sGBtky0p1PG9GDJlGntqNCIHSIdmrozuK98R46Qn7vo2+NeXWzXZzZ68pqlQlPsKch6Vqdht6oXS0+RU/WoIWqtJbXldx02/ZVdP6PVHnR7b7SW/ixHwNWQs4CstuQwYO2vmdytundex3E7tM7su3pbt4ud11B624jZnvVdbum6s8EL+6iTJa4r+3zlQ08VuJNOfhShk2zUJQeSDL28zYmGJrWhwd3M5mlxWTsjb+GEh6sZtpGqzURrIDAMBopLeSyBImln5CUcsXEkL/5cTntxGco/U13Knl9yJCjm0FN7KTUVfqYicq34eqi8Z6vspOMC4idV7UVK9bs6LlBs1ZufsZL27uknEw93zrfAJ/v2y8cMwWhKPpgufw+prTSH0zfk8a3ys08gDm5hhugl9Umexz2DtTtPUs2yzOeu0OvepeIlNsIt+4D4dI336NtGrqzfFsjpd371Kf4G0tU9SBXX8muabR956sKSGPBuEwe/b2CQd9BtoAzMvoh9+HA6+W9O4dhb/Ls85uO/8i5TjN9j78D7w1W4IO0FjhEwJHdGj7ePrETe+mmjTjIXHzbqQkR81shd86in0zVV/pWHm0B1E6NCtjP0Srvxe6v6xMi/bRTFH221Wk8920epmUQv18Y/9VIjtrGOnmpfCNCWd5LLNilehHFeB/9YjLMZUX4bxsd/I3Wswh7siw/HjKVSlDEG9mEyZB8qGWeUCI+WjFNp6+mrw3slzujyz5M4Jcu+RuJiBLZ77WL/hkefCbZaiZdEWqzEZU7YaHHOIKFWyC5VonKz/1mut9zCYRCFNoAp3AFhe2gPK08J7C3K1apm0DXBqLaB62VopyD8TxkqrdDQIZr9S9916Dt5a31/e44Nu+5sqlJGWTd7OrrGWB9dFO7cdlwo26Gh27DTvL8AHnHo6/aAXzqvTZjsp9F1Qw5cNyGntxtkugjWxLAwTkTpMSJ36W6FyxXtTcDo/kGi88BYDJGho0KPFB5wHwKj2oR+thbzQPqABi5jarcLNr3jANHc9do5hHQI47w9qAiheSQ2rIP07jh4THfAdhxFFqFHd2Uxsl1Ejbs4aY+q/QiZvCtYGm+dMy5ubNc6+xP4eFcQU0UUY5iwDre8B8jRXwndMnqEo9HVWQMxBJkouOK0NXfAVxuOmB6CPp34NwRm1NTXBAoVKVuHKlbVUefLd6JU8W51sYxVtJWRP0WaxijHKso0z0ycWgcSaZqsIkxybHm2joysbwH9JLCo0iJ8sqqaItNGtEz0ZIWImVy1qNnYzGYYlafaVGAq8zSQqsIRm2uhEZhVddAcTQ1FTGeTRNpGblbKp0d0Z3NwZ1WNYoBoQ41siGepOjZTVRcXPdqoxSwCRKs12I6Ej+4SMJqbFZiYj9LCYJvBodsGhGamiSrYWv8GOQkA3a1B7DRSR9lxJaOBQjx3C+MtTGrmIMe7F7+534gcrxscBmbu1+RhxusAoZf7NVNYQjWFaXYTWVm+EomtkE1MTjfRX2cwC+5qEieYZgxXnP1RfUOaVxpCAkflJ+LtBIiAj42TdykKbsEK4ewVzLL8mdt83/F08iG6gf4ivtyg9QbhJsPoJuSgTcyppvrz8NE8zyeXa/Irc9EEzGZADoRdxu83QehXfH9UnPrQkCB2WrFhS2SJyMbt3WNF6SKJLQkV3VeZl9cwWoeYWHYZLwG54NCety8ZPId3YPVY3mnVEzELgu/2k7MA3KUgygoadXn8E2PYjx5++D/kNCz4BqcAAA==</value>
  </data>
  <data name="DefaultSchema" xml:space="preserve">
    <value>dbo</value>
  </data>
</root>
```

`src/Arma3BE.Client.Libs/Migrations/Configuration.cs`:

```cs
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System.Data.Entity.Migrations;
using System.Linq;

namespace Arma3BEClient.Libs.Migrations
{
    internal sealed class Configuration : DbMigrationsConfiguration<Arma3BeClientContext>
    {
        public Configuration()
        {
            AutomaticMigrationsEnabled = true;
        }

        protected override void Seed(Arma3BeClientContext context)
        {
            //  This method will be called after migrating to the latest version.

            //  You can use the DbSet<T>.AddOrUpdateAsync() helper extension method 
            //  to avoid creating duplicate seed data. E.g.
            //
            //    context.People.AddOrUpdateAsync(
            //      p => p.FullName,
            //      new Person { FullName = "Andrew Peters" },
            //      new Person { FullName = "Brice Lambson" },
            //      new Person { FullName = "Rowan Miller" }
            //    );
            //


            if (context.BanReasons.Any() == false)
            {
                context.BanReasons.AddOrUpdate(x => x.Text,
                    new BanReason { Text = "Fill nickname" },
                    new BanReason { Text = "Sabotage" },
                    new BanReason { Text = "Teamkill" },
                    new BanReason { Text = "Inadequate" },
                    new BanReason { Text = "Troll" },
                    new BanReason { Text = "Flud" }
                    );
            }

            if (context.KickReasons.Any() == false)
            {
                context.KickReasons.AddOrUpdate(x => x.Text,
                    new KickReason { Text = "Fill nickname" },
                    new KickReason { Text = "Sabotage" },
                    new KickReason { Text = "Teamkill" },
                    new KickReason { Text = "Inadequate" },
                    new KickReason { Text = "Troll" },
                    new KickReason { Text = "Flud" }
                    );
            }

            if (context.BanTimes.Any() == false)
            {
                context.BanTimes.AddOrUpdate(x => x.TimeInMinutes,
                    new BanTime { Title = "Permanent", TimeInMinutes = 0 },
                    new BanTime { Title = "Day", TimeInMinutes = 1440 },
                    new BanTime { Title = "Week", TimeInMinutes = 10080 },
                    new BanTime { Title = "Month", TimeInMinutes = 43200 }
                    );
            }


            if (context.BadNicknames.Any() == false)
            {
                context.BadNicknames.AddOrUpdate(x => x.Text,
                    new BadNickname { Text = "Admin" },
                    new BadNickname { Text = "Administrator" }
                );
            }

            if (context.ImportantWords.Any() == false)
            {
                context.ImportantWords.AddOrUpdate(x => x.Text,
                    new ImportantWord { Text = "Admin" },
                    new ImportantWord { Text = "Administrator" },
                    new ImportantWord { Text = "Админ" },
                    new ImportantWord { Text = "Администратор" }
                );
            }
        }
    }
}
```

`src/Arma3BE.Client.Libs/ModelCompact/Admin.cs`:

```cs
using System;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BEClient.Libs.ModelCompact
{
    // ReSharper disable once ClassWithVirtualMembersNeverInherited.Global
    public class Admin
    {
        [Key]
        // ReSharper disable once UnusedMember.Global
        public int Id { get; set; }

        public int Num { get; set; }
        public string IP { get; set; }
        public int Port { get; set; }
        public Guid ServerId { get; set; }

        [ForeignKey("ServerId")]
        // ReSharper disable once UnusedMember.Global
        public virtual ServerInfo ServerInfo { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/ModelCompact/Ban.cs`:

```cs
using Arma3BEClient.Common.Attributes;
using System;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable UnusedMember.Global

namespace Arma3BEClient.Libs.ModelCompact
{
    // ReSharper disable once ClassWithVirtualMembersNeverInherited.Global
    public class Ban
    {
        public Ban()
        {
            CreateDate = DateTime.UtcNow;
            IsActive = true;
        }

        [Key]
        public int Id { get; set; }

        [Index]
        public Guid? PlayerId { get; set; }
        public int Num { get; set; }

        [Index]
        public Guid ServerId { get; set; }

        [Index]
        public string GuidIp { get; set; }

        [Index]
        public int Minutes { get; set; }

        [ShowInUi]
        [EnableCopy]
        [Index]
        public int MinutesLeft { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Reason { get; set; }

        [Index]
        public DateTime CreateDate { get; set; }

        [Index]
        public bool IsActive { get; set; }

        [ForeignKey("PlayerId")]
        public virtual Player Player { get; set; }

        [ForeignKey("ServerId")]
        public virtual ServerInfo ServerInfo { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/ModelCompact/ChatLog.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Manual changes to this file may cause unexpected behavior in your application.
//     Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace Arma3BEClient.Libs.ModelCompact
{
    public partial class ChatLog
    {
        [Key]
        public int Id { get; set; }

        [Index]
        public string Text { get; set; }

        [Index]
        public System.Guid ServerId { get; set; }

        [Index]
        public System.DateTime Date { get; set; }

        [ForeignKey("ServerId")]
        public virtual ServerInfo ServerInfo { get; set; }
    }
}

```

`src/Arma3BE.Client.Libs/ModelCompact/Note.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Manual changes to this file may cause unexpected behavior in your application.
//     Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using Arma3BEClient.Common.Attributes;

namespace Arma3BEClient.Libs.ModelCompact
{
    public partial class Note
    {

        public Note()
        {
            Id = Guid.NewGuid();
            Date = DateTime.UtcNow;
        }

        [Key]
        public System.Guid Id { get; set; }
        public System.Guid PlayerId { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Text { get; set; }

        [ShowInUi]
        [EnableCopy]
        public System.DateTime Date { get; set; }

        [ForeignKey("PlayerId")]
        public virtual Player Player { get; set; }
    }
}

```

`src/Arma3BE.Client.Libs/ModelCompact/Player.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Manual changes to this file may cause unexpected behavior in your application.
//     Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Arma3BEClient.Libs.Repositories.Players;
using System.Collections.Generic;

namespace Arma3BEClient.Libs.ModelCompact
{
    public partial class Player : PlayerDto
    {
        public Player()
        {
            this.Notes = new HashSet<Note>();
            this.PlayerHistory = new HashSet<PlayerHistory>();
            // this.Sessions = new HashSet<Sessions>();
        }

        public virtual ICollection<Note> Notes { get; set; }
        public virtual ICollection<Ban> Bans { get; set; }
        public virtual ICollection<PlayerHistory> PlayerHistory { get; set; }
    }
}

```

`src/Arma3BE.Client.Libs/ModelCompact/PlayerHistory.cs`:

```cs
using Arma3BEClient.Common.Attributes;
using System;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BEClient.Libs.ModelCompact
{
    // ReSharper disable once ClassWithVirtualMembersNeverInherited.Global
    public class PlayerHistory
    {
        public PlayerHistory()
        {
            Date = DateTime.UtcNow;
        }

        [Key]
        // ReSharper disable once UnusedMember.Global
        public int Id { get; set; }

        [Required]
        public Guid PlayerId { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Name { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string IP { get; set; }

        [ShowInUi]
        [EnableCopy]
        // ReSharper disable once MemberCanBePrivate.Global
        public DateTime Date { get; set; }

        public Guid ServerId { get; set; }

        [ForeignKey("PlayerId")]
        // ReSharper disable once UnusedMember.Global
        public virtual Player Player { get; set; }

        [ForeignKey("ServerId")]
        // ReSharper disable once UnusedMember.Global
        public virtual ServerInfo ServerInfo { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/ModelCompact/Reason.cs`:

```cs
using System.ComponentModel.DataAnnotations;
// ReSharper disable UnusedMember.Global

namespace Arma3BEClient.Libs.ModelCompact
{
    public class BanReason
    {
        [Key]
        public int Id { get; set; }
        public string Text { get; set; }
    }

    public class KickReason
    {
        [Key]
        public int Id { get; set; }
        public string Text { get; set; }
    }

    public class BanTime
    {
        [Key]
        public int Id { get; set; }
        public string Title { get; set; }
        public int TimeInMinutes { get; set; }
    }



    public class BadNickname
    {
        [Key]
        public int Id { get; set; }
        public string Text { get; set; }
    }

    public class ImportantWord
    {
        [Key]
        public int Id { get; set; }
        public string Text { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/ModelCompact/ServerInfo.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Manual changes to this file may cause unexpected behavior in your application.
//     Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace Arma3BEClient.Libs.ModelCompact
{
    public partial class ServerInfo
    {
        public ServerInfo()
        {
            this.ChatLog = new HashSet<ChatLog>();
            this.PlayerHistory = new HashSet<PlayerHistory>();
            this.Admins = new HashSet<Admin>();
        }

        [Key]
        public System.Guid Id { get; set; }

        [Required]
        public string Host { get; set; }

        [Required]
        public int Port { get; set; }

        [Required]
        public int SteamPort { get; set; }

        [Required]
        public string Password { get; set; }

        [Required]
        public string Name { get; set; }

        [Required]
        [Index]
        public bool Active { get; set; }


        public virtual ICollection<ChatLog> ChatLog { get; set; }

        public virtual ICollection<Ban> Bans { get; set; }

        public virtual ICollection<Admin> Admins { get; set; }

        public virtual ICollection<PlayerHistory> PlayerHistory { get; set; }
    }
}

```

`src/Arma3BE.Client.Libs/ModelCompact/Sessions.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Manual changes to this file may cause unexpected behavior in your application.
//     Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Arma3BEClient.Libs.ModelCompact
{
    //public partial class Sessions
    //{
    //    [Key]
    //    public int Id { get; set; }
        
    //    [Required]
    //    public System.Guid ServerId { get; set; }

    //    [Required]
    //    public System.Guid PlayerId { get; set; }
        
        
    //    public System.DateTime StartTime { get; set; }
    //    public Nullable<DateTime> EndTime { get; set; }

        
    //    public string IP { get; set; }
    //    public string Guid { get; set; }
    //    public string Comment { get; set; }

    //    public System.DateTime LastCheck { get; set; }
    //    public string Nickname { get; set; }
    //    public int Ping { get; set; }
    //    public int Number { get; set; }

    //    [ForeignKey("PlayerId")]
    //    public virtual Player Player { get; set; }

    //    [ForeignKey("ServerId")]
    //    public virtual ServerInfo ServerInfo { get; set; }
    //}
}

```

`src/Arma3BE.Client.Libs/ModelCompact/Settings.cs`:

```cs
using System.ComponentModel.DataAnnotations;

namespace Arma3BEClient.Libs.ModelCompact
{
    public class Settings
    {
        //[Key]
        public int Id { get; set; }
        public string Value { get; set; }
    }

    public class CustomSettings
    {
        [Key]
        public string Id { get; set; }
        public string Value { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/AdminRepository.cs`:

```cs
using Arma3BE.Server.Models;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Libs.Context;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories
{
    public class AdminRepository : DisposeObject
    {
        public Task AddOrUpdateAsync(IEnumerable<Admin> admins, Guid serverId)
        {
            return Task.Run(() =>
            {

                var l = admins.ToList();
                var ips = l.Select(x => x.IP).ToList();

                using (var context = new Arma3BeClientContext())
                {
                    var adminsdb = context.Admins.Where(x => x.ServerId == serverId && ips.Contains(x.IP)).ToList();

                    foreach (var admin in l)
                    {
                        var db = adminsdb.FirstOrDefault(x => x.IP == admin.IP);
                        if (db == null)
                        {
                            context.Admins.Add(new ModelCompact.Admin
                            {
                                ServerId = serverId,
                                IP = admin.IP,
                                Port = admin.Port,
                                Num = admin.Num
                            });
                        }
                    }

                    context.SaveChanges();
                }
            });
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/BanRepository.cs`:

```cs
using Arma3BEClient.Common.Core;
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Data.Entity.Migrations;
using System.Linq;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories
{
    public class BanRepository : DisposeObject
    {
        public async Task<IEnumerable<Ban>> GetActiveBansAsync(Guid serverId)
        {
            return await Task.Run(() =>
            {
                using (var context = new Arma3BeClientContext())
                {
                    return
                        context.Bans.Where(x => x.IsActive && x.ServerId == serverId)
                            .ToList();
                }
            });
        }

        public async Task<IEnumerable<Ban>> GetActivePermBansAsync()
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.Bans
                        .Where(x => x.ServerInfo.Active && x.IsActive && x.MinutesLeft == 0)
                        .Include(x => x.Player)
                        .ToList();
                }
            });
        }

        public Task AddOrUpdateAsync(IEnumerable<Ban> bans)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.Bans.AddOrUpdate(bans.ToArray());
                    dc.SaveChanges();
                }
            });
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/ChatRepository.cs`:

```cs
using Arma3BE.Server.Models;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Data.Entity;
using System.Linq;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories
{
    public class ChatRepository : DisposeObject
    {
        public Task AddOrUpdateAsync(ChatMessage message, Guid serverId)
        {
            return Task.Run(() =>
            {

                using (var context = new Arma3BeClientContext())
                {
                    context.ChatLog.Add(new ChatLog
                    {
                        Date = message.Date,
                        ServerId = serverId,
                        Text = message.Message
                    });

                    context.SaveChangesAsync();
                }
            });
        }


        public Task<IQueryable<ChatLog>> GetChatLogsAsync(string selectedServers, DateTime? startDate, DateTime? endDate,
            string filter)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    var log = dc.ChatLog.AsQueryable();

                    if (!string.IsNullOrEmpty(selectedServers))
                    {
                        var guids = selectedServers.Split(',').Select(Guid.Parse).ToArray();
                        if (guids.Length > 0)
                        {
                            log = log.Where(x => guids.Contains(x.ServerId));
                        }
                    }

                    if (startDate.HasValue)
                    {
                        var date = startDate.Value;
                        log = log.Where(x => x.Date >= date);
                    }

                    if (endDate.HasValue)
                    {
                        var date = endDate.Value;
                        log = log.Where(x => x.Date <= date);
                    }

                    if (!string.IsNullOrEmpty(filter))
                    {
                        log = log.Where(x => x.Text.Contains(filter));
                    }
                    return log.Include(x => x.ServerInfo).ToArray().AsQueryable();
                }
            });
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/Players/IPlayerRepository.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq.Expressions;
using System.Threading.Tasks;
using Arma3BEClient.Libs.ModelCompact;

namespace Arma3BEClient.Libs.Repositories.Players
{
    public interface IPlayerRepository : IDisposable
    {
        Task<IEnumerable<PlayerDto>> GetAllPlayersAsync();
        Task<IEnumerable<PlayerDto>> GetPlayersAsync(Expression<Func<Player, bool>> expression);
        Task<IEnumerable<PlayerDto>> GetPlayersAsync(IEnumerable<string> guids);
        Task<PlayerDto> GetPlayerAsync(string guid);
        Task<Player> GetPlayerInfoAsync(string guid);

        Task UpdatePlayerCommentAsync(string guid, string comment);
        Task UpdateCommentAsync(Dictionary<Guid, string> playersToUpdateComments);
        Task AddOrUpdateAsync(IEnumerable<PlayerDto> players);
        Task AddHistoryAsync(List<PlayerHistory> histories);
        Task AddNotesAsync(Guid id, string s);
        Task<IEnumerable<PlayerDto>> GetAllPlayersWithoutSteamAsync();
        Task SaveSteamIdAsync(Dictionary<Guid, string> found);

        Task ImportPlayersAsync(List<PlayerDto> toAdd, List<PlayerDto> toUpdate);
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/Players/PlayerDto.cs`:

```cs
using System;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace Arma3BEClient.Libs.Repositories.Players
{
    public class PlayerDto
    {
        public PlayerDto()
        {
            LastSeen = DateTime.UtcNow;
        }

        [Key]
        public Guid Id { get; set; }

        [Index]
        public string GUID { get; set; }

        [Index]
        public string SteamId { get; set; }

        public string Name { get; set; }
        public string Comment { get; set; }

        public string LastIp { get; set; }

        [Index]
        public DateTime LastSeen { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/Players/PlayerRepository.cs`:

```cs
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Data.Entity.Migrations;
using System.Linq;
using System.Linq.Expressions;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories.Players
{
    public class PlayerRepository : DisposeObject, IPlayerRepository
    {
        private readonly ILog _log = new Log();

        public async Task<IEnumerable<PlayerDto>> GetAllPlayersAsync()
        {
            using (var dc = new Arma3BeClientContext())
            {
                return await dc.Player.ToListAsync();
            }
        }

        public Task ImportPlayersAsync(List<PlayerDto> toAdd, List<PlayerDto> toUpdate)
        {
            return Task.Run(() =>
            {
                _log.Info("ImportPlayersAsync - Import started");
                _log.Info($"ImportPlayersAsync - ToAdd {toAdd.Count}, ToUpdate {toUpdate.Count}");
                using (var dc = new Arma3BeClientContext())
                {
                    foreach (var _add in toAdd.Paged(2000))
                    {
                        var toAddDto = _add.Select(Map).ToArray();
                        dc.Player.AddRange(toAddDto);
                        dc.SaveChanges();
                    }
                }

                _log.Info($"Inserted {toAdd.Count}");

                _log.Info("ImportPlayersAsync - Update started");
                using (var dc = new Arma3BeClientContext())
                {
                    var allPlayers = dc.Player.ToArray().ToDictionary(x => x.Id);

                    _log.Info($"Players loaded");

                    foreach (var player in toUpdate)
                    {
                        if (allPlayers.ContainsKey(player.Id))
                        {
                            var dto = allPlayers[player.Id];

                            if (string.IsNullOrEmpty(dto.SteamId))
                                dto.SteamId = player.SteamId;

                            if (string.IsNullOrEmpty(dto.Comment))
                                dto.Comment = player.Comment;
                        }
                    }

                    dc.SaveChanges();
                }

                _log.Info("ImportPlayersAsync - Update finished");
            });
        }

        public async Task<IEnumerable<PlayerDto>> GetPlayersAsync(Expression<Func<Player, bool>> expression)
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.Player.Where(expression).ToList();
                }
            });
        }

        public async Task<IEnumerable<PlayerDto>> GetPlayersAsync(IEnumerable<string> guids)
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.Player.Where(x => guids.Contains(x.GUID)).ToList();
                }
            });
        }

        public async Task<PlayerDto> GetPlayerAsync(string guid)
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.Player.FirstOrDefault(x => x.GUID == guid);
                }
            });
        }

        public Task<Player> GetPlayerInfoAsync(string guid)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return
                        dc.Player.Where(x => x.GUID == guid)
                            .Include(x => x.Bans)
                            .Include(x => x.Bans.Select(b => b.ServerInfo))
                            .Include(x => x.Notes)
                            .Include(x => x.PlayerHistory)
                            .FirstOrDefault();
                }
            });
        }

        public Task UpdatePlayerCommentAsync(string guid, string comment)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    var dbp = dc.Player.FirstOrDefault(x => x.GUID == guid);
                    if (dbp != null)
                    {
                        dbp.Comment = comment;
                        dc.SaveChanges();
                    }
                }
            });
        }

        public Task UpdateCommentAsync(Dictionary<Guid, string> playersToUpdateComments)
        {
            return Task.Run(() =>
            {
                var ids = playersToUpdateComments.Keys.ToArray();

                using (var dc = new Arma3BeClientContext())
                {
                    var players = dc.Player.Where(x => ids.Contains(x.Id));
                    foreach (var player in players)
                    {
                        player.Comment = playersToUpdateComments[player.Id];
                    }
                    dc.SaveChanges();
                }
            });
        }

        public Task AddOrUpdateAsync(IEnumerable<PlayerDto> players)
        {
            return Task.Run(() =>
            {
                var playerList = players.Select(Map).ToArray();

                using (var dc = new Arma3BeClientContext())
                {
                    dc.Player.AddOrUpdate(playerList);
                    dc.SaveChanges();
                }
            });
        }

        public Task AddHistoryAsync(List<PlayerHistory> histories)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.PlayerHistory.AddOrUpdate(histories.ToArray());
                    dc.SaveChanges();
                }
            });
        }

        public Task AddNotesAsync(Guid id, string s)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.Comments.Add(new Note()
                    {
                        PlayerId = id,
                        Text = s,
                    });
                    dc.SaveChanges();
                }
            });
        }

        public async Task<IEnumerable<PlayerDto>> GetAllPlayersWithoutSteamAsync()
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return
                        dc.Player.Where(x => string.IsNullOrEmpty(x.SteamId)).ToArray();
                }
            });
        }

        public Task SaveSteamIdAsync(Dictionary<Guid, string> found)
        {
            return Task.Run(() =>
            {
                var guids = found.Keys.ToArray();
                using (var dc = new Arma3BeClientContext())
                {
                    var players = dc.Player
                        .Where(x => string.IsNullOrEmpty(x.GUID) == false && string.IsNullOrEmpty(x.SteamId))
                        .Where(x => guids.Contains(x.Id)).ToArray();

                    foreach (var player in players)
                    {
                        if (found.ContainsKey(player.Id))
                        {
                            player.SteamId = found[player.Id];
                        }
                    }

                    dc.SaveChanges();
                }
            });
        }


        private Player Map(PlayerDto source)
        {
            return new Player()
            {
                Id = source.Id,
                Comment = source.Comment,
                GUID = source.GUID,
                LastIp = source.LastIp,
                LastSeen = source.LastSeen,
                Name = source.Name,
                SteamId = source.SteamId
            };
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/Players/PlayerRepositoryCache.cs`:

```cs
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Linq.Expressions;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories.Players
{
    public class PlayerRepositoryCache : DisposeObject, IPlayerRepository
    {
        private static readonly object Lock = new object();
        private readonly IPlayerRepository _playerRepository;
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private static volatile bool _validCache;
        private static volatile ConcurrentDictionary<string, PlayerDto> _playersByGuidsCache;


        async Task<ConcurrentDictionary<string, PlayerDto>> GetCacheAsync()
        {
            if (!_validCache) await ResetCacheAsync();
            return _playersByGuidsCache;
        }

        private void ResetCache()
        {
            if (_validCache) return;
            lock (Lock)
            {

                if (_validCache) return;
                _log.Info($"Refresh Players cache from {new StackTrace()}.");
                var playersByGuidsCache = new ConcurrentDictionary<string, PlayerDto>();
                var players = _playerRepository.GetAllPlayersAsync().Result.GroupBy(x => x.GUID).Select(x => x.First());
                foreach (var playerDto in players)
                {
                    playersByGuidsCache.AddOrUpdate(playerDto.GUID, playerDto, (key, value) => value);
                }

                _playersByGuidsCache = playersByGuidsCache;
                _validCache = true;
            }
        }

        private Task ResetCacheAsync()
        {
            return Task.Run(() => ResetCache());
        }

        public PlayerRepositoryCache(IPlayerRepository playerRepository)
        {
            _playerRepository = playerRepository;
        }

        public async Task<IEnumerable<PlayerDto>> GetAllPlayersAsync()
        {
            return (await GetCacheAsync()).Values.ToArray();
        }

        public Task<IEnumerable<PlayerDto>> GetPlayersAsync(Expression<Func<Player, bool>> expression)
        {
            return _playerRepository.GetPlayersAsync(expression);
        }

        public async Task<IEnumerable<PlayerDto>> GetPlayersAsync(IEnumerable<string> guids)
        {
            var result = new List<PlayerDto>();

            foreach (var guid in guids.Distinct().ToArray())
            {
                PlayerDto element;
                if ((await GetCacheAsync()).TryGetValue(guid, out element))
                    result.Add(element);
            }

            return result;
        }

        public async Task<PlayerDto> GetPlayerAsync(string guid)
        {
            PlayerDto element;
            if ((await GetCacheAsync()).TryGetValue(guid, out element))
                return element;
            return null;
        }

        public Task<Player> GetPlayerInfoAsync(string guid)
        {
            return _playerRepository.GetPlayerInfoAsync(guid);
        }

        public async Task UpdatePlayerCommentAsync(string guid, string comment)
        {
            await _playerRepository.UpdatePlayerCommentAsync(guid, comment);

            PlayerDto element;
            if ((await GetCacheAsync()).TryGetValue(guid, out element))
            {
                element.Comment = comment;
            }
        }

        public async Task UpdateCommentAsync(Dictionary<Guid, string> playersToUpdateComments)
        {
            var dto = playersToUpdateComments ?? new Dictionary<Guid, string>();
            if (dto.Count == 0) return;

            await _playerRepository.UpdateCommentAsync(dto);

            var local = (await GetCacheAsync()).Values.ToDictionary(x => x.Id);

            foreach (var playersToUpdateComment in dto)
            {
                PlayerDto element;
                if (local.TryGetValue(playersToUpdateComment.Key, out element))
                {
                    element.Comment = playersToUpdateComment.Value;
                }
            }
        }

        public async Task AddOrUpdateAsync(IEnumerable<PlayerDto> players)
        {
            var playerDtos = players?.ToArray() ?? new PlayerDto[0];
            if (!playerDtos.Any()) return;

            await _playerRepository.AddOrUpdateAsync(playerDtos);

            foreach (var player in playerDtos)
            {
                if ((await GetCacheAsync()).ContainsKey(player.GUID) == false)
                {
                    _log.Info("AddOrUpdateAsync - found new Player, resetting cache");
                    _validCache = false;
                    break;
                }

                (await GetCacheAsync()).AddOrUpdate(player.GUID, player, (k, v) => player);
            }
        }

        public Task AddHistoryAsync(List<PlayerHistory> histories)
        {
            return _playerRepository.AddHistoryAsync(histories);
        }

        public Task AddNotesAsync(Guid id, string s)
        {
            return _playerRepository.AddNotesAsync(id, s);
        }

        public Task<IEnumerable<PlayerDto>> GetAllPlayersWithoutSteamAsync()
        {
            if (_validCache)
            {
                return Task.FromResult(_playersByGuidsCache.Values
                    .Where(x => string.IsNullOrEmpty(x.SteamId)));
            }
            else
            {
                return _playerRepository.GetAllPlayersWithoutSteamAsync();
            }
        }

        public async Task SaveSteamIdAsync(Dictionary<Guid, string> found)
        {
            foreach (var paged in found.Paged(2000))
            {
                await _playerRepository.SaveSteamIdAsync(paged.ToDictionary(x => x.Key, x => x.Value));
            }

            _log.Info("SaveSteamIdAsync resetting cache");
            _validCache = false;
        }

        public async Task ImportPlayersAsync(List<PlayerDto> toAdd, List<PlayerDto> toUpdate)
        {
            if (toAdd.Any() || toUpdate.Any())
            {
                await _playerRepository.ImportPlayersAsync(toAdd, toUpdate);

                _log.Info("ImportPlayersAsync resetting cache");
                _validCache = false;
            }
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/Players/PlayerRepositoryCacheV2.cs`:

```cs
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Linq.Expressions;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories.Players
{
    public class PlayerRepositoryCacheV2 : DisposeObject, IPlayerRepository
    {
        private readonly IPlayerRepository _inner;
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private readonly ICache<PlayerDto> _cache;

        public PlayerRepositoryCacheV2(IPlayerRepository inner, ICacheFactory cacheFactory)
        {
            _inner = inner;
            _cache = cacheFactory.CreateCache<PlayerDto>(TimeSpan.FromMinutes(15));
        }

        public async Task<IEnumerable<PlayerDto>> GetAllPlayersAsync()
        {
            var ret = await _inner.GetAllPlayersAsync();
            foreach (var playerDto in ret)
            {
                _cache.Add(playerDto.GUID, playerDto);
            }
            return ret;
        }

        public async Task<IEnumerable<PlayerDto>> GetPlayersAsync(Expression<Func<Player, bool>> expression)
        {
            var ret = await _inner.GetPlayersAsync(expression);
            foreach (var playerDto in ret)
            {
                _cache.Add(playerDto.GUID, playerDto);
            }
            return ret;
        }

        public async Task<IEnumerable<PlayerDto>> GetPlayersAsync(IEnumerable<string> guids)
        {
            var guidsArray = guids as string[] ?? guids.ToArray();

            var result = _cache.GetAll(guidsArray).ToList();
            var foundGuids = new HashSet<string>(result.Select(x => x.GUID));
            var notFound = new HashSet<string>(guidsArray.Where(x => !foundGuids.Contains(x) && x.IsGuid()).Distinct());

            if (notFound.Any())
            {
                var playedsToAdd = await _inner.GetPlayersAsync(notFound);

                foreach (var playerDto in playedsToAdd)
                {
                    _cache.Add(playerDto.GUID, playerDto);
                    if (notFound.Contains(playerDto.GUID)) notFound.Remove(playerDto.GUID);
                }

                //await _inner.AddOrUpdateAsync(notFound.Select(x => new PlayerDto()
                //{
                //    Id = Guid.NewGuid(),
                //    GUID = x
                //}));

                result.AddRange(playedsToAdd);
            }

            return result;
        }

        public async Task<PlayerDto> GetPlayerAsync(string guid)
        {
            var p = _cache.Get(guid);
            if (p == null)
            {
                var res = await _inner.GetPlayerAsync(guid);
                _cache.Add(res.GUID, res);
            }
            return p;
        }

        public async Task<Player> GetPlayerInfoAsync(string guid)
        {
            var p = await _inner.GetPlayerInfoAsync(guid);
            _cache.Add(p.GUID, p);
            return p;
        }

        public async Task UpdatePlayerCommentAsync(string guid, string comment)
        {
            await _inner.UpdatePlayerCommentAsync(guid, comment);
            var p = _cache.Get(guid);
            if (p != null) p.Comment = comment;
        }

        public async Task UpdateCommentAsync(Dictionary<Guid, string> playersToUpdateComments)
        {
            var dto = playersToUpdateComments ?? new Dictionary<Guid, string>();
            if (dto.Count == 0) return;

            await _inner.UpdateCommentAsync(dto);

            foreach (var player in _cache.GetAll())
            {
                if (dto.ContainsKey(player.Id))
                {
                    player.Comment = dto[player.Id];
                }
            }
        }

        public async Task AddOrUpdateAsync(IEnumerable<PlayerDto> players)
        {
            var playerDtos = players?.ToArray() ?? new PlayerDto[0];
            if (!playerDtos.Any()) return;

            await _inner.AddOrUpdateAsync(playerDtos);

            foreach (var player in playerDtos)
            {
                _cache.Remove(player.GUID);
            }
        }

        public Task AddHistoryAsync(List<PlayerHistory> histories)
        {
            return _inner.AddHistoryAsync(histories);
        }

        public Task AddNotesAsync(Guid id, string s)
        {
            return _inner.AddNotesAsync(id, s);
        }

        public Task<IEnumerable<PlayerDto>> GetAllPlayersWithoutSteamAsync()
        {
            return _inner.GetAllPlayersWithoutSteamAsync();
        }

        public async Task SaveSteamIdAsync(Dictionary<Guid, string> found)
        {
            var cachedItems = _cache.GetAll().ToDictionary(x => x.Id);

            foreach (var paged in found.Paged(2000))
            {
                await _inner.SaveSteamIdAsync(paged.ToDictionary(x => x.Key, x => x.Value));

                foreach (var player in paged)
                {
                    if (cachedItems.ContainsKey(player.Key))
                        _cache.Remove(cachedItems[player.Key].GUID);
                }
            }

            _log.Info("SaveSteamIdAsync resetting cache");
        }

        public async Task ImportPlayersAsync(List<PlayerDto> toAdd, List<PlayerDto> toUpdate)
        {
            if (toAdd.Any() || toUpdate.Any())
            {
                await _inner.ImportPlayersAsync(toAdd, toUpdate);


                foreach (var playerDto in toAdd)
                {
                    _cache.Remove(playerDto.GUID);
                }

                foreach (var playerDto in toUpdate)
                {
                    _cache.Remove(playerDto.GUID);
                }

                _log.Info("ImportPlayersAsync resetting cache");
            }
        }

        protected override void DisposeManagedResources()
        {
            _inner?.Dispose();
            base.DisposeManagedResources();
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/ReasonRepository.cs`:

```cs
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Linq;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories
{
    public class ReasonRepository : IDisposable
    {
        public Task<string[]> GetBanReasonsAsync()
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                    return dc.BanReasons.Select(x => x.Text).ToArray();
            });
        }

        public Task<BanTime[]> GetBanTimesAsync()
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                    return dc.BanTimes.ToArray();
            });
        }


        public Task<string[]> GetKickReasonsAsync()
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                    return dc.KickReasons.Select(x => x.Text).ToArray();
            });
        }

        public Task<string[]> GetBadNicknamesAsync()
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                    return dc.BadNicknames.Select(x => x.Text).ToArray();
            });
        }

        public Task<string[]> GetImportantWordsAsync()
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                    return dc.ImportantWords.Select(x => x.Text).ToArray();
            });
        }

        public void Dispose()
        {
        }

        public Task UpdateBadNicknames(string[] badNicknames)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.BadNicknames.RemoveRange(dc.BadNicknames);
                    dc.BadNicknames.AddRange(
                        badNicknames.Distinct().Select(x => new BadNickname() { Text = x }).ToArray());
                    dc.SaveChanges();
                }
            });
        }

        public Task UpdateImportantWords(string[] importantWords)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.ImportantWords.RemoveRange(dc.ImportantWords);
                    dc.ImportantWords.AddRange(importantWords.Distinct().Select(x => new ImportantWord() { Text = x })
                        .ToArray());
                    dc.SaveChanges();
                }
            });
        }

        public Task UpdateBanReasons(string[] banReasons)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.BanReasons.RemoveRange(dc.BanReasons);
                    dc.BanReasons.AddRange(banReasons.Distinct().Select(x => new BanReason() { Text = x }).ToArray());
                    dc.SaveChanges();
                }
            });
        }

        public Task UpdateKickReasons(string[] kickReasons)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.KickReasons.RemoveRange(dc.KickReasons);
                    dc.KickReasons.AddRange(kickReasons.Distinct().Select(x => new KickReason() { Text = x }).ToArray());
                    dc.SaveChanges();
                }
            });
        }

        public Task UpdateBanTimes(BanTime[] banTimes)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.BanTimes.RemoveRange(dc.BanTimes);
                    dc.BanTimes.AddRange(banTimes.Distinct().ToArray());
                    dc.SaveChanges();
                }
            });
        }
    }
}
```

`src/Arma3BE.Client.Libs/Repositories/ServerInfoRepository.cs`:

```cs
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Data.Entity.Migrations;
using System.Diagnostics;
using System.Linq;
using System.Threading.Tasks;

namespace Arma3BEClient.Libs.Repositories
{
    public interface IServerInfoRepository
    {
        Task AddOrUpdateAsync(ServerInfoDto serverInfo);
        Task<IEnumerable<ServerInfoDto>> GetActiveServerInfoAsync();
        Task<IEnumerable<ServerInfoDto>> GetNotActiveServerInfoAsync();
        Task<IEnumerable<ServerInfoDto>> GetServerInfoAsync();
        Task RemoveAsync(Guid serverInfoId);
        Task SetServerInfoActiveAsync(Guid serverInfoId, bool active);
    }


    public class ServerInfoRepositoryCache : IServerInfoRepository
    {
        private readonly IServerInfoRepository _infoRepository;

        private static readonly object Lock = new object();
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        private static volatile bool _validCache;
        private static volatile ConcurrentDictionary<Guid, ServerInfoDto> _cache;

        private Task ResetCacheAsync()
        {
            return Task.Run(() => { ResetCache(); });
        }

        async Task<ConcurrentDictionary<Guid, ServerInfoDto>> GetCacheAsync()
        {
            if (!_validCache) await ResetCacheAsync();
            return _cache;
        }

        private void ResetCache()
        {
            if (_validCache) return;
            lock (Lock)
            {
                if (_validCache) return;
                _log.Info("Refresh ServerInfo cache.");
                var playersByGuidsCache = new ConcurrentDictionary<Guid, ServerInfoDto>();
                var players = _infoRepository.GetServerInfoAsync().Result;

                foreach (var playerDto in players)
                {
                    playersByGuidsCache.AddOrUpdate(playerDto.Id, playerDto, (key, value) => value);
                }

                _cache = playersByGuidsCache;
                _validCache = true;
            }
        }


        public ServerInfoRepositoryCache(IServerInfoRepository infoRepository)
        {
            _infoRepository = infoRepository;
        }

        public async Task AddOrUpdateAsync(ServerInfoDto serverInfo)
        {
            (await GetCacheAsync()).AddOrUpdate(serverInfo.Id, serverInfo, (key, value) => value);
            await _infoRepository.AddOrUpdateAsync(serverInfo);
        }

        public async Task<IEnumerable<ServerInfoDto>> GetActiveServerInfoAsync()
        {
            return (await GetCacheAsync()).Values.Where(x => x.Active).ToArray();
        }

        public async Task<IEnumerable<ServerInfoDto>> GetNotActiveServerInfoAsync()
        {
            return (await GetCacheAsync()).Values.Where(x => !x.Active).ToArray();
        }

        public async Task<IEnumerable<ServerInfoDto>> GetServerInfoAsync()
        {
            return (await GetCacheAsync()).Values.ToArray();
        }

        public async Task RemoveAsync(Guid serverInfoId)
        {
            ServerInfoDto val;
            (await GetCacheAsync()).TryRemove(serverInfoId, out val);
            await _infoRepository.RemoveAsync(serverInfoId);
        }

        public async Task SetServerInfoActiveAsync(Guid serverInfoId, bool active)
        {
            ServerInfoDto value;
            if ((await GetCacheAsync()).TryGetValue(serverInfoId, out value))
            {
                if (value.Active == active) return;
                await _infoRepository.SetServerInfoActiveAsync(serverInfoId, active);
                (await GetCacheAsync()).AddOrUpdate(serverInfoId, k => value, (k, v) =>
                {
                    v.Active = active;
                    return v;
                });
            }
            else
            {
                await _infoRepository.SetServerInfoActiveAsync(serverInfoId, active);
                ResetCache();
            }
        }
    }

    public class ServerInfoRepository : DisposeObject, IServerInfoRepository
    {
        public async Task<IEnumerable<ServerInfoDto>> GetActiveServerInfoAsync()
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.ServerInfo.Where(x => x.Active).Select(ToDto).ToArray();
                }
            });
        }

        public async Task<IEnumerable<ServerInfoDto>> GetServerInfoAsync()
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.ServerInfo.ToList().Select(ToDto).ToArray();
                }
            });
        }

        public Task SetServerInfoActiveAsync(Guid serverInfoId, bool active)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    var server = dc.ServerInfo.FirstOrDefault(x => x.Id == serverInfoId);
                    if (server != null)
                    {
                        server.Active = active;
                        dc.SaveChanges();
                    }
                }
            });
        }

        public async Task<IEnumerable<ServerInfoDto>> GetNotActiveServerInfoAsync()
        {
            return await Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    return dc.ServerInfo.Where(x => !x.Active).Select(ToDto).ToArray();
                }
            });
        }

        public Task AddOrUpdateAsync(ServerInfoDto serverInfo)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {

                    dc.ServerInfo.AddOrUpdate(FromDto(serverInfo));
                    dc.SaveChanges();
                }
            });
        }

        public Task RemoveAsync(Guid serverInfoId)
        {
            return Task.Run(() =>
            {
                using (var dc = new Arma3BeClientContext())
                {
                    dc.ChatLog.RemoveRange(dc.ChatLog.Where(x => x.ServerId == serverInfoId));
                    dc.Bans.RemoveRange(dc.Bans.Where(x => x.ServerId == serverInfoId));
                    dc.PlayerHistory.RemoveRange(dc.PlayerHistory.Where(x => x.ServerId == serverInfoId));
                    dc.Admins.RemoveRange(dc.Admins.Where(x => x.ServerId == serverInfoId));

                    dc.ServerInfo.RemoveRange(dc.ServerInfo.Where(x => x.Id == serverInfoId));
                    dc.SaveChanges();
                }
            });
        }

        private ServerInfoDto ToDto(ServerInfo info)
        {
            return new ServerInfoDto()
            {
                Id = info.Id,
                Host = info.Host,
                Port = info.Port,
                SteamPort = info.SteamPort,
                Password = info.Password,
                Name = info.Name,
                Active = info.Active,
            };
        }

        private ServerInfo FromDto(ServerInfoDto info)
        {
            return new ServerInfo()
            {
                Id = info.Id,
                Host = info.Host,
                Port = info.Port,
                SteamPort = info.SteamPort,
                Password = info.Password,
                Name = info.Name,
                Active = info.Active,
            };
        }
    }


    public class ServerInfoDto
    {
        public Guid Id { get; set; }
        public string Host { get; set; }
        public int Port { get; set; }
        public int SteamPort { get; set; }
        public string Password { get; set; }
        public string Name { get; set; }
        public bool Active { get; set; }
    }
}
```

`src/Arma3BE.Client.Libs/Tools/ConnectionFactory.cs`:

```cs
using System.Configuration;
using System.Data.Common;
using System.Data.SqlServerCe;

namespace Arma3BEClient.Libs.Tools
{
    public class ConnectionFactory: IConnectionFactory
    {
        public DbConnection Create()
        {
            var connString = ConfigurationManager.ConnectionStrings["Arma3BEClientEntities"].ConnectionString;
            var connection =  new SqlCeConnection(connString);
            return connection;
        }
    }

    public interface IConnectionFactory
    {
        DbConnection Create();
    }
}

```

`src/Arma3BE.Client.Libs/Tools/ISettingsStore.cs`:

```cs
using System;

namespace Arma3BEClient.Libs.Tools
{
    public interface ISettingsStore : ICloneable
    {
        string AdminName { get; set; }

        string BanMessageTemplate { get; set; }
        string KickMessageTemplate { get; set; }

        int BansUpdateSeconds { get; set; }
        int PlayersUpdateSeconds { get; set; }
        TimeZoneInfo TimeZoneInfo { get; set; }

        bool TopMost { get; set; }

        string SteamFolder { get; set; }

        void Save();
    }


    public interface ICustomSettingsStore
    {
        void Save(string key, string value);
        string Load(string key);

        void Save<T>(string key, T value);
        T Load<T>(string key);
    }

    public interface ISettingsStoreSource
    {
        ISettingsStore GetSettingsStore();
        ICustomSettingsStore GetCustomSettingsStore();
    }

    public class SettingsStoreSource : ISettingsStoreSource
    {
        public ISettingsStore GetSettingsStore()
        {
            return SettingsStore.Instance;
        }

        public ICustomSettingsStore GetCustomSettingsStore()
        {
            return CustomSettingsStore.Instance;
        }
    }
}
```

`src/Arma3BE.Client.Libs/Tools/ISteamService.cs`:

```cs
using System.Collections;
using System.Collections.Generic;
using System.Threading;

namespace Arma3BEClient.Libs.Tools
{
    public interface ISteamService
    {
        bool IsReady();
        long? GetSteamId(string hash);
        Dictionary<string, long> GetSteamIds(string[] hashes);
        Dictionary<string, long> GetSteamIds(string[] hashes, CancellationToken token);
    }
}
```

`src/Arma3BE.Client.Libs/Tools/Settings.cs`:

```cs
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Libs.Context;
using Arma3BEClient.Libs.ModelCompact;
using System;
using System.Collections.Concurrent;
using System.Data.Entity.Migrations;
using System.IO;
using System.Linq;
using System.Text;
using System.Xml.Serialization;

namespace Arma3BEClient.Libs.Tools
{
    internal class SettingsStore : ISettingsStore
    {
        private const int AdminNameKey = 1;
        private const int TimeZoneKey = 2;
        private const int PlayersUpdateKey = 3;
        private const int BansUpdateKey = 4;

        private const int BanMessageTemplateKey = 5;
        private const int KickMessageTemplateKey = 6;

        private const int TopMostKey = 7;

        private const int SteamFolderKey = 8;

        public string AdminName { get; set; }

        public string BanMessageTemplate { get; set; }
        public string KickMessageTemplate { get; set; }

        public TimeZoneInfo TimeZoneInfo { get; set; }
        public int PlayersUpdateSeconds { get; set; }
        public int BansUpdateSeconds { get; set; }

        public bool TopMost { get; set; }

        public string SteamFolder { get; set; }


        private static SettingsStore _instance;
        public static SettingsStore Instance => _instance ?? (_instance = Load());

        public void Save()
        {
            using (var context = new Arma3BeClientContext())
            {
                context.Settings.AddOrUpdate(
                    new Settings { Id = AdminNameKey, Value = AdminName },
                    new Settings { Id = TimeZoneKey, Value = TimeZoneInfo?.Id },
                    new Settings { Id = PlayersUpdateKey, Value = PlayersUpdateSeconds.ToString() },
                    new Settings { Id = BansUpdateKey, Value = BansUpdateSeconds.ToString() },
                    new Settings { Id = BanMessageTemplateKey, Value = BanMessageTemplate },
                    new Settings { Id = KickMessageTemplateKey, Value = KickMessageTemplate },
                    new Settings { Id = TopMostKey, Value = TopMost.ToString() },
                    new Settings { Id = SteamFolderKey, Value = SteamFolder }
                );

                context.SaveChanges();
                _instance = null;
            }
        }

        private static SettingsStore Load()
        {
            using (var context = new Arma3BeClientContext())
            {
                var settings = context.Settings.ToArray();

                var ss = new SettingsStore();
                ss.AdminName = settings.FirstOrDefault(x => x.Id == AdminNameKey)?.Value ?? "Admin";


                ss.BanMessageTemplate = settings.FirstOrDefault(x => x.Id == BanMessageTemplateKey)?.Value ??
                                        "[{AdminName}][{Date} {Time}] {Reason} {Minutes}";
                ss.KickMessageTemplate = settings.FirstOrDefault(x => x.Id == KickMessageTemplateKey)?.Value ??
                                         "[{AdminName}][{Date} {Time}] {Reason}";


                ss.PlayersUpdateSeconds = (settings.FirstOrDefault(x => x.Id == PlayersUpdateKey)?.Value).FromString(5);
                ss.BansUpdateSeconds = (settings.FirstOrDefault(x => x.Id == BansUpdateKey)?.Value).FromString(5);

                try
                {
                    var zone = settings.FirstOrDefault(x => x.Id == TimeZoneKey)?.Value;
                    ss.TimeZoneInfo = zone != null ? TimeZoneInfo.FindSystemTimeZoneById(zone) : TimeZoneInfo.Local;
                }
                catch (Exception)
                {
                    ss.TimeZoneInfo = TimeZoneInfo.Local;
                }

                ss.TopMost = bool.Parse(settings.FirstOrDefault(x => x.Id == TopMostKey)?.Value ?? bool.FalseString);

                ss.SteamFolder = settings.FirstOrDefault(x => x.Id == SteamFolderKey)?.Value;

                return ss;
            }
        }

        public object Clone()
        {
            return new SettingsStore
            {
                TimeZoneInfo = TimeZoneInfo,
                AdminName = AdminName,
                BansUpdateSeconds = BansUpdateSeconds,
                PlayersUpdateSeconds = PlayersUpdateSeconds,
                BanMessageTemplate = BanMessageTemplate,
                KickMessageTemplate = KickMessageTemplate,
                TopMost = TopMost,
                SteamFolder = SteamFolder
            };
        }
    }

    public class CustomSettingsStore : ICustomSettingsStore
    {
        readonly ConcurrentDictionary<string, string> _cache = new ConcurrentDictionary<string, string>();


        private static readonly Lazy<CustomSettingsStore> _instance =
            new Lazy<CustomSettingsStore>(() => new CustomSettingsStore());

        public static CustomSettingsStore Instance => _instance.Value;

        public void Save(string key, string value)
        {
            _cache.AddOrUpdate(key, k => value, (k, v) => value);
            SaveInternal(key, value);
        }

        public string Load(string key)
        {
            var rrr = _cache.GetOrAdd(key, LoadInternal);
            return rrr;
        }

        public void Save<T>(string key, T value)
        {
            var ser = new XmlSerializer(typeof(T));

            var sb = new StringBuilder();

            using (var sw = new StringWriter(sb))
            {
                ser.Serialize(sw, value);
            }

            Save(key, sb.ToString());
        }

        public T Load<T>(string key)
        {
            var data = Load(key);
            if (string.IsNullOrEmpty(data)) return default(T);

            var ser = new XmlSerializer(typeof(T));
            using (var sr = new StringReader(data))
            {
                return (T)ser.Deserialize(sr);
            }
        }

        private string LoadInternal(string key)
        {
            using (var context = new Arma3BeClientContext())
            {
                return context.CustomSettings.FirstOrDefault(x => x.Id == key)?.Value;
            }
        }

        private void SaveInternal(string key, string value)
        {
            using (var context = new Arma3BeClientContext())
            {
                context.CustomSettings.AddOrUpdate(new CustomSettings { Id = key, Value = value });
                context.SaveChanges();
            }
        }
    }
}
```

`src/Arma3BE.Client.Libs/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="EntityFramework" version="6.1.3" targetFramework="net452" />
  <package id="EntityFramework.SqlServerCompact" version="6.1.3" targetFramework="net452" />
  <package id="Microsoft.SqlServer.Compact" version="4.0.8876.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.AdminsModule/AdminsModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.AdminsModule.Grids;
using Arma3BE.Client.Modules.AdminsModule.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.AdminsModule
{
    public class AdminsModuleInit : IModule
    {
        private readonly IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public AdminsModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.ServerTabPartRegion, CreateView);
        }

        private object CreateView()
        {
            return ServerTabViewHelper.RegisterView<AdminsControl, ServerInfoDto, ServerMonitorAdminsViewModel>(_container,
                "serverInfo");
        }
    }
}
```

`src/Arma3BE.Client.Modules.AdminsModule/Arma3BE.Client.Modules.AdminsModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{50E80FCC-87BD-4982-901E-38FD22482D02}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.AdminsModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.AdminsModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="AdminsModuleInit.cs" />
    <Compile Include="Grids\AdminsControl.xaml.cs">
      <DependentUpon>AdminsControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="Helpers\AdminHelper.cs" />
    <Compile Include="Models\ServerMonitorAdminsViewModel.cs" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="Grids\AdminsControl.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.AdminsModule/Grids/AdminsControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.AdminsModule.Grids.AdminsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
             mc:Ignorable="d">
    <UserControl.Resources>
        <converters:BisyBoolToColorConverter x:Uid="local:BisyBoolToColorConverter"
                                                     x:Key="BisyBoolToColorConverter" />
    </UserControl.Resources>
    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <ToolBar Height="30">
            <Button Command="{Binding RefreshCommand, Mode=OneWay}" BorderThickness="1" BorderBrush="{Binding WaitingForEvent, Mode=OneWay, Converter={StaticResource BisyBoolToColorConverter}}">
                <!-- ReSharper disable once Xaml.StaticResourceNotResolved -->
                <Image Source="{StaticResource refresh_icon}" Height="16" Width="16" />
            </Button>


            <Separator />
            <TextBlock Margin="2" HorizontalAlignment="Right" VerticalAlignment="Center"
                       Text="{Binding DataCount, Mode=OneWay, StringFormat=Total: {0}}" />


        </ToolBar>

        <xcdg:DataGridControl Grid.Row="1" ItemsSource="{Binding Data, Mode=OneWay}" AutoCreateColumns="False"
                              ReadOnly="True" Name="dg">

            <xcdg:DataGridControl.View>
                <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                    <xcdg:TableView.FixedHeaders>
                        <DataTemplate>
                            <xcdg:ColumnManagerRow />
                        </DataTemplate>
                    </xcdg:TableView.FixedHeaders>
                </xcdg:TableflowView>
            </xcdg:DataGridControl.View>

        </xcdg:DataGridControl>


    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.AdminsModule/Grids/AdminsControl.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Server.Models;
using Prism.Regions;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.AdminsModule.Grids
{
    /// <summary>
    ///     Interaction logic for AdminsControl.xaml
    /// </summary>
    [ViewSortHint("0300")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class AdminsControl : UserControl
    {
        public AdminsControl()
        {
            InitializeComponent();

            dg.LoadState<Admin>(GetType().FullName);
            dg.ContextMenu = dg.Generate<Admin>();
        }
    }
}
```

`src/Arma3BE.Client.Modules.AdminsModule/Helpers/AdminHelper.cs`:

```cs
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BEClient.Libs.Repositories;
using System;
using System.Collections.Generic;
using System.Threading.Tasks;
using Admin = Arma3BE.Server.Models.Admin;

namespace Arma3BE.Client.Modules.AdminsModule.Helpers
{
    public class AdminHelper : StateHelper<Admin>
    {
        private readonly Guid _serverInfoId;

        public AdminHelper(Guid serverInfoId)
        {
            _serverInfoId = serverInfoId;
        }

        public Task RegisterAdminsAsync(IEnumerable<Admin> list)
        {
            using (var repo = new AdminRepository())
            {
                return repo.AddOrUpdateAsync(list, _serverInfoId);
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.AdminsModule/Models/ServerMonitorAdminsViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.AdminsModule.Helpers;
using Arma3BE.Server;
using Arma3BEClient.Libs.Repositories;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Admin = Arma3BE.Server.Models.Admin;

namespace Arma3BE.Client.Modules.AdminsModule.Models
{
    public class ServerMonitorAdminsViewModel : ServerMonitorBaseViewModel<Admin, Admin>
    {
        private readonly AdminHelper _helper;

        public ServerMonitorAdminsViewModel(ServerInfoDto serverInfo, IEventAggregator eventAggregator)
            : base(new ActionCommand(() => SendCommand(eventAggregator, serverInfo.Id, CommandType.Admins)), new AdminComparer())
        {
            _helper = new AdminHelper(serverInfo.Id);

            eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Admin>>>().Subscribe(async e =>
            {
                if (e.ServerId == serverInfo.Id)
                {
                    await SetDataAsync(e.Items);
                    WaitingForEvent = false;
                }
            });
        }

        public string Title => "Admins";

        protected override async Task<IEnumerable<Admin>> RegisterDataAsync(IEnumerable<Admin> initialData)
        {
            var enumerable = initialData as IList<Admin> ?? initialData.ToList();
            await _helper.RegisterAdminsAsync(enumerable);
            return enumerable;
        }

        private static void SendCommand(IEventAggregator eventAggregator, Guid serverId, CommandType commandType,
            string parameters = null)
        {
            eventAggregator.GetEvent<BEMessageEvent<BECommand>>()
                .Publish(new BECommand(serverId, commandType, parameters));
        }

        private class AdminComparer : IEqualityComparer<Admin>
        {
            public bool Equals(Admin x, Admin y)
            {
                return x.Num == y.Num && x.IP == y.IP && x.Port == y.Port;
            }

            public int GetHashCode(Admin obj)
            {
                return obj.GetHashCode();
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.AdminsModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.BEServerModule.Tests/Arma3BE.Client.Modules.BEServerModule.Tests.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.BEServerModule.Tests</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.BEServerModule.Tests</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
    <ReferencePath>$(ProgramFiles)\Common Files\microsoft shared\VSTT\$(VisualStudioVersion)\UITestExtensionPackages</ReferencePath>
    <IsCodedUITest>False</IsCodedUITest>
    <TestProjectType>UnitTest</TestProjectType>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Castle.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=407dd0808d44fbdc, processorArchitecture=MSIL">
      <HintPath>..\packages\Castle.Core.4.0.0\lib\net45\Castle.Core.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Moq, Version=4.7.10.0, Culture=neutral, PublicKeyToken=69f491c39445e920, processorArchitecture=MSIL">
      <HintPath>..\packages\Moq.4.7.10\lib\net45\Moq.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
  </ItemGroup>
  <Choose>
    <When Condition="('$(VisualStudioVersion)' == '10.0' or '$(VisualStudioVersion)' == '') and '$(TargetFrameworkVersion)' == 'v3.5'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework, Version=10.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
      </ItemGroup>
    </When>
    <Otherwise>
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework" />
      </ItemGroup>
    </Otherwise>
  </Choose>
  <ItemGroup>
    <Compile Include="BEServiceLogicTests.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.BEServerModule\Arma3BE.Client.Modules.BEServerModule.csproj">
      <Project>{35dba2b4-0519-44cf-ba45-7aa6754866fd}</Project>
      <Name>Arma3BE.Client.Modules.BEServerModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client\Arma3BE.Client.csproj">
      <Project>{46b9af55-01d0-45b0-95cb-16f5b61a9f03}</Project>
      <Name>Arma3BE.Client</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <None Include="app.config" />
    <None Include="packages.config" />
  </ItemGroup>
  <Choose>
    <When Condition="'$(VisualStudioVersion)' == '10.0' And '$(IsCodedUITest)' == 'True'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.CodedUITestFramework, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Extension, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITesting, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
      </ItemGroup>
    </When>
  </Choose>
  <Import Project="$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets" Condition="Exists('$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets')" />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.BEServerModule.Tests/BEServiceLogicTests.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Server;
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.ModelCompact;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Moq;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using Arma3BEClient.Libs.Repositories;

namespace Arma3BE.Client.Modules.BEServerModule.Tests
{
    [TestClass]
    public class BEServiceLogicTests
    {
        [TestMethod]
        public void Player_Log_Test()
        {
            var serverGuid = Guid.NewGuid();

            var ev = new FakeEventAggregator();

            var logic = new BELogic(ev);

            BECommand command = null;

            logic.ServerUpdateHandler += (s, e) =>
            {
                command = e.Command;
            };


            ev.GetEvent<BEMessageEvent<BEPlayerLogMessage>>()
               .Publish(new BEPlayerLogMessage(new LogMessage(), serverGuid));


            Assert.IsNotNull(command);
            Assert.AreEqual(CommandType.Players, command.CommandType);

            GC.KeepAlive(logic);
        }

        [TestMethod]
        public void Admin_Test()
        {
            var serverGuid = Guid.NewGuid();

            var ev = new FakeEventAggregator();

            var logic = new BELogic(ev);

            BECommand command = null;

            logic.ServerUpdateHandler += (s, e) =>
            {
                command = e.Command;
            };


            ev.GetEvent<BEMessageEvent<BEAdminLogMessage>>()
               .Publish(new BEAdminLogMessage(new LogMessage(), serverGuid));


            Assert.IsNotNull(command);
            Assert.AreEqual(CommandType.Admins, command.CommandType);

            GC.KeepAlive(logic);
        }


        [TestMethod]
        public void Connect_Test()
        {
            var serverGuid = Guid.NewGuid();

            var ev = new FakeEventAggregator();

            var logic = new BELogic(ev);

            var commands = new List<BECommand>();
            var immediateCommands = new List<BECommand>();

            logic.ServerUpdateHandler += (s, e) =>
            {
                commands.Add(e.Command);
            };

            logic.ServerImmediateUpdateHandler += (s, e) =>
            {
                immediateCommands.Add(e.Command);
            };


            ev.GetEvent<ConnectServerEvent>()
               .Publish(new ServerInfoDto() { Id = serverGuid });

            Assert.IsNotNull(immediateCommands);
            Assert.IsNotNull(immediateCommands.FirstOrDefault(x => x.CommandType == CommandType.Players && x.ServerId == serverGuid));

            Assert.IsNotNull(commands);
            Assert.IsNotNull(commands.FirstOrDefault(x => x.CommandType == CommandType.Bans && x.ServerId == serverGuid));
            Assert.IsNotNull(commands.FirstOrDefault(x => x.CommandType == CommandType.Admins && x.ServerId == serverGuid));
            Assert.IsNotNull(commands.FirstOrDefault(x => x.CommandType == CommandType.Missions && x.ServerId == serverGuid));

            GC.KeepAlive(logic);
        }


        [TestMethod]
        public void Player_Ban_Test()
        {
            var serverGuid = Guid.NewGuid();

            var ev = new FakeEventAggregator();

            var logic = new BELogic(ev);

            var commands = new List<BECommand>();

            logic.ServerUpdateHandler += (s, e) =>
            {
                commands.Add(e.Command);
            };


            ev.GetEvent<BEMessageEvent<BEBanLogMessage>>()
               .Publish(new BEBanLogMessage(new LogMessage(), serverGuid));

            Assert.IsNotNull(commands);
            Assert.IsNotNull(commands.FirstOrDefault(x => x.CommandType == CommandType.Bans && x.ServerId == serverGuid));
            Assert.IsNotNull(commands.FirstOrDefault(x => x.CommandType == CommandType.Players && x.ServerId == serverGuid));

            GC.KeepAlive(logic);
        }
    }

    class FakeEventAggregator : IEventAggregator
    {
        private readonly Dictionary<string, EventBase> _events = new Dictionary<string, EventBase>();

        public TEventType GetEvent<TEventType>() where TEventType : EventBase, new()
        {
            var evType = typeof(TEventType);
            var typeArgs = new List<Type> { evType };

            typeArgs.AddRange(GetGenericArguments(evType));

            var method = typeof(FakeEventAggregator).GetMethod(nameof(CreateEvent), BindingFlags.NonPublic | BindingFlags.Instance);
            var generic = method.MakeGenericMethod(typeArgs.ToArray());

            return generic.Invoke(this, null) as TEventType;
        }

        private Type[] GetGenericArguments(Type source)
        {
            if (source.IsGenericType) return source.GenericTypeArguments;
            if (source.BaseType != null) return GetGenericArguments(source.BaseType);
            return null;
        }

        private EventBase CreateEvent<T, TK>() where T : PubSubEvent<TK>
        {
            var sId = typeof(T).FullName;

            if (_events.ContainsKey(sId)) return _events[sId];

            var mockedEvent = new Mock<T>();
            var cont = new ActionContainer<TK>();

            mockedEvent.Setup(x =>
            x.Subscribe(
                It.IsAny<Action<TK>>(),
                It.IsAny<ThreadOption>(),
                It.IsAny<bool>(),
                It.IsAny<Predicate<TK>>()
                ))
                .Callback<Action<TK>, ThreadOption, bool, Predicate<TK>>(
                    (a, o, b, p) =>
                    {
                        cont.Inner = a;
                    });

            mockedEvent.Setup(x => x.Publish(It.IsAny<TK>()))
                .Callback<TK>(m =>
                {
                    cont.Inner(m);
                });


            _events.Add(sId, mockedEvent.Object);

            return mockedEvent.Object;
        }


        private class ActionContainer<T>
        {
            public Action<T> Inner { get; set; }
        }
    }
}

```

`src/Arma3BE.Client.Modules.BEServerModule.Tests/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Runtime.InteropServices;

// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
[assembly: AssemblyTitle("Arma3BE.Client.Modules.BEServerModule.Tests")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("Arma3BE.Client.Modules.BEServerModule.Tests")]
[assembly: AssemblyCopyright("Copyright ©  2016")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Setting ComVisible to false makes the types in this assembly not visible 
// to COM components.  If you need to access a type in this assembly from 
// COM, set the ComVisible attribute to true on that type.
[assembly: ComVisible(false)]

// The following GUID is for the ID of the typelib if this project is exposed to COM
[assembly: Guid("fa11fea6-31fa-4a53-afb0-dcb23ce48ecf")]

// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Build and Revision Numbers 
// by using the '*' as shown below:
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]

```

`src/Arma3BE.Client.Modules.BEServerModule.Tests/app.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Prism" publicKeyToken="91a96d2a154366d8" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-6.2.0.0" newVersion="6.2.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Prism.Wpf" publicKeyToken="91a96d2a154366d8" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-6.1.0.0" newVersion="6.1.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-10.0.0.0" newVersion="10.0.0.0" />
      </dependentAssembly>     
    </assemblyBinding>
  </runtime>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" /></startup></configuration>

```

`src/Arma3BE.Client.Modules.BEServerModule.Tests/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Castle.Core" version="4.0.0" targetFramework="net452" />
  <package id="Moq" version="4.7.10" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.BEServerModule/Arma3BE.Client.Modules.BEServerModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{35DBA2B4-0519-44CF-BA45-7AA6754866FD}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.BEServerModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.BEServerModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Akka, Version=1.2.0.33, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\Akka.1.2.0\lib\net45\Akka.dll</HintPath>
    </Reference>
    <Reference Include="Akka.DI.Core, Version=1.2.0.33, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\Akka.DI.Core.1.2.0\lib\net45\Akka.DI.Core.dll</HintPath>
    </Reference>
    <Reference Include="Akka.DI.Unity, Version=1.1.0.2, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\Akka.DI.Unity.1.1.0\lib\net45\Akka.DI.Unity.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Newtonsoft.Json, Version=10.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed, processorArchitecture=MSIL">
      <HintPath>..\packages\Newtonsoft.Json.10.0.2\lib\net45\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Collections.Immutable, Version=1.2.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Collections.Immutable.1.3.1\lib\portable-net45+win8+wp8+wpa81\System.Collections.Immutable.dll</HintPath>
    </Reference>
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="BELogic.cs" />
    <Compile Include="BELogicItems\LobbyKicker.cs" />
    <Compile Include="BEServerModuleInit.cs" />
    <Compile Include="BEService.cs" />
    <Compile Include="BEServiceLogic.cs" />
    <Compile Include="IBELogic.cs" />
    <Compile Include="IBELogicItem.cs" />
    <Compile Include="IBEService.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="app.config" />
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.BEServerModule/BELogic.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Server;
using Prism.Events;
using System;
using System.Threading.Tasks;
using Arma3BEClient.Libs.Repositories;

namespace Arma3BE.Client.Modules.BEServerModule
{
    public sealed class BELogic : IBELogic
    {
        public BELogic(IEventAggregator aggregator)
        {
            var aggregator1 = aggregator;

            aggregator1.GetEvent<BEMessageEvent<BECommand>>().Subscribe(ProcessCommand, ThreadOption.BackgroundThread);
            aggregator1.GetEvent<BEMessageEvent<BEPlayerLogMessage>>().Subscribe(BEPlayerLogMessage, ThreadOption.BackgroundThread);
            aggregator1.GetEvent<BEMessageEvent<BEBanLogMessage>>().Subscribe(BEBanLogMessage, ThreadOption.BackgroundThread);
            aggregator1.GetEvent<BEMessageEvent<BEAdminLogMessage>>().Subscribe(BEAdminLogMessage, ThreadOption.BackgroundThread);
            aggregator1.GetEvent<ConnectServerEvent>().Subscribe(BeServerConnectHandler, ThreadOption.BackgroundThread);
        }

        public event EventHandler<ServerCommandEventArgs> ServerUpdateHandler;
        public event EventHandler<ServerCommandEventArgs> ServerImmediateUpdateHandler;

        private void ProcessCommand(BECommand command)
        {
            if (command.CommandType == CommandType.RemoveBan || command.CommandType == CommandType.AddBan ||
                command.CommandType == CommandType.Ban)
            {
                Task.Delay(2000).ContinueWith(t =>
                {
                    OnServerUpdateHandler(new BECommand(command.ServerId, CommandType.Bans));
                });
            }
        }

        private void BeServerConnectHandler(ServerInfoDto info)
        {
            OnServerImmediateUpdateHandler(new BECommand(info.Id, CommandType.Players));

            OnServerUpdateHandler(new BECommand(info.Id, CommandType.Bans));
            OnServerUpdateHandler(new BECommand(info.Id, CommandType.Missions));
            OnServerUpdateHandler(new BECommand(info.Id, CommandType.Admins));
        }

        private void BEPlayerLogMessage(BEPlayerLogMessage message)
        {
            OnServerUpdateHandler(new BECommand(message.ServerId, CommandType.Players));
        }

        private void BEAdminLogMessage(BEAdminLogMessage message)
        {
            OnServerUpdateHandler(new BECommand(message.ServerId, CommandType.Admins));
        }

        private void BEBanLogMessage(BEBanLogMessage message)
        {
            OnServerUpdateHandler(new BECommand(message.ServerId, CommandType.Players));
            OnServerUpdateHandler(new BECommand(message.ServerId, CommandType.Bans));
        }

        private void OnServerUpdateHandler(BECommand command)
        {
            ServerUpdateHandler?.Invoke(this, new ServerCommandEventArgs(command));
        }

        private void OnServerImmediateUpdateHandler(BECommand command)
        {
            ServerImmediateUpdateHandler?.Invoke(this, new ServerCommandEventArgs(command));
        }
    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/BELogicItems/LobbyKicker.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Settings;
using Arma3BE.Server;
using Arma3BE.Server.Models;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Tools;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Client.Modules.BEServerModule.BELogicItems
{
    public class LobbyKicker : IBELogicItem
    {
        private readonly IEventAggregator _aggregator;
        private readonly ISettingsStoreSource _settingsStoreSource;

        private Dictionary<Guid, LobbyIdleStore> _servers = new Dictionary<Guid, LobbyIdleStore>();


        private readonly ILog _logger = new Log();


        public LobbyKicker(IEventAggregator aggregator, ISettingsStoreSource settingsStoreSource)
        {
            _aggregator = aggregator;
            _settingsStoreSource = settingsStoreSource;
            _aggregator.GetEvent<BEMessageEvent<BEItemsMessage<Player>>>()
                .Subscribe(PlayersUpdate);
        }

        private void PlayersUpdate(BEItemsMessage<Player> data)
        {
            try
            {
                var settingsStore = _settingsStoreSource.GetCustomSettingsStore();
                var serversSettings = settingsStore.Load<ServerSettings>(data.ServerId.ToString());

                if (serversSettings?.IdleTimeInMins > 0 && serversSettings?.KickIdlePlayers == true)
                {
                    var idleTime = serversSettings.IdleTimeInMins;
                    if (!_servers.ContainsKey(data.ServerId)) _servers.Add(data.ServerId, new LobbyIdleStore());
                    var items = data.Items.ToArray();
                    _servers[data.ServerId].Update(items);

                    var span = TimeSpan.FromMinutes(idleTime);
                    var idlePlayers = _servers[data.ServerId].GetIdlePlayers(span, items);

                    var reason = serversSettings.IdleKickReason;

                    foreach (var idlePlayer in idlePlayers)
                    {
                        _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                            .Publish(new BECommand(data.ServerId, CommandType.Kick, $"{idlePlayer} {reason}"));
                    }
                }
            }
            catch (Exception e)
            {
                _logger.Error(e);
            }
        }

        private class LobbyIdleStore
        {
            private Dictionary<int, DateTime> _idlePlayers = new Dictionary<int, DateTime>();

            public IEnumerable<int> GetIdlePlayers(TimeSpan span, Server.Models.Player[] players)
            {
                var now = DateTime.UtcNow;
                var target = now.Add(span.Negate());

                return players.Where(x => x.State == Player.PlayerState.Lobby).Where(x => _idlePlayers[x.Num] < target).Select(x => x.Num).ToArray();
            }

            public void Update(Server.Models.Player[] players)
            {
                var now = DateTime.UtcNow;
                var set = new HashSet<int>(players.Select(x => x.Num));
                var remove = _idlePlayers.Keys.Where(x => !set.Contains(x)).ToArray();
                foreach (var i in remove)
                {
                    _idlePlayers.Remove(i);
                }
                foreach (var p in players)
                {
                    if (!_idlePlayers.ContainsKey(p.Num))
                    {
                        _idlePlayers.Add(p.Num, now);
                    }
                    else
                    {
                        if (p.State != Player.PlayerState.Lobby)
                        {
                            _idlePlayers[p.Num] = now;
                        }
                    }
                }
            }

        }
    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/BEServerModuleInit.cs`:

```cs
using Arma3BE.Client.Modules.BEServerModule.BELogicItems;
using Microsoft.Practices.Unity;
using Prism.Modularity;

namespace Arma3BE.Client.Modules.BEServerModule
{
    public class BEServerModuleInit : IModule
    {
        private readonly IUnityContainer _container;

        public BEServerModuleInit(IUnityContainer container)
        {
            _container = container;
        }

        public void Initialize()
        {
            _container.RegisterInstance<IBELogic>(_container.Resolve<BELogic>());
            _container.RegisterInstance<IBEService>(_container.Resolve<BEService>());
            _container.RegisterInstance(_container.Resolve<BEServiceLogic>());


            _container.RegisterInstance(_container.Resolve<LobbyKicker>());
        }
    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/BEService.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Server;
using Arma3BE.Server.Abstract;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Events;
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;

// ReSharper disable MemberCanBePrivate.Local

namespace Arma3BE.Client.Modules.BEServerModule
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class BEService : IBEService
    {
        private readonly IUnityContainer _container;
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private readonly IIpService _ipService;
        private readonly IEventAggregator _eventAggregator;
        private readonly ConcurrentDictionary<Guid, ServerItem> _serverPool = new ConcurrentDictionary<Guid, ServerItem>();

        public BEService(IUnityContainer container, IIpService ipService, IEventAggregator eventAggregator)
        {
            _container = container;
            _ipService = ipService;
            _eventAggregator = eventAggregator;

            _eventAggregator.GetEvent<RunServerEvent>().Subscribe(CheckServer, ThreadOption.BackgroundThread);
            _eventAggregator.GetEvent<CloseServerEvent>().Subscribe(CloseServer, ThreadOption.BackgroundThread);
        }

        public IEnumerable<Guid> ConnectedServers()
        {
            return _serverPool.Keys.ToArray();
        }

        private void CloseServer(ServerInfoDto info)
        {
            ServerItem item;

            if (_serverPool.TryRemove(info.Id, out item))
            {
                item.Dispose();
            }
        }

        private void CheckServer(ServerInfoDto info)
        {
            var item = _serverPool.GetOrAdd(info.Id, id => Create(info));
            if (!item.BEServer.Connected) item.BEServer.Connect();
        }

        private ServerItem Create(ServerInfoDto info)
        {
            return new ServerItem(info, CreateServer(info), _eventAggregator);
        }

        private IBEServer CreateServer(ServerInfoDto info)
        {
            var host = _ipService.GetIpAddress(info.Host);

            if (string.IsNullOrEmpty(host))
            {
                var message = $"Host {info.Host} is incorrect for server {info.Name}";
                _log.Error(message);
            }

            var server = _container.Resolve<BEServer>(new ParameterOverride("host", host),
                new ParameterOverride("port", info.Port),
                new ParameterOverride("password", info.Password));

            return server;
        }

        private class ServerItem : DisposeObject
        {
            private readonly IEventAggregator _eventAggregator;
            public ServerInfoDto Info { get; }
            public IBEServer BEServer { get; }

            public ServerItem(ServerInfoDto info, IBEServer beServer, IEventAggregator eventAggregator)
            {
                _eventAggregator = eventAggregator;
                Info = info;
                BEServer = beServer;

                BEServer.PlayerHandler += BEServer_PlayerHandler;
                BEServer.AdminHandler += BEServer_AdminHandler;
                BEServer.BanHandler += BEServer_BanHandler;
                BEServer.MissionHandler += BEServer_MissionHandler;

                BEServer.BanLog += BEServer_BanLog;
                BEServer.RConAdminLog += BEServer_RConAdminLog;
                BEServer.PlayerLog += BEServer_PlayerLog;

                BEServer.ChatMessageHandler += BEServer_ChatMessageHandler;

                BEServer.ConnectHandler += BEServer_ConnectHandler;
                BEServer.ConnectingHandler += BEServer_ConnectingHandler;
                BEServer.DisconnectHandler += BEServer_DisconnectHandler;

                BEServer.MessageHandler += BEServer_MessageHandler;

                _eventAggregator.GetEvent<BEMessageEvent<BECommand>>().Subscribe(Command);
                _eventAggregator.GetEvent<BEMessageEvent<BECustomCommand>>().Subscribe(CustomCommand);
            }

            private void BEServer_MessageHandler(object sender, EventArgs e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEMessage>>()
                    .Publish(new BEMessage(Info.Id));
            }

            private void BEServer_DisconnectHandler(object sender, EventArgs e)
            {
                _eventAggregator.GetEvent<DisConnectServerEvent>()
                    .Publish(Info);
            }

            private void BEServer_ConnectingHandler(object sender, EventArgs e)
            {
                _eventAggregator.GetEvent<ConnectingServerEvent>()
                    .Publish(Info);
            }

            private void BEServer_ConnectHandler(object sender, EventArgs e)
            {
                _eventAggregator.GetEvent<ConnectServerEvent>()
                    .Publish(Info);
            }

            protected override void DisposeManagedResources()
            {
                base.DisposeManagedResources();

                BEServer.PlayerHandler -= BEServer_PlayerHandler;
                BEServer.AdminHandler -= BEServer_AdminHandler;
                BEServer.BanHandler -= BEServer_BanHandler;
                BEServer.MissionHandler -= BEServer_MissionHandler;

                BEServer.BanLog -= BEServer_BanLog;
                BEServer.RConAdminLog -= BEServer_RConAdminLog;
                BEServer.PlayerLog -= BEServer_PlayerLog;

                BEServer.ChatMessageHandler -= BEServer_ChatMessageHandler;

                BEServer.ConnectHandler -= BEServer_ConnectHandler;
                BEServer.ConnectingHandler -= BEServer_ConnectingHandler;
                BEServer.DisconnectHandler -= BEServer_DisconnectHandler;

                BEServer.MessageHandler -= BEServer_MessageHandler;

                _eventAggregator.GetEvent<BEMessageEvent<BECommand>>().Unsubscribe(Command);
                _eventAggregator.GetEvent<BEMessageEvent<BECustomCommand>>().Unsubscribe(CustomCommand);

                BEServer.Disconnect();
                BEServer.Dispose();
            }

            private void BEServer_ChatMessageHandler(object sender, Server.Models.ChatMessage e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEChatMessage>>()
                    .Publish(new BEChatMessage(e, Info.Id));
            }

            private void BEServer_PlayerLog(object sender, Server.Models.LogMessage e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEPlayerLogMessage>>()
                    .Publish(new BEPlayerLogMessage(e, Info.Id));
            }

            private void BEServer_RConAdminLog(object sender, Server.Models.LogMessage e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEAdminLogMessage>>()
                    .Publish(new BEAdminLogMessage(e, Info.Id));
            }

            private void BEServer_BanLog(object sender, Server.Models.LogMessage e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEBanLogMessage>>()
                    .Publish(new BEBanLogMessage(e, Info.Id));
            }

            private void Command(BECommand command)
            {
                var server = BEServer;

                if (Info.Id == command.ServerId && server != null && server.Connected)
                {
                    server.SendCommand(command.CommandType, command.Parameters);
                }
            }

            private void CustomCommand(BECustomCommand command)
            {
                var server = BEServer;

                if (Info.Id == command.ServerId && server != null && server.Connected)
                {
                    server.SendCommand(command.Command);
                }
            }

            private void BEServer_MissionHandler(object sender, BEClientEventArgs<IEnumerable<Server.Models.Mission>> e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Server.Models.Mission>>>()
                    .Publish(new BEItemsMessage<Server.Models.Mission>(e.Data, Info.Id));
            }

            private void BEServer_BanHandler(object sender, BEClientEventArgs<IEnumerable<Server.Models.Ban>> e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Server.Models.Ban>>>()
                    .Publish(new BEItemsMessage<Server.Models.Ban>(e.Data, Info.Id));
            }

            private void BEServer_AdminHandler(object sender, BEClientEventArgs<IEnumerable<Server.Models.Admin>> e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Server.Models.Admin>>>()
                    .Publish(new BEItemsMessage<Server.Models.Admin>(e.Data, Info.Id));
            }

            private void BEServer_PlayerHandler(object sender, BEClientEventArgs<IEnumerable<Server.Models.Player>> e)
            {
                _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Server.Models.Player>>>()
                    .Publish(new BEItemsMessage<Server.Models.Player>(e.Data, Info.Id));
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/BEServiceLogic.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Server;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Tools;
using Prism.Events;
using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Threading;

namespace Arma3BE.Client.Modules.BEServerModule
{
    public class BEServiceLogic : DisposeObject
    {
        private readonly IEventAggregator _aggregator;
        private readonly IBEService _beService;
        private readonly ISettingsStoreSource _settingsStoreSource;
        private readonly IBELogic _beLogic;

        private readonly TimedAction _playersUpdater;
        private readonly TimedAction _bansUpdater;

        private readonly TimedAction _adminsUpdater;
        private readonly TimedAction _missionsUpdater;

        public BEServiceLogic(IEventAggregator aggregator, IBEService beService, ISettingsStoreSource settingsStoreSource, IBELogic beLogic)
        {
            _aggregator = aggregator;
            _beService = beService;
            _settingsStoreSource = settingsStoreSource;
            _beLogic = beLogic;

            _playersUpdater = new TimedAction(_settingsStoreSource.GetSettingsStore().PlayersUpdateSeconds, UpdatePlayers);
            _bansUpdater = new TimedAction(_settingsStoreSource.GetSettingsStore().BansUpdateSeconds, UpdateBans);

            _adminsUpdater = new TimedAction(3, UpdateAdmins);
            _missionsUpdater = new TimedAction(4, UpdateMissions);


            _aggregator.GetEvent<SettingsChangedEvent>()
                .Subscribe(SettingsChanged);


            _beLogic.ServerUpdateHandler += _beLogic_ServerUpdateHandler;
            _beLogic.ServerImmediateUpdateHandler += _beLogic_ServerImmediateUpdateHandler;

        }

        private void _beLogic_ServerImmediateUpdateHandler(object sender, ServerCommandEventArgs e)
        {
            _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                       .Publish(e.Command);
        }

        private void _beLogic_ServerUpdateHandler(object sender, ServerCommandEventArgs e)
        {
            switch (e.Command.CommandType)
            {
                case CommandType.Players:
                    _playersUpdater.Update(e.Command.ServerId);
                    break;
                case CommandType.Bans:
                    _bansUpdater.Update(e.Command.ServerId);
                    break;

                case CommandType.Admins:
                    _adminsUpdater.Update(e.Command.ServerId);
                    break;
                case CommandType.Missions:
                    _missionsUpdater.Update(e.Command.ServerId);
                    break;

                default:
                    _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                        .Publish(e.Command);
                    break;
            }
        }

        private void SettingsChanged(ISettingsStore settings)
        {
            _playersUpdater.SetTimer(_settingsStoreSource.GetSettingsStore().PlayersUpdateSeconds);
            _bansUpdater.SetTimer(_settingsStoreSource.GetSettingsStore().BansUpdateSeconds);
        }

        private void UpdatePlayers(HashSet<Guid> servers)
        {
            foreach (var server in _beService.ConnectedServers())
            {
                if (servers.Contains(server))
                {
                    _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                        .Publish(new BECommand(server, CommandType.Players));
                }
            }
        }

        private void UpdateBans(HashSet<Guid> servers)
        {
            foreach (var server in _beService.ConnectedServers())
            {
                if (servers.Contains(server))
                {
                    _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                        .Publish(new BECommand(server, CommandType.Bans));
                }
            }
        }


        private void UpdateAdmins(HashSet<Guid> servers)
        {
            foreach (var server in _beService.ConnectedServers())
            {
                if (servers.Contains(server))
                {
                    _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                        .Publish(new BECommand(server, CommandType.Admins));
                }
            }
        }

        private void UpdateMissions(HashSet<Guid> servers)
        {
            foreach (var server in _beService.ConnectedServers())
            {
                if (servers.Contains(server))
                {
                    _aggregator.GetEvent<BEMessageEvent<BECommand>>()
                        .Publish(new BECommand(server, CommandType.Missions));
                }
            }
        }


        protected override void DisposeManagedResources()
        {
            base.DisposeManagedResources();

            _beLogic.ServerUpdateHandler -= _beLogic_ServerUpdateHandler;
            _playersUpdater?.Dispose();
            _bansUpdater?.Dispose();
        }
    }

    public class TimedAction : DisposeObject
    {
        private int _interval;
        private readonly Action<HashSet<Guid>> _action;
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        private Timer _timer;

        private readonly ConcurrentDictionary<Guid, byte> _servers = new ConcurrentDictionary<Guid, byte>();

        public TimedAction(int interval, Action<HashSet<Guid>> action)
        {
            _interval = interval;
            _action = action;

            _timer = new Timer(Tick, null, Interval(), Timeout.Infinite);
        }

        public void Update(Guid server)
        {
            _servers.AddOrUpdate(server, 0, (guid, b) => b);
        }

        public void SetTimer(int intervalInSeconds)
        {
            _timer?.Dispose();
            _timer = null;
            _interval = intervalInSeconds;
            _timer = new Timer(Tick, null, Interval(), Timeout.Infinite);
        }

        private int Interval()
        {
            var i = _interval;
            return Math.Max(5000, i * 1000);
        }

        private void Tick(object state)
        {
            try
            {
                if (_servers.Any())
                {
                    var set = new HashSet<Guid>(_servers.Keys.ToArray());
                    _servers.Clear();
                    _action(set);
                }
            }
            catch (Exception ex)
            {
                _log.Error(ex);
            }
            finally
            {
                _timer?.Change(Interval(), Timeout.Infinite);
            }
        }

        protected override void DisposeManagedResources()
        {
            base.DisposeManagedResources();
            _timer?.Dispose();
            _timer = null;
        }
    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/IBELogic.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.BE;
using System;

namespace Arma3BE.Client.Modules.BEServerModule
{
    public interface IBELogic
    {
        event EventHandler<ServerCommandEventArgs> ServerUpdateHandler;
        event EventHandler<ServerCommandEventArgs> ServerImmediateUpdateHandler;
    }

    public class ServerCommandEventArgs : EventArgs
    {
        public BECommand Command { get; }

        public ServerCommandEventArgs(BECommand command)
        {
            Command = command;
        }
    }

}
```

`src/Arma3BE.Client.Modules.BEServerModule/IBELogicItem.cs`:

```cs
namespace Arma3BE.Client.Modules.BEServerModule
{
    public interface IBELogicItem
    {

    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/IBEService.cs`:

```cs
using System;
using System.Collections.Generic;

namespace Arma3BE.Client.Modules.BEServerModule
{
    public interface IBEService
    {
        IEnumerable<Guid> ConnectedServers();
    }
}
```

`src/Arma3BE.Client.Modules.BEServerModule/app.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral"/>
        <bindingRedirect oldVersion="0.0.0.0-10.0.0.0" newVersion="10.0.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1"/></startup></configuration>

```

`src/Arma3BE.Client.Modules.BEServerModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.BanModule/Arma3BE.Client.Modules.BanModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{B9350497-D13C-4A2B-B4F9-51C53D28A55A}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.BanModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.BanModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="BanModuleInit.cs" />
    <Compile Include="BanService.cs" />
    <Compile Include="Boxes\BanPlayerWindow.xaml.cs">
      <DependentUpon>BanPlayerWindow.xaml</DependentUpon>
    </Compile>
    <Compile Include="Boxes\KickPlayerWindow.xaml.cs">
      <DependentUpon>KickPlayerWindow.xaml</DependentUpon>
    </Compile>
    <Compile Include="Grids\BansControl.xaml.cs">
      <DependentUpon>BansControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="Models\ServerMonitorBansViewModel.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Page Include="Boxes\BanPlayerWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Boxes\KickPlayerWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Grids\BansControl.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.BanModule/BanModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.BanModule.Grids;
using Arma3BE.Client.Modules.BanModule.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Events;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.BanModule
{
    public class BanModuleInit : IModule
    {
        private readonly IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public BanModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _container.RegisterInstance(new BanService(_container, _container.Resolve<IEventAggregator>()));
            _regionManager.RegisterViewWithRegion(RegionNames.ServerTabPartRegion, CreateView);
        }

        private object CreateView()
        {
            return ServerTabViewHelper.RegisterView<BansControl, ServerInfoDto, ServerMonitorBansViewModel>(_container,
                "serverInfo");
        }
    }
}
```

`src/Arma3BE.Client.Modules.BanModule/BanService.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Modules.BanModule.Boxes;
using Microsoft.Practices.Unity;
using Prism.Events;
using System;

namespace Arma3BE.Client.Modules.BanModule
{
    public class BanService
    {
        private readonly IUnityContainer _container;

        public BanService(IUnityContainer container, IEventAggregator eventAggregator)
        {
            _container = container;

            eventAggregator.GetEvent<BanUserEvent>()
                .Subscribe(e => ShowBanDialog(e.ServerId, e.PlayerGuid, e.IsOnline, e.PlayerName, e.PlayerNum));

            eventAggregator.GetEvent<KickUserEvent>()
                .Subscribe(e => ShowKickDialog(e.ServerId, e.PlayerNum, e.PlayerGuid, e.PlayerName));

        }

        private void ShowBanDialog(Guid? serverId, string playerGuid, bool isOnline, string playerName,
            string playerNum)
        {

            var w = _container.Resolve<BanPlayerWindow>(
                   new ParameterOverride("serverId", serverId ?? Guid.Empty),
                   new ParameterOverride("playerGuid", playerGuid),
                   new ParameterOverride("isOnline", isOnline),
                   new ParameterOverride("playerName", playerName ?? string.Empty),
                   new ParameterOverride("playerNum", playerNum ?? string.Empty)
                   );
            w.ShowDialog();

            //if (playerNum != null)
            //{
            //    var w = _container.Resolve<BanPlayerWindow>(
            //        new ParameterOverride("serverId", serverId),
            //        new ParameterOverride("playerGuid", playerGuid),
            //        new ParameterOverride("isOnline", isOnline),
            //        new ParameterOverride("playerName", playerName),
            //        new ParameterOverride("playerNum", playerNum)
            //        );
            //    w.ShowDialog();
            //}
            //else
            //{
            //    var w = _container.Resolve<BanPlayerWindow>(
            //       new ParameterOverride("serverId", serverId),
            //       new ParameterOverride("playerGuid", playerGuid),
            //       new ParameterOverride("isOnline", isOnline),
            //       new ParameterOverride("playerName", playerName),
            //        new ParameterOverride("playerNum", string.Empty)
            //       );
            //    w.ShowDialog();
            //}
        }

        private void ShowKickDialog(Guid serverId, int playerNum, string playerGuid, string playerName)
        {
            var w = _container.Resolve<KickPlayerWindow>(
                new ParameterOverride("serverId", serverId),
                new ParameterOverride("playerGuid", playerGuid),
                new ParameterOverride("playerName", playerName),
                new ParameterOverride("playerNum", playerNum));
            w.ShowDialog();
        }
    }
}

```

`src/Arma3BE.Client.Modules.BanModule/Boxes/BanPlayerWindow.xaml`:

```xaml
<windows:WindowBase x:Class="Arma3BE.Client.Modules.BanModule.Boxes.BanPlayerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:windows="clr-namespace:Arma3BE.Client.Infrastructure.Windows;assembly=Arma3BE.Client.Infrastructure"
        Title="{Binding PlayerName, StringFormat=Ban player {0}}"
        WindowStyle="ToolWindow" SizeToContent="WidthAndHeight" ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>


        <TextBlock Grid.Row="0" Text="Player Guid" Margin="5" />
        <TextBox Grid.Row="0" Grid.Column="1" Margin="5" Width="300" Name="tbGuid"
                 Text="{Binding PlayerGuid, Mode=TwoWay}" IsEnabled="False" />

        <TextBlock Grid.Row="1" Text="Reason" Margin="5" />
        <xctk:WatermarkTextBox Grid.Row="1" Grid.Column="1" Margin="5" MinLines="2" Width="300"
                               Watermark="Enter reason" Text="{Binding Reason, Mode=TwoWay}" />


        <TextBlock Text="Template" Grid.Row="2" Margin="5" />
        <ComboBox Grid.Row="2" Grid.Column="1" Margin="5" SelectedItem="{Binding Reason, Mode=TwoWay}"
                  ItemsSource="{Binding Reasons, Mode=OneWay}" />

        <TextBlock Text="Minutes" Margin="5" Grid.Row="3" />
        <xctk:LongUpDown Watermark="Minutes" Minimum="0" Grid.Row="3" Grid.Column="1" Margin="5" Name="lnMinutes"
                         Value="{Binding Minutes, Mode=TwoWay}" />

        <TextBlock Text="Template" Grid.Row="4" Margin="5" />
        <ComboBox Grid.Row="4" Grid.Column="1" Margin="5" ItemsSource="{Binding BanTimes, Mode=OneWay}" SelectedItem="{Binding TimeSpan, Mode=TwoWay}" DisplayMemberPath="Display" />


        <TextBlock Text="Servers" Grid.Row="5" Margin="5" />
        <xctk:CheckListBox Grid.Row="5" Grid.Column="1"  Margin="5"
                            DisplayMemberPath="Name"
                            SelectedItemsOverride="{Binding SelectedServers}" 
                            ItemsSource="{Binding Servers}"/>


        <StackPanel Grid.Row="6" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Ban" Margin="5 2" Padding="5 0" Click="BanClick" />
            <Button Content="Cancel" Margin="5 2" Padding="5 0" Click="CancelClick" />
        </StackPanel>

    </Grid>
</windows:WindowBase>
```

`src/Arma3BE.Client.Modules.BanModule/Boxes/BanPlayerWindow.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Infrastructure.Windows;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Repositories.Players;
using Arma3BEClient.Libs.Tools;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;

// ReSharper disable MemberCanBePrivate.Global

namespace Arma3BE.Client.Modules.BanModule.Boxes
{
    /// <summary>
    ///     Interaction logic for BanPlayerWindow.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class BanPlayerWindow : WindowBase
    {
        private readonly BanPlayerViewModel _model;

        public BanPlayerWindow(Guid? serverId, IBanHelper banHelper, string playerGuid, bool isOnline, string playerName,
            string playerNum, IServerInfoRepository infoRepository, ISettingsStoreSource settingsStoreSource) : base(settingsStoreSource)
        {
            InitializeComponent();
            _model = new BanPlayerViewModel(serverId, playerGuid, isOnline, banHelper, playerName, playerNum, infoRepository);

            tbGuid.IsEnabled = string.IsNullOrEmpty(playerGuid);

            DataContext = _model;
        }

        private async void BanClick(object sender, RoutedEventArgs e)
        {
            if (!string.IsNullOrEmpty(_model.Reason) && lnMinutes.Value.HasValue)
            {
                await _model.BanAsync();
                Close();
            }
        }

        private void CancelClick(object sender, RoutedEventArgs e)
        {
            Close();
        }
    }

    public class BanPlayerViewModel : ViewModelBase
    {
        private readonly bool _isOnline;
        private readonly IBanHelper _playerHelper;
        private readonly string _playerNum;
        private long? _minutes;
        private string _playerGuid;
        private string _playerName;
        private string _reason;
        private BanFullTime _timeSpan;
        private ObservableCollection<ServerInfoDto> _selectedServers = new ObservableCollection<ServerInfoDto>();

        public BanPlayerViewModel(Guid? serverId, string playerGuid, bool isOnline, IBanHelper playerHelper,
            string playerName,
            string playerNum, IServerInfoRepository infoRepository)
        {
            _playerGuid = playerGuid;
            _isOnline = isOnline;
            _playerHelper = playerHelper;
            _playerName = playerName;
            _playerNum = playerNum;
            _minutes = 0;


            Init(infoRepository, serverId);
        }

        private async Task Init(IServerInfoRepository infoRepository, Guid? serverId)
        {
            Servers = (await infoRepository.GetActiveServerInfoAsync()).OrderBy(x => x.Name).ToList();


            if (string.IsNullOrEmpty(_playerName))
                using (var userRepo = new PlayerRepository())
                {
                    var player = await userRepo.GetPlayerAsync(_playerGuid);
                    _playerName = player?.Name;
                }

            //SelectedServers = new ObservableCollection<ServerInfoDto>();

            if (serverId.HasValue)
                SelectedServers.AddRange(Servers.Where(s => s.Id == serverId.Value));

            Reasons = await GetReasons();
            BanTimes = await GetBanTimes();

            RaisePropertyChanged(nameof(Reasons));
            RaisePropertyChanged(nameof(BanTimes));
        }

        public List<ServerInfoDto> Servers { get; private set; }

        public ObservableCollection<ServerInfoDto> SelectedServers
        {
            get => _selectedServers;
            set => SetProperty(ref _selectedServers, value);
        }

        public string PlayerName
        {
            get { return _playerName; }
            set
            {
                _playerName = value;
                RaisePropertyChanged();
            }
        }

        async Task<string[]> GetReasons()
        {
            try
            {
                using (var repo = new ReasonRepository())
                {
                    var str = await repo.GetBanReasonsAsync();
                    return str;
                }
            }
            catch (Exception)
            {
                return new[] { string.Empty };
            }
        }

        public IEnumerable<string> Reasons { get; set; }


        async Task<IEnumerable<BanFullTime>> GetBanTimes()
        {
            try
            {
                using (var repo = new ReasonRepository())
                {
                    var str = (await repo.GetBanTimesAsync()).Select(x => new BanFullTime
                    {
                        Text = x.Title,
                        Period = System.TimeSpan.FromMinutes(x.TimeInMinutes),
                        PeriodMinutes = x.TimeInMinutes
                    }).ToArray();
                    return str;
                }
            }
            catch (Exception)
            {
                return Enumerable.Empty<BanFullTime>();
            }
        }

        public IEnumerable<BanFullTime> BanTimes { get; set; }


        public string PlayerGuid
        {
            get { return _playerGuid; }
            set
            {
                _playerGuid = value;
                RaisePropertyChanged();
            }
        }

        public string Reason
        {
            get { return _reason; }
            set
            {
                _reason = value;
                RaisePropertyChanged();
            }
        }

        public long? Minutes
        {
            get { return _minutes; }
            set
            {
                _minutes = value;
                RaisePropertyChanged();
            }
        }

        public BanFullTime TimeSpan
        {
            get { return _timeSpan; }
            set
            {
                _timeSpan = value;
                RaisePropertyChanged();
                Minutes = _timeSpan.PeriodMinutes;
            }
        }

        public async Task BanAsync()
        {
            if (Minutes != null)
            {
                foreach (var selectedServer in SelectedServers)
                {
                    if (_isOnline)
                        await _playerHelper.BanGuidOnlineAsync(selectedServer.Id, _playerNum, _playerGuid, Reason, Minutes.Value);
                    else
                        await _playerHelper.BanGUIDOfflineAsync(selectedServer.Id, _playerGuid, Reason, Minutes.Value);
                }
            }
        }

        public class BanFullTime
        {
            public string Text { get; set; }
            public TimeSpan Period { get; set; }
            public int PeriodMinutes { get; set; }

            public string Display => $"{Text} ({Period})";
        }
    }
}
```

`src/Arma3BE.Client.Modules.BanModule/Boxes/KickPlayerWindow.xaml`:

```xaml
<windows:WindowBase x:Class="Arma3BE.Client.Modules.BanModule.Boxes.KickPlayerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:windows="clr-namespace:Arma3BE.Client.Infrastructure.Windows;assembly=Arma3BE.Client.Infrastructure"
        Title="{Binding Path=PlayerName , StringFormat=Kick player {0}}" WindowStyle="ToolWindow"
        SizeToContent="WidthAndHeight" ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>


        <TextBlock Text="Reason" Margin="5" />
        <TextBox Grid.Column="1" Margin="5" MinLines="2" Width="300" Name="tbReason"
                 Text="{Binding Reason, Mode=TwoWay}" />

        <TextBlock Text="Template" Grid.Row="1" Margin="5" />
        <ComboBox Grid.Row="1" Grid.Column="1" Margin="5" SelectedItem="{Binding Reason, Mode=TwoWay}"
                  ItemsSource="{Binding Reasons, Mode=OneWay}" />

        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Kick" Margin="5 2" Padding="5 0" Click="KickClick" />
            <Button Content="Cancel" Margin="5 2" Padding="5 0" Click="CancelClick" />
        </StackPanel>

    </Grid>
</windows:WindowBase>
```

`src/Arma3BE.Client.Modules.BanModule/Boxes/KickPlayerWindow.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Infrastructure.Windows;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Tools;
using System;
using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;
using System.Threading.Tasks;
using System.Windows;

namespace Arma3BE.Client.Modules.BanModule.Boxes
{
    /// <summary>
    ///     Interaction logic for KickPlayerWindow.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class KickPlayerWindow : WindowBase
    {
        private readonly IBanHelper _playerHelper;
        private readonly Guid _serverId;
        private readonly int _playerNum;
        private readonly string _playerGuid;

        public KickPlayerWindow(IBanHelper playerHelper, Guid serverId, int playerNum, string playerGuid, string playerName, ISettingsStoreSource settingsStoreSource) : base(settingsStoreSource)
        {
            _playerHelper = playerHelper;
            _serverId = serverId;
            _playerNum = playerNum;
            _playerGuid = playerGuid;
            InitializeComponent();

            var model = new KickPlayerViewModel(playerName);
            DataContext = model;


        }

        private void KickClick(object sender, RoutedEventArgs e)
        {
            _playerHelper.KickAsync(_serverId, _playerNum, _playerGuid, tbReason.Text);
            Close();
        }

        private void CancelClick(object sender, RoutedEventArgs e)
        {
            Close();
        }
    }


    [SuppressMessage("ReSharper", "UnusedMember.Global")]
    public class KickPlayerViewModel : ViewModelBase
    {
        private string _reason;

        public KickPlayerViewModel(string playerName)
        {
            PlayerName = playerName;

            Init();
        }

        private async void Init()
        {
            Reasons = await GerReasons();
            RaisePropertyChanged(nameof(Reasons));
        }

        // ReSharper disable once MemberCanBePrivate.Global
        // ReSharper disable once UnusedAutoPropertyAccessor.Global
        public string PlayerName { get; }

        public string Reason
        {
            get { return _reason; }
            set
            {
                _reason = value;
                RaisePropertyChanged();
            }
        }

        // ReSharper disable once UnusedMember.Global
        public IEnumerable<string> Reasons { get; set; }

        private async Task<IEnumerable<string>> GerReasons()
        {
            try
            {
                using (var repo = new ReasonRepository())
                {
                    var str = await repo.GetKickReasonsAsync();
                    return str;
                }
            }
            catch (Exception)
            {
                return new[] { string.Empty };
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.BanModule/Grids/BansControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.BanModule.Grids.BansControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
             mc:Ignorable="d">
    <UserControl.Resources>
        <converters:BisyBoolToColorConverter x:Uid="local:BisyBoolToColorConverter"
                                                     x:Key="BisyBoolToColorConverter" />
    </UserControl.Resources>
    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <ToolBar Height="30">
            <Button Command="{Binding RefreshCommand, Mode=OneWay}"
                    BorderThickness="1" BorderBrush="{Binding WaitingForEvent, Mode=OneWay, Converter={StaticResource BisyBoolToColorConverter}}">
                <!-- ReSharper disable once Xaml.StaticResourceNotResolved -->
                <Image x:Uid="Image_1" Source="{StaticResource ResourceKey=refresh_icon}" Height="16" Width="16" />
            </Button>

            <Separator />
            <TextBlock Margin="2" HorizontalAlignment="Right" VerticalAlignment="Center"
                       Text="{Binding DataCount, Mode=OneWay, StringFormat=Total: {0}}" />

            <Separator />

            <Button Content="Custom ban" Command="{Binding CustomBan, Mode=TwoWay}" />

            <Separator />

            <TextBox Margin="2" Text="{Binding Filter, Mode=TwoWay}" Height="20" MinWidth="150" />
            <Button Content="Search" Margin="2" Command="{Binding FilterCommand, Mode=OneWay}" />

        </ToolBar>


        <TabControl Grid.Row="1">
            <TabItem Header="Actual bans">
                <xcdg:DataGridControl ItemsSource="{Binding Data, Mode=OneWay}" AutoCreateColumns="False"
                                      ReadOnly="True" Name="dg">

                    <xcdg:DataGridControl.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Remove Ban" Click="RemoveBan_Click" />

                            <MenuItem Header="Player Info" Click="PlayerInfo_Click" />

                        </ContextMenu>
                    </xcdg:DataGridControl.ContextMenu>

                    <xcdg:DataGridControl.View>
                        <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                            <xcdg:TableView.FixedHeaders>
                                <DataTemplate>
                                    <xcdg:ColumnManagerRow />
                                </DataTemplate>
                            </xcdg:TableView.FixedHeaders>
                        </xcdg:TableflowView>
                    </xcdg:DataGridControl.View>
                </xcdg:DataGridControl>
            </TabItem>
            <TabItem Header="Availible bans">

                <Grid>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <ToolBar Height="30">
                        <Button Command="{Binding RefreshAvailiableCommand, Mode=OneWay}"
                            BorderThickness="1">
                            <Image x:Uid="Image_1" Source="{StaticResource ResourceKey=refresh_icon}" Height="16" Width="16" />
                        </Button>

                        <Separator />

                        <TextBlock Margin="2" HorizontalAlignment="Right" VerticalAlignment="Center"
                                   Text="{Binding AvailibleBansCount, Mode=OneWay, StringFormat=Availible bans: {0}}" />

                        <Button Command="{Binding SyncBans, Mode=OneWay}" Content="Ban selected">
                            <!--<Image x:Uid="Image_1" Source="{StaticResource refresh_icon}" Height="16" Width="16"></Image>-->
                        </Button>

                    </ToolBar>

                    <xcdg:DataGridControl Grid.Row="1" ItemsSource="{Binding AvailibleBans, Mode=OneWay}" AutoCreateColumns="False"
                                      ReadOnly="True"
                                      SelectionChanged="Av_Grid_Selection_Changed" Name="dg2">

                        <xcdg:DataGridControl.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Player Info" Click="PlayerInfo_Click" />
                            </ContextMenu>
                        </xcdg:DataGridControl.ContextMenu>

                        <xcdg:DataGridControl.View>
                            <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                                <xcdg:TableView.FixedHeaders>
                                    <DataTemplate>
                                        <xcdg:ColumnManagerRow />
                                    </DataTemplate>
                                </xcdg:TableView.FixedHeaders>
                            </xcdg:TableflowView>
                        </xcdg:DataGridControl.View>

                    </xcdg:DataGridControl>
                </Grid>

            </TabItem>

        </TabControl>


        <!--<Viewbox Stretch="Uniform" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <TextBlock Opacity="0.15" Foreground="Turquoise" VerticalAlignment="Top" HorizontalAlignment="Left" Background="Transparent" Text="{Binding BanCount, Mode=OneWay}" IsHitTestVisible="False" ></TextBlock>
        </Viewbox>-->

    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.BanModule/Grids/BansControl.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Infrastructure.Helpers.Views;
using Arma3BE.Client.Modules.BanModule.Models;
using Prism.Regions;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using Xceed.Wpf.DataGrid;

namespace Arma3BE.Client.Modules.BanModule.Grids
{
    /// <summary>
    ///     Interaction logic for BansControl.xaml
    /// </summary>
    [ViewSortHint("0200")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class BansControl : UserControl
    {
        public BansControl()
        {
            InitializeComponent();

            dg.LoadState<BanView>($"{GetType().FullName}_{typeof(BanView).FullName}");

            var menu = dg.Generate<BanView>();

            foreach (var menuItem in menu.Items.OfType<MenuItem>().ToList())
            {
                menu.Items.Remove(menuItem);
                dg.ContextMenu?.Items.Add(menuItem);
            }

            dg2.LoadState<BanView>($"{GetType().FullName}_{typeof(BanView).FullName}_2");

            var menu2 = dg2.Generate<BanView>();

            foreach (var menuItem in menu2.Items.OfType<MenuItem>().ToList())
            {
                menu2.Items.Remove(menuItem);
                dg2.ContextMenu?.Items.Add(menuItem);
            }
        }

        private ServerMonitorBansViewModel Model => DataContext as ServerMonitorBansViewModel;

        private void RemoveBan_Click(object sender, RoutedEventArgs e)
        {
            var si = dg.SelectedItem as BanView;

            if (si != null)
            {
                Model.RemoveBan(si);
            }
        }

        private void Av_Grid_Selection_Changed(object sender, DataGridSelectionChangedEventArgs e)
        {
            var dataGridControl = e.OriginalSource as DataGridControl;
            if (dataGridControl != null)
            {
                var res =
                    (from object selectedItem in dataGridControl.SelectedItems select selectedItem as BanView).ToList();

                Model.SelectedAvailibleBans = res;
            }
        }

        private void PlayerInfo_Click(object sender, RoutedEventArgs e)
        {
            var si = dg.SelectedItem as BanView;

            if (si != null)
            {
                Model.ShowPlayerInfo(si);
            }
        }

    }
}
```

`src/Arma3BE.Client.Modules.BanModule/Models/ServerMonitorBansViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Infrastructure.Helpers.Views;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.BanModule.Boxes;
using Arma3BE.Server;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Tools;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Input;
using Ban = Arma3BE.Server.Models.Ban;
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BE.Client.Modules.BanModule.Models
{
    public class ServerMonitorBansViewModel : ServerMonitorBaseViewModel<Ban, BanView>
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly IBanHelper _helper;
        private readonly Guid _serverInfoId;

        public ServerMonitorBansViewModel(ServerInfoDto serverInfo, IEventAggregator eventAggregator, IServerInfoRepository infoRepository,
            IBanHelper banHelper, ISettingsStoreSource settingsStoreSource)
            : base(
                new ActionCommand(() => SendCommand(eventAggregator, serverInfo.Id, CommandType.Bans)),
                new BanViewComparer())
        {
            _serverInfoId = serverInfo.Id;
            _eventAggregator = eventAggregator;
            _helper = banHelper;
            AvailibleBans = new BanView[0];

            SyncBans = new ActionCommand(() =>
            {
                var bans = SelectedAvailibleBans;

                if (bans != null)
                    Task.Factory.StartNew(async () => { await _helper.BanGUIDOfflineAsync(_serverInfoId, bans.ToArray(), true); },
                        TaskCreationOptions.LongRunning);
            });

            CustomBan = new ActionCommand(() =>
            {
                var w = new BanPlayerWindow(_serverInfoId, _helper, null, false, null, null, infoRepository, settingsStoreSource);
                w.ShowDialog();
            });

            RefreshAvailiableCommand = new ActionCommand(async () =>
            {
                AvailibleBans = await GetAvailibleBans();
                RaisePropertyChanged(nameof(AvailibleBans));
                RaisePropertyChanged(nameof(AvailibleBansCount));
            });

            _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Ban>>>()
                .Subscribe(async e =>
               {
                   if (_serverInfoId == e.ServerId)
                   {
                       await SetDataAsync(e.Items);
                       WaitingForEvent = false;
                   }
               });
        }

        public string Title => "Bans";

        public IEnumerable<BanView> SelectedAvailibleBans { get; set; }

        public IEnumerable<BanView> AvailibleBans { get; set; }

        private async Task<IEnumerable<BanView>> GetAvailibleBans()
        {
            if (_data == null) return new List<BanView>();

            using (var dc = new BanRepository())
            {
                var dbBans = await dc.GetActivePermBansAsync();

                var data = _data.ToList();

                var res =
                    dbBans.Where(x => data.All(y => y.GuidIp != x.GuidIp)).GroupBy(x => x.GuidIp)
                        .Select(x => x.OrderByDescending(y => y.Reason).First())
                        .Select(x => new BanView
                        {
                            GuidIp = x.GuidIp,
                            Minutesleft = x.MinutesLeft,
                            Num = 0,
                            PlayerComment = x.Player == null ? string.Empty : x.Player.Comment,
                            Reason = x.Reason,
                            PlayerName = x.Player == null ? string.Empty : x.Player.Name
                        })
                        .ToList();

                return res;
            }
        }

        public long AvailibleBansCount => AvailibleBans.Count();

        public ICommand SyncBans { get; set; }
        public ICommand CustomBan { get; set; }

        public ICommand RefreshAvailiableCommand { get; set; }

        protected override Task<IEnumerable<BanView>> RegisterDataAsync(IEnumerable<Ban> initialData)
        {
            var enumerable = initialData as IList<Ban> ?? initialData.ToList();
            _helper.RegisterBans(enumerable, _serverInfoId);
            return _helper.GetBanViewAsync(enumerable);
        }

        public void RemoveBan(BanView si)
        {
            SendCommand(CommandType.RemoveBan, si.Num.ToString());
        }

        private void SendCommand(CommandType commandType, string parameters = null)
        {
            SendCommand(_eventAggregator, _serverInfoId, commandType, parameters);
        }

        private static void SendCommand(IEventAggregator eventAggregator, Guid serverId, CommandType commandType,
            string parameters = null)
        {
            eventAggregator.GetEvent<BEMessageEvent<BECommand>>()
                .Publish(new BECommand(serverId, commandType, parameters));
        }

        public void ShowPlayerInfo(BanView si)
        {
            if (string.IsNullOrEmpty(si.GuidIp) == false)
                _eventAggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(si.GuidIp));
        }

        private class BanViewComparer : IEqualityComparer<BanView>
        {
            public bool Equals(BanView x, BanView y)
            {
                return x.GuidIp == y.GuidIp && x.Num == y.Num && x.Reason == y.Reason;
            }

            public int GetHashCode(BanView obj)
            {
                return obj.GetHashCode();
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.BanModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net45" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net45" />
</packages>
```

`src/Arma3BE.Client.Modules.ChatModule/Arma3BE.Client.Modules.ChatModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.ChatModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.ChatModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="WindowsFormsIntegration" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Boxes\ColoredItemsControl.xaml.cs">
      <DependentUpon>ColoredItemsControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="Boxes\ColoredTextControl.xaml.cs">
      <DependentUpon>ColoredTextControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="Boxes\Converters\ConnectTextConverter.cs" />
    <Compile Include="Boxes\Converters\FullCHatMessageToColorConverter.cs" />
    <Compile Include="Boxes\Converters\FullCHatMessageToStringConverter.cs" />
    <Compile Include="Boxes\Converters\FullCHatMessageToWeightConverter.cs" />
    <Compile Include="Boxes\Converters\PlayerMessageToColorConverter.cs" />
    <Compile Include="Boxes\IColoredTextControl.cs" />
    <Compile Include="Boxes\RTBControl.xaml.cs">
      <DependentUpon>RTBControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="ChatModuleInit.cs" />
    <Compile Include="Boxes\ChatHistory.xaml.cs">
      <DependentUpon>ChatHistory.xaml</DependentUpon>
    </Compile>
    <Compile Include="Chat\ChatControl.xaml.cs">
      <DependentUpon>ChatControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="Helpers\ChatHelper.cs" />
    <Compile Include="Models\ChatHistoryViewModel.cs" />
    <Compile Include="Models\ServerMonitorChatViewModel.cs" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="Boxes\ChatHistory.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Boxes\ColoredItemsControl.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Boxes\ColoredTextControl.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Boxes\RTBControl.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Chat\ChatControl.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/ChatHistory.xaml`:

```xaml
<windows:WindowBase x:Class="Arma3BE.Client.Modules.ChatModule.Boxes.ChatHistory"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:boxes="clr-namespace:Arma3BE.Client.Modules.ChatModule.Boxes"
        xmlns:windows="clr-namespace:Arma3BE.Client.Infrastructure.Windows;assembly=Arma3BE.Client.Infrastructure"
        Title="Chat history"
        WindowStyle="SingleBorderWindow" Width="750" Height="500"
        WindowStartupLocation="CenterScreen">

    <xctk:BusyIndicator IsBusy="{Binding IsBusy, Mode=OneWay}" BusyContent="Please, wait...">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>

            <ToolBar>
                <xctk:DropDownButton Content="Servers">
                    <xctk:DropDownButton.DropDownContent>
                        <xctk:CheckListBox ItemsSource="{Binding ServerList}" DisplayMemberPath="Name" ValueMemberPath="Id"
                                       SelectedValue="{Binding SelectedServers}" />
                    </xctk:DropDownButton.DropDownContent>
                </xctk:DropDownButton>

                <xctk:DateTimePicker Value="{Binding StartDate, Mode=TwoWay}" Width="200" FormatString="dd.MM.yy HH:mm:ss" />
                <xctk:DateTimePicker Value="{Binding EndDate, Mode=TwoWay}" Width="200" FormatString="dd.MM.yy HH:mm:ss" />
                <xctk:WatermarkTextBox Watermark="Filter" Text="{Binding Filter, Mode=TwoWay}" Width="200" />
                <Button Content="Search" Command="{Binding FilterCommand}" />
            </ToolBar>

            <!--<boxes:ColoredTextControl x:Name="textControl" IsAutoScroll="True" Grid.Row="1">
            </boxes:ColoredTextControl>-->

            <!--<boxes:RTBControl x:Name="textControl" IsAutoScroll="True" Grid.Row="1">
            </boxes:RTBControl>-->


            <boxes:ColoredItemsControl x:Name="textControl"  Grid.Row="1"  IsAutoScroll="True" >
            </boxes:ColoredItemsControl>

        </Grid>
    </xctk:BusyIndicator>
</windows:WindowBase>
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/ChatHistory.xaml.cs`:

```cs
using Arma3BE.Client.Modules.ChatModule.Models;
using Arma3BE.Server.Models;
using System.ComponentModel;
using System.Linq;
using System.Windows;
using Arma3BE.Client.Infrastructure.Windows;
using Arma3BEClient.Libs.Tools;

namespace Arma3BE.Client.Modules.ChatModule.Boxes
{
    /// <summary>
    ///     Interaction logic for ChatHistory.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class ChatHistory : WindowBase
    {
        private readonly ChatHistoryViewModel _model;

        public ChatHistory(ChatHistoryViewModel model, ISettingsStoreSource settingsStoreSource):base(settingsStoreSource)
        {
            _model = model;
            InitializeComponent();

            _model.PropertyChanged += _model_PropertyChanged;

            DataContext = _model;
        }

        private void _model_PropertyChanged(object sender, PropertyChangedEventArgs e)
        {
            if (e.PropertyName == "Log")
            {
                Refresh();
            }
        }

        private void Refresh()
        {
            textControl.ClearAll();

            if (_model.Log.Count() > 10000)
            {
                // ReSharper disable once AssignNullToNotNullAttribute
                MessageBox.Show(GetWindow(this), "Too many results.", "Info", MessageBoxButton.OK, MessageBoxImage.Information);
                return;
            }

            foreach (var chatLog in _model.Log)
            {
                var mes = new ChatMessage { Date = chatLog.Date, Message = chatLog.Text };
                textControl.AppendText(mes, chatLog.ServerName);
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/ColoredItemsControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.ChatModule.Boxes.ColoredItemsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Arma3BE.Client.Modules.ChatModule.Boxes"
             xmlns:converters="clr-namespace:Arma3BE.Client.Modules.ChatModule.Boxes.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <ListView ItemsSource="{Binding Messages}" ScrollViewer.CanContentScroll="True" 
                  SelectionMode="Extended" Name="lv">
            <ListView.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Copy" Command="Copy"/>
                </ContextMenu>
            </ListView.ContextMenu>
            <ListView.CommandBindings>
                <CommandBinding Command="Copy" Executed="OnListCopy"/>
            </ListView.CommandBindings>

            <ListView.Resources>
                <converters:PlayerMessageToColorConverter x:Key="playerMessageToColorConverter"/>
                <converters:ConnectTextConverter x:Key="connectTextConverter"></converters:ConnectTextConverter>
                
                <converters:FullCHatMessageToColorConverter x:Key="CHatMessageToColorConverter"></converters:FullCHatMessageToColorConverter>
                <converters:FullCHatMessageToStringConverter x:Key="CHatMessageToStringConverter"></converters:FullCHatMessageToStringConverter>
                <converters:FullCHatMessageToWeightConverter x:Key="CHatMessageToWeightConverter"></converters:FullCHatMessageToWeightConverter>


                <DataTemplate DataType="{x:Type local:PlayerMessage}">
                    <TextBlock Foreground="{Binding Converter={StaticResource playerMessageToColorConverter}}">
                        <Run Text="{Binding DateTime, Mode=OneWay, StringFormat=HH:mm:ss}"/>
                        <Hyperlink Command="{Binding DataContext.ShowPlayerCommand, RelativeSource={RelativeSource AncestorType=local:ColoredItemsControl}}" CommandParameter="{Binding}">
                            <Run Text="{Binding PlayerName, Mode=OneWay}" />
                        </Hyperlink>
                        <Run Text=" "></Run>
                        <Run Text="{Binding Converter={StaticResource connectTextConverter}, Mode=OneWay}"></Run>
                    </TextBlock>
                </DataTemplate>



                <DataTemplate DataType="{x:Type local:FullChatMessage}">
                    <TextBlock Text="{Binding Converter={StaticResource CHatMessageToStringConverter}}"
                               Foreground="{Binding Converter={StaticResource CHatMessageToColorConverter}}"
                               FontWeight="{Binding Converter={StaticResource CHatMessageToWeightConverter}}"
                               ></TextBlock>
                </DataTemplate>


            </ListView.Resources>
        </ListView>
    </Grid>

    
</UserControl>

```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/ColoredItemsControl.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.ServiceLocation;
using Prism.Commands;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;

namespace Arma3BE.Client.Modules.ChatModule.Boxes
{
    /// <summary>
    /// Interaction logic for ColoredItemsControl.xaml
    /// </summary>
    public partial class ColoredItemsControl : UserControl, IColoredTextControl
    {
        public ColoredItemsControl()
        {
            InitializeComponent();
            DataContext = this;

            ShowPlayerCommand = new DelegateCommand<PlayerMessage>(p =>
            {
                var aggregator = ServiceLocator.Current.TryResolve<IEventAggregator>();
                aggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(p.PlayerId));
            });

            InitBox();

            this.IsHitTestVisibleChanged += ColoredItemsControl_IsVisibleChanged;
            this.IsVisibleChanged += ColoredItemsControl_IsVisibleChanged;
        }

        private void ColoredItemsControl_IsVisibleChanged(object sender, DependencyPropertyChangedEventArgs e)
        {
            lv.SelectedItem = null;
            ScrollIfNeeded();
        }

        private async Task InitBox()
        {
            using (var repo = new ReasonRepository())
            {
                importantWords = await repo.GetImportantWordsAsync();
            }
        }

        private string[] importantWords;

        bool IsImportantMessage(ChatMessage message)
        {
            if (importantWords?.Any() == false) return false;

            return ChatMessage.IsImportantMessageProc(message, importantWords);
        }

        public ICommand ShowPlayerCommand { get; set; }

        public void AppendPlayerText(KeyValuePair<string, string> player, bool isIn)
        {
            Messages.Add(new PlayerMessage { PlayerId = player.Key, PlayerName = player.Value, isIn = isIn, DateTime = DateTime.UtcNow.UtcToLocalFromSettings() });
            ScrollIfNeeded();
        }

        public void AppendText(ChatMessage message, string servername = null)
        {
            var msg = new FullChatMessage
            {
                Message = message,
                Server = servername,
                DateTime = message.Date.UtcToLocalFromSettings(),
                IsImportant = message.Type != ChatMessage.MessageType.RCon && IsImportantMessage(message)
            };

            if (msg.IsImportant)
            {
                if (Application.Current?.MainWindow?.WindowState == WindowState.Minimized)
                {
                    var wnd = Application.Current.MainWindow;

                    EventHandler handler = null;
                    handler = (s, e) =>
                    {
                        wnd.StateChanged -= handler;
                        wnd.StopFlashingWindow();
                    };

                    wnd.StateChanged += handler;
                    wnd.FlashWindow();
                }
            }


            Messages.Add(msg);
            ScrollIfNeeded();
        }

        public void ClearAll()
        {
            Messages.Clear();
        }

        void ScrollIfNeeded()
        {
            if (!IsAutoScroll) return;

            lv.SelectedIndex = lv.Items.Count - 1;
            lv.ScrollIntoView(lv.SelectedItem);
            lv.SelectedItem = null;
        }

        void OnListCopy(object sender, ExecutedRoutedEventArgs e)
        {
            var lv = (ListView)sender;
            var text = string.Join(Environment.NewLine, lv.SelectedItems.Cast<object>()
                .OrderBy(x => Messages.IndexOf(x))
                .Select(x => x.ToString()).ToArray());
            Clipboard.SetDataObject(text);
        }

        public ObservableCollection<object> Messages { get; set; } = new ObservableCollection<object>();

        public static readonly DependencyProperty IsAutoScrollProperty =
            DependencyProperty.Register("IsAutoScroll", typeof(Boolean), typeof(ColoredItemsControl),
                new FrameworkPropertyMetadata(false));


        public bool IsAutoScroll
        {
            get { return (bool)GetValue(IsAutoScrollProperty); }
            set { SetValue(IsAutoScrollProperty, value); }
        }

        public void AppendText(LogMessage message)
        {
            var text = $"[ {message.Date.UtcToLocalFromSettings():HH:mm:ss} ]  {message.Message}";
            Messages.Add(text);
            ScrollIfNeeded();
        }
    }

    public class PlayerMessage
    {
        public string PlayerId { get; set; }
        public string PlayerName { get; set; }
        public bool isIn { get; set; }
        public DateTime DateTime { get; set; }

        public override string ToString()
        {
            var text = $"[ {DateTime.UtcNow.UtcToLocalFromSettings():HH:mm:ss} ] {PlayerName} {(isIn ? "connected" : "disconnected")}";
            return text;
        }
    }


    public class FullChatMessage
    {
        public string Server { get; set; }
        public DateTime DateTime { get; set; }
        public ChatMessage Message { get; set; }
        public bool IsImportant { get; set; }

        public override string ToString()
        {
            var ret = string.IsNullOrEmpty(Server)
                ? $"[ {Message.Date.UtcToLocalFromSettings():HH:mm:ss} ]  {Message.Message}"
                : $"[{Server}] [ {Message.Date.UtcToLocalFromSettings():yyyy-MM-dd HH:mm:ss} ]  {Message.Message}";
            return ret;
        }
    }
}

```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/ColoredTextControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.ChatModule.Boxes.ColoredTextControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" >
    <ScrollViewer Name="ChatScrollViewer">
        <RichTextBox Name="msgBox" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                     IsReadOnly="True" IsReadOnlyCaretVisible="False"
                                     FontSize="14" FontWeight="Medium" FontStyle="Normal" Background="#F0F0F0">
            <RichTextBox.Resources>
                <Style TargetType="{x:Type Paragraph}">
                    <Setter Property="Margin" Value="0" />
                </Style>
            </RichTextBox.Resources>
        </RichTextBox>
    </ScrollViewer>
</UserControl>

```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/ColoredTextControl.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Modules.ChatModule.Models;
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.ServiceLocation;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Media;

namespace Arma3BE.Client.Modules.ChatModule.Boxes
{
    /// <summary>
    /// Interaction logic for ColoredTextControl.xaml
    /// </summary>
    public partial class ColoredTextControl : IColoredTextControl
    {
        public static readonly DependencyProperty IsAutoScrollProperty =
            DependencyProperty.Register("IsAutoScroll", typeof(Boolean), typeof(ColoredTextControl),
                new FrameworkPropertyMetadata(false));


        public bool IsAutoScroll
        {
            get { return (bool)GetValue(IsAutoScrollProperty); }
            set { SetValue(IsAutoScrollProperty, value); }
        }

        public ColoredTextControl()
        {
            InitializeComponent();
            InitBox();
        }

        private async Task InitBox()
        {
            msgBox.Document.Blocks.Clear();
            msgBox.IsDocumentEnabled = true;


            using (var repo = new ReasonRepository())
            {
                importantWords = await repo.GetImportantWordsAsync();
            }
        }

        public void AppendText(ChatMessage message, string servername = null)
        {
            AppendText(ChatScrollViewer, message);
        }

        private void AppendText(ScrollViewer scroll, ChatMessage message, string servername = null)
        {
            var text = string.IsNullOrEmpty(servername)
                ?
                $"[ {message.Date.UtcToLocalFromSettings():HH:mm:ss} ]  {message.Message}"
                :
                $"[{servername}] [ {message.Date.UtcToLocalFromSettings():yyyy-MM-dd HH:mm:ss} ]  {message.Message}";

            var color = ServerMonitorChatViewModel.GetMessageColor(message);

            var p = new Paragraph
            {
                Foreground = new SolidColorBrush(color),
                FontSize = 13
            };


            p.Inlines.Add(text);

            if (message.Type != ChatMessage.MessageType.RCon && IsImportantMessage(message))
                p.FontWeight = FontWeights.Heavy;

            msgBox.Document.Blocks.Add(p);

            if (IsAutoScroll)
                scroll.ScrollToEnd();
        }

        private string[] importantWords;
        bool IsImportantMessage(ChatMessage message)
        {
            if (importantWords?.Any() == false) return false;

            return ChatMessage.IsImportantMessageProc(message, importantWords);
        }

        public void AppendPlayerText(KeyValuePair<string, string> player, bool isIn)
        {
            var text = $"[ {DateTime.UtcNow.UtcToLocalFromSettings():HH:mm:ss} ] ";

            var p = new Paragraph
            {
                Margin = new Thickness(0),
                Foreground = new SolidColorBrush(isIn ? Colors.Green : Colors.Red),
                FontSize = 13
            };
            // remove indent between paragraphs

            var link = new Hyperlink
            {
                IsEnabled = true,
                DataContext = player.Key
            };

            link.Inlines.Add(player.Value);
            link.NavigateUri = new Uri("http://local/");
            link.RequestNavigate += (sender, args) =>
            {
                var context = (sender as FrameworkContentElement)?.DataContext as string;
                if (string.IsNullOrEmpty(context) == false)
                {
                    var aggregator = ServiceLocator.Current.TryResolve<IEventAggregator>();
                    aggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(context));
                }
            };

            p.Inlines.Add(text);
            p.Inlines.Add(link);
            p.Inlines.Add(new Run(isIn ? " Connected" : " Disconnected") { FontSize = 10 });

            msgBox.Document.Blocks.Add(p);

            if (IsAutoScroll)
                ChatScrollViewer.ScrollToEnd();
        }

        public void ClearAll()
        {
            msgBox.Document.Blocks.Clear();
            InitBox();
        }
    }
}

```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/Converters/ConnectTextConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;

namespace Arma3BE.Client.Modules.ChatModule.Boxes.Converters
{
    public class ConnectTextConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return (value as PlayerMessage)?.isIn == true ? "connected" : "disconnected";
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/Converters/FullCHatMessageToColorConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;
using Arma3BE.Client.Modules.ChatModule.Models;

namespace Arma3BE.Client.Modules.ChatModule.Boxes.Converters
{
    public class FullCHatMessageToColorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            var message = value as FullChatMessage;
            if (message == null) return Brushes.Black;


            var color = ServerMonitorChatViewModel.GetMessageColor(message.Message);
            var brush = new SolidColorBrush(color);
            return brush;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/Converters/FullCHatMessageToStringConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;

namespace Arma3BE.Client.Modules.ChatModule.Boxes.Converters
{
    public class FullCHatMessageToStringConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            var message = value as FullChatMessage;
            if (message == null) return string.Empty;


            return message.ToString();
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/Converters/FullCHatMessageToWeightConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

namespace Arma3BE.Client.Modules.ChatModule.Boxes.Converters
{
    public class FullCHatMessageToWeightConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            var message = value as FullChatMessage;
            if (message == null) return FontWeights.Normal;

            if (message.IsImportant) return FontWeights.Heavy;

            return FontWeights.Normal;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/Converters/PlayerMessageToColorConverter.cs`:

```cs
using System;
using System.Globalization;
using System.Windows.Data;
using System.Windows.Media;

namespace Arma3BE.Client.Modules.ChatModule.Boxes.Converters
{
    public class PlayerMessageToColorConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if ((value as PlayerMessage)?.isIn == true) return Brushes.Green;
            return Brushes.Red;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/IColoredTextControl.cs`:

```cs
using System.Collections.Generic;
using Arma3BE.Server.Models;

namespace Arma3BE.Client.Modules.ChatModule.Boxes
{
    public interface IColoredTextControl
    {
        bool IsAutoScroll { get; set; }

        void AppendPlayerText(KeyValuePair<string, string> player, bool isIn);
        void AppendText(ChatMessage message, string servername = null);
        void ClearAll();
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/RTBControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.ChatModule.Boxes.RTBControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:forms="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
             mc:Ignorable="d" >
    <WindowsFormsHost>
        <forms:RichTextBox x:Name="rtb" ReadOnly="True"></forms:RichTextBox>
    </WindowsFormsHost>
</UserControl>

```

`src/Arma3BE.Client.Modules.ChatModule/Boxes/RTBControl.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Modules.ChatModule.Models;
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.ServiceLocation;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
using Color = System.Windows.Media.Color;

namespace Arma3BE.Client.Modules.ChatModule.Boxes
{
    /// <summary>
    ///     Interaction logic for RTBControl.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class RTBControl : UserControl, IColoredTextControl
    {
        // ReSharper disable once InconsistentNaming
        private const int WM_USER = 0x400;
        // ReSharper disable once InconsistentNaming
        private const int EM_HIDESELECTION = WM_USER + 63;

        public static readonly DependencyProperty IsAutoScrollProperty =
            DependencyProperty.Register("IsAutoScroll", typeof(bool), typeof(RTBControl),
                new FrameworkPropertyMetadata(false));

        public RTBControl()
        {
            InitializeComponent();

            rtb.Font = new Font(rtb.Font.FontFamily, 10);

            rtb.LinkClicked += Rtb_LinkClicked;

            Init();
        }

        private async void Init()
        {
            using (var repo = new ReasonRepository())
            {
                importantWords = await repo.GetImportantWordsAsync();
            }
        }

        private void Rtb_LinkClicked(object sender, System.Windows.Forms.LinkClickedEventArgs e)
        {
            var id = e.LinkText.Replace("http://", string.Empty);
            var aggregator = ServiceLocator.Current.TryResolve<IEventAggregator>();
            aggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(id));
        }

        public bool IsAutoScroll
        {
            get { return (bool)GetValue(IsAutoScrollProperty); }
            set { SetValue(IsAutoScrollProperty, value); }
        }

        public void AppendPlayerText(KeyValuePair<string, string> player, bool isIn)
        {
            var text = $"[ {DateTime.UtcNow.UtcToLocalFromSettings():HH:mm:ss} ] {player.Value} (http://{player.Key})\n";
            var color = isIn ? Colors.Green : Colors.Red;
            Add(text, color);
        }


        public void AppendText(ChatMessage message, string servername = null)
        {
            var text = string.IsNullOrEmpty(servername)
                ?
                $"[ {message.Date.UtcToLocalFromSettings():HH:mm:ss} ]  {message.Message}\n"
                :
                $"[{servername}] [ {message.Date.UtcToLocalFromSettings():yyyy-MM-dd HH:mm:ss} ]  {message.Message}\n";

            var color = ServerMonitorChatViewModel.GetMessageColor(message);
            Add(text, color, (message.Type != ChatMessage.MessageType.RCon) && IsImportantMessage(message));
        }


        private string[] importantWords;
        bool IsImportantMessage(ChatMessage message)
        {
            if (importantWords?.Any() == false) return false;

            return ChatMessage.IsImportantMessageProc(message, importantWords);
        }

        public void ClearAll()
        {
            rtb.Clear();
        }


        [DllImport("user32.dll")]
        private static extern IntPtr SendMessage(IntPtr hWnd, uint msg, int wParam, int lParam);

        private void Add(string text, Color color, bool bold = false)
        {
            var wformsColor = System.Drawing.Color.FromArgb(color.A, color.R, color.G, color.B);

            var selection = rtb.SelectionStart;
            var length = rtb.SelectionLength;


            if (!IsAutoScroll)
                SendMessage(rtb.Handle, EM_HIDESELECTION, 1, 0);


            rtb.AppendText(text);

            rtb.Select(rtb.TextLength - text.Length, text.Length);
            rtb.SelectionColor = wformsColor;


            if (bold)
                rtb.SelectionFont = new Font(rtb.SelectionFont, System.Drawing.FontStyle.Bold);

            if (length != 0)
            {
                rtb.SelectionStart = selection;
                rtb.SelectionLength = length;
            }
            else
            {
                rtb.Select(rtb.TextLength, 0);
            }


            if (!IsAutoScroll)
                SendMessage(rtb.Handle, EM_HIDESELECTION, 0, 0);
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Chat/ChatControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.ChatModule.Chat.ChatControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
             xmlns:boxes="clr-namespace:Arma3BE.Client.Modules.ChatModule.Boxes"
             xmlns:chat="clr-namespace:Arma3BE.Client.Modules.ChatModule.Chat"
             mc:Ignorable="d" DataContextChanged="ToolBar_DataContextChanged" HorizontalAlignment="Stretch"
             VerticalAlignment="Stretch">

    <UserControl.Resources>
        <converters:PlayerNumberToColorConverter x:Uid="local:PlayerNumberToColorConverter"
                                              x:Key="PlayerNumberToColorConverter" />
    </UserControl.Resources>


    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <ToolBar>
            <CheckBox Content="Enable chat" IsChecked="{Binding EnableChat, Mode=TwoWay}" />
            <Separator />
            <CheckBox Content="Auto scroll" IsChecked="{Binding AutoScroll, Mode=TwoWay}" />
            <Separator />
            <Button Content="History" Command="{Binding ShowHistoryCommand}" />
            <Button Content="Clear all" Click="ClearAll_Click" />
        </ToolBar>

        <TabControl Grid.Row="1" TabStripPlacement="Left">


            <TabControl.Resources>
                <Style TargetType="{x:Type TabItem}">
                    <Setter Property="HeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <ContentPresenter Content="{TemplateBinding Content}">
                                    <ContentPresenter.LayoutTransform>
                                        <RotateTransform Angle="270" />
                                    </ContentPresenter.LayoutTransform>
                                </ContentPresenter>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Padding" Value="3" />
                </Style>
            </TabControl.Resources>


            <TabItem Header="Chat">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition  Width="Auto" />
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!--<boxes:ColoredTextControl x:Name="textControl" IsAutoScroll="{Binding AutoScroll}" Grid.ColumnSpan="3">
                    </boxes:ColoredTextControl>-->

                    <boxes:ColoredItemsControl x:Name="textControl" Grid.ColumnSpan="3"  IsAutoScroll="{Binding Path=DataContext.AutoScroll, RelativeSource={RelativeSource  AncestorType=chat:ChatControl}}" >
                    </boxes:ColoredItemsControl>

                    <!--<boxes:RTBControl x:Name="textControl" IsAutoScroll="{Binding AutoScroll}" Grid.ColumnSpan="3">
                    </boxes:RTBControl>-->


                    <ComboBox Grid.Row="1" Grid.Column="0" Margin="2" ItemsSource="{Binding Players, Mode=OneWay}" 
                              SelectedValue="{Binding SelectedPlayer, Mode=TwoWay}">

                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <!-- ReSharper disable Xaml.BindingWithContextNotResolved -->
                                <TextBlock Text="{Binding Path=Name}" Foreground="{Binding Path=Num, Converter={StaticResource PlayerNumberToColorConverter}}">
                                    <!-- ReSharper restore Xaml.BindingWithContextNotResolved -->
                                    </TextBlock>
                                
                            </DataTemplate>

                        </ComboBox.ItemTemplate>

                    </ComboBox>

                    <TextBox Name="tbNewMessage" Grid.Row="1" Grid.Column="1" Margin="2"
                             Text="{Binding InputMessage, Mode=TwoWay}" KeyDown="KeyDown" Height="20" />
                    <Button Grid.Row="1" Grid.Column="2" Content="Send" Margin="2" Click="SendMessage" />

                </Grid>

            </TabItem>
            <TabItem Header="Console">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>



                    <boxes:ColoredItemsControl x:Name="consoleControl" Grid.ColumnSpan="2" IsAutoScroll="{Binding Path=DataContext.AutoScroll, RelativeSource={RelativeSource  AncestorType=chat:ChatControl}}" >
                    </boxes:ColoredItemsControl>

                    <!--<ScrollViewer  Name="ConsoleScrollViewer"  Grid.ColumnSpan="2">
                        <TextBox Name="msgConsole" FontSize="12" IsReadOnly="True" />
                    </ScrollViewer>-->

                    <TextBox Grid.Row="1" Grid.Column="0" Margin="2"
                             Text="{Binding CommandMessage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Height="20" />
                    
                    <Button Grid.Row="1" Grid.Column="1" Content="Send" Margin="2" Command="{Binding SendCommandMessage}" />

                </Grid>
            </TabItem>


            <TabItem Header="Players Log">

                <boxes:ColoredItemsControl x:Name="textPlayerControl" IsAutoScroll="{Binding Path=DataContext.AutoScroll, RelativeSource={RelativeSource  AncestorType=chat:ChatControl}}" >
                </boxes:ColoredItemsControl>

                <!--<boxes:ColoredTextControl x:Name="textPlayerControl" IsAutoScroll="{Binding AutoScroll}" >
                </boxes:ColoredTextControl>-->

                <!--<boxes:RTBControl x:Name="textPlayerControl" IsAutoScroll="{Binding AutoScroll}" >
                </boxes:RTBControl>-->
            </TabItem>

        </TabControl>


    </Grid>
</UserControl>

```

`src/Arma3BE.Client.Modules.ChatModule/Chat/ChatControl.xaml.cs`:

```cs
using Arma3BE.Client.Modules.ChatModule.Models;
using Arma3BE.Server.Models;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;

namespace Arma3BE.Client.Modules.ChatModule.Chat
{
    /// <summary>
    ///     Interaction logic for ChatControl.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class ChatControl : UserControl
    {
        public ChatControl()
        {
            InitializeComponent();
        }

        private ServerMonitorChatViewModel Model => DataContext as ServerMonitorChatViewModel;

        private void _model_ChatMessageEventHandler(object sender, ServerMonitorChatViewModelEventArgs e)
        {
            if (!Model.EnableChat) return;
            var type = e.Message.Type;
            if (type != ChatMessage.MessageType.Unknown)
                textControl.AppendText(e.Message);
            else
                consoleControl.AppendText(e.Message);
        }

        private void SendMessage(object sender, RoutedEventArgs e)
        {
            Model.SendMessage();
        }

        private new void KeyDown(object sender, KeyEventArgs e)
        {
            if (e.Key == Key.Enter)
            {
                var text = tbNewMessage.Text;
                Model.SendMessage(text);
            }
        }

        private void ToolBar_DataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
        {
            var model = e.NewValue as ServerMonitorChatViewModel;
            if (model != null)
            {
                model.ChatMessageEventHandler += _model_ChatMessageEventHandler;
                model.LogMessageEventHandler += Model_LogMessageEventHandler;

                model.PlayersInHandler += ModelOnPlayersInHandler;
                model.PlayersOutHandler += ModelOnPlayersOutHandler;
            }
        }

        private void ModelOnPlayersOutHandler(object sender, IEnumerable<KeyValuePair<string, string>> keyValuePairs)
        {
            if (!Model.EnableChat) return;
            foreach (var pair in keyValuePairs)
            {
                textPlayerControl.AppendPlayerText(pair, false);
            }

        }

        private void ModelOnPlayersInHandler(object sender, IEnumerable<KeyValuePair<string, string>> keyValuePairs)
        {
            if (!Model.EnableChat) return;
            foreach (var pair in keyValuePairs)
            {
                textPlayerControl.AppendPlayerText(pair, true);
            }
        }

        private void Model_LogMessageEventHandler(object sender, ServerMonitorLogViewModelEventArgs e)
        {
            Dispatcher.Invoke(() =>
            {
                if (!Model.EnableChat) return;
                consoleControl.AppendText(e.Message);
            });
        }

        private void ClearAll_Click(object sender, RoutedEventArgs e)
        {
            textPlayerControl.ClearAll();
            consoleControl.ClearAll();
            textControl.ClearAll();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/ChatModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.ChatModule.Chat;
using Arma3BE.Client.Modules.ChatModule.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.ChatModule
{
    public class ChatModuleInit : IModule
    {
        private readonly IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public ChatModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.ServerSidePartRegion, CreateView);
        }

        private object CreateView()
        {
            return ServerTabViewHelper.RegisterView<ChatControl, ServerInfoDto, ServerMonitorChatViewModel>(_container,
                "serverInfo");
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Helpers/ChatHelper.cs`:

```cs
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.Repositories;
using System;
using System.Threading.Tasks;

namespace Arma3BE.Client.Modules.ChatModule.Helpers
{
    public class ChatHelper
    {
        private readonly Guid _currentServerId;

        public ChatHelper(Guid currentServerId)
        {
            _currentServerId = currentServerId;
        }

        public async Task<bool> RegisterChatMessageAsync(ChatMessage message)
        {
            if (message.Type != ChatMessage.MessageType.Unknown)
                using (var repo = new ChatRepository())
                {
                    await repo.AddOrUpdateAsync(message, _currentServerId);
                }

            return true;
        }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Models/ChatHistoryViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Libs.Repositories;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Input;
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedMember.Global

namespace Arma3BE.Client.Modules.ChatModule.Models
{
    public class ChatHistoryViewModel : ViewModelBase
    {
        private readonly IServerInfoRepository _repository;

        public ChatHistoryViewModel(Guid serverId, IServerInfoRepository repository)
        {
            _repository = repository;
            FilterCommand = new ActionCommand(async () =>
            {
                try
                {
                    IsBusy = true;
                    await UpdateLogAsync();
                    RaisePropertyChanged(nameof(Log));
                }
                finally
                {
                    IsBusy = false;
                }
            });


            Init(serverId);
        }

        public async Task Init(Guid serverId)
        {
            ServerList = (await _repository.GetServerInfoAsync()).OrderBy(x => x.Name).ToList();
            SelectedServers = serverId.ToString();

            RaisePropertyChanged(nameof(ServerList));
            RaisePropertyChanged(nameof(SelectedServers));
        }

        private bool _isBusy;
        public bool IsBusy
        {
            get { return _isBusy; }
            set
            {
                _isBusy = value;
                RaisePropertyChanged();
            }
        }

        private async Task UpdateLogAsync()
        {
            using (var dc = new ChatRepository())
            {
                var log = await dc.GetChatLogsAsync(SelectedServers, StartDate.LocalToUtcFromSettings(), EndDate.LocalToUtcFromSettings(), Filter);

                Log = log.OrderBy(x => x.Date).Select(x => new ChatView
                {
                    Id = x.Id,
                    Date = x.Date,
                    ServerName = x.ServerInfo.Name,
                    Text = x.Text
                }).ToList();
            }
        }

        public DateTime? StartDate { get; set; }
        public DateTime? EndDate { get; set; }
        public string Filter { get; set; }

        public IEnumerable<ChatView> Log { get; private set; }


        public IEnumerable<ServerInfoDto> ServerList { get; set; }

        // ReSharper disable once AutoPropertyCanBeMadeGetOnly.Global
        public string SelectedServers { get; set; }
        public ICommand FilterCommand { get; set; }
    }

    public class ChatView
    {
        public int Id { get; set; }
        public string Text { get; set; }
        public string ServerName { get; set; }
        public DateTime Date { get; set; }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/Models/ServerMonitorChatViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.ChatModule.Boxes;
using Arma3BE.Client.Modules.ChatModule.Helpers;
using Arma3BE.Server;
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Tools;
using Prism.Commands;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Input;
using System.Windows.Media;
using Player = Arma3BE.Server.Models.Player;
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BE.Client.Modules.ChatModule.Models
{
    public class ServerMonitorChatViewModel : ViewModelBase
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly ISettingsStoreSource _settingsStoreSource;
        private readonly ChatHelper _chatHelper;
        private readonly Guid _serverId;
        private bool _autoScroll;
        private bool _enableChat;
        private string _inputMessage;
        private string _commandMessage;
        private List<Player> _players = new List<Player>();

        public DelegateCommand SendCommandMessage { get; }

        public ServerMonitorChatViewModel(ServerInfoDto serverInfo, IEventAggregator eventAggregator, ISettingsStoreSource settingsStoreSource, IServerInfoRepository infoRepository)
        {
            _serverId = serverInfo.Id;
            _eventAggregator = eventAggregator;
            _settingsStoreSource = settingsStoreSource;

            AutoScroll = true;
            EnableChat = true;

            _chatHelper = new ChatHelper(_serverId);

            _eventAggregator.GetEvent<BEMessageEvent<BEChatMessage>>()
                .Subscribe(async e => await BeServerChatMessageHandlerAsync(e), ThreadOption.UIThread);

            _eventAggregator.GetEvent<BEMessageEvent<BEAdminLogMessage>>()
                .Subscribe(_beServer_PlayerLog, ThreadOption.UIThread);
            _eventAggregator.GetEvent<BEMessageEvent<BEPlayerLogMessage>>()
                .Subscribe(_beServer_PlayerLog, ThreadOption.UIThread);
            _eventAggregator.GetEvent<BEMessageEvent<BEBanLogMessage>>()
                .Subscribe(_beServer_PlayerLog, ThreadOption.UIThread);

            _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Player>>>()
                .Subscribe(_beServer_PlayerHandler, ThreadOption.UIThread);

            var global = new Player(-1, null, 0, 0, null, "GLOBAL", Player.PlayerState.Ingame);
            Players = new List<Player> { global };
            SelectedPlayer = global;

            ShowHistoryCommand = new ActionCommand(() =>
            {
                var model = new ChatHistoryViewModel(_serverId, infoRepository);
                model.StartDate = DateTime.UtcNow.UtcToLocalFromSettings().AddHours(-5);
                var wnd = new ChatHistory(model, settingsStoreSource);
                wnd.Show();
                wnd.Activate();
            });

            SendCommandMessage = new DelegateCommand(() => SendCommand(), () => string.IsNullOrEmpty(CommandMessage) == false);
        }


        private void SendCommand()
        {
            var local = CommandMessage;
            if (!string.IsNullOrEmpty(local))
            {
                _eventAggregator.GetEvent<BEMessageEvent<BECustomCommand>>()
                    .Publish(new BECustomCommand(_serverId, local));
                OnLogMessageEventHandler(new LogMessage() { Date = DateTime.UtcNow.UtcToLocalFromSettings(), Message = $"Message {local} was sended to server." });
                CommandMessage = string.Empty;
            }
        }

        private void _beServer_PlayerHandler(BEItemsMessage<Player> e)
        {
            if (e.ServerId != _serverId) return;

            var newItems = new List<Player>();
            var global = new Player(-1, null, 0, 0, null, "GLOBAL", Player.PlayerState.Ingame);
            newItems.Add(global);
            newItems.AddRange(e.Items.OrderBy(x => x.Name));

            var selected = SelectedPlayer;

            Players = newItems;

            if (selected != null)
            {
                var newSelected = Players.FirstOrDefault(x => x.Num == selected.Num && x.Name == selected.Name);
                if (newSelected != null) SelectedPlayer = newSelected;
            }
            else
            {
                SelectedPlayer = global;
            }

            ProcessPlayers(e);
        }



        Dictionary<string, string> _prev = new Dictionary<string, string>();
        private void ProcessPlayers(BEItemsMessage<Player> newPlayers)
        {
            if (newPlayers.ServerId != _serverId) return;

            var prev = _prev;
            var next = newPlayers.Items.GroupBy(x => x.Guid).ToDictionary(x => x.Key, x => x.First().Name);

            _prev = next;

            var addedItems = next.Where(x => prev.ContainsKey(x.Key) == false).ToArray();
            var removedItems = prev.Where(x => next.ContainsKey(x.Key) == false).ToArray();

            if (addedItems.Any())
                OnPlayersInHandler(addedItems);

            if (removedItems.Any())
                OnPlayersOutHandler(removedItems);
        }


        private void _beServer_PlayerLog(BEAdminLogMessage e)
        {
            if (_serverId == e.ServerId)
                OnLogMessageEventHandler(e.Message);
        }

        private void _beServer_PlayerLog(BEBanLogMessage e)
        {
            if (_serverId == e.ServerId)
                OnLogMessageEventHandler(e.Message);
        }

        private void _beServer_PlayerLog(BEPlayerLogMessage e)
        {
            if (_serverId == e.ServerId)
                OnLogMessageEventHandler(e.Message);
        }

        public List<Player> Players
        {
            get { return _players; }
            set
            {
                _players = value;
                RaisePropertyChanged();
            }
        }

        private Player _selectedPlayer;
        public Player SelectedPlayer
        {
            get { return _selectedPlayer; }
            set
            {
                _selectedPlayer = value;
                RaisePropertyChanged();
            }
        }

        public bool AutoScroll
        {
            get { return _autoScroll; }
            set
            {
                _autoScroll = value;
                RaisePropertyChanged();
            }
        }

        public bool EnableChat
        {
            get { return _enableChat; }
            set
            {
                _enableChat = value;
                RaisePropertyChanged();
            }
        }

        public string InputMessage
        {
            get { return _inputMessage; }
            set
            {
                _inputMessage = value;
                RaisePropertyChanged();
            }
        }

        public string CommandMessage
        {
            get { return _commandMessage; }
            set
            {
                _commandMessage = value;
                RaisePropertyChanged(nameof(CommandMessage));
                SendCommandMessage.RaiseCanExecuteChanged();
            }
        }

        public ICommand ShowHistoryCommand { get; set; }
        public event EventHandler<ServerMonitorChatViewModelEventArgs> ChatMessageEventHandler;
        public event EventHandler<ServerMonitorLogViewModelEventArgs> LogMessageEventHandler;

        public event EventHandler<IEnumerable<KeyValuePair<string, string>>> PlayersInHandler;
        public event EventHandler<IEnumerable<KeyValuePair<string, string>>> PlayersOutHandler;

        protected virtual void OnChatMessageEventHandler(ChatMessage e)
        {
            ChatMessageEventHandler?.Invoke(this, new ServerMonitorChatViewModelEventArgs(e));
        }

        private async Task BeServerChatMessageHandlerAsync(BEChatMessage e)
        {
            if (e.ServerId != _serverId) return;
            await _chatHelper.RegisterChatMessageAsync(e.Message);
            OnChatMessageEventHandler(e.Message);
        }

        public void SendMessage(string rawmessage)
        {
            if (!string.IsNullOrEmpty(rawmessage))
            {
                var adminName = _settingsStoreSource.GetSettingsStore().AdminName;

                var selectedPlayer = SelectedPlayer;
                var destinationNum = -1;
                if (selectedPlayer != null)
                {
                    destinationNum = selectedPlayer.Num;
                }

                var message = $" {destinationNum} {adminName}: {rawmessage}";

                _eventAggregator.GetEvent<BEMessageEvent<BECommand>>()
                    .Publish(new BECommand(_serverId, CommandType.Say, message));
            }

            InputMessage = string.Empty;
        }

        public void SendMessage()
        {
            if (!string.IsNullOrEmpty(InputMessage))
            {
                SendMessage(InputMessage);
            }
        }

        protected virtual void OnLogMessageEventHandler(LogMessage e)
        {
            LogMessageEventHandler?.Invoke(this, new ServerMonitorLogViewModelEventArgs(e));
        }

        public static Color GetMessageColor(ChatMessage message)
        {
            var type = message.Type;

            var color = Colors.Black;

            switch (type)
            {
                case ChatMessage.MessageType.Command:
                    color = Color.FromRgb(212, 169, 24);
                    break;
                case ChatMessage.MessageType.Direct:
                    color = Color.FromRgb(146, 140, 150);
                    break;
                case ChatMessage.MessageType.Global:
                    color = Color.FromRgb(80, 112, 115);
                    break;
                case ChatMessage.MessageType.Group:
                    color = Color.FromRgb(156, 204, 118);
                    break;
                case ChatMessage.MessageType.RCon:
                    color = Color.FromRgb(252, 31, 23);
                    break;
                case ChatMessage.MessageType.Side:
                    color = Color.FromRgb(25, 181, 209);
                    break;
                case ChatMessage.MessageType.Vehicle:
                    color = Color.FromRgb(155, 115, 0);
                    break;
                case ChatMessage.MessageType.NonCommon:
                    color = Color.FromRgb(89, 173, 10);
                    break;
                // ReSharper disable once RedundantEmptyDefaultSwitchBranch
                default:
                    break;
            }

            return color;
        }

        protected virtual void OnPlayersInHandler(IEnumerable<KeyValuePair<string, string>> e)
        {
            PlayersInHandler?.Invoke(this, e);
        }

        protected virtual void OnPlayersOutHandler(IEnumerable<KeyValuePair<string, string>> e)
        {
            PlayersOutHandler?.Invoke(this, e);
        }

        public void ShowPlayer(string guidIp)
        {
            if (string.IsNullOrEmpty(guidIp) == false)
                _eventAggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(guidIp));
        }
    }

    public class ServerMonitorChatViewModelEventArgs : EventArgs
    {
        public ServerMonitorChatViewModelEventArgs(ChatMessage message)
        {
            Message = message;
        }

        public ChatMessage Message { get; private set; }
    }

    public class ServerMonitorLogViewModelEventArgs : EventArgs
    {
        public ServerMonitorLogViewModelEventArgs(LogMessage message)
        {
            Message = message;
        }

        public LogMessage Message { get; private set; }
    }
}
```

`src/Arma3BE.Client.Modules.ChatModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.CoreModule.Tests/Arma3BE.Client.Modules.CoreModule.Tests.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{969269FC-6C5F-49E9-BC60-96F1AE571B8F}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.CoreModule.Tests</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.CoreModule.Tests</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
    <ReferencePath>$(ProgramFiles)\Common Files\microsoft shared\VSTT\$(VisualStudioVersion)\UITestExtensionPackages</ReferencePath>
    <IsCodedUITest>False</IsCodedUITest>
    <TestProjectType>UnitTest</TestProjectType>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="nunit.framework, Version=3.6.1.0, Culture=neutral, PublicKeyToken=2638cd05610744eb, processorArchitecture=MSIL">
      <HintPath>..\packages\NUnit.3.6.1\lib\net45\nunit.framework.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="StringTemplaterTests.cs" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Modules.CoreModule\Arma3BE.Client.Modules.CoreModule.csproj">
      <Project>{308eef0c-5de3-435e-8249-7a658bfafd08}</Project>
      <Name>Arma3BE.Client.Modules.CoreModule</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <Choose>
    <When Condition="('$(VisualStudioVersion)' == '10.0' or '$(VisualStudioVersion)' == '') and '$(TargetFrameworkVersion)' == 'v3.5'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework, Version=10.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
      </ItemGroup>
    </When>
    <Otherwise>
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework" />
      </ItemGroup>
    </Otherwise>
  </Choose>
  <Choose>
    <When Condition="'$(VisualStudioVersion)' == '10.0' And '$(IsCodedUITest)' == 'True'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.CodedUITestFramework, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Extension, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITesting, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
      </ItemGroup>
    </When>
  </Choose>
  <Import Project="$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets" Condition="Exists('$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets')" />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.CoreModule.Tests/StringTemplaterTests.cs`:

```cs
using NUnit.Framework;

namespace Arma3BE.Client.Modules.CoreModule.Tests
{
    [TestFixture]
    public class StringTemplaterTests
    {
        [Test]
        public void TemplateSimpleTest()
        {
            var templater = new StringTemplater();
            var actual = templater.Template("some text");
            Assert.AreEqual("some text", actual);
        }


        [Test]
        public void TemplateParametersTest()
        {
            var templater = new StringTemplater();
            templater.AddParameter("Param", "value");
            var actual = templater.Template("some text {Param}");
            Assert.AreEqual("some text value", actual);
        }
    }
}
```

`src/Arma3BE.Client.Modules.CoreModule.Tests/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="NUnit" version="3.6.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.CoreModule/Arma3BE.Client.Modules.CoreModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{308EEF0C-5DE3-435E-8249-7A658BFAFD08}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.CoreModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.CoreModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject />
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="CoreModuleInit.cs" />
    <Compile Include="Helpers\BanHelper.cs" />
    <Compile Include="Helpers\MessageHelper.cs" />
    <Compile Include="StringTemplater.cs" />
  </ItemGroup>
  <ItemGroup>
    <Folder Include="Data\" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.CoreModule/CoreModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.CoreModule.Helpers;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Repositories.Players;
using Arma3BEClient.Libs.Tools;
using Microsoft.Practices.Unity;
using Prism.Modularity;

namespace Arma3BE.Client.Modules.CoreModule
{
    public class CoreModuleInit : IModule
    {
        private readonly IUnityContainer _container;

        public CoreModuleInit(IUnityContainer container)
        {
            _container = container;
        }

        public void Initialize()
        {
            _container.RegisterType<ILog, Log>();
            _container.RegisterType<ICacheFactory, CacheFactory>();
            _container.RegisterType<ISettingsStoreSource, SettingsStoreSource>();

            _container.RegisterType<IPlayerRepository>(
                new InjectionFactory(
                    c =>
                    //new PlayerRepositoryCache(c.Resolve<PlayerRepository>())
                    new PlayerRepositoryCacheV2(c.Resolve<PlayerRepository>(), c.Resolve<ICacheFactory>())
                        ));

            //_container.RegisterType<IPlayerRepository, PlayerRepositoryCacheV2>();


            _container.RegisterType<IServerInfoRepository>(
               new InjectionFactory(
                   c =>
                       new ServerInfoRepositoryCache(
                           c.Resolve<ServerInfoRepository>())));

            _container.RegisterType<IBanHelper, BanHelper>();
        }
    }
}
```

`src/Arma3BE.Client.Modules.CoreModule/Helpers/BanHelper.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Infrastructure.Helpers.Views;
using Arma3BE.Server;
using Arma3BE.Server.Models;
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Repositories.Players;
using Arma3BEClient.Libs.Tools;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace Arma3BE.Client.Modules.CoreModule.Helpers
{
    public class BanHelper : StateHelper<Ban>, IBanHelper
    {
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private readonly IEventAggregator _eventAggregator;
        private readonly IPlayerRepository _playerRepository;
        private readonly ISettingsStoreSource _settingsStoreSource;
        private readonly Regex _replace = new Regex(@"\[[^\]^\[]*\]", RegexOptions.Compiled | RegexOptions.Multiline);
        private readonly MessageHelper _messageHelper;

        public BanHelper(IEventAggregator eventAggregator, IPlayerRepository playerRepository, ISettingsStoreSource settingsStoreSource)
        {
            _eventAggregator = eventAggregator;
            _playerRepository = playerRepository;
            _settingsStoreSource = settingsStoreSource;
            _messageHelper = new MessageHelper();
        }

        public Task RegisterBans(IEnumerable<Ban> list, Guid currentServerId)
        {
            return Task.Run(() => RegisterBansInternal(list, currentServerId));
        }

        private async Task<bool> RegisterBansInternal(IEnumerable<Ban> list, Guid currentServerId)
        {
            using (_log.Time("RegisterBansInternal"))
            {
                var bans = list.ToList();

                if (!HaveChanges(bans, x => x.Num,
                    (x, y) => x.GuidIp == y.GuidIp && x.Reason == y.Reason && x.Num == y.Num))
                    return false;


                using (var banRepository = new BanRepository())
                {

                    var db =
                        (await banRepository.GetActiveBansAsync(currentServerId)).ToArray();

                    var ids = bans.Select(x => x.GuidIp).ToList();

                    ids.AddRange(db.Select(x => x.GuidIp).ToList());
                    ids = ids.Distinct().ToList();

                    var players = (await _playerRepository.GetPlayersAsync(ids.ToArray())).ToArray();

                    var bansToUpdate = new List<Arma3BEClient.Libs.ModelCompact.Ban>();
                    var bansToAdd = new List<Arma3BEClient.Libs.ModelCompact.Ban>();
                    var playersToUpdateComments = new Dictionary<Guid, string>();

                    foreach (var ban in db)
                    {
                        var needUpdate = false;

                        var actual = bans.FirstOrDefault(x => x.GuidIp == ban.GuidIp);
                        if (actual == null)
                        {
                            ban.IsActive = false;
                            needUpdate = true;
                        }
                        else
                        {
                            if (ban.MinutesLeft != actual.Minutesleft)
                            {
                                ban.MinutesLeft = actual.Minutesleft;
                                needUpdate = true;
                            }

                            if (ban.PlayerId == null)
                            {
                                var player = players.FirstOrDefault(x => x.GUID == ban.GuidIp);
                                if (player != null && !string.IsNullOrEmpty(ban.Reason))
                                {
                                    ban.PlayerId = player.Id;

                                    var comm = ban.Reason;

                                    var ind1 = comm.IndexOf('[');
                                    var ind2 = comm.LastIndexOf(']');

                                    if (ind1 > -1 && ind2 > ind1) comm = comm.Remove(ind1, ind2 - ind1 + 1).Trim();

                                    if (string.IsNullOrEmpty(player.Comment) || !player.Comment.Contains(comm))
                                    {
                                        player.Comment = $"{player.Comment} | {comm}";

                                        if (!playersToUpdateComments.ContainsKey(player.Id))
                                            playersToUpdateComments.Add(player.Id, player.Comment);
                                        else
                                            playersToUpdateComments[player.Id] = player.Comment;
                                    }

                                    needUpdate = true;
                                }
                            }
                        }

                        if (needUpdate)
                            bansToUpdate.Add(ban);
                    }

                    foreach (var ban in bans)
                    {
                        var bdb = db.FirstOrDefault(x => x.ServerId == currentServerId && x.GuidIp == ban.GuidIp);
                        if (bdb == null)
                        {
                            var player = players.FirstOrDefault(x => x.GUID == ban.GuidIp);

                            var newBan = new Arma3BEClient.Libs.ModelCompact.Ban
                            {
                                CreateDate = DateTime.UtcNow,
                                GuidIp = ban.GuidIp,
                                IsActive = true,
                                Minutes = ban.Minutesleft,
                                MinutesLeft = ban.Minutesleft,
                                Num = ban.Num,
                                Reason = ban.Reason,
                                ServerId = currentServerId,
                                PlayerId = player?.Id
                            };

                            bansToAdd.Add(newBan);

                            var comm = _replace.Replace(ban.Reason, string.Empty).Trim();
                            if (player != null &&
                                (string.IsNullOrEmpty(player.Comment) || !player.Comment.Contains(comm)))
                            {
                                player.Comment = $"{player.Comment} | {comm}";

                                if (!playersToUpdateComments.ContainsKey(player.Id))
                                    playersToUpdateComments.Add(player.Id, player.Comment);
                                else
                                    playersToUpdateComments[player.Id] = player.Comment;
                            }
                        }
                    }

                    await banRepository.AddOrUpdateAsync(bansToAdd);
                    await banRepository.AddOrUpdateAsync(bansToUpdate);
                    await _playerRepository.UpdateCommentAsync(playersToUpdateComments);
                }

                return true;
            }
        }

        public async Task<IEnumerable<BanView>> GetBanViewAsync(IEnumerable<Ban> list)
        {
            using (_log.Time("GetBanViewAsync"))
            {
                var bans = list as Ban[] ?? list.ToArray();
                var guids = bans.Select(x => x.GuidIp).ToArray();
                var players = await _playerRepository.GetPlayersAsync(guids);

                return bans.Select(x =>
                {
                    var p = players.FirstOrDefault(y => y.GUID == x.GuidIp);

                    var ban = new BanView
                    {
                        Num = x.Num,
                        GuidIp = x.GuidIp,
                        Reason = x.Reason,
                        Minutesleft = x.Minutesleft,
                    };

                    if (p != null)
                    {
                        ban.PlayerComment = p.Comment;
                        ban.PlayerName = p.Name;
                        ban.SteamId = p.SteamId;
                    }
                    return ban;
                }).ToList();
            }
        }

        private void SendCommand(Guid serverId, CommandType commandType, string parameters = null)
        {
            _eventAggregator.GetEvent<BEMessageEvent<BECommand>>()
                .Publish(new BECommand(serverId, commandType, parameters));
        }


        public async Task KickAsync(Guid serverId, int playerNum, string playerGuid, string reason, bool isAuto = false)
        {
            var totalreason = _messageHelper.GetKickMessage(_settingsStoreSource.GetSettingsStore(), reason);

            SendCommand(serverId, CommandType.Kick,
                $"{playerNum} {totalreason}");

            if (!isAuto)
            {

                var user = await _playerRepository.GetPlayerAsync(playerGuid);
                if (user != null)
                {
                    await _playerRepository.AddNotesAsync(user.Id, $"Kicked with reason: {totalreason}");
                    user.Comment = $"{user.Comment} | {reason}";
                    await _playerRepository.UpdatePlayerCommentAsync(user.GUID, user.Comment);
                }

            }
        }

        public async Task BanGUIDOfflineAsync(Guid serverId, string guid, string reason, long minutes, bool syncMode = false)
        {
            if (!syncMode)
            {
                var totalreason = _messageHelper.GetBanMessage(_settingsStoreSource.GetSettingsStore(), reason, minutes);

                SendCommand(serverId, CommandType.AddBan,
                    $"{guid} {minutes} {totalreason}");

                var user = await _playerRepository.GetPlayerAsync(guid);
                if (user != null)
                {
                    await _playerRepository.AddNotesAsync(user.Id, $"Baned with reason: {totalreason}");
                    user.Comment = $"{user.Comment} | {reason}";
                    await _playerRepository.UpdatePlayerCommentAsync(user.GUID, user.Comment);
                }


            }
            else
            {
#pragma warning disable 4014
                SendCommand(serverId, CommandType.AddBan,
#pragma warning restore 4014
                    $"{guid} {minutes} {reason}");
            }
        }

        public async Task BanGUIDOfflineAsync(Guid serverId, BanView[] bans, bool syncMode = false)
        {
            foreach (var ban in bans)
            {
                await BanGUIDOfflineAsync(serverId, ban.GuidIp, ban.Reason, ban.Minutesleft, syncMode);
            }

        }

        public async Task BanGuidOnlineAsync(Guid serverId, string num, string guid, string reason, long minutes)
        {
            var totalreason = _messageHelper.GetBanMessage(_settingsStoreSource.GetSettingsStore(), reason, minutes);


            SendCommand(serverId, CommandType.Ban,
                $"{num} {minutes} {totalreason}");



            var user = await _playerRepository.GetPlayerAsync(guid);
            if (user != null)
            {
                await _playerRepository.AddNotesAsync(user.Id, $"Baned with reason: {totalreason}");
                user.Comment = $"{user.Comment} | {reason}";
                await _playerRepository.UpdatePlayerCommentAsync(user.GUID, user.Comment);
            }

        }
    }
}
```

`src/Arma3BE.Client.Modules.CoreModule/Helpers/MessageHelper.cs`:

```cs
using Arma3BEClient.Libs.Tools;
using System;

namespace Arma3BE.Client.Modules.CoreModule.Helpers
{
    public class MessageHelper
    {
        public string GetKickMessage(ISettingsStore settingsStore, string reason)
        {
            // [{AdminName}][{Date} {Time}] {Reason}
            var templater = new StringTemplater();
            PrepareTemplate(settingsStore, reason, templater);
            return templater.Template(settingsStore.KickMessageTemplate);
        }

        public string GetBanMessage(ISettingsStore settingsStore, string reason, long minutes)
        {
            // [{AdminName}][{Date} {Time}] {Reason}
            var templater = new StringTemplater();
            PrepareTemplate(settingsStore, reason, templater);

            templater.AddParameter("Minutes", minutes == 0 ? $"perm" : $"{minutes}");

            return templater.Template(settingsStore.BanMessageTemplate);
        }

        private static void PrepareTemplate(ISettingsStore settingsStore, string reason, StringTemplater templater)
        {
            templater.AddParameter("AdminName", settingsStore.AdminName);
            templater.AddParameter("Reason", reason);
            templater.AddParameter("Date", () => DateTime.UtcNow.ToString("dd.MM.yy"));
            templater.AddParameter("Time", () => DateTime.UtcNow.ToString("HH:mm:ss"));
        }
    }
}
```

`src/Arma3BE.Client.Modules.CoreModule/StringTemplater.cs`:

```cs
using System;
using System.Collections.Generic;

namespace Arma3BE.Client.Modules.CoreModule
{
    public class StringTemplater
    {
        private readonly IDictionary<string, Func<string>> _params;

        public StringTemplater()
        {
            _params = new Dictionary<string, Func<string>>();
        }

        public string Template(string someText)
        {
            var result = someText;

            foreach (var p in _params)
            {
                result = result.Replace($"{{{p.Key}}}", p.Value());
            }

            return result;
        }

        public void AddParameter(string param, string value)
        {
            _params.Add(param, () => value);
        }

        public void AddParameter(string param, Func<string> value)
        {
            _params.Add(param, value);
        }
    }
}
```

`src/Arma3BE.Client.Modules.CoreModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.DevTools/Arma3BE.Client.Modules.DevTools.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{1EE247D9-EAD2-4E52-82DA-270BBEB688E9}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.DevTools</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.DevTools</AssemblyName>
    <TargetFrameworkVersion>v4.5.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject />
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism, Version=6.2.0.0, Culture=neutral, PublicKeyToken=91a96d2a154366d8, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.2.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.2.0.0, Culture=neutral, PublicKeyToken=91a96d2a154366d8, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.2.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.2.0.0, Culture=neutral, PublicKeyToken=91a96d2a154366d8, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.2.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.2.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=2.9.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.2.9\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=2.9.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.2.9\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=2.9.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.2.9\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=2.9.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.2.9\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=2.9.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.2.9\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=2.9.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.2.9\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="DevToolsModuleInit.cs" />
    <Compile Include="Models\LogViewerViewModel.cs" />
    <Compile Include="Windows\LogViewer.xaml.cs">
      <DependentUpon>LogViewer.xaml</DependentUpon>
    </Compile>
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <None Include="packages.config" />
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <AppDesigner Include="Properties\" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Page Include="Windows\LogViewer.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.DevTools/DevToolsModuleInit.cs`:

```cs
using System.Diagnostics;
using System.Windows.Controls;
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Modules.DevTools.Models;
using Arma3BE.Client.Modules.DevTools.Windows;
using Microsoft.Practices.Unity;
using Prism.Commands;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.DevTools
{
    public class DevToolsModuleInit : IModule
    {
        private static IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public DevToolsModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            InitDebug();
        }

        [Conditional("DEBUG")]
        private void InitDebug()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.MenuToolsRegion, CreateSteamDiscoveryView);
        }

        private object CreateSteamDiscoveryView()
        {
            return new MenuItem()
            {
                Header = "DevTools",
                ItemsSource = new[]
                {
                    new MenuItem()
                    {
                        Header = "Log viewer",
                        Command = new DelegateCommand(() =>
                        {
                            var vm = _container.Resolve<LogViewerViewModel>();
                            var w = _container.Resolve<LogViewer>();
                            w.DataContext = vm;
                            w.Show();
                        })
                    },
                }
            };
        }
    }
}
```

`src/Arma3BE.Client.Modules.DevTools/Models/LogViewerViewModel.cs`:

```cs
using System.Collections.ObjectModel;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Models;
using Prism.Events;

namespace Arma3BE.Client.Modules.DevTools.Models
{
    public class LogViewerViewModel : ViewModelBase
    {
        public LogViewerViewModel(IEventAggregator aggregator)
        {
            Messages = new ObservableCollection<LoggerMessage>();


            aggregator.GetEvent<LoggerMessageEvent>().Subscribe(ProcessMessage, ThreadOption.UIThread);

            aggregator.GetEvent<ShowUserInfoEvent>().Subscribe(e =>
            {
                ProcessMessage(new LoggerMessage(LoggerMessage.LogLevel.Info, e.UserGuid));
            }, ThreadOption.UIThread);
        }

        public ObservableCollection<LoggerMessage> Messages { get; set; }


        private void ProcessMessage(LoggerMessage message)
        {
            Messages.Add(message);
        }

        public LoggerMessage SelectedMessage { get; set; }
    }
}
```

`src/Arma3BE.Client.Modules.DevTools/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Resources;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Windows;

// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
[assembly: AssemblyTitle("Arma3BE.Client.Modules.DevTools")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("Arma3BE.Client.Modules.DevTools")]
[assembly: AssemblyCopyright("Copyright ©  2016")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Setting ComVisible to false makes the types in this assembly not visible 
// to COM components.  If you need to access a type in this assembly from 
// COM, set the ComVisible attribute to true on that type.
[assembly: ComVisible(false)]

//In order to begin building localizable applications, set 
//<UICulture>CultureYouAreCodingWith</UICulture> in your .csproj file
//inside a <PropertyGroup>.  For example, if you are using US english
//in your source files, set the <UICulture> to en-US.  Then uncomment
//the NeutralResourceLanguage attribute below.  Update the "en-US" in
//the line below to match the UICulture setting in the project file.

//[assembly: NeutralResourcesLanguage("en-US", UltimateResourceFallbackLocation.Satellite)]


[assembly: ThemeInfo(
    ResourceDictionaryLocation.None, //where theme specific resource dictionaries are located
                                     //(used if a resource is not found in the page, 
                                     // or application resource dictionaries)
    ResourceDictionaryLocation.SourceAssembly //where the generic resource dictionary is located
                                              //(used if a resource is not found in the page, 
                                              // app, or any theme specific resource dictionaries)
)]


// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Build and Revision Numbers 
// by using the '*' as shown below:
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]

```

`src/Arma3BE.Client.Modules.DevTools/Properties/Resources.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Arma3BE.Client.Modules.DevTools.Properties
{


    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "4.0.0.0")]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    internal class Resources
    {

        private static global::System.Resources.ResourceManager resourceMan;

        private static global::System.Globalization.CultureInfo resourceCulture;

        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources()
        {
        }

        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager
        {
            get
            {
                if ((resourceMan == null))
                {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("Arma3BE.Client.Modules.DevTools.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }

        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture
        {
            get
            {
                return resourceCulture;
            }
            set
            {
                resourceCulture = value;
            }
        }
    }
}

```

`src/Arma3BE.Client.Modules.DevTools/Properties/Resources.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>
```

`src/Arma3BE.Client.Modules.DevTools/Properties/Settings.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Arma3BE.Client.Modules.DevTools.Properties
{


    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "11.0.0.0")]
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase
    {

        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));

        public static Settings Default
        {
            get
            {
                return defaultInstance;
            }
        }
    }
}

```

`src/Arma3BE.Client.Modules.DevTools/Properties/Settings.settings`:

```settings
<?xml version='1.0' encoding='utf-8'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>
```

`src/Arma3BE.Client.Modules.DevTools/Windows/LogViewer.xaml`:

```xaml
<Window x:Class="Arma3BE.Client.Modules.DevTools.Windows.LogViewer"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Arma3BE.Client.Modules.DevTools"
        xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
        mc:Ignorable="d"
        Title="LogViewer" Height="300" Width="300">
    <Grid>
        <ScrollViewer>
            <xcdg:DataGridControl Name="dg" ItemsSource="{Binding Messages}"
                              AutoCreateColumns="False" ReadOnly="True" SelectedItem="{Binding SelectedMessage, Mode=TwoWay}">
                <!--<xcdg:DataGridControl.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Ban" Command="{Binding BanCommand}" />
                        <MenuItem Header="Player Info" Command="{Binding PlayerInfoCommand}" />
                    </ContextMenu>
                </xcdg:DataGridControl.ContextMenu>-->

                <xcdg:DataGridControl.View>
                    <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                        <xcdg:TableView.FixedHeaders>
                            <DataTemplate>
                                <xcdg:ColumnManagerRow />
                            </DataTemplate>
                        </xcdg:TableView.FixedHeaders>
                    </xcdg:TableflowView>
                </xcdg:DataGridControl.View>
            </xcdg:DataGridControl>
        </ScrollViewer>
    </Grid>
</Window>

```

`src/Arma3BE.Client.Modules.DevTools/Windows/LogViewer.xaml.cs`:

```cs
using System.Windows;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;

namespace Arma3BE.Client.Modules.DevTools.Windows
{
    /// <summary>
    /// Interaction logic for LogViewer.xaml
    /// </summary>
    public partial class LogViewer : Window
    {
        public LogViewer()
        {
            InitializeComponent();

            foreach (var generateColumn in GridHelper.GenerateColumns<LoggerMessage>())
            {
                dg.Columns.Add(generateColumn);
            }
        }
    }
}

```

`src/Arma3BE.Client.Modules.DevTools/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Extended.Wpf.Toolkit" version="2.9" targetFramework="net452" />
  <package id="Prism.Core" version="6.2.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.2.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.2.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.IndicatorsModule/Arma3BE.Client.Modules.IndicatorsModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.IndicatorsModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.IndicatorsModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject />
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="IndicatorsModuleInit.cs" />
    <Compile Include="LastUpdateIndicator.xaml.cs">
      <DependentUpon>LastUpdateIndicator.xaml</DependentUpon>
    </Compile>
    <Compile Include="LastUpdateIndicatorViewModel.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="LastUpdateIndicator.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{B58670E5-011F-4318-964E-35C8B63870A5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{E5240A50-E944-4F50-A353-2E3C9E547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.IndicatorsModule/IndicatorsModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.IndicatorsModule
{
    public class IndicatorsModuleInit : IModule
    {
        private readonly IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public IndicatorsModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.BottomUpdateIndicatorRegion, CreateView);
        }

        private object CreateView()
        {
            return ServerTabViewHelper.RegisterView<LastUpdateIndicator, ServerInfoDto, LastUpdateIndicatorViewModel>(_container,
                "serverInfo");
        }
    }
}
```

`src/Arma3BE.Client.Modules.IndicatorsModule/LastUpdateIndicator.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.IndicatorsModule.LastUpdateIndicator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Arma3BE.Client.Modules.IndicatorsModule"
             mc:Ignorable="d" >
    <Grid Margin="5 0 5 0">
        <TextBlock Text="{Binding LastUpdate, Mode=OneWay}"></TextBlock>
    </Grid>
</UserControl>

```

`src/Arma3BE.Client.Modules.IndicatorsModule/LastUpdateIndicator.xaml.cs`:

```cs
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.IndicatorsModule
{
    /// <summary>
    /// Interaction logic for LastUpdateIndicator.xaml
    /// </summary>
    /// // ReSharper disable once RedundantExtendsListEntry
    public partial class LastUpdateIndicator : UserControl
    {
        public LastUpdateIndicator()
        {
            InitializeComponent();
        }
    }
}

```

`src/Arma3BE.Client.Modules.IndicatorsModule/LastUpdateIndicatorViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Libs.ModelCompact;
using Prism.Events;
using System;
using Arma3BEClient.Libs.Repositories;

namespace Arma3BE.Client.Modules.IndicatorsModule
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class LastUpdateIndicatorViewModel : ViewModelBase
    {
        private readonly ServerInfoDto _serverInfo;

        public LastUpdateIndicatorViewModel(IEventAggregator eventAggregator, ServerInfoDto serverInfo)
        {
            _serverInfo = serverInfo;
            eventAggregator.GetEvent<BEMessageEvent<BEMessage>>().Subscribe(AddMessage);
        }

        private void AddMessage(BEMessage message)
        {
            if (_serverInfo.Id != message.ServerId) return;
            LastUpdate = $"Last update at {DateTime.UtcNow.UtcToLocalFromSettings().ToLongTimeString()}";
            // ReSharper disable once ExplicitCallerInfoArgument
            RaisePropertyChanged(nameof(LastUpdate));
        }

        // ReSharper disable once UnusedAutoPropertyAccessor.Global
        // ReSharper disable once MemberCanBePrivate.Global
        public string LastUpdate { get; private set; }
    }
}
```

`src/Arma3BE.Client.Modules.IndicatorsModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.MainModule/About.xaml`:

```xaml
<Window x:Class="Arma3BE.Client.Modules.MainModule.About"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="About" 
        WindowStyle="ToolWindow" 
        ResizeMode="NoResize" WindowStartupLocation="CenterScreen"
        SizeToContent="WidthAndHeight"
        Width="350"
        Height="300"
        >

    <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>

                <RowDefinition Height="Auto"></RowDefinition>
            </Grid.RowDefinitions>

            <Label Grid.Column="0" Grid.Row="0" VerticalAlignment="Center">Company</Label>
            <Label Grid.Column="0" Grid.Row="1" VerticalAlignment="Center">Title</Label>
            <Label Grid.Column="0" Grid.Row="2" VerticalAlignment="Center">Product</Label>
            <Label Grid.Column="0" Grid.Row="3" VerticalAlignment="Center">Description</Label>
            <Label Grid.Column="0" Grid.Row="4" VerticalAlignment="Center">Sources</Label>
            <Label Grid.Column="0" Grid.Row="5" VerticalAlignment="Center">Latest version</Label>
            <Label Grid.Column="0" Grid.Row="6" VerticalAlignment="Center">Author</Label>

            <Label Grid.Column="0" Grid.Row="7" VerticalAlignment="Center">Powered by</Label>
            <Label Grid.Column="0" Grid.Row="8" VerticalAlignment="Center">Copyright</Label>

            <Label Grid.Column="1" Grid.Row="0" Name="lbCompany" FontSize="20">Company</Label>
            <Label Grid.Column="1" Grid.Row="1" Name="lbTitle" FontSize="20">Title</Label>
            <Label Grid.Column="1" Grid.Row="2" Name="lbProduct" FontSize="20">Product</Label>
            <Label Grid.Column="1" Grid.Row="3" MaxWidth="300">
                <TextBlock Name="lbDescription" TextWrapping="WrapWithOverflow"></TextBlock>
            </Label>


            <Label Grid.Column="1" Grid.Row="7">
                <Hyperlink NavigateUri="https://github.com/marceldev89/BattleNET" RequestNavigate="Hyperlink_RequestNavigate">BattleNET</Hyperlink>
            </Label>

            <Label Grid.Column="1" Grid.Row="8" Name="lbCopyright">Copyright</Label>

            <Label Grid.Column="1" Grid.Row="4">
                <Hyperlink NavigateUri="https://github.com/tym32167/arma3beclient" RequestNavigate="Hyperlink_RequestNavigate">github</Hyperlink>
            </Label>

            <Label Grid.Column="1" Grid.Row="5">
                <Hyperlink NavigateUri="https://github.com/tym32167/arma3beclient/releases/latest" RequestNavigate="Hyperlink_RequestNavigate">download</Hyperlink>
            </Label>

            <Label Grid.Column="1" Grid.Row="6">
                <Hyperlink NavigateUri="mailto:tym32167@gmail.com" RequestNavigate="Hyperlink_RequestNavigate">Artem Muradov (tym32167@gmail.com)</Hyperlink>
            </Label>

        </Grid>
    </Border>
</Window>

```

`src/Arma3BE.Client.Modules.MainModule/About.xaml.cs`:

```cs
using System.Diagnostics;
using System.Reflection;
using System.Windows;
using System.Windows.Navigation;

namespace Arma3BE.Client.Modules.MainModule
{
    /// <summary>
    /// Interaction logic for About.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class About : Window
    {
        public About()
        {
            InitializeComponent();
            Init();
        }

        private void Init()
        {
            var app = Assembly.GetExecutingAssembly();

            AssemblyTitleAttribute title = (AssemblyTitleAttribute)app.GetCustomAttributes(typeof(AssemblyTitleAttribute), false)[0];
            AssemblyProductAttribute product = (AssemblyProductAttribute)app.GetCustomAttributes(typeof(AssemblyProductAttribute), false)[0];
            AssemblyCopyrightAttribute copyright = (AssemblyCopyrightAttribute)app.GetCustomAttributes(typeof(AssemblyCopyrightAttribute), false)[0];
            AssemblyCompanyAttribute company = (AssemblyCompanyAttribute)app.GetCustomAttributes(typeof(AssemblyCompanyAttribute), false)[0];
            AssemblyDescriptionAttribute description = (AssemblyDescriptionAttribute)app.GetCustomAttributes(typeof(AssemblyDescriptionAttribute), false)[0];

            var version = Assembly.GetExecutingAssembly().GetName().Version;

            lbTitle.Content = title.Title;
            lbCompany.Content = company.Company;
            lbCopyright.Content = copyright.Copyright;
            lbDescription.Text = description.Description;
            lbProduct.Content = $"{product.Product} ver {version.ToString(3)}";
        }

        private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
        {
            Process.Start(new ProcessStartInfo(e.Uri.AbsoluteUri));
            e.Handled = true;
        }
    }
}

```

`src/Arma3BE.Client.Modules.MainModule/Arma3BE.Client.Modules.MainModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.MainModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.MainModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <RunCodeAnalysis>false</RunCodeAnalysis>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="log4net, Version=2.0.8.0, Culture=neutral, PublicKeyToken=669e0ddf0bb1aa2a, processorArchitecture=MSIL">
      <HintPath>..\packages\log4net.2.0.8\lib\net45-full\log4net.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="MaxMind.Db, Version=2.0.0.0, Culture=neutral, PublicKeyToken=66afa4cc5ae853ac, processorArchitecture=MSIL">
      <HintPath>..\packages\MaxMind.Db.2.2.0\lib\net45\MaxMind.Db.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="MaxMind.GeoIP2, Version=2.6.0.0, Culture=neutral, PublicKeyToken=66afa4cc5ae853ac, processorArchitecture=MSIL">
      <HintPath>..\packages\MaxMind.GeoIP2.2.8.0\lib\net45\MaxMind.GeoIP2.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
    <Reference Include="Newtonsoft.Json, Version=10.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed, processorArchitecture=MSIL">
      <HintPath>..\packages\Newtonsoft.Json.10.0.3\lib\net45\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="RestSharp, Version=106.2.1.0, Culture=neutral, PublicKeyToken=598062e77f915f75, processorArchitecture=MSIL">
      <HintPath>..\packages\RestSharp.106.2.1\lib\net452\RestSharp.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.ComponentModel.DataAnnotations" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Numerics" />
    <Reference Include="System.Security.Cryptography.Algorithms, Version=4.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.Algorithms.4.3.0\lib\net461\System.Security.Cryptography.Algorithms.dll</HintPath>
    </Reference>
    <Reference Include="System.Security.Cryptography.Encoding, Version=4.0.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.Encoding.4.3.0\lib\net46\System.Security.Cryptography.Encoding.dll</HintPath>
    </Reference>
    <Reference Include="System.Security.Cryptography.Primitives, Version=4.0.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.Primitives.4.3.0\lib\net46\System.Security.Cryptography.Primitives.dll</HintPath>
    </Reference>
    <Reference Include="System.Security.Cryptography.X509Certificates, Version=4.1.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.X509Certificates.4.3.0\lib\net461\System.Security.Cryptography.X509Certificates.dll</HintPath>
    </Reference>
    <Reference Include="System.ValueTuple, Version=4.0.2.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51, processorArchitecture=MSIL">
      <HintPath>..\packages\System.ValueTuple.4.4.0\lib\net461\System.ValueTuple.dll</HintPath>
    </Reference>
    <Reference Include="System.Web" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="About.xaml.cs">
      <DependentUpon>About.xaml</DependentUpon>
    </Compile>
    <Compile Include="AvalonDockRegionAdapter.cs" />
    <Compile Include="MainModuleInit.cs" />
    <Compile Include="MainWindow.xaml.cs">
      <DependentUpon>MainWindow.xaml</DependentUpon>
    </Compile>
    <Compile Include="Properties\Annotations.cs" />
    <Compile Include="ServerInfoControl.xaml.cs">
      <DependentUpon>ServerInfoControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="ViewModel\MainViewModel.cs" />
    <Compile Include="ViewModel\ServerMonitorModel.cs" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="About.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="MainWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="ServerInfoControl.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup />
  <ItemGroup>
    <None Include="app.config" />
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{B58670E5-011F-4318-964E-35C8B63870A5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Steam\Arma3BE.Steam.csproj">
      <Project>{b2948bd4-b413-4e9d-b9ed-41261b0c56da}</Project>
      <Name>Arma3BE.Steam</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.MainModule/AvalonDockRegionAdapter.cs`:

```cs
using System;
using System.Collections.Specialized;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.MainModule.ViewModel;
using Prism.Regions;
using Xceed.Wpf.AvalonDock;
using Xceed.Wpf.AvalonDock.Layout;

namespace Arma3BE.Client.Modules.MainModule
{
    public class AvalonDockRegionAdapter : RegionAdapterBase<DockingManager>
    {
        public AvalonDockRegionAdapter(IRegionBehaviorFactory regionBehaviorFactory) : base(regionBehaviorFactory)
        {
        }

        protected override void Adapt(IRegion region, DockingManager regionTarget)
        {
            region.Views.CollectionChanged += delegate(
                object sender, NotifyCollectionChangedEventArgs e)
            {
                OnViewsCollectionChanged(e, regionTarget);
            };

            regionTarget.DocumentClosed += async (s, e) =>
            {
                await CloseView(region, regionTarget, e.Document);
            };
        }

        private async Task CloseView(IRegion region, DockingManager regionTarget, LayoutDocument document)
        {
            region.Remove(document.Content);

            var viewModel = (document.Content as FrameworkElement)?.DataContext as ServerMonitorModel;
            if (viewModel != null)
            {
                await viewModel.CloseServerAsync();
                viewModel.Cleanup();
            }

            if (!region.Views.Any())
            {
                regionTarget.ActiveContent = null;
            }
        }

        async void OnViewsCollectionChanged(NotifyCollectionChangedEventArgs e, DockingManager regionTarget)
        {
            switch (e.Action)
            {
                case NotifyCollectionChangedAction.Add:

                    foreach (FrameworkElement item in e.NewItems)
                    {
                        //Create a new layout document to be included in the LayoutDocuemntPane (defined in xaml)
                        LayoutDocument newLayoutDocument = new LayoutDocument
                        {
                            Content = item,
                            Title = (item.DataContext as ITitledItem)?.Title
                        };
                        //Set the content of the LayoutDocument

                        var viewModel = item.DataContext as ServerMonitorModel;
                        if (viewModel != null)
                        {
                            //All my viewmodels have properties DisplayName and IconKey
                            newLayoutDocument.Title = viewModel.CurrentServer.Name;
                            await viewModel.OpenServerAsync();
                        }

                        var layoutDocumentPane = new LayoutDocumentPane();

                        if (regionTarget.Layout.RootPanel.Children.Count == 0)
                        {
                            regionTarget.Layout.RootPanel.Children.Add(layoutDocumentPane);
                        }
                        else
                        {
                            layoutDocumentPane = regionTarget.Layout.RootPanel.Children[0] as LayoutDocumentPane;
                        }

                        layoutDocumentPane?.Children?.Add(newLayoutDocument);
                        regionTarget.ActiveContent = newLayoutDocument.Content;
                    }

                    break;
                case NotifyCollectionChangedAction.Remove:
                    foreach (var eOldItem in e.OldItems)
                    {
                        var disposables = new[]
                        {
                            eOldItem as IDisposable,
                            (eOldItem as FrameworkElement)?.DataContext as IDisposable,
                            (eOldItem as ContentControl)?.Content as IDisposable,
                            ((eOldItem as ContentControl)?.Content as FrameworkElement)?.DataContext as IDisposable
                        };

                        foreach (var disposable in disposables)
                        {
                            disposable?.Dispose();
                        }
                    }
                    break;
                default:
                    break;
            }
        }

        protected override IRegion CreateRegion()
        {
            return new SingleActiveRegion();
        }
    }
}
```

`src/Arma3BE.Client.Modules.MainModule/MainModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Modules.MainModule.ViewModel;
using Arma3BE.Server.Abstract;
using Arma3BE.Server.ServerFactory;
using Microsoft.Practices.ServiceLocation;
using Microsoft.Practices.Unity;
using Prism.Modularity;
using Prism.Regions;
using System.Configuration;
using Xceed.Wpf.AvalonDock;

namespace Arma3BE.Client.Modules.MainModule
{
    public class MainModuleInit : IModule
    {
        private readonly IRegionManager _regionManager;
        private const string DebugServerKey = "DebugServerEnabled";

        public MainModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            var container1 = container;
            _regionManager = regionManager;

            container1.RegisterType<MainViewModel>();
            container1.RegisterType<MainWindow>();

            if (ConfigurationManager.AppSettings[DebugServerKey] != bool.TrueString)
                container1.RegisterType<IBattlEyeServerFactory, WatcherBEServerFactory>();
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.MainRegionRegion, typeof(MainWindow));
        }

        public static void CreateRegionAdapterMappings(RegionAdapterMappings mappings)
        {
            mappings.RegisterMapping(typeof(DockingManager),
               ServiceLocator.Current.GetInstance<AvalonDockRegionAdapter>());
        }
    }

}
```

`src/Arma3BE.Client.Modules.MainModule/MainWindow.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.MainModule.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xcad="http://schemas.xceed.com/wpf/xaml/avalondock"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:regions="http://prismlibrary.com/"
        xmlns:inf="clr-namespace:Arma3BE.Client.Infrastructure;assembly=Arma3BE.Client.Infrastructure"
        Loaded="LoadedWindow">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <!-- Toolbar -->
        <Menu>
            <MenuItem Header="File" >
                <MenuItem Header="Tools" regions:RegionManager.RegionName="{x:Static inf:RegionNames.MenuFileToolsRegion}">
                </MenuItem>

                <Separator />
                <MenuItem Header="Exit" Click="ExitClick" />
            </MenuItem>
            <MenuItem Header="Options">
                <MenuItem Header="Preferences..." Command="{Binding OptionsCommand}" />
            </MenuItem>
            <MenuItem Header="Servers" ItemsSource="{Binding Servers}" Click="ServerClick">
                <MenuItem.ItemContainerStyle>
                    <Style>
                        <Setter Property="MenuItem.Header" Value="{Binding Name}" />
                    </Style>
                </MenuItem.ItemContainerStyle>
            </MenuItem>

            <MenuItem Header="Tools" regions:RegionManager.RegionName="{x:Static inf:RegionNames.MenuToolsRegion}">
            </MenuItem>

            <Separator/>
            <MenuItem Header="Help">
                <MenuItem Header="Update to latest dev version" Click="UpdateToLatestDevClick" />
                <MenuItem Header="About" Click="AboutClick" />
            </MenuItem>
        </Menu>
        <xcad:DockingManager x:Name="DockManager" Grid.Row="1" Margin="0,0,0,0" regions:RegionManager.RegionName="{x:Static inf:RegionNames.ServerTabRegion}">
            <xcad:LayoutRoot>
                
            </xcad:LayoutRoot>
        </xcad:DockingManager>
    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.MainModule/MainWindow.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Modules.MainModule.ViewModel;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Regions;
using System;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using Xceed.Wpf.AvalonDock.Controls;

namespace Arma3BE.Client.Modules.MainModule
{
    /// <summary>
    ///     Interaction logic for MainWindow.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class MainWindow
    {
        private readonly IUnityContainer _container;
        private readonly MainViewModel _model;
        private readonly IRegionManager _regionManager;
        private readonly IServerInfoRepository _infoRepository;

        public MainWindow(MainViewModel model, IUnityContainer container, IRegionManager regionManager,
            IServerInfoRepository infoRepository)
        {
            InitializeComponent();

            _model = model;
            _container = container;
            _regionManager = regionManager;
            _infoRepository = infoRepository;

            DataContext = _model;
        }

        private async Task OpenServerInfoAsync(ServerInfoDto serverInfo)
        {
            var region = _regionManager.Regions[RegionNames.ServerTabRegion];

            if (region.Views.OfType<ServerInfoControl>()
                .Select(x => x.DataContext as ServerMonitorModel)
                .Any(x => x?.CurrentServer.Id == serverInfo.Id))
                return;

            var control =
                _container.Resolve<ServerInfoControl>(
                    new ParameterOverride("currentServer", serverInfo).OnType<ServerMonitorModel>(),
                    new ParameterOverride("console", false).OnType<ServerMonitorModel>());

            await _model.ReloadAsync();

            region.Add(control, null, true);
            region.Activate(control);
        }

        private async void ServerClick(object sender, RoutedEventArgs e)
        {
            var orig = e.OriginalSource as FrameworkElement;
            if (orig?.DataContext is ServerInfoDto)
            {
                var serverInfo = (ServerInfoDto)orig.DataContext;
                await OpenServerInfoAsync(serverInfo);
            }
        }

        private void ExitClick(object sender, RoutedEventArgs e)
        {
            this.FindVisualAncestor<Window>().Close();
            Application.Current.Shutdown();
        }

        private async void LoadedWindow(object sender, RoutedEventArgs e)
        {
            var servers = await _infoRepository.GetActiveServerInfoAsync();
            foreach (var server in servers)
            {
                OpenServerInfoAsync(server);
            }
        }

        private void AboutClick(object sender, RoutedEventArgs e)
        {
            var window = new About();
            window.Owner = this.FindVisualAncestor<Window>();
            window.ShowDialog();
        }


        private void UpdateToLatestDevClick(object sender, RoutedEventArgs e)
        {
            var tempDirName = Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString());
            if (Directory.Exists(tempDirName) == false) Directory.CreateDirectory(tempDirName);

            var files = new[] { "Arma3BE.Client.Updater.exe", "Newtonsoft.Json.dll" };
            var currentfile = System.Reflection.Assembly.GetEntryAssembly().Location;
            var currentDir = Path.GetDirectoryName(currentfile);

            foreach (var file in files)
            {
                var from = Path.Combine(currentDir, file);
                var to = Path.Combine(tempDirName, file);

                File.Copy(from, to);
            }

            var exec = Path.Combine(tempDirName, "Arma3BE.Client.Updater.exe");
            Process.Start(exec, $"\"{currentDir}\" RESTART");
            Environment.Exit(0);
        }
    }
}
```

`src/Arma3BE.Client.Modules.MainModule/Properties/Annotations.cs`:

```cs
using System;

#pragma warning disable 1591
// ReSharper disable UnusedMember.Global
// ReSharper disable UnusedParameter.Local
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable IntroduceOptionalParameters.Global
// ReSharper disable MemberCanBeProtected.Global
// ReSharper disable InconsistentNaming

namespace Arma3BE.Client.Modules.MainModule.Properties
{
    /// <summary>
    ///     Indicates that the value of the marked element could be <c>null</c> sometimes,
    ///     so the check for <c>null</c> is necessary before its usage
    /// </summary>
    /// <example>
    ///     <code>
    /// [CanBeNull] public object Test() { return null; }
    /// public void UseTest() {
    ///   var p = Test();
    ///   var s = p.ToString(); // Warning: Possible 'System.NullReferenceException'
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(
        AttributeTargets.Method | AttributeTargets.Parameter |
        AttributeTargets.Property | AttributeTargets.Delegate |
        AttributeTargets.Field)]
    public sealed class CanBeNullAttribute : Attribute
    {
    }

    /// <summary>
    ///     Indicates that the value of the marked element could never be <c>null</c>
    /// </summary>
    /// <example>
    ///     <code>
    /// [NotNull] public object Foo() {
    ///   return null; // Warning: Possible 'null' assignment
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(
        AttributeTargets.Method | AttributeTargets.Parameter |
        AttributeTargets.Property | AttributeTargets.Delegate |
        AttributeTargets.Field)]
    public sealed class NotNullAttribute : Attribute
    {
    }

    /// <summary>
    ///     Indicates that the marked method builds string by format pattern and (optional) arguments.
    ///     Parameter, which contains format string, should be given in constructor. The format string
    ///     should be in <see cref="string.Format(IFormatProvider,string,object[])" />-like form
    /// </summary>
    /// <example>
    ///     <code>
    /// [StringFormatMethod("message")]
    /// public void ShowError(string message, params object[] args) { /* do something */ }
    /// public void Foo() {
    ///   ShowError("Failed: {0}"); // Warning: Non-existing argument in format string
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(
        AttributeTargets.Constructor | AttributeTargets.Method)]
    public sealed class StringFormatMethodAttribute : Attribute
    {
        /// <param name="formatParameterName">
        ///     Specifies which parameter of an annotated method should be treated as format-string
        /// </param>
        public StringFormatMethodAttribute(string formatParameterName)
        {
            FormatParameterName = formatParameterName;
        }

        public string FormatParameterName { get; private set; }
    }

    /// <summary>
    ///     Indicates that the function argument should be string literal and match one
    ///     of the parameters of the caller function. For example, ReSharper annotates
    ///     the parameter of <see cref="System.ArgumentNullException" />
    /// </summary>
    /// <example>
    ///     <code>
    /// public void Foo(string param) {
    ///   if (param == null)
    ///     throw new ArgumentNullException("par"); // Warning: Cannot resolve symbol
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class InvokerParameterNameAttribute : Attribute
    {
    }

    /// <summary>
    ///     Indicates that the method is contained in a type that implements
    ///     <see cref="System.ComponentModel.INotifyPropertyChanged" /> interface
    ///     and this method is used to notify that some property value changed
    /// </summary>
    /// <remarks>
    ///     The method should be non-static and conform to one of the supported signatures:
    ///     <list>
    ///         <item>
    ///             <c>NotifyChanged(string)</c>
    ///         </item>
    ///         <item>
    ///             <c>NotifyChanged(params string[])</c>
    ///         </item>
    ///         <item>
    ///             <c>NotifyChanged{T}(Expression{Func{T}})</c>
    ///         </item>
    ///         <item>
    ///             <c>NotifyChanged{T,U}(Expression{Func{T,U}})</c>
    ///         </item>
    ///         <item>
    ///             <c>SetProperty{T}(ref T, T, string)</c>
    ///         </item>
    ///     </list>
    /// </remarks>
    /// <example>
    ///     <code>
    ///  public class Foo : INotifyPropertyChanged {
    ///    public event PropertyChangedEventHandler PropertyChanged;
    ///    [NotifyPropertyChangedInvocator]
    ///    protected virtual void NotifyChanged(string propertyName) { ... }
    /// 
    ///    private string _name;
    ///    public string Name {
    ///      get { return _name; }
    ///      set { _name = value; NotifyChanged("LastName"); /* Warning */ }
    ///    }
    ///  }
    ///  </code>
    ///     Examples of generated notifications:
    ///     <list>
    ///         <item>
    ///             <c>NotifyChanged("Property")</c>
    ///         </item>
    ///         <item>
    ///             <c>NotifyChanged(() =&gt; Property)</c>
    ///         </item>
    ///         <item>
    ///             <c>NotifyChanged((VM x) =&gt; x.Property)</c>
    ///         </item>
    ///         <item>
    ///             <c>SetProperty(ref myField, value, "Property")</c>
    ///         </item>
    ///     </list>
    /// </example>
    [AttributeUsage(AttributeTargets.Method)]
    public sealed class NotifyPropertyChangedInvocatorAttribute : Attribute
    {
        public NotifyPropertyChangedInvocatorAttribute()
        {
        }

        public NotifyPropertyChangedInvocatorAttribute(string parameterName)
        {
            ParameterName = parameterName;
        }

        public string ParameterName { get; private set; }
    }

    /// <summary>
    ///     Describes dependency between method input and output
    /// </summary>
    /// <syntax>
    ///     <p>Function Definition Table syntax:</p>
    ///     <list>
    ///         <item>FDT      ::= FDTRow [;FDTRow]*</item>
    ///         <item>FDTRow   ::= Input =&gt; Output | Output &lt;= Input</item>
    ///         <item>Input    ::= ParameterName: Value [, Input]*</item>
    ///         <item>Output   ::= [ParameterName: Value]* {halt|stop|void|nothing|Value}</item>
    ///         <item>Value    ::= true | false | null | notnull | canbenull</item>
    ///     </list>
    ///     If method has single input parameter, it's name could be omitted.<br />
    ///     Using <c>halt</c> (or <c>void</c>/<c>nothing</c>, which is the same)
    ///     for method output means that the methos doesn't return normally.<br />
    ///     <c>canbenull</c> annotation is only applicable for output parameters.<br />
    ///     You can use multiple <c>[ContractAnnotation]</c> for each FDT row,
    ///     or use single attribute with rows separated by semicolon.<br />
    /// </syntax>
    /// <examples>
    ///     <list>
    ///         <item>
    ///             <code>
    /// [ContractAnnotation("=> halt")]
    /// public void TerminationMethod()
    /// </code>
    ///         </item>
    ///         <item>
    ///             <code>
    /// [ContractAnnotation("halt &lt;= condition: false")]
    /// public void Assert(bool condition, string text) // regular assertion method
    /// </code>
    ///         </item>
    ///         <item>
    ///             <code>
    /// [ContractAnnotation("s:null => true")]
    /// public bool IsNullOrEmpty(string s) // string.IsNullOrEmpty()
    /// </code>
    ///         </item>
    ///         <item>
    ///             <code>
    /// // A method that returns null if the parameter is null, and not null if the parameter is not null
    /// [ContractAnnotation("null => null; notnull => notnull")]
    /// public object Transform(object data) 
    /// </code>
    ///         </item>
    ///         <item>
    ///             <code>
    /// [ContractAnnotation("s:null=>false; =>true,result:notnull; =>false, result:null")]
    /// public bool TryParse(string s, out Person result)
    /// </code>
    ///         </item>
    ///     </list>
    /// </examples>
    [AttributeUsage(AttributeTargets.Method, AllowMultiple = true)]
    public sealed class ContractAnnotationAttribute : Attribute
    {
        public ContractAnnotationAttribute([NotNull] string contract)
            : this(contract, false)
        {
        }

        public ContractAnnotationAttribute([NotNull] string contract, bool forceFullStates)
        {
            Contract = contract;
            ForceFullStates = forceFullStates;
        }

        public string Contract { get; private set; }
        public bool ForceFullStates { get; private set; }
    }

    /// <summary>
    ///     Indicates that marked element should be localized or not
    /// </summary>
    /// <example>
    ///     <code>
    /// [LocalizationRequiredAttribute(true)]
    /// public class Foo {
    ///   private string str = "my string"; // Warning: Localizable string
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(AttributeTargets.All)]
    public sealed class LocalizationRequiredAttribute : Attribute
    {
        public LocalizationRequiredAttribute() : this(true)
        {
        }

        public LocalizationRequiredAttribute(bool required)
        {
            Required = required;
        }

        public bool Required { get; private set; }
    }

    /// <summary>
    ///     Indicates that the value of the marked type (or its derivatives)
    ///     cannot be compared using '==' or '!=' operators and <c>Equals()</c>
    ///     should be used instead. However, using '==' or '!=' for comparison
    ///     with <c>null</c> is always permitted.
    /// </summary>
    /// <example>
    ///     <code>
    /// [CannotApplyEqualityOperator]
    /// class NoEquality { }
    /// class UsesNoEquality {
    ///   public void Test() {
    ///     var ca1 = new NoEquality();
    ///     var ca2 = new NoEquality();
    ///     if (ca1 != null) { // OK
    ///       bool condition = ca1 == ca2; // Warning
    ///     }
    ///   }
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(
        AttributeTargets.Interface | AttributeTargets.Class |
        AttributeTargets.Struct)]
    public sealed class CannotApplyEqualityOperatorAttribute : Attribute
    {
    }

    /// <summary>
    ///     When applied to a target attribute, specifies a requirement for any type marked
    ///     with the target attribute to implement or inherit specific type or types.
    /// </summary>
    /// <example>
    ///     <code>
    /// [BaseTypeRequired(typeof(IComponent)] // Specify requirement
    /// public class ComponentAttribute : Attribute { }
    /// [Component] // ComponentAttribute requires implementing IComponent interface
    /// public class MyComponent : IComponent { }
    /// </code>
    /// </example>
    [AttributeUsage(AttributeTargets.Class, AllowMultiple = true)]
    [BaseTypeRequired(typeof (Attribute))]
    public sealed class BaseTypeRequiredAttribute : Attribute
    {
        public BaseTypeRequiredAttribute([NotNull] Type baseType)
        {
            BaseType = baseType;
        }

        [NotNull]
        public Type BaseType { get; private set; }
    }

    /// <summary>
    ///     Indicates that the marked symbol is used implicitly
    ///     (e.g. via reflection, in external library), so this symbol
    ///     will not be marked as unused (as well as by other usage inspections)
    /// </summary>
    [AttributeUsage(AttributeTargets.All)]
    public sealed class UsedImplicitlyAttribute : Attribute
    {
        public UsedImplicitlyAttribute()
            : this(ImplicitUseKindFlags.Default, ImplicitUseTargetFlags.Default)
        {
        }

        public UsedImplicitlyAttribute(ImplicitUseKindFlags useKindFlags)
            : this(useKindFlags, ImplicitUseTargetFlags.Default)
        {
        }

        public UsedImplicitlyAttribute(ImplicitUseTargetFlags targetFlags)
            : this(ImplicitUseKindFlags.Default, targetFlags)
        {
        }

        public UsedImplicitlyAttribute(
            ImplicitUseKindFlags useKindFlags, ImplicitUseTargetFlags targetFlags)
        {
            UseKindFlags = useKindFlags;
            TargetFlags = targetFlags;
        }

        public ImplicitUseKindFlags UseKindFlags { get; private set; }
        public ImplicitUseTargetFlags TargetFlags { get; private set; }
    }

    /// <summary>
    ///     Should be used on attributes and causes ReSharper
    ///     to not mark symbols marked with such attributes as unused
    ///     (as well as by other usage inspections)
    /// </summary>
    [AttributeUsage(AttributeTargets.Class)]
    public sealed class MeansImplicitUseAttribute : Attribute
    {
        public MeansImplicitUseAttribute()
            : this(ImplicitUseKindFlags.Default, ImplicitUseTargetFlags.Default)
        {
        }

        public MeansImplicitUseAttribute(ImplicitUseKindFlags useKindFlags)
            : this(useKindFlags, ImplicitUseTargetFlags.Default)
        {
        }

        public MeansImplicitUseAttribute(ImplicitUseTargetFlags targetFlags)
            : this(ImplicitUseKindFlags.Default, targetFlags)
        {
        }

        public MeansImplicitUseAttribute(
            ImplicitUseKindFlags useKindFlags, ImplicitUseTargetFlags targetFlags)
        {
            UseKindFlags = useKindFlags;
            TargetFlags = targetFlags;
        }

        [UsedImplicitly]
        public ImplicitUseKindFlags UseKindFlags { get; private set; }

        [UsedImplicitly]
        public ImplicitUseTargetFlags TargetFlags { get; private set; }
    }

    [Flags]
    public enum ImplicitUseKindFlags
    {
        Default = Access | Assign | InstantiatedWithFixedConstructorSignature,

        /// <summary>Only entity marked with attribute considered used</summary>
        Access = 1,

        /// <summary>Indicates implicit assignment to a member</summary>
        Assign = 2,

        /// <summary>
        ///     Indicates implicit instantiation of a type with fixed constructor signature.
        ///     That means any unused constructor parameters won't be reported as such.
        /// </summary>
        InstantiatedWithFixedConstructorSignature = 4,

        /// <summary>Indicates implicit instantiation of a type</summary>
        InstantiatedNoFixedConstructorSignature = 8
    }

    /// <summary>
    ///     Specify what is considered used implicitly
    ///     when marked with <see cref="MeansImplicitUseAttribute" />
    ///     or <see cref="UsedImplicitlyAttribute" />
    /// </summary>
    [Flags]
    public enum ImplicitUseTargetFlags
    {
        Default = Itself,
        Itself = 1,

        /// <summary>Members of entity marked with attribute are considered used</summary>
        Members = 2,

        /// <summary>Entity marked with attribute and all its members considered used</summary>
        WithMembers = Itself | Members
    }

    /// <summary>
    ///     This attribute is intended to mark publicly available API
    ///     which should not be removed and so is treated as used
    /// </summary>
    [MeansImplicitUse]
    public sealed class PublicAPIAttribute : Attribute
    {
        public PublicAPIAttribute()
        {
        }

        public PublicAPIAttribute([NotNull] string comment)
        {
            Comment = comment;
        }

        [NotNull]
        public string Comment { get; private set; }
    }

    /// <summary>
    ///     Tells code analysis engine if the parameter is completely handled
    ///     when the invoked method is on stack. If the parameter is a delegate,
    ///     indicates that delegate is executed while the method is executed.
    ///     If the parameter is an enumerable, indicates that it is enumerated
    ///     while the method is executed
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class InstantHandleAttribute : Attribute
    {
    }

    /// <summary>
    ///     Indicates that a method does not make any observable state changes.
    ///     The same as <c>System.Diagnostics.Contracts.PureAttribute</c>
    /// </summary>
    /// <example>
    ///     <code>
    /// [Pure] private int Multiply(int x, int y) { return x * y; }
    /// public void Foo() {
    ///   const int a = 2, b = 2;
    ///   Multiply(a, b); // Waring: Return value of pure method is not used
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(AttributeTargets.Method)]
    public sealed class PureAttribute : Attribute
    {
    }

    /// <summary>
    ///     Indicates that a parameter is a path to a file or a folder
    ///     within a web project. Path can be relative or absolute,
    ///     starting from web root (~)
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public class PathReferenceAttribute : Attribute
    {
        public PathReferenceAttribute()
        {
        }

        public PathReferenceAttribute([PathReference] string basePath)
        {
            BasePath = basePath;
        }

        [NotNull]
        public string BasePath { get; private set; }
    }

    // ASP.NET MVC attributes

    [AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
    public sealed class AspMvcAreaMasterLocationFormatAttribute : Attribute
    {
        public AspMvcAreaMasterLocationFormatAttribute(string format)
        {
        }
    }

    [AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
    public sealed class AspMvcAreaPartialViewLocationFormatAttribute : Attribute
    {
        public AspMvcAreaPartialViewLocationFormatAttribute(string format)
        {
        }
    }

    [AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
    public sealed class AspMvcAreaViewLocationFormatAttribute : Attribute
    {
        public AspMvcAreaViewLocationFormatAttribute(string format)
        {
        }
    }

    [AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
    public sealed class AspMvcMasterLocationFormatAttribute : Attribute
    {
        public AspMvcMasterLocationFormatAttribute(string format)
        {
        }
    }

    [AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
    public sealed class AspMvcPartialViewLocationFormatAttribute : Attribute
    {
        public AspMvcPartialViewLocationFormatAttribute(string format)
        {
        }
    }

    [AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
    public sealed class AspMvcViewLocationFormatAttribute : Attribute
    {
        public AspMvcViewLocationFormatAttribute(string format)
        {
        }
    }

    /// <summary>
    ///     ASP.NET MVC attribute. If applied to a parameter, indicates that the parameter
    ///     is an MVC action. If applied to a method, the MVC action name is calculated
    ///     implicitly from the context. Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Html.ChildActionExtensions.RenderAction(HtmlHelper, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter | AttributeTargets.Method)]
    public sealed class AspMvcActionAttribute : Attribute
    {
        public AspMvcActionAttribute()
        {
        }

        public AspMvcActionAttribute([NotNull] string anonymousProperty)
        {
            AnonymousProperty = anonymousProperty;
        }

        [NotNull]
        public string AnonymousProperty { get; private set; }
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Indicates that a parameter is an MVC area.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Html.ChildActionExtensions.RenderAction(HtmlHelper, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class AspMvcAreaAttribute : PathReferenceAttribute
    {
        public AspMvcAreaAttribute()
        {
        }

        public AspMvcAreaAttribute([NotNull] string anonymousProperty)
        {
            AnonymousProperty = anonymousProperty;
        }

        [NotNull]
        public string AnonymousProperty { get; private set; }
    }

    /// <summary>
    ///     ASP.NET MVC attribute. If applied to a parameter, indicates that
    ///     the parameter is an MVC controller. If applied to a method,
    ///     the MVC controller name is calculated implicitly from the context.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Html.ChildActionExtensions.RenderAction(HtmlHelper, String, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter | AttributeTargets.Method)]
    public sealed class AspMvcControllerAttribute : Attribute
    {
        public AspMvcControllerAttribute()
        {
        }

        public AspMvcControllerAttribute([NotNull] string anonymousProperty)
        {
            AnonymousProperty = anonymousProperty;
        }

        [NotNull]
        public string AnonymousProperty { get; private set; }
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Indicates that a parameter is an MVC Master.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Controller.View(String, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class AspMvcMasterAttribute : Attribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Indicates that a parameter is an MVC model type.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Controller.View(String, Object)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class AspMvcModelTypeAttribute : Attribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. If applied to a parameter, indicates that
    ///     the parameter is an MVC partial view. If applied to a method,
    ///     the MVC partial view name is calculated implicitly from the context.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Html.RenderPartialExtensions.RenderPartial(HtmlHelper, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter | AttributeTargets.Method)]
    public sealed class AspMvcPartialViewAttribute : PathReferenceAttribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Allows disabling all inspections
    ///     for MVC views within a class or a method.
    /// </summary>
    [AttributeUsage(AttributeTargets.Class | AttributeTargets.Method)]
    public sealed class AspMvcSupressViewErrorAttribute : Attribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Indicates that a parameter is an MVC display template.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Html.DisplayExtensions.DisplayForModel(HtmlHelper, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class AspMvcDisplayTemplateAttribute : Attribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Indicates that a parameter is an MVC editor template.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Html.EditorExtensions.EditorForModel(HtmlHelper, String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class AspMvcEditorTemplateAttribute : Attribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. Indicates that a parameter is an MVC template.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.ComponentModel.DataAnnotations.UIHintAttribute(System.String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter)]
    public sealed class AspMvcTemplateAttribute : Attribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. If applied to a parameter, indicates that the parameter
    ///     is an MVC view. If applied to a method, the MVC view name is calculated implicitly
    ///     from the context. Use this attribute for custom wrappers similar to
    ///     <c>System.Web.Mvc.Controller.View(Object)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter | AttributeTargets.Method)]
    public sealed class AspMvcViewAttribute : PathReferenceAttribute
    {
    }

    /// <summary>
    ///     ASP.NET MVC attribute. When applied to a parameter of an attribute,
    ///     indicates that this parameter is an MVC action name
    /// </summary>
    /// <example>
    ///     <code>
    /// [ActionName("Foo")]
    /// public ActionResult Login(string returnUrl) {
    ///   ViewBag.ReturnUrl = Url.Action("Foo"); // OK
    ///   return RedirectToAction("Bar"); // Error: Cannot resolve action
    /// }
    /// </code>
    /// </example>
    [AttributeUsage(AttributeTargets.Parameter | AttributeTargets.Property)]
    public sealed class AspMvcActionSelectorAttribute : Attribute
    {
    }

    [AttributeUsage(
        AttributeTargets.Parameter | AttributeTargets.Property |
        AttributeTargets.Field)]
    public sealed class HtmlElementAttributesAttribute : Attribute
    {
        public HtmlElementAttributesAttribute()
        {
        }

        public HtmlElementAttributesAttribute([NotNull] string name)
        {
            Name = name;
        }

        [NotNull]
        public string Name { get; private set; }
    }

    [AttributeUsage(
        AttributeTargets.Parameter | AttributeTargets.Field |
        AttributeTargets.Property)]
    public sealed class HtmlAttributeValueAttribute : Attribute
    {
        public HtmlAttributeValueAttribute([NotNull] string name)
        {
            Name = name;
        }

        [NotNull]
        public string Name { get; private set; }
    }

    // Razor attributes

    /// <summary>
    ///     Razor attribute. Indicates that a parameter or a method is a Razor section.
    ///     Use this attribute for custom wrappers similar to
    ///     <c>System.Web.WebPages.WebPageBase.RenderSection(String)</c>
    /// </summary>
    [AttributeUsage(AttributeTargets.Parameter | AttributeTargets.Method)]
    public sealed class RazorSectionAttribute : Attribute
    {
    }
}
```

`src/Arma3BE.Client.Modules.MainModule/ServerInfoControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.MainModule.ServerInfoControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
             xmlns:regions="http://prismlibrary.com/"
             xmlns:inf="clr-namespace:Arma3BE.Client.Infrastructure;assembly=Arma3BE.Client.Infrastructure"
             mc:Ignorable="d">

    <UserControl.Resources>
        <Style TargetType="{x:Type xcdg:GroupByControl}">
            <Setter Property="Visibility" Value="Collapsed" />
        </Style>
        <converters:BoolToVisibilityConverter x:Uid="local:BoolToVisibilityConverter_1"
                                              x:Key="BoolToVisibilityConverter" />
        <converters:BoolToVisibilityConverterInverse x:Uid="local:BoolToVisibilityConverterInverse"
                                                     x:Key="BoolToVisibilityConverterInverse" />
    </UserControl.Resources>

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <TabControl regions:RegionManager.RegionName="{x:Static inf:RegionNames.ServerTabPartRegion}" regions:RegionManager.RegionContext="{Binding CurrentServer, Mode=OneWay}">
        </TabControl>

        <GridSplitter Grid.Row="0" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Center" Width="5" />
        
        <ContentControl  Grid.Row="0" Grid.Column="2" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                             regions:RegionManager.RegionName="{x:Static inf:RegionNames.ServerSidePartRegion}" regions:RegionManager.RegionContext="{Binding CurrentServer, Mode=OneWay}"></ContentControl>
        
        <StatusBar Grid.Row="1" Grid.ColumnSpan="3" Height="20">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Connected" Foreground="DarkGreen"
                           Visibility="{Binding Connected, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}" />
                <TextBlock Foreground="Red" Text="Disonnected"
                           Visibility="{Binding Connected, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverterInverse}}" />

                <ContentControl regions:RegionManager.RegionName="{x:Static inf:RegionNames.BottomUpdateIndicatorRegion}"  regions:RegionManager.RegionContext="{Binding CurrentServer, Mode=OneWay}"></ContentControl>
            </StackPanel>
        </StatusBar>
    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.MainModule/ServerInfoControl.xaml.cs`:

```cs
using Arma3BE.Client.Modules.MainModule.ViewModel;
using System;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.MainModule
{
    /// <summary>
    ///     Interaction logic for ServerInfoControl.xaml
    /// </summary>
    // ReSharper disable once ClassWithVirtualMembersNeverInherited.Global
    // ReSharper disable once RedundantExtendsListEntry
    public partial class ServerInfoControl : UserControl, IDisposable
    {
        private bool _disposed;
        private ServerMonitorModel _model;

        public ServerInfoControl(ServerMonitorModel model)
        {
            InitializeComponent();

            _model = model;
            DataContext = _model;
            Dispatcher.ShutdownStarted += Dispatcher_ShutdownStarted;
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        private void Dispatcher_ShutdownStarted(object sender, EventArgs e)
        {
            Cleanup();
        }

        // ReSharper disable once MemberCanBePrivate.Global
        public void Cleanup()
        {
            Dispose();
        }

        ~ServerInfoControl()
        {
            Dispose(false);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (_disposed)
                return;

            if (disposing)
            {
                DisposeManagedResources();
            }
            DisposeUnManagedResources();
            _disposed = true;
        }

        protected virtual void DisposeManagedResources()
        {
            if (_model != null)
            {
                _model.Dispose();
                _model.Cleanup();
                _model = null;
            }

            Dispatcher.ShutdownStarted -= Dispatcher_ShutdownStarted;
        }

        protected virtual void DisposeUnManagedResources()
        {
        }
    }
}
```

`src/Arma3BE.Client.Modules.MainModule/ViewModel/MainViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Tools;
using Prism.Commands;
using Prism.Events;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;

// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ExplicitCallerInfoArgument

namespace Arma3BE.Client.Modules.MainModule.ViewModel
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class MainViewModel : ViewModelBase
    {
        private readonly IServerInfoRepository _infoRepository;

        public MainViewModel(IEventAggregator eventAggregator, IServerInfoRepository infoRepository, ISettingsStoreSource settingsStoreSource)
        {
            _infoRepository = infoRepository;
            ReloadAsync();

            OptionsCommand = new DelegateCommand(() =>
            {
                eventAggregator.GetEvent<ShowOptionsEvent>().Publish(new ShowOptionsEvent());
            });

            eventAggregator.GetEvent<BEServersChangedEvent>().Subscribe(async (state) =>
            {
                await ReloadAsync();
            });

            var tm = settingsStoreSource.GetSettingsStore().TopMost;
            foreach (Window wnd in Application.Current.Windows)
            {
                wnd.Topmost = tm;
            }
        }

        // ReSharper disable once UnusedAutoPropertyAccessor.Global
        public ICommand OptionsCommand { get; set; }

        // ReSharper disable once MemberCanBeMadeStatic.Global
        public List<ServerInfoDto> Servers
        {
            // ReSharper disable once UnusedMember.Global
            get;
            set;
        }

        public async Task ReloadAsync()
        {
            Servers = (await _infoRepository.GetNotActiveServerInfoAsync()).OrderBy(x => x.Name).ToList();
            RaisePropertyChanged(nameof(Servers));
        }
    }
}
```

`src/Arma3BE.Client.Modules.MainModule/ViewModel/ServerMonitorModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Contracts;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BEClient.Libs.Repositories;
using Prism.Events;
using System;
using System.Threading.Tasks;

// ReSharper disable MemberCanBePrivate.Global

namespace Arma3BE.Client.Modules.MainModule.ViewModel
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class ServerMonitorModel : DisposableViewModelBase
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly IServerInfoRepository _infoRepository;
        private bool _connected;

        public ServerMonitorModel(ServerInfoDto currentServer,
            IEventAggregator eventAggregator, IServerInfoRepository infoRepository)
        {
            CurrentServer = currentServer;
            _eventAggregator = eventAggregator;
            _infoRepository = infoRepository;

            _eventAggregator.GetEvent<ConnectServerEvent>().Subscribe(BeServerConnectHandler, ThreadOption.UIThread);
            _eventAggregator.GetEvent<DisConnectServerEvent>().Subscribe(BeServerDisconnectHandler, ThreadOption.UIThread);
            _eventAggregator.GetEvent<RunServerEvent>().Publish(CurrentServer);
        }

        public ServerInfoDto CurrentServer { get; }

        public bool Connected
        {
            // ReSharper disable once UnusedMember.Global
            get { return _connected; }
            set
            {
                _connected = value;
                RaisePropertyChanged();
            }
        }

        public string Title => CurrentServer.Name;

        private void BeServerDisconnectHandler(ServerInfoDto info)
        {
            if (info.Id != CurrentServer.Id) return;
            Connected = false;
        }

        private void BeServerConnectHandler(ServerInfoDto info)
        {
            Connected = true;
        }

        protected override void DisposeManagedResources()
        {
            base.DisposeManagedResources();
            _eventAggregator.GetEvent<CloseServerEvent>()
                .Publish(CurrentServer);
        }

        public async Task SetActive(Guid serverId, bool active = false)
        {
            await _infoRepository.SetServerInfoActiveAsync(serverId, active);
            _eventAggregator.GetEvent<BEServersChangedEvent>().Publish(null);
        }

        public async Task CloseServerAsync()
        {
            // ReSharper disable once RedundantArgumentDefaultValue
            await SetActive(CurrentServer.Id, false);
        }

        public async Task OpenServerAsync()
        {
            await SetActive(CurrentServer.Id, true);
        }
    }
}
```

`src/Arma3BE.Client.Modules.MainModule/app.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-9.0.0.0" newVersion="9.0.0.0" />
      </dependentAssembly>
      
    </assemblyBinding>
  </runtime>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" /></startup></configuration>

```

`src/Arma3BE.Client.Modules.MainModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net45" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="log4net" version="2.0.8" targetFramework="net452" />
  <package id="MaxMind.Db" version="2.2.0" targetFramework="net452" />
  <package id="MaxMind.GeoIP2" version="2.8.0" targetFramework="net452" />
  <package id="Newtonsoft.Json" version="10.0.3" targetFramework="net461" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="RestSharp" version="106.2.1" targetFramework="net461" />
  <package id="System.Net.Http" version="4.0.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.Algorithms" version="4.3.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.Encoding" version="4.3.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.Primitives" version="4.3.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.X509Certificates" version="4.3.0" targetFramework="net461" />
  <package id="System.ValueTuple" version="4.4.0" targetFramework="net461" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.ManageServerModule/Arma3BE.Client.Modules.ManageServerModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{DA176F41-7DB9-4678-868B-C585C95CB48E}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.ManageServerModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.ManageServerModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Grids\ManageServer.xaml.cs">
      <DependentUpon>ManageServer.xaml</DependentUpon>
    </Compile>
    <Compile Include="Models\ServerMonitorManageServerViewModel.cs" />
    <Compile Include="ManageServerModuleInit.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{E5240A50-E944-4F50-A353-2E3C9E547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Steam\Arma3BE.Steam.csproj">
      <Project>{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}</Project>
      <Name>Arma3BE.Steam</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Page Include="Grids\ManageServer.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.ManageServerModule/Grids/ManageServer.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.ManageServerModule.Grids.ManageServer"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
             mc:Ignorable="d">
    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Uid="local:BoolToVisibilityConverter_1"
                                              x:Key="BoolToVisibilityConverter" />

        <converters:BisyBoolToColorConverter x:Uid="local:BisyBoolToColorConverter_1"
                                              x:Key="BisyBoolToColorConverter" />
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <TextBlock Grid.Row="0" HorizontalAlignment="Left" Margin="2" Grid.ColumnSpan="2" 
                   Visibility="{Binding ShowWarning, Converter={StaticResource BoolToVisibilityConverter}}" 
                   Text="Warning! Not all commands supported by this server." 
                   FontWeight="Bold"
                   Foreground="Red"></TextBlock>

        <StackPanel Orientation="Vertical" Grid.Row="2" HorizontalAlignment="Left" Margin="5">
            <Button Content="Lock" Command="{Binding LockCommand}" Height="40" Width="120" />
            <Button Content="Unlock" Command="{Binding UnlockCommand}" Height="40" Width="120" />

            <Border BorderBrush="{Binding ShowWarning, Converter={StaticResource BisyBoolToColorConverter}}" 
                    BorderThickness="1">
                <Button Content="Shutdown" Command="{Binding ShutdownCommand}" Height="40" Width="120" />
            </Border>

            <Border BorderBrush="{Binding ShowWarning, Converter={StaticResource BisyBoolToColorConverter}}" 
                    BorderThickness="1">
                <Button Content="Restart" Command="{Binding RestartCommand}" Height="40" Width="120" />
            </Border>

            <Border BorderBrush="{Binding ShowWarning, Converter={StaticResource BisyBoolToColorConverter}}" 
                    BorderThickness="1">
                <Button Content="Restart Server" Command="{Binding RestartServerCommand}" Height="40" Width="120" />
            </Border>
        </StackPanel>


        <StackPanel Orientation="Vertical" Grid.Column="1" Grid.Row="2" HorizontalAlignment="Left" Margin="5">
            <Button Content="Init" Command="{Binding InitCommand}" Height="40" Width="120"></Button>
            <Button Content="Reassign" Command="{Binding ReassignCommand}" Height="40" Width="120"></Button>
            <Button Content="Load bans" Command="{Binding LoadBansCommand}" Height="40" Width="120"></Button>
            <Button Content="Load scripts" Command="{Binding LoadScriptsCommand}" Height="40" Width="120"></Button>
            <Button Content="Load events" Command="{Binding LoadEventsCommand}" Height="40" Width="120"></Button>
        </StackPanel>

        <Border Grid.Row="1" Grid.ColumnSpan="2" HorizontalAlignment="Left"
                BorderBrush="{Binding ShowWarning, Converter={StaticResource BisyBoolToColorConverter}}" 
                BorderThickness="1">
            <StackPanel Orientation="Horizontal" >
            <Button Command="{Binding RefreshCommand}">
                <!-- ReSharper disable once Xaml.StaticResourceNotResolved -->
                <Image x:Uid="Image_1" Source="{StaticResource refresh_icon}" Height="16" Width="16" />
            </Button>
            <ComboBox ItemsSource="{Binding Missions, Mode=OneWay}" Width="300"
                      SelectedItem="{Binding SelectedMission, Mode=TwoWay}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <!-- ReSharper disable once Xaml.BindingWithContextNotResolved -->
                        <TextBlock Text="{Binding Name, Mode=OneWay}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <Button Content="Set Mission" Command="{Binding SetMissionCommand}" />
        </StackPanel>
        </Border>
    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.ManageServerModule/Grids/ManageServer.xaml.cs`:

```cs
using Prism.Regions;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.ManageServerModule.Grids
{
    /// <summary>
    ///     Interaction logic for ManageServer.xaml
    /// </summary>
    [ViewSortHint("0500")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class ManageServer : UserControl
    {
        public ManageServer()
        {
            InitializeComponent();
        }
    }
}
```

`src/Arma3BE.Client.Modules.ManageServerModule/ManageServerModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.ManageServerModule.Grids;
using Arma3BE.Client.Modules.ManageServerModule.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.ManageServerModule
{
    public class ManageServerModuleInit : IModule
    {
        private static IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public ManageServerModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.ServerTabPartRegion, CreateView);
        }

        private object CreateView()
        {
            return ServerTabViewHelper.RegisterView<ManageServer, ServerInfoDto, ServerMonitorManageServerViewModel>(_container,
                "serverInfo");
        }
    }
}
```

`src/Arma3BE.Client.Modules.ManageServerModule/Models/ServerMonitorManageServerViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Server;
using Arma3BE.Server.Models;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Steam;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Threading.Tasks;
using System.Windows;

// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable AutoPropertyCanBeMadeGetOnly.Global

namespace Arma3BE.Client.Modules.ManageServerModule.Models
{
    public class ServerMonitorManageServerViewModel : ViewModelBase
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly IIpService _ipService;
        private readonly Guid _serverId;
        private IEnumerable<Mission> _missions;
        private Mission _selectedMission;
        private bool _showWarning;

        public ServerMonitorManageServerViewModel(ServerInfoDto serverInfo, IEventAggregator eventAggregator,
            IIpService ipService)
        {
            _serverId = serverInfo.Id;
            _eventAggregator = eventAggregator;
            _ipService = ipService;

            _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Mission>>>().Subscribe(e =>
            {
                if (e.ServerId == _serverId)
                    Missions = e.Items;
            });

            SetMissionCommand = new ActionCommand(() =>
                {
                    var m = SelectedMission;
                    if (m != null && ConfirmNotSupported(CommandType.Mission))
                    {
                        var mn = m.Name;
                        SendCommand(CommandType.Mission, mn);
                    }
                },
                () => SelectedMission != null);

            RefreshCommand = new ActionCommand(() => SendCommand(CommandType.Missions));

            InitCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.Init); });
            ShutdownCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.Shutdown); });
            ReassignCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.Reassign); });
            RestartCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.Restart); });

            RestartServerCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.RestartServer); });

            LockCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.Lock); });
            UnlockCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.Unlock); });

            LoadBansCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.LoadBans); });
            LoadScriptsCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.LoadScripts); });
            LoadEventsCommand = new ActionCommand(() => { SendCommandWithConfirmation(CommandType.LoadEvents); });

            ShowWarning = false;
            Task.Run(() => CheckServer(serverInfo));
        }

        private void CheckServer(ServerInfoDto serverInfo)
        {
            var iphost = _ipService.GetIpAddress(serverInfo.Host);
            var server = new Arma3BEClient.Steam.Server(new IPEndPoint(IPAddress.Parse(iphost), serverInfo.SteamPort));

            var settings = new GetServerInfoSettings();
            var rules = server.GetServerInfoSync(settings);
            if (string.Compare(rules.Environment, "w", StringComparison.Ordinal) != 0)
            {
                ShowWarning = true;
            }
        }

        public bool ShowWarning
        {
            get => _showWarning;
            set => SetProperty(ref _showWarning, value);
        }

        private CommandType[] NotSupportedCommands = new[]
        {
            CommandType.Mission,
            CommandType.Restart,
            CommandType.RestartServer,
            CommandType.Shutdown
        };


        private bool ConfirmNotSupported(CommandType command)
        {
            if (_showWarning && NotSupportedCommands.Contains(command))
            {
                return MessageBox.Show(Application.Current.MainWindow,
                           $"This command ({command}) may not be supported on server. Are you sure you want to proceed?",
                           "No supported command", MessageBoxButton.YesNo, MessageBoxImage.Warning) ==
                       MessageBoxResult.Yes;
            }
            else
            {
                return MessageBox.Show(Application.Current.MainWindow, "Are you sure?", command.ToString(),
                           MessageBoxButton.YesNo, MessageBoxImage.Question) == MessageBoxResult.Yes;
            }
        }

        private void SendCommandWithConfirmation(CommandType command)
        {
            if (ConfirmNotSupported(command))
            {
                SendCommand(command);
                MessageBox.Show("Executed " + command, "Server command", MessageBoxButton.OK);
            }
        }

        public string Title => "Manage Server";

        public Mission SelectedMission
        {
            get { return _selectedMission; }
            set
            {
                _selectedMission = value;
                RaisePropertyChanged();
                SetMissionCommand.RaiseCanExecuteChanged();
            }
        }

        public IEnumerable<Mission> Missions
        {
            get { return _missions; }
            set
            {
                _missions = value;
                RaisePropertyChanged();
            }
        }

        public ActionCommand RefreshCommand { get; set; }
        public ActionCommand SetMissionCommand { get; set; }
        public ActionCommand InitCommand { get; set; }
        public ActionCommand ShutdownCommand { get; set; }
        public ActionCommand ReassignCommand { get; set; }
        public ActionCommand RestartCommand { get; set; }
        public ActionCommand RestartServerCommand { get; set; }
        public ActionCommand LockCommand { get; set; }
        public ActionCommand UnlockCommand { get; set; }
        public ActionCommand LoadBansCommand { get; set; }
        public ActionCommand LoadScriptsCommand { get; set; }
        public ActionCommand LoadEventsCommand { get; set; }

        private void SendCommand(CommandType commandType, string parameters = null)
        {
            _eventAggregator.GetEvent<BEMessageEvent<BECommand>>()
                .Publish(new BECommand(_serverId, commandType, parameters));
        }
    }
}
```

`src/Arma3BE.Client.Modules.ManageServerModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.NetModule/Arma3BE.Client.Modules.NetModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.NetModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.NetModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="MaxMind.Db, Version=2.0.0.0, Culture=neutral, PublicKeyToken=66afa4cc5ae853ac, processorArchitecture=MSIL">
      <HintPath>..\packages\MaxMind.Db.2.2.0\lib\net45\MaxMind.Db.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="MaxMind.GeoIP2, Version=2.6.0.0, Culture=neutral, PublicKeyToken=66afa4cc5ae853ac, processorArchitecture=MSIL">
      <HintPath>..\packages\MaxMind.GeoIP2.2.8.0\lib\net45\MaxMind.GeoIP2.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Newtonsoft.Json, Version=10.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed, processorArchitecture=MSIL">
      <HintPath>..\packages\Newtonsoft.Json.10.0.3\lib\net45\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Core" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Numerics" />
    <Reference Include="System.Security.Cryptography.Algorithms, Version=4.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.Algorithms.4.3.0\lib\net461\System.Security.Cryptography.Algorithms.dll</HintPath>
    </Reference>
    <Reference Include="System.Security.Cryptography.Encoding, Version=4.0.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.Encoding.4.3.0\lib\net46\System.Security.Cryptography.Encoding.dll</HintPath>
    </Reference>
    <Reference Include="System.Security.Cryptography.Primitives, Version=4.0.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.Primitives.4.3.0\lib\net46\System.Security.Cryptography.Primitives.dll</HintPath>
    </Reference>
    <Reference Include="System.Security.Cryptography.X509Certificates, Version=4.1.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Security.Cryptography.X509Certificates.4.3.0\lib\net461\System.Security.Cryptography.X509Certificates.dll</HintPath>
    </Reference>
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="IpService.cs" />
    <Compile Include="NetModuleInit.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="app.config" />
    <Content Include="IPDatabase\GeoLite2-City.mmdb">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.NetModule/IPDatabase/COPYRIGHT.txt`:

```txt
Database and Contents Copyright (c) 2017 MaxMind, Inc.

```

`src/Arma3BE.Client.Modules.NetModule/IPDatabase/LICENSE.txt`:

```txt
This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License. To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/4.0/.

This database incorporates GeoNames [http://www.geonames.org] geographical data, which is made available under the Creative Commons Attribution 3.0 License. To view a copy of this license, visit http://www.creativecommons.org/licenses/by/3.0/us/.

```

`src/Arma3BE.Client.Modules.NetModule/IpService.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using MaxMind.GeoIP2;
using MaxMind.GeoIP2.Responses;
using System;
using System.Configuration;
using System.Diagnostics;
using System.Net;
using System.Net.Http;
using System.Threading.Tasks;

namespace Arma3BE.Client.Modules.NetModule
{
    public class IpService : DisposeObject, IIpService
    {
        private DatabaseReader reader;
        private static readonly ILog Log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        public IpService()
        {
            reader = new DatabaseReader(@"IPDatabase\GeoLite2-City.mmdb");
        }

        protected override void DisposeManagedResources()
        {
            base.DisposeManagedResources();
            reader.Dispose();
        }

        public string GetIpAddress(string host)
        {
            IPAddress ip;

            if (IPAddress.TryParse(host, out ip))
            {
                return ip.ToString();
            }
            try
            {
                var entry = Dns.GetHostEntry(host);
                return entry.AddressList[0].ToString();
            }
            catch
            {
                return string.Empty;
            }
        }

        public async Task<string> Get(string ip)
        {
            if (string.IsNullOrEmpty(ip)) return string.Empty;
            using (var c = new HttpClient())
            {
                var pattern = ConfigurationManager.AppSettings["IPServicePattern"];
                var data = await c.GetStringAsync(string.Format(pattern, ip));
                return data;
            }
        }

        public GeoInfo GetGeoInfoLocal(string ip)
        {
            if (string.IsNullOrEmpty(ip)) return default(GeoInfo);

            try
            {
                CityResponse city;
                if (reader.TryCity(ip, out city))
                {
                    var result = new GeoInfo(city.Country.Name, city.City.Name);
                    return result;
                }
                return default(GeoInfo);
            }
            catch (Exception ex)
            {
                Log.Error(ex);
                return default(GeoInfo);
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.NetModule/NetModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Microsoft.Practices.Unity;
using Prism.Modularity;

namespace Arma3BE.Client.Modules.NetModule
{
    public class NetModuleInit : IModule
    {
        private readonly IUnityContainer _container;

        public NetModuleInit(IUnityContainer container)
        {
            _container = container;
        }

        public void Initialize()
        {
            _container.RegisterType<IIpService, IpService>(new ContainerControlledLifetimeManager());
        }
    }
}
```

`src/Arma3BE.Client.Modules.NetModule/app.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-10.0.0.0" newVersion="10.0.0.0" />
      </dependentAssembly>     
    </assemblyBinding>
  </runtime>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" /></startup></configuration>

```

`src/Arma3BE.Client.Modules.NetModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net45" />
  <package id="MaxMind.Db" version="2.2.0" targetFramework="net452" />
  <package id="MaxMind.GeoIP2" version="2.8.0" targetFramework="net452" />
  <package id="Newtonsoft.Json" version="10.0.3" targetFramework="net461" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="System.Net.Http" version="4.0.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.Algorithms" version="4.3.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.Encoding" version="4.3.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.Primitives" version="4.3.0" targetFramework="net461" />
  <package id="System.Security.Cryptography.X509Certificates" version="4.3.0" targetFramework="net461" />
  <package id="Unity" version="4.0.1" targetFramework="net45" />
</packages>
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/Arma3BE.Client.Modules.OnlinePlayersModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.OnlinePlayersModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.OnlinePlayersModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Grids\OnlinePlayers.xaml.cs">
      <DependentUpon>OnlinePlayers.xaml</DependentUpon>
    </Compile>
    <Compile Include="Helpers\PlayerHelper.cs" />
    <Compile Include="Helpers\Views\PlayerView.cs" />
    <Compile Include="Models\ServerMonitorPlayerViewModel.cs" />
    <Compile Include="OnlinePlayersModuleInit.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="Grids\OnlinePlayers.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/Grids/OnlinePlayers.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.OnlinePlayersModule.Grids.OnlinePlayers"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"

             mc:Ignorable="d">

    <UserControl.Resources>
        <converters:BisyBoolToColorConverter x:Uid="local:BisyBoolToColorConverter"
                                                     x:Key="BisyBoolToColorConverter" />
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>


        <ToolBar Height="30">
            <Button Command="{Binding RefreshCommand, Mode=OneWay}" 
                    BorderThickness="1" BorderBrush="{Binding WaitingForEvent, Mode=OneWay, Converter={StaticResource BisyBoolToColorConverter}}"
                    >
                <!-- ReSharper disable once Xaml.StaticResourceNotResolved -->
                <Image Source="{StaticResource refresh_icon}" Height="16" Width="16" />
            </Button>


            <Separator />
            <TextBlock Margin="2" HorizontalAlignment="Right" VerticalAlignment="Center"
                       Text="{Binding DataCount, Mode=OneWay, StringFormat=Total: {0}}" />
            <Separator />


            <TextBox Margin="2" Text="{Binding Filter, Mode=TwoWay}" Height="20" MinWidth="150" />
            <Button Content="Search" Margin="2" Command="{Binding FilterCommand, Mode=OneWay}" />

        </ToolBar>

        <xcdg:DataGridControl Grid.Row="1" ItemsSource="{Binding Data, Mode=OneWay}" 
                              AutoCreateColumns="False" SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                              ReadOnly="True" Name="dg" MouseDoubleClick="Dg_OnMouseDoubleClick">

            <xcdg:DataGridControl.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Kick" Command="{Binding KickUserCommand}" />
                    <MenuItem Header="Ban" Command="{Binding BanUserCommand}" />
                    <MenuItem Header="Player Info" Command="{Binding PlayerInfoCommand}" />
                </ContextMenu>
            </xcdg:DataGridControl.ContextMenu>

            <xcdg:DataGridControl.View>
                <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                    <xcdg:TableView.FixedHeaders>
                        <DataTemplate>
                            <xcdg:ColumnManagerRow />
                        </DataTemplate>
                    </xcdg:TableView.FixedHeaders>
                </xcdg:TableflowView>
            </xcdg:DataGridControl.View>
        </xcdg:DataGridControl>

    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/Grids/OnlinePlayers.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Modules.OnlinePlayersModule.Helpers.Views;
using Prism.Events;
using Prism.Regions;
using System.Linq;
using System.Windows.Controls;
using System.Windows.Input;

namespace Arma3BE.Client.Modules.OnlinePlayersModule.Grids
{
    /// <summary>
    ///     Interaction logic for OnlinePlayers.xaml
    /// </summary>
    [ViewSortHint("0100")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class OnlinePlayers : UserControl
    {
        private readonly IEventAggregator _eventAggregator;

        public OnlinePlayers(IEventAggregator eventAggregator)
        {
            _eventAggregator = eventAggregator;
            InitializeComponent();

            dg.LoadState<PlayerView>(GetType().FullName);

            var menu = dg.Generate<PlayerView>();

            foreach (var menuItem in menu.Items.OfType<MenuItem>().ToList())
            {
                menu.Items.Remove(menuItem);
                dg.ContextMenu?.Items.Add(menuItem);
            }
        }

        private void Dg_OnMouseDoubleClick(object sender, MouseButtonEventArgs e)
        {
            var player = dg.SelectedItem as PlayerView;
            if (player != null)
            {
                _eventAggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(player.Guid));
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/Helpers/PlayerHelper.cs`:

```cs
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.OnlinePlayersModule.Helpers.Views;
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Repositories.Players;
using Arma3BEClient.Libs.Tools;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using Player = Arma3BE.Server.Models.Player;

namespace Arma3BE.Client.Modules.OnlinePlayersModule.Helpers
{
    public class PlayerHelper : StateHelper<Player>
    {
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private readonly IBanHelper _banHelper;
        private readonly IPlayerRepository _playerRepository;
        private readonly ISteamService _steamService;
        private readonly Guid _serverId;

        private string[] _badNicknames;

        private readonly Regex _nameRegex = new Regex("[A-Za-zА-Яа-я0-9]+",
            RegexOptions.Compiled | RegexOptions.CultureInvariant | RegexOptions.IgnoreCase);

        public PlayerHelper(Guid serverId, IBanHelper banHelper, IPlayerRepository playerRepository, ReasonRepository reasonRepository, ISteamService steamService)
        {
            _serverId = serverId;
            _banHelper = banHelper;
            _playerRepository = playerRepository;
            _steamService = steamService;

            Init(reasonRepository);
        }

        private async Task Init(ReasonRepository reasonRepository)
        {
            _badNicknames = await reasonRepository.GetBadNicknamesAsync();
        }

        public void RegisterPlayers(IEnumerable<Player> list)
        {
            Task.Run(() => RegisterPlayersInternal(list));
        }


        private IEnumerable<Player> _previousState = new Player[0];

        private async Task<bool> RegisterPlayersInternal(IEnumerable<Player> list)
        {
            var players = list.ToList();

            if (!HaveChanges(players, x => x.Num))
                return false;

            var prevoius = new HashSet<string>(_previousState.Select(x => x.Guid).Distinct());
            _previousState = players;

            var guids = players.Select(x => x.Guid).ToList();

            var playersInDb = (await _playerRepository.GetPlayersAsync(guids)).ToArray();
            var dbGuids = playersInDb.Select(x => x.GUID).ToList();

            var historyToAdd = new List<PlayerHistory>();
            var playerToUpdate = new List<PlayerDto>();

            foreach (var player in playersInDb)
            {
                var p = players.FirstOrDefault(x => x.Guid == player.GUID);
                if (p != null)
                {
                    var needUpdate = false;
                    if ((player.Name != p.Name) || (player.LastIp != p.IP))
                    {
                        historyToAdd.Add(new PlayerHistory
                        {
                            IP = p.IP,
                            Name = p.Name,
                            PlayerId = player.Id,
                            ServerId = _serverId
                        });

                        player.Name = p.Name;
                        player.LastIp = p.IP;

                        needUpdate = true;
                    }


                    if (prevoius.Contains(player.GUID) == false)
                    {
                        player.LastSeen = DateTime.UtcNow;
                        needUpdate = true;
                    }

                    if (string.IsNullOrEmpty(player.SteamId))
                    {
                        player.SteamId = _steamService.GetSteamId(player.GUID)?.ToString();
                        needUpdate = true;
                    }

                    if (needUpdate)
                        playerToUpdate.Add(player);
                }
            }

            var newplayers = players.Where(x => !dbGuids.Contains(x.Guid)).ToList();

            if (newplayers.Any())
                foreach (var p in newplayers)
                {
                    var np = new Arma3BEClient.Libs.ModelCompact.Player
                    {
                        GUID = p.Guid,
                        Name = p.Name,
                        Id = Guid.NewGuid(),
                        LastIp = p.IP,
                        SteamId = _steamService.GetSteamId(p.Guid)?.ToString()
                    };

                    playerToUpdate.Add(np);

                    historyToAdd.Add(new PlayerHistory
                    {
                        IP = np.LastIp,
                        Name = np.Name,
                        PlayerId = np.Id,
                        ServerId = _serverId
                    });
                }

            await _playerRepository.AddOrUpdateAsync(playerToUpdate);
            await _playerRepository.AddHistoryAsync(historyToAdd);

            return true;
        }

        public async Task<IEnumerable<PlayerView>> GetPlayerViewAsync(IEnumerable<Player> list)
        {
            using (_log.Time("GetPlayerViewAsync"))
            {

                var players = list.ToList();
                var guids = players.Select(x => x.Guid).ToList();

                var playersInDb = await _playerRepository.GetPlayersAsync(guids);

                var result = players.Select(x => new PlayerView
                {
                    Guid = x.Guid,
                    IP = x.IP,
                    Name = x.Name,
                    Num = x.Num,
                    Ping = x.Ping,
                    State = x.State,
                    Port = x.Port
                }).ToList();

                result.ForEach(x =>
                {
                    var p = playersInDb.FirstOrDefault(y => y.GUID == x.Guid);
                    if (p != null)
                    {
                        x.Id = p.Id;
                        x.Comment = p.Comment;
                        x.SteamId = p.SteamId;
                    }
                });

                var filterUsers = result.FirstOrDefault(x => !_nameRegex.IsMatch(x.Name));
                if (filterUsers != null)
                {
#pragma warning disable 4014
                    _banHelper.KickAsync(_serverId, filterUsers.Num, filterUsers.Guid, "bot: Fill Nickname");
#pragma warning restore 4014
                }

                if (_badNicknames?.Any() == true)
                {
                    var names = _badNicknames.Select(x => x.ToLower()).Distinct().ToDictionary(x => x);


                    var bad =
                        result.FirstOrDefault(x => !string.IsNullOrEmpty(x.Name) && names.ContainsKey(x.Name.ToLower()));

                    if (bad != null)
#pragma warning disable 4014
                        _banHelper.KickAsync(_serverId, bad.Num, bad.Guid, "bot: Bad Nickname");
#pragma warning restore 4014
                }


                return result;
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/Helpers/Views/PlayerView.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Server.Models;
using Arma3BEClient.Common.Attributes;
using Microsoft.Practices.Unity;
using System;
// ReSharper disable UnusedMember.Global
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BE.Client.Modules.OnlinePlayersModule.Helpers.Views
{
    public class PlayerView : ViewModelBase
    {
        private bool _canBeAdmin;
        private string _comment;

        private string _country;
        private string _city;
        private string _ip;

        private readonly IIpService _ipService;
        private int _ping;
        private int _port;
        private Player.PlayerState _state;

        public PlayerView()
        {
            _ipService = OnlinePlayersModuleInit.Current.Resolve<IIpService>();

            _geoInfo = new Lazy<GeoInfo>(() => _ipService.GetGeoInfoLocal(IP));
        }

        [ShowInUi]
        [EnableCopy]
        public int Num { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Name { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Comment
        {
            get { return _comment; }
            set { SetProperty(ref _comment, value); }
        }

        [ShowInUi]
        public bool CanBeAdmin
        {
            get { return _canBeAdmin; }
            set { SetProperty(ref _canBeAdmin, value); }
        }

        [ShowInUi]
        [EnableCopy]
        public string Country
        {
            get
            {
                if (string.IsNullOrEmpty(_country))
                {
                    SetProperty(ref _country, _geoInfo?.Value?.Country, nameof(Country));
                }

                return _country;
            }
        }

        private Lazy<GeoInfo> _geoInfo;

        [ShowInUi]
        [EnableCopy]
        public string City
        {
            get
            {
                if (string.IsNullOrEmpty(_city))
                {
                    SetProperty(ref _city, _geoInfo?.Value?.City, nameof(Country));
                }

                return _city;
            }
        }

        [ShowInUi]
        [EnableCopy]
        public Player.PlayerState State
        {
            get { return _state; }
            set { SetProperty(ref _state, value); }
        }

        [ShowInUi]
        [EnableCopy]
        public int Ping
        {
            get { return _ping; }
            set { SetProperty(ref _ping, value); }
        }

        [ShowInUi]
        [EnableCopy]
        public string SteamId { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string IP
        {
            get { return _ip; }
            set { SetProperty(ref _ip, value); }
        }

        [ShowInUi]
        [EnableCopy]
        public string Guid { get; set; }

        [ShowInUi]
        [EnableCopy]
        public int Port
        {
            get { return _port; }
            set { SetProperty(ref _port, value); }
        }

        public Guid Id { get; set; }
    }
}
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/Models/ServerMonitorPlayerViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.BE;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.OnlinePlayersModule.Helpers;
using Arma3BE.Server;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Repositories.Players;
using Arma3BEClient.Libs.Tools;
using Prism.Commands;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Admin = Arma3BE.Server.Models.Admin;
using Player = Arma3BE.Server.Models.Player;
// ReSharper disable MemberCanBePrivate.Global

// ReSharper disable RedundantNameQualifier

namespace Arma3BE.Client.Modules.OnlinePlayersModule.Models
{
    public class ServerMonitorPlayerViewModel : ServerMonitorBaseViewModel<Player, Helpers.Views.PlayerView>
    {
        private readonly ServerInfoDto _serverInfo;
        private readonly IEventAggregator _eventAggregator;
        private readonly PlayerHelper _playerHelper;

        public ServerMonitorPlayerViewModel(ServerInfoDto serverInfo,
            IBanHelper banHelper, IEventAggregator eventAggregator, IPlayerRepository playerRepository,
            ReasonRepository reasonRepository,
            ISteamService steamService)
            : base(
                new ActionCommand(() => SendCommand(eventAggregator, serverInfo.Id, CommandType.Players)),
                new PlayerViewComparer())
        {
            _serverInfo = serverInfo;
            _eventAggregator = eventAggregator;
            _playerHelper = new PlayerHelper(serverInfo.Id, banHelper, playerRepository, reasonRepository, steamService);

            KickUserCommand = new DelegateCommand(ShowKickDialog, CanShowDialog);
            BanUserCommand = new DelegateCommand(ShowBanDialog, CanShowDialog);
            PlayerInfoCommand = new DelegateCommand(PlayerInfoDialog, CanShowDialog);


            PropertyChanged += ServerMonitorPlayerViewModel_PropertyChanged;

            _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Player>>>().Subscribe(async e =>
            {
                if (e.ServerId == serverInfo.Id)
                {
                    await SetDataAsync(e.Items);
                    WaitingForEvent = false;
                }
            });

            _eventAggregator.GetEvent<BEMessageEvent<BEItemsMessage<Admin>>>().Subscribe(e =>
            {
                if (e.ServerId == serverInfo.Id)
                {
                    _admins = e.Items ?? new Admin[0];
                }
            });
        }

        private void ServerMonitorPlayerViewModel_PropertyChanged(object sender,
            System.ComponentModel.PropertyChangedEventArgs e)
        {
            if (e.PropertyName == nameof(SelectedItem) || e.PropertyName == nameof(Data))
            {
                KickUserCommand?.RaiseCanExecuteChanged();
                BanUserCommand?.RaiseCanExecuteChanged();
                PlayerInfoCommand?.RaiseCanExecuteChanged();
            }
        }

        public string Title => "Session";

        private static void SendCommand(IEventAggregator eventAggregator, Guid serverId, CommandType commandType,
            string parameters = null)
        {
            eventAggregator.GetEvent<BEMessageEvent<BECommand>>()
                .Publish(new BECommand(serverId, commandType, parameters));
        }

        private void ShowKickDialog()
        {
            var local = SelectedItem;
            if (local != null)
            {
                _eventAggregator.GetEvent<KickUserEvent>()
                    .Publish(new KickUserModel(_serverInfo.Id, local.Guid, local.Name, local.Num));
            }
        }

        private void ShowBanDialog()
        {
            var local = SelectedItem;
            if (local != null)
            {
                _eventAggregator.GetEvent<BanUserEvent>()
                    .Publish(new BanUserModel(_serverInfo.Id, local.Guid, true, local.Name, local.Num.ToString()));
            }
        }

        private void PlayerInfoDialog()
        {
            var local = SelectedItem;
            if (local != null)
            {
                _eventAggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(local.Guid));
            }
        }

        private bool CanShowDialog()
        {
            return SelectedItem != null;
        }

        private IEnumerable<Admin> _admins = new List<Admin>();

        public DelegateCommand KickUserCommand { get; }
        public DelegateCommand BanUserCommand { get; }
        public DelegateCommand PlayerInfoCommand { get; }

        protected override async Task<IEnumerable<Helpers.Views.PlayerView>> RegisterDataAsync(IEnumerable<Player> initialData)
        {
            var enumerable = initialData as IList<Player> ?? initialData.ToList();
            _playerHelper.RegisterPlayers(enumerable);
            var view = (await _playerHelper.GetPlayerViewAsync(enumerable)).ToArray();
            var admins = _admins ?? new Admin[0];
            var adminsIps = new HashSet<string>(admins.Select(x => x.IP.ToLower()).Distinct());
            foreach (var playerView in view)
            {
                playerView.CanBeAdmin = adminsIps.Contains(playerView.IP.ToLower());
            }
            return view;
        }


        private class PlayerViewComparer : IEqualityComparer<Helpers.Views.PlayerView>
        {
            public bool Equals(Helpers.Views.PlayerView x, Helpers.Views.PlayerView y)
            {
                return x.Id == y.Id && x.Guid == y.Guid;
            }

            public int GetHashCode(Helpers.Views.PlayerView obj)
            {
                return obj.GetHashCode();
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/OnlinePlayersModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.OnlinePlayersModule.Grids;
using Arma3BE.Client.Modules.OnlinePlayersModule.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Microsoft.Practices.Unity;
using Prism.Modularity;
using Prism.Regions;

namespace Arma3BE.Client.Modules.OnlinePlayersModule
{
    public class OnlinePlayersModuleInit : IModule
    {
        private static IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public OnlinePlayersModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _regionManager.RegisterViewWithRegion(RegionNames.ServerTabPartRegion, CreateView);
        }

        private object CreateView()
        {
            return ServerTabViewHelper.RegisterView<OnlinePlayers, ServerInfoDto, ServerMonitorPlayerViewModel>(_container,
                "serverInfo");
        }

        public static IUnityContainer Current => _container;
    }
}
```

`src/Arma3BE.Client.Modules.OnlinePlayersModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net45" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.OptionsModule.Tests/Arma3BE.Client.Modules.OptionsModule.Tests.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{0E3BCF33-9E88-4919-85CD-D99DE6060D35}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.OptionsModule.Tests</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.OptionsModule.Tests</AssemblyName>
    <TargetFrameworkVersion>v4.5.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
    <ReferencePath>$(ProgramFiles)\Common Files\microsoft shared\VSTT\$(VisualStudioVersion)\UITestExtensionPackages</ReferencePath>
    <IsCodedUITest>False</IsCodedUITest>
    <TestProjectType>UnitTest</TestProjectType>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="nunit.framework, Version=3.5.0.0, Culture=neutral, PublicKeyToken=2638cd05610744eb, processorArchitecture=MSIL">
      <HintPath>..\packages\NUnit.3.5.0\lib\net45\nunit.framework.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Modules.OptionsModule\Arma3BE.Client.Modules.OptionsModule.csproj">
      <Project>{09d6c875-0877-40b7-b52c-7fa0476c1d5d}</Project>
      <Name>Arma3BE.Client.Modules.OptionsModule</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <Choose>
    <When Condition="('$(VisualStudioVersion)' == '10.0' or '$(VisualStudioVersion)' == '') and '$(TargetFrameworkVersion)' == 'v3.5'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework, Version=10.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
      </ItemGroup>
    </When>
    <Otherwise>
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework" />
      </ItemGroup>
    </Otherwise>
  </Choose>
  <Choose>
    <When Condition="'$(VisualStudioVersion)' == '10.0' And '$(IsCodedUITest)' == 'True'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.CodedUITestFramework, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Extension, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITesting, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
      </ItemGroup>
    </When>
  </Choose>
  <Import Project="$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets" Condition="Exists('$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets')" />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.OptionsModule.Tests/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="NUnit" version="3.5.0" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.OptionsModule/Arma3BE.Client.Modules.OptionsModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{09D6C875-0877-40B7-B52C-7FA0476C1D5D}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.OptionsModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.OptionsModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="OptionsModuleInit.cs" />
    <Compile Include="Options.xaml.cs">
      <DependentUpon>Options.xaml</DependentUpon>
    </Compile>
    <Compile Include="ViewModel\OptionsModel.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="Options.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{B58670E5-011F-4318-964E-35C8B63870A5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.CoreModule\Arma3BE.Client.Modules.CoreModule.csproj">
      <Project>{308eef0c-5de3-435e-8249-7a658bfafd08}</Project>
      <Name>Arma3BE.Client.Modules.CoreModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.OptionsModule/Options.xaml`:

```xaml
<windows:WindowBase x:Class="Arma3BE.Client.Modules.OptionsModule.Options"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:viewModel="clr-namespace:Arma3BE.Client.Modules.OptionsModule.ViewModel"
        xmlns:windows="clr-namespace:Arma3BE.Client.Infrastructure.Windows;assembly=Arma3BE.Client.Infrastructure"
        Title="Options" WindowStartupLocation="CenterScreen" Height="600" Width="800"
        WindowStyle="ToolWindow">

    <xctk:BusyIndicator IsBusy="False" BusyContent="Saving changes..." Name="BusyIndicator">

        <Grid>

            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <TabControl VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" Margin="5">
                <TabItem Header="Servers">
                    <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">
                        <xctk:CollectionControl Name="ServerCollectionControl" IsReadOnly="False"
                                            ItemsSource="{Binding Servers}"
                                            ItemAdded="ServerAdded" ItemDeleted="ServerDeleted"
                                            ItemsSourceType="viewModel:ServerInfoModel"
                                            NewItemTypes="{Binding NewListItemTypes}" />
                    </Border>
                </TabItem>

                <TabItem Header="Settings">
                    <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto"  />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Grid.RowDefinitions>
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25" />
                                <RowDefinition Height="25" />
                                <RowDefinition Height="325" />
                                <!--<RowDefinition Height="25" />-->
                            </Grid.RowDefinitions>


                            <TextBlock Grid.Row="0" Grid.Column="0"  Text="AdminName" Margin="2" />
                            <TextBox Grid.Row="0" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="2" Text="{Binding Settings.AdminName, Mode=TwoWay}" />


                            <TextBlock Grid.Row="1" Grid.Column="0"  Text="Time Zone" Margin="2" />
                            <ComboBox Grid.Row="1" Grid.Column="1" HorizontalAlignment="Left" Margin="2"
                                  ItemsSource="{Binding TimeZones}"
                                  DisplayMemberPath="DisplayName"
                                  SelectedItem="{Binding Settings.TimeZoneInfo, Mode=TwoWay}"
                                  ></ComboBox>


                            <TextBlock Grid.Row="2" Grid.Column="0"  Text="Players update interval (seconds)" Margin="2" />
                            <TextBox Grid.Row="2" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="2" Text="{Binding Settings.PlayersUpdateSeconds, Mode=TwoWay}" />


                            <TextBlock Grid.Row="3" Grid.Column="0"  Text="Bans update interval (seconds)" Margin="2" />
                            <TextBox Grid.Row="3" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="2" Text="{Binding Settings.BansUpdateSeconds, Mode=TwoWay}" />

                            <TextBlock Grid.Row="4" Grid.Column="0"  Text="Always on top" Margin="2" />
                            <CheckBox  Grid.Row="4" Grid.Column="1" Margin="2" IsChecked="{Binding Settings.TopMost, Mode=TwoWay}"></CheckBox>



                            <DataGrid Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" ItemsSource="{Binding ServerSettings}" IsReadOnly="False"
                                      CanUserAddRows="False" CanUserDeleteRows="False" AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Server" Binding="{Binding ServerName}" IsReadOnly="True"></DataGridTextColumn>


                                    <DataGridTextColumn Header="Kick Rreason" Binding="{Binding IdleKickReason}" ></DataGridTextColumn>

                                    <DataGridTextColumn Header="Lobby Time (mins)" Binding="{Binding IdleTimeInMins}" ></DataGridTextColumn>

                                    <DataGridCheckBoxColumn Header="Kick Idle Players" Binding="{Binding KickIdlePlayers}"></DataGridCheckBoxColumn>

                                </DataGrid.Columns>
                            </DataGrid>

                            <!--<ItemsControl ItemsSource="{Binding ServerSettings}" Grid.ColumnSpan="2">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>-->
                            
                            

                            <!--<TextBlock Grid.Row="5" Grid.Column="0"  Text="Lobby Idle Time Limit (minutes)" Margin="2" />
                            <TextBox Grid.Row="5" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="2" Text="{Binding Settings.IdleTimeInMins, Mode=TwoWay}" />

                            <TextBlock Grid.Row="6" Grid.Column="0"  Text="Lobby Idle kick reason" Margin="2" />
                            <TextBox Grid.Row="6" Grid.Column="1" Width="100" HorizontalAlignment="Left" Margin="2" Text="{Binding Settings.IdleKickText, Mode=TwoWay}" />-->
                        </Grid>
                    </Border>
                </TabItem>
                <TabItem Header="Ban / Kick Reasons">
                    <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">
                        <ScrollViewer HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <StackPanel Orientation="Vertical" Grid.Row="0" Grid.Column="0" Margin="3">
                                    <TextBlock>Ban reasons</TextBlock>
                                    <DataGrid ItemsSource="{Binding BanReasons}" IsReadOnly="False"></DataGrid>

                                </StackPanel>
                                <StackPanel Orientation="Vertical" Grid.Row="0" Grid.Column="1" Margin="3">

                                    <TextBlock>Ban times</TextBlock>
                                    <DataGrid ItemsSource="{Binding BanTimes}" IsReadOnly="False"></DataGrid>

                                </StackPanel>
                                <StackPanel Orientation="Vertical" Grid.Row="1" Grid.Column="0" Margin="3">

                                    <TextBlock>Kick reasons</TextBlock>
                                    <DataGrid ItemsSource="{Binding KickReasons}" IsReadOnly="False"></DataGrid>
                                </StackPanel>


                                <StackPanel Orientation="Vertical" Grid.Row="1" Grid.Column="1" Margin="3">

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock>Kick reason template</TextBlock>
                                        <TextBlock FontSize="10" FontWeight="Bold">[{AdminName}][{Date}:{Time}] {Reason}</TextBlock>
                                    </StackPanel>
                                    <TextBox Text="{Binding KickMessageTemplate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                    <TextBlock  FontSize="10" FontWeight="Bold" Text="{Binding KickMessageTemplateExample}"></TextBlock>

                                    <Separator></Separator>

                                    <StackPanel Orientation="Horizontal">
                                    <TextBlock>Ban reason template</TextBlock>
                                        <TextBlock FontSize="10" FontWeight="Bold">[{AdminName}][{Date} {Time}] {Reason} {Minutes}</TextBlock>
                                    </StackPanel>


                                    <TextBox Text="{Binding BanMessageTemplate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                    <TextBlock  FontSize="10" FontWeight="Bold" Text="{Binding BanMessageTemplateExample}"></TextBlock>

                                </StackPanel>

                            </Grid>
                        </ScrollViewer>
                    </Border>
                </TabItem>



                <TabItem Header="Other settings">
                    <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">
                        <ScrollViewer HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <StackPanel Orientation="Vertical" Grid.Row="0" Grid.Column="0" Margin="3">
                                    <TextBlock>Bad nicknames</TextBlock>
                                    <DataGrid ItemsSource="{Binding BadNicknames}" IsReadOnly="False"></DataGrid>

                                </StackPanel>
                                <StackPanel Orientation="Vertical" Grid.Row="0" Grid.Column="1" Margin="3">

                                    <TextBlock>Important words</TextBlock>
                                    <DataGrid ItemsSource="{Binding ImportantWords}" IsReadOnly="False"></DataGrid>

                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </Border>
                </TabItem>



            </TabControl>

            <StackPanel Grid.Row="1" HorizontalAlignment="Right" Margin="5" Orientation="Horizontal">
                <Button Content="Save" Margin="5 0 5 0" Padding="5 0" Click="Save_Click" />
                <Button Content="Cancel" Margin="5 0 5 0" Padding="5 0" Click="Cancel_Click" />
            </StackPanel>

        </Grid>
    </xctk:BusyIndicator>
</windows:WindowBase>
```

`src/Arma3BE.Client.Modules.OptionsModule/Options.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Windows;
using Arma3BE.Client.Modules.OptionsModule.ViewModel;
using Arma3BEClient.Libs.Tools;
using System;
using System.Windows;
using Xceed.Wpf.Toolkit;

namespace Arma3BE.Client.Modules.OptionsModule
{
    /// <summary>
    ///     Interaction logic for Options.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class Options : WindowBase
    {
        private readonly OptionsModel _optionsModel;

        public Options(OptionsModel optionsModel, ISettingsStoreSource settingsStoreSource) : base(settingsStoreSource)
        {
            InitializeComponent();

            _optionsModel = optionsModel;

            DataContext = _optionsModel;
        }

        protected override void OnClosed(EventArgs e)
        {
            base.OnClosed(e);
            _optionsModel.Cleanup();
        }

        private void ServerDeleted(object sender, ItemEventArgs e)
        {
            var model = e.Item as ServerInfoModel;
            _optionsModel.Servers.Remove(model);
        }

        private void ServerAdded(object sender, ItemEventArgs e)
        {
            _optionsModel.Servers.Add(e.Item as ServerInfoModel);
        }

        private async void Save_Click(object sender, RoutedEventArgs e)
        {
            BusyIndicator.IsBusy = true;
            await _optionsModel.Save();
            BusyIndicator.IsBusy = false;
            Close();
        }

        private void Cancel_Click(object sender, RoutedEventArgs e)
        {
            Close();
        }
    }
}
```

`src/Arma3BE.Client.Modules.OptionsModule/OptionsModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Microsoft.Practices.Unity;
using Prism.Events;
using Prism.Modularity;
using System.Windows;
// ReSharper disable PrivateFieldCanBeConvertedToLocalVariable

namespace Arma3BE.Client.Modules.OptionsModule
{
    public class OptionsModuleInit : IModule
    {
        private readonly IUnityContainer _container;

        public OptionsModuleInit(IUnityContainer container)
        {
            _container = container;
        }

        public void Initialize()
        {
            _container.RegisterInstance(new OptionsService(_container.Resolve<IEventAggregator>(), _container));
        }
    }

    public class OptionsService
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly IUnityContainer _container;

        public OptionsService(IEventAggregator eventAggregator, IUnityContainer container)
        {
            _eventAggregator = eventAggregator;
            _container = container;

            _eventAggregator.GetEvent<ShowOptionsEvent>().Subscribe(e =>
            {
                var owner = Application.Current.MainWindow;
                var w = _container.Resolve<Options>();
                w.Owner = owner;
                w.ShowDialog();
            });
        }
    }
}
```

`src/Arma3BE.Client.Modules.OptionsModule/ViewModel/OptionsModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Contracts;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Settings;
using Arma3BE.Client.Modules.CoreModule.Helpers;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Tools;
using Prism.Events;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;

// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable AutoPropertyCanBeMadeGetOnly.Global
// ReSharper disable ExplicitCallerInfoArgument

namespace Arma3BE.Client.Modules.OptionsModule.ViewModel
{
    public class OptionsModel : DisposableViewModelBase
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly ISettingsStoreSource _settingsStoreSource;
        private readonly MessageHelper _messageHelper;
        private readonly IServerInfoRepository _infoRepository;
        private readonly ILog _log = new Log();
        private ISettingsStore _settingsStore;

        public OptionsModel(IEventAggregator eventAggregator, ISettingsStoreSource settingsStoreSource, MessageHelper messageHelper, IServerInfoRepository infoRepository)
        {
            _eventAggregator = eventAggregator;
            _settingsStoreSource = settingsStoreSource;
            _messageHelper = messageHelper;
            _infoRepository = infoRepository;

            Init();
        }

        private async void Init()
        {
            var dbServers = (await _infoRepository.GetServerInfoAsync()).ToArray();
            Servers = dbServers.Select(x => new ServerInfoModel(x)).ToList();


            using (var dc = new ReasonRepository())
            {
                BanReasons = (await dc.GetBanReasonsAsync()).Select(x => new ReasonEdit { Text = x }).ToList();
                KickReasons = (await dc.GetKickReasonsAsync()).Select(x => new ReasonEdit { Text = x }).ToList();
                BanTimes =
                    (await dc.GetBanTimesAsync()).Select(x => new BanTimeEdit { Text = x.Title, Minutes = x.TimeInMinutes }).ToList();

                BadNicknames = (await dc.GetBadNicknamesAsync()).Select(x => new ReasonEdit { Text = x }).ToList();
                ImportantWords = (await dc.GetImportantWordsAsync()).Select(x => new ReasonEdit { Text = x }).ToList();
            }

            var zones = TimeZoneInfo.GetSystemTimeZones().ToArray();
            for (var i = 0; i < zones.Length; i++)
            {
                if (zones[i].Id == Settings.TimeZoneInfo?.Id)
                {
                    zones[i] = Settings.TimeZoneInfo;
                }
            }

            TimeZones = zones;

            var customStore = _settingsStoreSource.GetCustomSettingsStore();
            ServerSettings = dbServers.Select(x => new
            {
                ServerSettings =
                    customStore.Load<ServerSettings>(x.Id.ToString()) ?? new ServerSettings()
                    {
                        IdleTimeInMins = 0,
                        KickIdlePlayers = false,
                        IdleKickReason = "Lobby Idle",
                        ServerId = x.Id
                    },
                ServerName = x.Name
            })
                .Select(x => new ServerSettingsVM()
                {
                    ServerId = x.ServerSettings.ServerId,
                    IdleTimeInMins = x.ServerSettings.IdleTimeInMins,
                    ServerName = x.ServerName,
                    IdleKickReason = x.ServerSettings.IdleKickReason,
                    KickIdlePlayers = x.ServerSettings.KickIdlePlayers
                })
                .ToList();


            RaisePropertyChanged(nameof(Servers));
            RaisePropertyChanged(nameof(BanReasons));
            RaisePropertyChanged(nameof(KickReasons));
            RaisePropertyChanged(nameof(BanTimes));
            RaisePropertyChanged(nameof(BadNicknames));
            RaisePropertyChanged(nameof(ImportantWords));
            RaisePropertyChanged(nameof(TimeZones));
            RaisePropertyChanged(nameof(ServerSettings));
        }

        public List<ServerInfoModel> Servers { get; set; }

        public class ReasonEdit
        {
            public string Text { get; set; }
        }

        public class BanTimeEdit
        {
            public string Text { get; set; }
            public int Minutes { get; set; }
        }

        public List<ReasonEdit> BanReasons { get; set; }
        public List<ReasonEdit> KickReasons { get; set; }
        public List<BanTimeEdit> BanTimes { get; set; }

        public List<ReasonEdit> BadNicknames { get; set; }
        public List<ReasonEdit> ImportantWords { get; set; }


        public ISettingsStore Settings
        {
            get
            {
                return _settingsStore ?? (_settingsStore = _settingsStoreSource.GetSettingsStore().Clone() as ISettingsStore);
            }
            set { _settingsStore = value; }
        }

        public IList<Type> NewListItemTypes => new List<Type> { typeof(ServerInfoModel) };


        public string BanMessageTemplateExample => $"{_messageHelper.GetBanMessage(Settings, "Sample reason", 0)}\n{_messageHelper.GetBanMessage(Settings, "Sample reason", 10)}";


        public string BanMessageTemplate
        {
            get { return Settings.BanMessageTemplate; }
            set
            {
                Settings.BanMessageTemplate = value;
                RaisePropertyChanged(nameof(BanMessageTemplate));
                RaisePropertyChanged(nameof(BanMessageTemplateExample));
            }
        }


        public string KickMessageTemplateExample => _messageHelper.GetKickMessage(Settings, "Sample reason");


        public string KickMessageTemplate
        {
            get { return Settings.KickMessageTemplate; }
            set
            {
                Settings.KickMessageTemplate = value;
                RaisePropertyChanged(nameof(KickMessageTemplate));
                RaisePropertyChanged(nameof(KickMessageTemplateExample));
            }
        }


        // ReSharper disable once UnusedAutoPropertyAccessor.Global
        public IEnumerable<TimeZoneInfo> TimeZones { get; set; }

        public List<ServerSettingsVM> ServerSettings { get; set; }

        public async Task Save()
        {
            try
            {
                var customStore = _settingsStoreSource.GetCustomSettingsStore();

                foreach (var serverSetting in ServerSettings)
                {
                    customStore.Save(serverSetting.ServerId.ToString(), new ServerSettings()
                    {
                        ServerId = serverSetting.ServerId,
                        IdleTimeInMins = serverSetting.IdleTimeInMins,
                        IdleKickReason = serverSetting.IdleKickReason,
                        KickIdlePlayers = serverSetting.KickIdlePlayers
                    });
                }

                var settings = _settingsStoreSource.GetSettingsStore();
                settings.TimeZoneInfo = Settings.TimeZoneInfo;

                settings.AdminName = Settings.AdminName.Replace(" ", string.Empty);

                settings.BanMessageTemplate = Settings.BanMessageTemplate;
                settings.KickMessageTemplate = Settings.KickMessageTemplate;


                settings.BansUpdateSeconds = Settings.BansUpdateSeconds;
                settings.PlayersUpdateSeconds = Settings.PlayersUpdateSeconds;

                settings.TopMost = Settings.TopMost;

                settings.Save();


                var all = await _infoRepository.GetServerInfoAsync();

                var todelete = all.Where(x => Servers.All(s => s.GetDbModel().Id != x.Id));

                foreach (var serverInfo in todelete)
                {
                    await _infoRepository.RemoveAsync(serverInfo.Id);
                }

                foreach (var s in Servers)
                {
                    var m = s.GetDbModel();
                    if (m.Id == Guid.Empty)
                    {
                        m.Id = Guid.NewGuid();
                    }
                    await _infoRepository.AddOrUpdateAsync(m);
                }


                using (var dc = new ReasonRepository())
                {
                    await dc.UpdateBanReasons(BanReasons.Select(x => x.Text).Where(x => string.IsNullOrEmpty(x) == false).Distinct().ToArray());
                    await dc.UpdateBanTimes(BanTimes.Where(x => string.IsNullOrEmpty(x.Text) == false).Select(x => new BanTime { TimeInMinutes = x.Minutes, Title = x.Text }).ToArray());
                    await dc.UpdateKickReasons(KickReasons.Select(x => x.Text).Where(x => string.IsNullOrEmpty(x) == false).Distinct().ToArray());


                    await dc.UpdateBadNicknames(BadNicknames.Select(x => x.Text).Where(x => string.IsNullOrEmpty(x) == false).Distinct().ToArray());
                    await dc.UpdateImportantWords(ImportantWords.Select(x => x.Text).Where(x => string.IsNullOrEmpty(x) == false).Distinct().ToArray());
                }

                _eventAggregator.GetEvent<BEServersChangedEvent>().Publish(null);
                _eventAggregator.GetEvent<SettingsChangedEvent>().Publish(_settingsStoreSource.GetSettingsStore());


                foreach (Window wnd in Application.Current.Windows) wnd.Topmost = settings.TopMost;
            }
            catch (Exception e)
            {
                _log.Error(e);
                MessageBox.Show(e.Message, "Error", MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }
    }

    public class ServerSettingsVM : ServerSettings
    {
        public string ServerName { get; set; }
    }

    public class ServerInfoModel
    {
        private readonly ServerInfoDto _info;

        public ServerInfoModel(ServerInfoDto info)
        {
            _info = info;

            if (_info != null)
            {
                Host = _info.Host;
                Port = _info.Port;
                SteamPort = _info.SteamPort;
                Password = _info.Password;
                Name = _info.Name;
            }
        }

        public ServerInfoModel()
        {
            var model = new ServerInfoDto();
            model.Id = Guid.Empty;
            _info = model;
        }

        //[Required]
        public string Host
        {
            get { return _info.Host; }
            set { _info.Host = value; }
        }

        //[Required]
        public int Port
        {
            get { return _info.Port; }
            set { _info.Port = value; }
        }

        public int SteamPort
        {
            get { return _info.SteamPort; }
            set { _info.SteamPort = value; }
        }

        //[Required]
        public string Password
        {
            get { return _info.Password; }
            set { _info.Password = value; }
        }

        //[Required]
        public string Name
        {
            get { return _info.Name; }
            set { _info.Name = value; }
        }

        public ServerInfoDto GetDbModel()
        {
            return _info;
        }

        public override string ToString()
        {
            return Name;
        }
    }
}
```

`src/Arma3BE.Client.Modules.OptionsModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.PlayersModule/Arma3BE.Client.Modules.PlayersModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{CD6C99BE-B22B-4B78-AE37-A7561E1FF837}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.PlayersModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.PlayersModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Boxes\PlayerViewWindow.xaml.cs">
      <DependentUpon>PlayerViewWindow.xaml</DependentUpon>
    </Compile>
    <Compile Include="Grids\PlayersControl.xaml.cs">
      <DependentUpon>PlayersControl.xaml</DependentUpon>
    </Compile>
    <Compile Include="Models\PlayerView.cs" />
    <Compile Include="Models\PlayerViewModel.cs" />
    <Compile Include="PlayerService.cs" />
    <Compile Include="PlayersModuleInit.cs" />
    <Compile Include="ViewModel\PlayerListModelView.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Page Include="Boxes\PlayerViewWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Grids\PlayersControl.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.PlayersModule/Boxes/PlayerViewWindow.xaml`:

```xaml
<windows:WindowBase x:Class="Arma3BE.Client.Modules.PlayersModule.Boxes.PlayerViewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
        xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
        xmlns:windows="clr-namespace:Arma3BE.Client.Infrastructure.Windows;assembly=Arma3BE.Client.Infrastructure"
        Title="{Binding Path=Player.Name, StringFormat=Player info: {0}}"
        WindowStyle="ToolWindow" Width="700" SizeToContent="Height" MinHeight="500" MaxHeight="550"
        WindowStartupLocation="CenterScreen">

    <!-- ReSharper disable InconsistentNaming -->
    <Window.Resources>
        
        <converters:UtcToLocalDateTimeConverter x:Uid="local:"
                                              x:Key="utcToLocalDateTimeConverter" />
        
    </Window.Resources>
    <Grid>
        <TabControl Margin="5">
            <TabItem Header="Common">

                <Grid>

                    <Grid.Resources>
                        <Style TargetType="TextBlock">
                            <Setter Value="5" Property="Margin" />
                        </Style>
                    </Grid.Resources>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>


                    <TextBlock Text="Guid" Grid.Row="0" Grid.Column="0" />
                    <TextBlock Text="Steam Id" VerticalAlignment="Center" Grid.Row="1" Grid.Column="0" />
                    <TextBlock Text="Name" Grid.Row="2" Grid.Column="0" />
                    <TextBlock Text="Last IP" Grid.Row="3" Grid.Column="0" />



                    <TextBlock Text="Actions" Grid.Row="4" Grid.Column="0" />
                    <Button CommandParameter="{Binding Path=Player.GUID}" Content="Ban" Command="{Binding BanCommand}" Grid.Row="4" Grid.Column="1" HorizontalAlignment="Left"></Button>
                    



                    <TextBlock Text="IP Info" Grid.Row="5" Grid.Column="0" />
                    <TextBlock Text="Last seen" Grid.Row="6" Grid.Column="0" />
                    <TextBlock Text="Comment" Grid.Row="7" Grid.Column="0" />

                    <TextBlock Text="{Binding Path=Player.GUID}" Grid.Row="0" Grid.Column="1" />

                    <StackPanel   Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                        <TextBox IsReadOnly="True" Text="{Binding Path=Player.SteamId}"></TextBox>
                        <TextBlock>
                        <Hyperlink Command="{Binding GoToSteamCommand}">
                            (link)
                        </Hyperlink>    
                    </TextBlock>
                    </StackPanel>

                    
                    
                    <TextBlock Text="{Binding Path=Player.Name}" Grid.Row="2" Grid.Column="1" />
                    <TextBlock Text="{Binding Path=Player.LastIp}" Grid.Row="3" Grid.Column="1" />
                    <TextBlock Text="{Binding Path=PlayerIPInfo}" Grid.Row="5" Grid.Column="1" />
                    <TextBlock Text="{Binding Path=Player.LastSeen, Converter={StaticResource utcToLocalDateTimeConverter}, StringFormat=\{0:dd.MM.yy HH:mm:ss\}}" Grid.Row="6"
                               Grid.Column="1" />

                    <StackPanel Orientation="Horizontal" Grid.Row="7" Grid.Column="1">
                        <TextBox Text="{Binding Path=Player.Comment, Mode=TwoWay}" MinLines="3" Width="300"
                                 TextWrapping="Wrap" AcceptsReturn="True" />
                        <Button Content="Save" Command="{Binding SaveComment}" />
                    </StackPanel>
                </Grid>


            </TabItem>
            <TabItem Header="Bans">

                <xcdg:DataGridControl Grid.Row="1" ItemsSource="{Binding Path=Player.Bans, Mode=OneWay}" Name="dgBans"
                                      AutoCreateColumns="False" ReadOnly="True">

                    <xcdg:DataGridControl.View>
                        <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                            <xcdg:TableView.FixedHeaders>
                                <DataTemplate>
                                    <xcdg:ColumnManagerRow />
                                </DataTemplate>
                            </xcdg:TableView.FixedHeaders>
                        </xcdg:TableflowView>
                    </xcdg:DataGridControl.View>
                    <xcdg:DataGridControl.Columns>


                        <xcdg:Column FieldName="ServerInfo" AllowGroup="False" Title="Server">
                            <xcdg:Column.CellContentTemplate>
                                <DataTemplate>
                                    <!-- ReSharper disable Xaml.BindingWithContextNotResolved -->
                                    <TextBlock Text="{Binding Name}" />
                                    <!-- ReSharper restore Xaml.BindingWithContextNotResolved -->
                                </DataTemplate>
                            </xcdg:Column.CellContentTemplate>
                        </xcdg:Column>


                        <xcdg:Column FieldName="MinutesLeft" AllowGroup="False" Title="Minutes left" />

                        <xcdg:Column FieldName="Reason" AllowGroup="False" Title="Reason" />

                        <xcdg:Column FieldName="IsActive" AllowGroup="False" Title="Active">
                            <xcdg:Column.CellContentTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding .}" />
                                </DataTemplate>
                            </xcdg:Column.CellContentTemplate>
                        </xcdg:Column>

                    </xcdg:DataGridControl.Columns>
                </xcdg:DataGridControl>


            </TabItem>
            <TabItem Header="Seen on">


                <xcdg:DataGridControl Grid.Row="1" ItemsSource="{Binding Path=Player.PlayerHistory, Mode=OneWay}"
                                      Name="dgHist" AutoCreateColumns="False" ReadOnly="True">


                    <xcdg:DataGridControl.View>
                        <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                            <xcdg:TableView.FixedHeaders>
                                <DataTemplate>
                                    <xcdg:ColumnManagerRow />
                                </DataTemplate>
                            </xcdg:TableView.FixedHeaders>
                        </xcdg:TableflowView>
                    </xcdg:DataGridControl.View>
                    <xcdg:DataGridControl.Columns>


                        <xcdg:Column FieldName="Date" AllowGroup="False" Title="Date">
                            <xcdg:Column.CellContentTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ., Converter={StaticResource utcToLocalDateTimeConverter}, StringFormat=\{0:dd.MM.yy HH:mm:ss\}}" />
                                </DataTemplate>
                            </xcdg:Column.CellContentTemplate>
                        </xcdg:Column>


                        <xcdg:Column FieldName="Name" AllowGroup="False" Title="Name" />

                        <xcdg:Column FieldName="IP" AllowGroup="False" Title="IP" />

                    </xcdg:DataGridControl.Columns>
                </xcdg:DataGridControl>


            </TabItem>
            <TabItem Header="Notes">


                <xcdg:DataGridControl Grid.Row="1" ItemsSource="{Binding Path=Player.Notes, Mode=OneWay}"
                                      Name="dgNotes" AutoCreateColumns="False" ReadOnly="True">


                    <xcdg:DataGridControl.View>
                        <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                            <xcdg:TableView.FixedHeaders>
                                <DataTemplate>
                                    <xcdg:ColumnManagerRow />
                                </DataTemplate>
                            </xcdg:TableView.FixedHeaders>
                        </xcdg:TableflowView>
                    </xcdg:DataGridControl.View>
                    <xcdg:DataGridControl.Columns>


                        <xcdg:Column FieldName="Date" AllowGroup="False" Title="Date">
                            <xcdg:Column.CellContentTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ., Converter={StaticResource utcToLocalDateTimeConverter}, StringFormat=\{0:dd.MM.yy HH:mm:ss\}}" />
                                </DataTemplate>
                            </xcdg:Column.CellContentTemplate>
                        </xcdg:Column>


                        <xcdg:Column FieldName="Text" AllowGroup="False" Title="Note" />
                    </xcdg:DataGridControl.Columns>
                </xcdg:DataGridControl>


            </TabItem>
        </TabControl>
    </Grid>
    <!-- ReSharper restore InconsistentNaming -->
</windows:WindowBase>
```

`src/Arma3BE.Client.Modules.PlayersModule/Boxes/PlayerViewWindow.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Modules.PlayersModule.Models;
using Arma3BEClient.Libs.ModelCompact;
using System.Windows;
using Arma3BE.Client.Infrastructure.Windows;
using Arma3BEClient.Libs.Tools;

namespace Arma3BE.Client.Modules.PlayersModule.Boxes
{
    /// <summary>
    ///     Interaction logic for PlayerViewWindow.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class PlayerViewWindow : WindowBase
    {
        public PlayerViewWindow(PlayerViewModel model, ISettingsStoreSource settingsStoreSource):base(settingsStoreSource)
        {
            InitializeComponent();

            dgBans.ContextMenu = dgBans.Generate<Ban>();
            dgHist.ContextMenu = dgHist.Generate<PlayerHistory>();
            dgNotes.ContextMenu = dgNotes.Generate<Note>();

            DataContext = model;
        }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/Grids/PlayersControl.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.PlayersModule.Grids.PlayersControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d"
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <ToolBar Height="30">
            <Button Command="{Binding RefreshCommand, Mode=OneWay}">
                <!-- ReSharper disable Xaml.StaticResourceNotResolved -->
                <Image Source="{StaticResource refresh_icon}" Height="16" Width="16" />
                <!-- ReSharper restore Xaml.StaticResourceNotResolved -->
            </Button>
            <Separator />
            <TextBox Margin="2" Text="{Binding Filter, Mode=TwoWay}" Height="20" MinWidth="150" />
            <Button Content="Search" Margin="2" Command="{Binding RefreshCommand, Mode=OneWay}" />
            <Separator />
            <TextBlock Margin="2" HorizontalAlignment="Right" VerticalAlignment="Center"
                       Text="{Binding PlayerCount, Mode=OneWay, StringFormat=Total: {0}}" />

            <xctk:DropDownButton Content="Search options">
                <xctk:DropDownButton.DropDownContent>
                    <xctk:CheckListBox ItemsSource="{Binding SearchOptions}" SelectedValue="{Binding SelectedOptions}" />
                </xctk:DropDownButton.DropDownContent>
            </xctk:DropDownButton>
        </ToolBar>

        <xctk:BusyIndicator Grid.Row="1" IsBusy="{Binding IsBusy}" BusyContent="Please, wait...">

            <xcdg:DataGridControl Name="dg"  ItemsSource="{Binding Players,  Mode=OneWay}" MouseDoubleClick="Dg_OnMouseDoubleClick"
                              AutoCreateColumns="False" ReadOnly="True" SelectedItem="{Binding SelectedPlayer, Mode=TwoWay}">
                <xcdg:DataGridControl.ContextMenu>
                    <ContextMenu>

                        <MenuItem Header="Ban" Command="{Binding BanCommand}" />

                        <MenuItem Header="Player Info" Command="{Binding PlayerInfoCommand}" />

                    </ContextMenu>
                </xcdg:DataGridControl.ContextMenu>

                <xcdg:DataGridControl.View>
                    <xcdg:TableflowView FixedColumnCount="0" UseDefaultHeadersFooters="False" ContainerHeight="20">
                        <xcdg:TableView.FixedHeaders>
                            <DataTemplate>
                                <xcdg:ColumnManagerRow />
                            </DataTemplate>
                        </xcdg:TableView.FixedHeaders>
                    </xcdg:TableflowView>
                </xcdg:DataGridControl.View>
            </xcdg:DataGridControl>
        </xctk:BusyIndicator>
    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.PlayersModule/Grids/PlayersControl.xaml.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Modules.PlayersModule.Models;
using Prism.Events;
using Prism.Regions;
using System.Linq;
using System.Windows.Controls;
using System.Windows.Input;

namespace Arma3BE.Client.Modules.PlayersModule.Grids
{
    /// <summary>
    ///     Interaction logic for PlayersControl.xaml
    /// </summary>
    [ViewSortHint("0400")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class PlayersControl : UserControl
    {
        private readonly IEventAggregator _eventAggregator;

        public PlayersControl(IEventAggregator eventAggregator)
        {
            _eventAggregator = eventAggregator;
            InitializeComponent();

            dg.LoadState<PlayerView>(GetType().FullName);

            var menu = dg.Generate<PlayerView>();

            foreach (var menuItem in menu.Items.OfType<MenuItem>().ToList())
            {
                menu.Items.Remove(menuItem);
                dg.ContextMenu?.Items.Add(menuItem);
            }
        }

        private void Dg_OnMouseDoubleClick(object sender, MouseButtonEventArgs e)
        {
            var player = dg.SelectedItem as PlayerView;
            if (player != null)
            {
                _eventAggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(player.Guid));
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/Models/PlayerView.cs`:

```cs
using Arma3BEClient.Common.Attributes;
using System;
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BE.Client.Modules.PlayersModule.Models
{
    public class PlayerView
    {
        public Guid Id { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Name { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Comment { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string Guid { get; set; }

        [ShowInUi]
        [EnableCopy]
        public DateTime LastSeen { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string LastIp { get; set; }

        [ShowInUi]
        [EnableCopy]
        public string SteamId { get; set; }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/Models/PlayerViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Libs.Repositories.Players;
using Prism.Commands;
using Prism.Events;
using System;
using System.Diagnostics;
using System.Diagnostics.CodeAnalysis;
using System.Threading.Tasks;
using System.Windows.Input;

// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable UnusedAutoPropertyAccessor.Global


namespace Arma3BE.Client.Modules.PlayersModule.Models
{
    public class PlayerViewModel : ViewModelBase
    {
        private readonly string _userGuid;
        private readonly IIpService _ipService;
        private readonly IPlayerRepository _playerRepository;
        private readonly IEventAggregator _eventAggregator;

        public PlayerViewModel(string userGuid, IIpService ipService, IPlayerRepository playerRepository, IEventAggregator eventAggregator)
        {
            _userGuid = userGuid;
            _ipService = ipService;
            _playerRepository = playerRepository;
            _eventAggregator = eventAggregator;

            SaveComment = new ActionCommand(SaveUserComment);
            GoToSteamCommand = new ActionCommand(GoToSteam);
            BanCommand = new DelegateCommand<string>(BanPlayerView);
        }


        public async Task Init()
        {
            await SetupPlayerAsync();
            SetupPlayerIPInfoAsync();
        }

        private async Task SetupPlayerAsync()
        {
            Player = await _playerRepository.GetPlayerInfoAsync(_userGuid);
            RaisePropertyChanged(nameof(Player));
        }

        private async Task SetupPlayerIPInfoAsync()
        {
            PlayerIPInfo = await _ipService.Get(Player.LastIp);
            RaisePropertyChanged(nameof(PlayerIPInfo));
        }


        private void BanPlayerView(string obj)
        {
            _eventAggregator.GetEvent<BanUserEvent>()
                .Publish(new BanUserModel(null, obj, false, null, null));
        }

        private void GoToSteam()
        {
            var id = Player?.SteamId;
            if (string.IsNullOrEmpty(id) == false)
            {
                var suri = $"http://steamcommunity.com/profiles/{id}/";
                Process.Start(new ProcessStartInfo(new Uri(suri).AbsoluteUri));
            }
        }

        public Player Player { get; set; }

        [SuppressMessage("ReSharper", "UnusedMember.Global")]
        public string PlayerIPInfo { get; private set; }

        public ICommand SaveComment { get; set; }
        public ICommand GoToSteamCommand { get; set; }

        public ICommand BanCommand { get; set; }

        private async void SaveUserComment()
        {
            await _playerRepository.UpdatePlayerCommentAsync(Player.GUID, Player.Comment);
            await SetupPlayerAsync();
        }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/PlayerService.cs`:

```cs
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Modules.PlayersModule.Boxes;
using Arma3BE.Client.Modules.PlayersModule.Models;
using Microsoft.Practices.Unity;
using Prism.Events;
using System.Threading.Tasks;

namespace Arma3BE.Client.Modules.PlayersModule
{
    public class PlayerService
    {
        private readonly IUnityContainer _container;

        public PlayerService(IUnityContainer container)
        {
            _container = container;

            var eventAggregator = _container.Resolve<IEventAggregator>();

            eventAggregator.GetEvent<ShowUserInfoEvent>().Subscribe(async model =>
            {
                await ShowDialogAsync(model.UserGuid);
            });
        }

        private async Task ShowDialogAsync(string userGuid)
        {
            var model = _container.Resolve<PlayerViewModel>(new ParameterOverride("userGuid", userGuid));
            await model.Init();
            if (model.Player != null)
            {
                var window = _container.Resolve<PlayerViewWindow>(new ParameterOverride("model", model));
                window.Show();
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/PlayersModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Modules.PlayersModule.Grids;
using Arma3BE.Client.Modules.PlayersModule.ViewModel;
using Microsoft.Practices.Unity;
using Prism.Commands;
using Prism.Modularity;
using Prism.Regions;
using System.Linq;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.PlayersModule
{
    public class PlayersModuleInit : IModule
    {
        private static IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public PlayersModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _container.RegisterInstance(new PlayerService(_container));
            _regionManager.RegisterViewWithRegion(RegionNames.MenuToolsRegion, CreateView);
        }

        private object CreateView()
        {
            return new MenuItem()
            {
                Command = new DelegateCommand(() =>
                {
                    var vm = _container.Resolve<PlayerListModelView>();
                    var view = _container.Resolve<PlayersControl>();
                    view.DataContext = vm;
                    _regionManager.Regions[RegionNames.ServerTabRegion].Add(view, null, true);
                },
                    () =>
                        _regionManager.Regions[RegionNames.ServerTabRegion].Views.OfType<PlayersControl>().Any() ==
                        false),
                Header = PlayerListModelView.StaticTitle
            };
        }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/ViewModel/PlayerListModelView.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Events;
using Arma3BE.Client.Infrastructure.Events.Models;
using Arma3BE.Client.Infrastructure.Extensions;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.PlayersModule.Models;
using Arma3BEClient.Libs.Repositories.Players;
using Prism.Commands;
using Prism.Events;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Input;

// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable UnusedMember.Global

namespace Arma3BE.Client.Modules.PlayersModule.ViewModel
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class PlayerListModelView : ViewModelBase, ITitledItem
    {
        private readonly IEventAggregator _eventAggregator;
        private readonly IPlayerRepository _playerRepository;
        private int _playerCount;
        private ICommand _refreshCommand;
        private bool _isBusy = false;

        public PlayerListModelView(IEventAggregator eventAggregator, IPlayerRepository playerRepository)
        {
            _eventAggregator = eventAggregator;
            _playerRepository = playerRepository;
            SelectedOptions = "Name,IP,Guid,Comment";

            BanCommand = new ActionCommand(ShowBan);
            PlayerInfoCommand = new DelegateCommand(PlayerInfoDialog, CanShowDialog);
        }

        public PlayerView SelectedPlayer { get; set; }

        public ICommand BanCommand { get; set; }
        public ICommand PlayerInfoCommand { get; set; }

        public bool IsBusy
        {
            get { return _isBusy; }
            set { SetProperty(ref _isBusy, value); }
        }


        public string Filter { get; set; }

        public int PlayerCount
        {
            get { return _playerCount; }
            set
            {
                _playerCount = value;
                RaisePropertyChanged();
            }
        }

        public ICommand RefreshCommand => _refreshCommand ?? (_refreshCommand = new ActionCommand(async () => await Refresh()));

        public List<PlayerView> Players { get; private set; } = new List<PlayerView>();

        public string SelectedOptions { get; set; }

        public IEnumerable<string> SearchOptions => new[]
        {
            "Name",
            "Last Names",
            "IP",
            "Guid",
            "Notes",
            "Comment",
            nameof(PlayerView.SteamId)
        };

        public static string StaticTitle = "Players";
        public string Title => StaticTitle;

        private void ShowBan()
        {
            var local = SelectedPlayer;
            if (local != null)
                _eventAggregator.GetEvent<BanUserEvent>()
                    .Publish(new BanUserModel(null, local.Guid, false, local.Name, null));
        }

        private bool CanShowDialog()
        {
            return SelectedPlayer != null;
        }

        private void PlayerInfoDialog()
        {
            var local = SelectedPlayer;
            if (local != null)
                _eventAggregator.GetEvent<ShowUserInfoEvent>().Publish(new ShowUserModel(local.Guid));
        }

        public async Task Refresh()
        {
            IsBusy = true;

            var opts = SelectedOptions.Split(',');

            var searchName = opts.Contains(nameof(PlayerView.Name));
            var searchLastNames = opts.Contains("Last Names");
            var searchIP = opts.Contains("IP");
            var searchGuid = opts.Contains("Guid");
            var searchNotes = opts.Contains("Notes");
            var searchComment = opts.Contains(nameof(PlayerView.Comment));
            var searchSteamId = opts.Contains(nameof(PlayerView.SteamId));

            IEnumerable<PlayerDto> result;

            if (!string.IsNullOrEmpty(Filter))
                result = await _playerRepository.GetPlayersAsync(x =>
                    (searchGuid && (x.GUID == Filter))
                    ||
                    (searchComment && x.Comment.Contains(Filter))
                    ||
                    (searchName && x.Name.Contains(Filter))
                    ||
                    (searchNotes && x.Notes.Any(y => y.Text.Contains(Filter)))
                    ||
                    (searchIP && x.LastIp.Contains(Filter))
                    ||
                    (searchSteamId && x.SteamId.Contains(Filter))
                    ||
                    (searchLastNames && x.PlayerHistory.Any(y => y.Name.Contains(Filter))));
            else
                result = await _playerRepository.GetAllPlayersAsync();

            var r = result.Select(x => new PlayerView
            {
                Id = x.Id,
                Comment = x.Comment,
                Guid = x.GUID,
                Name = x.Name,
                LastIp = x.LastIp,
                LastSeen = x.LastSeen,
                SteamId = x.SteamId
            }).OrderBy(x => x.Name).ToList();

            foreach (var playerView in r)
            {
                playerView.LastSeen = playerView.LastSeen.UtcToLocalFromSettings();
            }

            PlayerCount = r.Count;

            Players = r;


            RaisePropertyChanged(nameof(Players));

            IsBusy = false;
        }
    }
}
```

`src/Arma3BE.Client.Modules.PlayersModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.SteamModule/Arma3BE.Client.Modules.SteamModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{6CE098A8-DFF1-4C66-AD16-909903945E2B}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.SteamModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.SteamModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xaml" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
    <Reference Include="Xceed.Wpf.AvalonDock, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Aero.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.Metro, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.Metro.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.AvalonDock.Themes.VS2010, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.AvalonDock.Themes.VS2010.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.DataGrid, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.DataGrid.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Xceed.Wpf.Toolkit, Version=3.0.0.0, Culture=neutral, PublicKeyToken=3e4669d2f30244f4, processorArchitecture=MSIL">
      <HintPath>..\packages\Extended.Wpf.Toolkit.3.0\lib\net40\Xceed.Wpf.Toolkit.dll</HintPath>
      <Private>True</Private>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Core\IdByHashSearcher.cs" />
    <Compile Include="Core\IMd5Provider.cs" />
    <Compile Include="Core\OptimizedHashProvider.cs" />
    <Compile Include="Core\StandardHashProvider.cs" />
    <Compile Include="Core\SteamService.cs" />
    <Compile Include="Core\Uint32ToTiont32AllHashesFileGenerator.cs" />
    <Compile Include="Core\FileReaderWriterFactory.cs" />
    <Compile Include="Grids\SteamDiscovery.xaml.cs">
      <DependentUpon>SteamDiscovery.xaml</DependentUpon>
    </Compile>
    <Compile Include="Grids\SteamQuery.xaml.cs">
      <DependentUpon>SteamQuery.xaml</DependentUpon>
    </Compile>
    <Compile Include="Grids\SteamService.xaml.cs">
      <DependentUpon>SteamService.xaml</DependentUpon>
    </Compile>
    <Compile Include="Models\ServerMonitorSteamQueryViewModel.cs" />
    <Compile Include="Models\SteamDiscoveryViewModel.cs" />
    <Compile Include="Models\SteamServiceViewModel.cs" />
    <Compile Include="SteamModuleInit.cs" />
  </ItemGroup>
  <ItemGroup />
  <ItemGroup>
    <Page Include="Grids\SteamDiscovery.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Grids\SteamQuery.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Grids\SteamService.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{E5240A50-E944-4F50-A353-2E3C9E547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Steam\Arma3BE.Steam.csproj">
      <Project>{b2948bd4-b413-4e9d-b9ed-41261b0c56da}</Project>
      <Name>Arma3BE.Steam</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.SteamModule/Core/FileReaderWriterFactory.cs`:

```cs
using System.IO;

namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public static class FileReaderWriterFactory
    {
        private const int BufferLen = 100 * 1024 * 1024;

        public static BufferedStream Buffered(this Stream source, int bufferLen = BufferLen)
        {
            return new BufferedStream(source, bufferLen);
        }

        public static BinaryWriter ToBinaryWriter(this Stream stream)
        {
            return new BinaryWriter(stream);
        }

        public static BinaryReader ToBinaryReader(this Stream stream)
        {
            return new BinaryReader(stream);
        }

        public static FileStream CreateReader(this string src)
        {
            return File.OpenRead(src);
        }

        public static FileStream CreateWriter(this string src)
        {
            return File.OpenWrite(src);
        }
    }
}

```

`src/Arma3BE.Client.Modules.SteamModule/Core/IMd5Provider.cs`:

```cs
namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public interface IMd5Provider
    {
        uint ComputeUIntHash(uint input);
        byte[] ComputeByteHash(uint input);
        byte[] ComputeByteHash(long input);
    }


    public interface IMd5ProviderFactory
    {
        IMd5Provider Create();
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Core/IdByHashSearcher.cs`:

```cs
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading;

namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public class IdByHashSearcher
    {
        private readonly string _idsFile;
        private readonly IMd5Provider _md5Provider;
        private readonly ILog _log;
        private readonly Lazy<uint[]> _cache;

        public IdByHashSearcher(string idsFile, string indexFile, IMd5Provider md5Provider, ILog log)
        {
            _idsFile = idsFile;
            _md5Provider = md5Provider;
            _log = log;

            _cache = new Lazy<uint[]>(() =>
            {
                using (_log.Time("Creating cache"))
                {
                    return GetCache(indexFile);
                }
            });
        }

        // 70473 - 6:13 vs 1:15
        public Dictionary<string, long> Search(string[] ids, CancellationToken token)
        {
            var filteredIds = ids.Where(x => x.IsGuid()).Distinct().ToArray();

            var idsHash = new HashSet<string>(filteredIds);
            var result = new Dictionary<string, long>();

            _log.Info($"Given ids:{ids.Length}, Filtered ids:{filteredIds.Length}, Not correct ids:{ids.Length - filteredIds.Length}");

            using (_log.Time($"Searching for {filteredIds.Length} ids"))
            {
                using (var sr = _idsFile.CreateReader().Buffered(4 * 400).ToBinaryReader())
                {
                    foreach (var id in filteredIds)
                    {
                        Search(id, _cache.Value, sr, idsHash, result);
                        if (!idsHash.Any()) break;
                        if (token.IsCancellationRequested) return result;
                    }
                }
                _log.Info($"Found {result.Count} ids");
            }

            return result;
        }

        long lmin = 0x0110000100000000;
        private void Search(string shash, uint[] cache, BinaryReader reader, HashSet<string> idsHashSet, Dictionary<string, long> result)
        {
            var hash = FromString(shash);
            var ind = hash[0] * 256 * 256 + hash[1] * 256 + hash[2];
            var startLine = cache[ind];
            var endLine = uint.MaxValue;
            if (ind < cache.Length - 1)
                endLine = cache[ind + 1];

            reader.BaseStream.Position = startLine * 4L;

            for (var i = startLine; i < endLine; i++)
            {
                var id = reader.ReadUInt32();
                var ui = id + lmin;
                var midhash = _md5Provider.ComputeByteHash(id);

                var str = ToString(midhash);

                if (idsHashSet.Contains(str))
                {
                    result.Add(str, ui);
                    idsHashSet.Remove(str);
                }
            }
        }

        private static byte[] FromString(String hex)
        {
            var numberChars = hex.Length;
            var bytes = new byte[numberChars / 2];
            for (var i = 0; i < numberChars; i += 2)
                bytes[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
            return bytes;
        }

        private static string ToString(byte[] hash)
        {
            var result = "";
            foreach (var b in hash)
                result += b.ToString("x2");

            return result;
        }

        private static uint[] GetCache(string indexFile)
        {
            var cache = new uint[256 * 256 * 256];

            using (var reader = indexFile.CreateReader().Buffered(10 * 1024 * 1024).ToBinaryReader())
            {
                for (var i = 0; i < 256 * 256 * 256; i++)
                {
                    cache[i] = reader.ReadUInt32();
                }
            }

            return cache;
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Core/OptimizedHashProvider.cs`:

```cs
using System;

namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public class OptimizedHashProviderFactory : IMd5ProviderFactory
    {
        public IMd5Provider Create()
        {
            return new OptimizedHashProvider();
        }
    }


    public class OptimizedHashProvider : IMd5Provider
    {
        private readonly UInt32[] _buffer = new uint[4];

        public uint ComputeUIntHash(uint input)
        {
            ComputeByteHash(_buffer, input);
            return _buffer[0];
        }

        public byte[] ComputeByteHash(uint input)
        {
            ComputeByteHash(_buffer, input);
            return BitConverter.GetBytes(_buffer[0]);
        }

        long lmin = 0x0110000100000000;
        public byte[] ComputeByteHash(long input)
        {
            var uintInput = (uint)(input - lmin);
            ComputeByteHash(_buffer, uintInput);

            var result = new byte[16];
            for (var i = 0; i < 4; i++)
            {
                var bytes = BitConverter.GetBytes(_buffer[i]);
                for (var j = 0; j < 4; j++)
                {
                    result[i * 4 + j] = bytes[j];
                }
            }
            return result;
        }


        // Taken from https://ru.stackoverflow.com/a/768244/179763

        private readonly UInt32[] _block = { 0, 0, 0x00800110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x50, 0 };
        //              [10]=0x80 [9]=1, [8]=16
        private void ComputeByteHash(UInt32[] state, uint input)
        {
            UInt32 a = state[0] = 0x67452301;
            UInt32 b = state[1] = 0xEFCDAB89;
            UInt32 c = state[2] = 0x98BADCFE;
            UInt32 d = state[3] = 0x10325476;
            UInt32 x;

            _block[0] = 0x4542 | ((input << 16) & 0xFFFF0000);
            _block[1] = 0x00010000 | ((input >> 16) & 0xFFFF);

            x = (a + (d ^ (b & (c ^ d))) + 0xD76AA478 + _block[0]); a = ((x << 7) | (x >> (32 - 7))) + b;
            x = (d + (c ^ (a & (b ^ c))) + 0xE8C7B756 + _block[1]); d = ((x << 12) | (x >> (32 - 12))) + a;
            x = (c + (b ^ (d & (a ^ b))) + 0x242070DB + _block[2]); c = ((x << 17) | (x >> (32 - 17))) + d;
            x = (b + (a ^ (c & (d ^ a))) + 0xC1BDCEEE + _block[3]); b = ((x << 22) | (x >> (32 - 22))) + c;
            x = (a + (d ^ (b & (c ^ d))) + 0xF57C0FAF + _block[4]); a = ((x << 7) | (x >> (32 - 7))) + b;
            x = (d + (c ^ (a & (b ^ c))) + 0x4787C62A + _block[5]); d = ((x << 12) | (x >> (32 - 12))) + a;
            x = (c + (b ^ (d & (a ^ b))) + 0xA8304613 + _block[6]); c = ((x << 17) | (x >> (32 - 17))) + d;
            x = (b + (a ^ (c & (d ^ a))) + 0xFD469501 + _block[7]); b = ((x << 22) | (x >> (32 - 22))) + c;
            x = (a + (d ^ (b & (c ^ d))) + 0x698098D8 + _block[8]); a = ((x << 7) | (x >> (32 - 7))) + b;
            x = (d + (c ^ (a & (b ^ c))) + 0x8B44F7AF + _block[9]); d = ((x << 12) | (x >> (32 - 12))) + a;
            x = (c + (b ^ (d & (a ^ b))) + 0xFFFF5BB1 + _block[10]); c = ((x << 17) | (x >> (32 - 17))) + d;
            x = (b + (a ^ (c & (d ^ a))) + 0x895CD7BE + _block[11]); b = ((x << 22) | (x >> (32 - 22))) + c;
            x = (a + (d ^ (b & (c ^ d))) + 0x6B901122 + _block[12]); a = ((x << 7) | (x >> (32 - 7))) + b;
            x = (d + (c ^ (a & (b ^ c))) + 0xFD987193 + _block[13]); d = ((x << 12) | (x >> (32 - 12))) + a;
            x = (c + (b ^ (d & (a ^ b))) + 0xA679438E + _block[14]); c = ((x << 17) | (x >> (32 - 17))) + d;
            x = (b + (a ^ (c & (d ^ a))) + 0x49B40821 + _block[15]); b = ((x << 22) | (x >> (32 - 22))) + c;
            //Раунд 1
            x = (a + (c ^ (d & (b ^ c))) + 0xF61E2562 + _block[1]); a = ((x << 5) | (x >> (32 - 5))) + b;
            x = (d + (b ^ (c & (a ^ b))) + 0xC040B340 + _block[6]); d = ((x << 9) | (x >> (32 - 9))) + a;
            x = (c + (a ^ (b & (d ^ a))) + 0x265E5A51 + _block[11]); c = ((x << 14) | (x >> (32 - 14))) + d;
            x = (b + (d ^ (a & (c ^ d))) + 0xE9B6C7AA + _block[0]); b = ((x << 20) | (x >> (32 - 20))) + c;
            x = (a + (c ^ (d & (b ^ c))) + 0xD62F105D + _block[5]); a = ((x << 5) | (x >> (32 - 5))) + b;
            x = (d + (b ^ (c & (a ^ b))) + 0x02441453 + _block[10]); d = ((x << 9) | (x >> (32 - 9))) + a;
            x = (c + (a ^ (b & (d ^ a))) + 0xD8A1E681 + _block[15]); c = ((x << 14) | (x >> (32 - 14))) + d;
            x = (b + (d ^ (a & (c ^ d))) + 0xE7D3FBC8 + _block[4]); b = ((x << 20) | (x >> (32 - 20))) + c;
            x = (a + (c ^ (d & (b ^ c))) + 0x21E1CDE6 + _block[9]); a = ((x << 5) | (x >> (32 - 5))) + b;
            x = (d + (b ^ (c & (a ^ b))) + 0xC33707D6 + _block[14]); d = ((x << 9) | (x >> (32 - 9))) + a;
            x = (c + (a ^ (b & (d ^ a))) + 0xF4D50D87 + _block[3]); c = ((x << 14) | (x >> (32 - 14))) + d;
            x = (b + (d ^ (a & (c ^ d))) + 0x455A14ED + _block[8]); b = ((x << 20) | (x >> (32 - 20))) + c;
            x = (a + (c ^ (d & (b ^ c))) + 0xA9E3E905 + _block[13]); a = ((x << 5) | (x >> (32 - 5))) + b;
            x = (d + (b ^ (c & (a ^ b))) + 0xFCEFA3F8 + _block[2]); d = ((x << 9) | (x >> (32 - 9))) + a;
            x = (c + (a ^ (b & (d ^ a))) + 0x676F02D9 + _block[7]); c = ((x << 14) | (x >> (32 - 14))) + d;
            x = (b + (d ^ (a & (c ^ d))) + 0x8D2A4C8A + _block[12]); b = ((x << 20) | (x >> (32 - 20))) + c;
            //Раунд 2
            x = (a + (b ^ c ^ d) + 0xFFFA3942 + _block[5]); a = ((x << 4) | (x >> (32 - 4))) + b;
            x = (d + (a ^ b ^ c) + 0x8771F681 + _block[8]); d = ((x << 11) | (x >> (32 - 11))) + a;
            x = (c + (d ^ a ^ b) + 0x6D9D6122 + _block[11]); c = ((x << 16) | (x >> (32 - 16))) + d;
            x = (b + (c ^ d ^ a) + 0xFDE5380C + _block[14]); b = ((x << 23) | (x >> (32 - 23))) + c;
            x = (a + (b ^ c ^ d) + 0xA4BEEA44 + _block[1]); a = ((x << 4) | (x >> (32 - 4))) + b;
            x = (d + (a ^ b ^ c) + 0x4BDECFA9 + _block[4]); d = ((x << 11) | (x >> (32 - 11))) + a;
            x = (c + (d ^ a ^ b) + 0xF6BB4B60 + _block[7]); c = ((x << 16) | (x >> (32 - 16))) + d;
            x = (b + (c ^ d ^ a) + 0xBEBFBC70 + _block[10]); b = ((x << 23) | (x >> (32 - 23))) + c;
            x = (a + (b ^ c ^ d) + 0x289B7EC6 + _block[13]); a = ((x << 4) | (x >> (32 - 4))) + b;
            x = (d + (a ^ b ^ c) + 0xEAA127FA + _block[0]); d = ((x << 11) | (x >> (32 - 11))) + a;
            x = (c + (d ^ a ^ b) + 0xD4EF3085 + _block[3]); c = ((x << 16) | (x >> (32 - 16))) + d;
            x = (b + (c ^ d ^ a) + 0x04881D05 + _block[6]); b = ((x << 23) | (x >> (32 - 23))) + c;
            x = (a + (b ^ c ^ d) + 0xD9D4D039 + _block[9]); a = ((x << 4) | (x >> (32 - 4))) + b;
            x = (d + (a ^ b ^ c) + 0xE6DB99E5 + _block[12]); d = ((x << 11) | (x >> (32 - 11))) + a;
            x = (c + (d ^ a ^ b) + 0x1FA27CF8 + _block[15]); c = ((x << 16) | (x >> (32 - 16))) + d;
            x = (b + (c ^ d ^ a) + 0xC4AC5665 + _block[2]); b = ((x << 23) | (x >> (32 - 23))) + c;
            //Раунд 3
            x = (a + (c ^ (b | ~d)) + 0xF4292244 + _block[0]); a = ((x << 6) | (x >> (32 - 6))) + b;
            x = (d + (b ^ (a | ~c)) + 0x432AFF97 + _block[7]); d = ((x << 10) | (x >> (32 - 10))) + a;
            x = (c + (a ^ (d | ~b)) + 0xAB9423A7 + _block[14]); c = ((x << 15) | (x >> (32 - 15))) + d;
            x = (b + (d ^ (c | ~a)) + 0xFC93A039 + _block[5]); b = ((x << 21) | (x >> (32 - 21))) + c;
            x = (a + (c ^ (b | ~d)) + 0x655B59C3 + _block[12]); a = ((x << 6) | (x >> (32 - 6))) + b;
            x = (d + (b ^ (a | ~c)) + 0x8F0CCC92 + _block[3]); d = ((x << 10) | (x >> (32 - 10))) + a;
            x = (c + (a ^ (d | ~b)) + 0xFFEFF47D + _block[10]); c = ((x << 15) | (x >> (32 - 15))) + d;
            x = (b + (d ^ (c | ~a)) + 0x85845DD1 + _block[1]); b = ((x << 21) | (x >> (32 - 21))) + c;
            x = (a + (c ^ (b | ~d)) + 0x6FA87E4F + _block[8]); a = ((x << 6) | (x >> (32 - 6))) + b;
            x = (d + (b ^ (a | ~c)) + 0xFE2CE6E0 + _block[15]); d = ((x << 10) | (x >> (32 - 10))) + a;
            x = (c + (a ^ (d | ~b)) + 0xA3014314 + _block[6]); c = ((x << 15) | (x >> (32 - 15))) + d;
            x = (b + (d ^ (c | ~a)) + 0x4E0811A1 + _block[13]); b = ((x << 21) | (x >> (32 - 21))) + c;
            x = (a + (c ^ (b | ~d)) + 0xF7537E82 + _block[4]); a = ((x << 6) | (x >> (32 - 6))) + b;
            x = (d + (b ^ (a | ~c)) + 0xBD3AF235 + _block[11]); d = ((x << 10) | (x >> (32 - 10))) + a;
            x = (c + (a ^ (d | ~b)) + 0x2AD7D2BB + _block[2]); c = ((x << 15) | (x >> (32 - 15))) + d;
            x = (b + (d ^ (c | ~a)) + 0xEB86D391 + _block[9]); b = ((x << 21) | (x >> (32 - 21))) + c;

            state[0] = state[0] + a;
            state[1] = state[1] + b;
            state[2] = state[2] + c;
            state[3] = state[3] + d;

        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Core/StandardHashProvider.cs`:

```cs
using System;
using System.Security.Cryptography;

namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public class StandardHashProvider : IMd5Provider
    {
        private static readonly byte[] Parts = { 0x42, 0x45, 0, 0, 0, 0, 0, 0, 0, 0 };
        private static readonly MD5CryptoServiceProvider Md5 = new MD5CryptoServiceProvider();


        public uint ComputeUIntHash(uint input)
        {
            var hash = ComputeByteHash(input);
            return BitConverter.ToUInt32(hash, 0);
        }

        public byte[] ComputeByteHash(uint input)
        {
            Parts[0] = 0x42;
            Parts[1] = 0x45;

            Parts[2] = (byte)(input << 24 >> 24);
            Parts[3] = (byte)(input << 16 >> 24);
            Parts[4] = (byte)(input << 8 >> 24);
            Parts[5] = (byte)(input << 0 >> 24);

            Parts[6] = 1;
            Parts[7] = 0;
            Parts[8] = 16;
            Parts[9] = 1;

            var hash = Md5.ComputeHash(Parts);
            return hash;
        }

        public byte[] ComputeByteHash(long input)
        {
            Parts[0] = 0x42;
            Parts[1] = 0x45;

            for (var i = 2; i < 10; i++)
            {
                var res = input % 256;
                input = input / 256;
                Parts[i] = (byte)res;
            }

            var hash = Md5.ComputeHash(Parts);
            return hash;
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Core/SteamService.cs`:

```cs
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Tools;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Threading;

namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public class SteamService : ISteamService
    {
        private readonly IdByHashSearcher _idByHashSearcher;
        private readonly object _lock = new object();

        private readonly ConcurrentDictionary<string, string> _failedSearches = new ConcurrentDictionary<string, string>();

        private readonly bool _isReady;

        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        public SteamService(ISettingsStoreSource settingsStoreSource)
        {
            var folder = settingsStoreSource.GetSettingsStore().SteamFolder;

            if (string.IsNullOrEmpty(folder)) return;

            var idsFIleName = Path.Combine(folder, "ids.bin");
            var indexFIleName = Path.Combine(folder, "index.bin");

            _isReady = File.Exists(idsFIleName) && File.Exists(indexFIleName);

            if (_isReady)
            {
                var md5 = new StandardHashProvider();
                _idByHashSearcher = new IdByHashSearcher(idsFIleName, indexFIleName, md5, _log);
            }
        }

        public bool IsReady()
        {
            return _isReady;
        }

        public long? GetSteamId(string hash)
        {
            if (_failedSearches.ContainsKey(hash)) return null;

            if (!_isReady) return null;

            if (_idByHashSearcher == null) return null;

            lock (_lock)
            {
                var source = new CancellationTokenSource();
                var result = _idByHashSearcher.Search(new[] { hash }, source.Token);
                if (result.ContainsKey(hash)) return result[hash];
            }

            _failedSearches.AddOrUpdate(hash, x => hash, (x, y) => hash);
            return null;
        }

        public Dictionary<string, long> GetSteamIds(string[] hashes)
        {
            hashes = hashes.Where(x => !_failedSearches.ContainsKey(x)).ToArray();

            if (!hashes.Any()) return new Dictionary<string, long>();
            if (!_isReady) return new Dictionary<string, long>();

            if (_idByHashSearcher == null) return new Dictionary<string, long>();

            lock (_lock)
            {
                var source = new CancellationTokenSource();
                var result = _idByHashSearcher.Search(hashes, source.Token);

                var notFound = hashes.Where(x => !result.ContainsKey(x));
                foreach (var f in notFound)
                    _failedSearches.AddOrUpdate(f, x => f, (x, y) => f);

                return result;
            }
        }

        public Dictionary<string, long> GetSteamIds(string[] hashes, CancellationToken token)
        {
            hashes = hashes.Where(x => !_failedSearches.ContainsKey(x)).ToArray();

            if (!hashes.Any()) return new Dictionary<string, long>();

            if (!_isReady) return new Dictionary<string, long>();

            if (_idByHashSearcher == null) return new Dictionary<string, long>();

            lock (_lock)
            {
                var result = _idByHashSearcher.Search(hashes, token);

                var notFound = hashes.Where(x => !result.ContainsKey(x));
                foreach (var f in notFound)
                    _failedSearches.AddOrUpdate(f, x => f, (x, y) => f);

                return result;
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Core/Uint32ToTiont32AllHashesFileGenerator.cs`:

```cs
using Arma3BEClient.Common.Extensions;
using Arma3BEClient.Common.Logging;
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading;
using System.Threading.Tasks;

namespace Arma3BE.Client.Modules.SteamModule.Core
{
    public class Uint32ToTiont32AllHashesFileGenerator
    {
        private readonly ILog _log;
        private readonly IMd5ProviderFactory _md5ProviderFactory;

        public Uint32ToTiont32AllHashesFileGenerator(IMd5ProviderFactory md5ProviderFactory, ILog log)
        {
            _md5ProviderFactory = md5ProviderFactory;
            _log = log;
        }

        public void GenerateFile(string folder, IProgress<int> progress, CancellationToken cancellationToken)
        {
            var step1Folder = Path.Combine(folder, "step1");
            Step1_Generate256UnsortedFiles(step1Folder, progress, cancellationToken);

            if (cancellationToken.IsCancellationRequested) return;

            Step2_GenerateIndexAndIdsFile(step1Folder, folder, progress, cancellationToken);
            Directory.Delete(step1Folder, true);

            progress.Report(100);
        }

        private void Step1_Generate256UnsortedFiles(string folder, IProgress<int> progress, CancellationToken cancellationToken)
        {
            if (!Directory.Exists(folder))
                Directory.CreateDirectory(folder);

            // Timing: 0:10:17
            using (_log.Time(nameof(Step1_Generate256UnsortedFiles)))
            {
                var writers = new BinaryWriter[256];

                try
                {
                    for (var i = 0; i < writers.Length; i++)
                    {
                        cancellationToken.ThrowIfCancellationRequested();

                        var fname = $"{i}.bin";
                        var path = Path.Combine(folder, fname);

                        if (File.Exists(path))
                            File.Delete(path);

                        writers[i] = path.CreateWriter().Buffered(1 * 1024 * 1024).ToBinaryWriter();
                    }

                    var tasks = new List<Task>();
                    long total = 0;

                    foreach (var tuple in ForEach(Math.Min(4, Environment.ProcessorCount)))
                    {
                        cancellationToken.ThrowIfCancellationRequested();
                        var local = tuple;
                        tasks.Add(Task.Factory.StartNew(() =>
                        {
                            var md5Provicer = _md5ProviderFactory.Create();
                            for (uint i = local.Item1; i <= local.Item2; i++)
                            {
                                cancellationToken.ThrowIfCancellationRequested();

                                var hash = md5Provicer.ComputeByteHash(i);
                                var writer = writers[hash[0]];

                                lock (writer)
                                {
                                    writer.Write(hash, 0, 4);
                                    writer.Write(i);
                                }

                                Interlocked.Increment(ref total);

                                if ((total + 1) / 100000000 > total / 100000000)
                                {
                                    var percent = total * 50.0 / uint.MaxValue;
                                    progress.Report((int)percent);
                                }

                                if (i == uint.MaxValue) break;
                            }
                        }, TaskCreationOptions.LongRunning));
                    }

                    Task.WaitAll(tasks.ToArray());
                }
                catch (Exception ex)
                {
                    _log.Error(ex);
                    throw;
                }
                finally
                {
                    foreach (var writer in writers)
                        writer.Dispose();
                }
            }
        }

        private void Step2_GenerateIndexAndIdsFile(string step1Folder, string step5Folder, IProgress<int> progress, CancellationToken cancellationToken)
        {
            if (!Directory.Exists(step5Folder))
                Directory.CreateDirectory(step5Folder);

            // Timing: 0:15:33
            using (_log.Time(nameof(Step2_GenerateIndexAndIdsFile)))
            {
                var idsFile = Path.Combine(step5Folder, "ids.bin");
                if (File.Exists(idsFile))
                    File.Delete(idsFile);

                using (var idsWriter = idsFile.CreateWriter().Buffered(10 * 1024 * 1024))
                {
                    var indexFileName = Path.Combine(step5Folder, "index.bin");
                    if (File.Exists(indexFileName))
                        File.Delete(indexFileName);

                    var fileIndexes = new uint[256 * 256 * 256];
                    var filebuffer = new byte[256 * 256 * 256 * 8 + 1024 * 1024 * 2];
                    var tempBuffer = new byte[256 * 256 * 256 * 8 + 1024 * 1024 * 2];

                    var indexes = new uint[256 * 256 * 256];

                    for (var i = 0; i < 256; i++)
                    {
                        cancellationToken.ThrowIfCancellationRequested();

                        var fileName = $"{i}.bin";
                        var inputFile = Path.Combine(step1Folder, fileName);

                        _log.Info($"Processing {fileName}");

                        int inputLen;

                        using (var sr = inputFile.CreateReader())
                        {
                            inputLen = sr.Read(filebuffer, 0, filebuffer.Length);
                        }

                        CreateMathes(filebuffer, inputLen, indexes);

                        Clear(fileIndexes);
                        CreateMathes(filebuffer, inputLen, fileIndexes, 1);
                        CreateIndexes(fileIndexes);
                        SortByHash(filebuffer, tempBuffer, inputLen, fileIndexes, 1);

                        for (var j = 0; j < inputLen; j += 8)
                        {
                            cancellationToken.ThrowIfCancellationRequested();
                            idsWriter.Write(tempBuffer, j + 4, 4);
                        }

                        progress.Report((int)(50.0 * i / 256 + 50));
                    }

                    CreateIndexes(indexes, 1);

                    using (var indexWriter = indexFileName.CreateWriter().Buffered(10 * 1024 * 1024)
                        .ToBinaryWriter())
                    {
                        for (var i = 0; i < 256; i++)
                            for (var ii = 0; ii < 256; ii++)
                                for (var jj = 0; jj < 256; jj++)
                                {
                                    cancellationToken.ThrowIfCancellationRequested();
                                    var ind = 256 * 256 * i + 256 * ii + jj;
                                    indexWriter.Write(indexes[ind]);
                                }
                    }
                }
            }
        }

        private static void Clear(uint[] source)
        {
            for (var i = 0; i < source.Length; i++)
                source[i] = 0;
        }

        internal static void CreateIndexes(uint[] indexes, uint wordLen = 8)
        {
            var curPos = 0u;
            for (var j = 0; j < indexes.Length; j++)
            {
                var count = indexes[j];
                indexes[j] = curPos * wordLen;
                curPos += count;
            }
        }

        internal static void CreateMathes(byte[] inputBytes, int inputLen, uint[] indexes, int baseoffset = 0)
        {
            var rowCount = inputLen / 8;

            for (var j = 0; j < rowCount; j++)
            {
                var inpInd = j * 8;

                var i1 = inputBytes[inpInd + baseoffset];
                var i2 = inputBytes[inpInd + 1 + baseoffset];
                var i3 = inputBytes[inpInd + 2 + baseoffset];

                indexes[i1 * 256 * 256 + i2 * 256 + i3]++;
            }
        }

        internal static void SortByHash(byte[] inputBytes, byte[] tempBuffer, int inputLen, uint[] indexes, int baseoffset = 0)
        {
            var rowCount = inputLen / 8;
            for (uint j = 0; j < rowCount; j++)
            {
                var inpInd = j * 8;

                var i1 = inputBytes[inpInd + baseoffset];
                var i2 = inputBytes[inpInd + 1 + baseoffset];
                var i3 = inputBytes[inpInd + 2 + baseoffset];

                var nextInd = indexes[i1 * 256 * 256 + i2 * 256 + i3];
                Copy(inputBytes, tempBuffer, inpInd, nextInd);
                indexes[i1 * 256 * 256 + i2 * 256 + i3] += 8;
            }
        }

        private static void Copy(byte[] source, byte[] dest, uint i, uint j)
        {
            for (var k = 0; k < 8; k++)
            {
                var index0 = i + k;
                var index1 = j + k;

                if (index0 >= source.Length) break;
                if (index1 >= source.Length) break;

                dest[index1] = source[index0];
            }
        }

        private static IEnumerable<Tuple<uint, uint>> ForEach(int parts)
        {
            var step = (uint)(uint.MaxValue / parts);
            var cmin = 0u;
            var cmax = cmin + step;

            for (var i = 0; i < parts; i++)
            {
                yield return Tuple.Create(cmin, cmax);
                cmin = cmax + 1;
                cmax += step;
                if (i == parts - 2) cmax = uint.MaxValue;
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Grids/SteamDiscovery.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.SteamModule.Grids.SteamDiscovery"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Arma3BE.Client.Modules.SteamModule.Grids"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             xmlns:converters="clr-namespace:Arma3BE.Client.Infrastructure.Converters;assembly=Arma3BE.Client.Infrastructure"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">

    <UserControl.Resources>

        <converters:InverseBooleanConverter x:Uid="local:"
                                              x:Key="InverseBooleanConverter" />

    </UserControl.Resources>


    <Grid>

        <xctk:BusyIndicator IsBusy="{Binding IsBusy}" BusyContent="Please, wait...">
            <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                        <RowDefinition  Height="Auto" ></RowDefinition>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <TextBlock Text="Minimal Id" Grid.Row="0" Grid.Column="0" Margin="2"></TextBlock>
                    <TextBlock Text="Maximal Id" Grid.Row="1" Grid.Column="0" Margin="2"></TextBlock>
                    <TextBlock Text="Current Id" Grid.Row="2" Grid.Column="0" Margin="2"></TextBlock>
                    <TextBlock Text="Total players:" Grid.Row="3" Grid.Column="0" Margin="2"></TextBlock>
                    <TextBlock Text="Found players:" Grid.Row="4" Grid.Column="0" Margin="2"></TextBlock>

                    <TextBlock Text="{Binding Progress, StringFormat=Progress: {0}}" Grid.Row="5" Grid.Column="0" Margin="2" />

                    <StackPanel Orientation="Horizontal" Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" Margin="2">
                        <Button Content="Start" Command="{Binding StartCommand}" Width="150" IsEnabled="{Binding InProcess, Mode=TwoWay, Converter={StaticResource InverseBooleanConverter}}"></Button>
                        <Button Content="Stop" Command="{Binding StopCommand}" Width="150" IsEnabled="{Binding InProcess, Mode=TwoWay}"></Button>
                    </StackPanel>


                    <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="1" Margin="2">
                        <TextBlock Text="7656119"></TextBlock>
                        <TextBox Text="{Binding Min, Mode=TwoWay}" IsEnabled="{Binding InProcess, Mode=TwoWay, Converter={StaticResource InverseBooleanConverter}}" ></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal"  Grid.Row="1" Grid.Column="1" Margin="2">
                        <TextBlock Text="7656119"></TextBlock>
                        <TextBox Text="{Binding Max, Mode=TwoWay}"  IsEnabled="{Binding InProcess, Mode=TwoWay, Converter={StaticResource InverseBooleanConverter}}"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal"  Grid.Row="2" Grid.Column="1" Margin="2">
                        <TextBlock Text="7656119"></TextBlock>
                        <TextBox Text="{Binding Current, Mode=TwoWay}"   IsEnabled="{Binding InProcess, Mode=TwoWay, Converter={StaticResource InverseBooleanConverter}}" ></TextBox>
                    </StackPanel>

                    <TextBlock Text="{Binding TotalPlayers.Count}" Grid.Row="3" Grid.Column="1" Margin="2"></TextBlock>
                    <TextBlock Text="{Binding PlayersFound.Count}" Grid.Row="4" Grid.Column="1" Margin="2"></TextBlock>

                    <ProgressBar Minimum="0" Maximum="100" Value="{Binding Progress}" Height="20" Grid.Row="5" Grid.Column="1" Margin="2"></ProgressBar>
                </Grid>
            </Border>
        </xctk:BusyIndicator>
    </Grid>
</UserControl>

```

`src/Arma3BE.Client.Modules.SteamModule/Grids/SteamDiscovery.xaml.cs`:

```cs
using Prism.Regions;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.SteamModule.Grids
{
    /// <summary>
    /// Interaction logic for SteamDiscovery.xaml
    /// </summary>
    [ViewSortHint("0700")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class SteamDiscovery : UserControl
    {
        public SteamDiscovery()
        {
            InitializeComponent();
        }
    }
}

```

`src/Arma3BE.Client.Modules.SteamModule/Grids/SteamQuery.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.SteamModule.Grids.SteamQuery"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d"
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid>
        <xctk:BusyIndicator IsBusy="{Binding IsBisy}" BusyContent="Please, wait...">
            <ScrollViewer HorizontalAlignment="Stretch" VerticalAlignment="Stretch" VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Auto">

                <StackPanel Orientation="Vertical" Margin="5">

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Host}" Width="Auto" Margin="2" />
                        <TextBox Text="{Binding Port, Mode=TwoWay}" Width="50" Margin="2" />
                        <Button Content="Go" Command="{Binding ExcecuteCommand}" Width="20" Margin="2" />
                    </StackPanel>


                    <StackPanel Orientation="Horizontal">
                        <DataGrid ItemsSource="{Binding Path=ServerPlayers.Players}" AutoGenerateColumns="True" Margin="5" />
                        <DataGrid ItemsSource="{Binding ServerInfo}" AutoGenerateColumns="True" Margin="5" />

                    </StackPanel>

                    <DataGrid ItemsSource="{Binding ServerRules}" AutoGenerateColumns="True" Margin="5" />

                </StackPanel>
            </ScrollViewer>
        </xctk:BusyIndicator>
    </Grid>
</UserControl>
```

`src/Arma3BE.Client.Modules.SteamModule/Grids/SteamQuery.xaml.cs`:

```cs
using Prism.Regions;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.SteamModule.Grids
{
    /// <summary>
    ///     Interaction logic for SteamQuery.xaml
    /// </summary>
    [ViewSortHint("0600")]
    // ReSharper disable once RedundantExtendsListEntry
    public partial class SteamQuery : UserControl
    {
        public SteamQuery()
        {
            InitializeComponent();
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Grids/SteamService.xaml`:

```xaml
<UserControl x:Class="Arma3BE.Client.Modules.SteamModule.Grids.SteamService"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Arma3BE.Client.Modules.SteamModule.Grids"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    
    
    <Grid>
        <Border BorderThickness="1" BorderBrush="Gray" Margin="5" Padding="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                    <ColumnDefinition></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" ></RowDefinition>
                    <RowDefinition Height="Auto" ></RowDefinition>
                    <RowDefinition Height="Auto" ></RowDefinition>
                </Grid.RowDefinitions>

                <TextBlock Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="2">Choose empty folder (48 gb needed)</TextBlock>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="{Binding Folder}" Width="300" ToolTip="{Binding Folder}"></TextBlock>
                
                <Button  Grid.Row="1" Grid.Column="1" Width="150" Content="Select folder" HorizontalAlignment="Left" Command="{Binding SelectFolderCommand}"></Button>

                <ProgressBar Grid.Row="2" Grid.Column="0"  Minimum="0" Maximum="100" Value="{Binding Progress}" ToolTip="{Binding Progress, StringFormat=Progress: {0}%}"></ProgressBar>

                <StackPanel Orientation="Horizontal" Grid.Row="2" Grid.Column="1" >
                    <Button Command="{Binding GenerateDataCommand}" Content="Generate"></Button>
                    <Button Command="{Binding CancelCommand}" Content="Cancel"></Button>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>

```

`src/Arma3BE.Client.Modules.SteamModule/Grids/SteamService.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace Arma3BE.Client.Modules.SteamModule.Grids
{
    /// <summary>
    /// Interaction logic for SteamService.xaml
    /// </summary>
    public partial class SteamService : UserControl
    {
        public SteamService()
        {
            InitializeComponent();
        }
    }
}

```

`src/Arma3BE.Client.Modules.SteamModule/Models/ServerMonitorSteamQueryViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Libs.ModelCompact;
using Arma3BEClient.Steam;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Threading.Tasks;
using System.Windows.Input;
using Arma3BEClient.Libs.Repositories;

// ReSharper disable VirtualMemberCallInConstructor
// ReSharper disable ExplicitCallerInfoArgument
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global
// ReSharper disable AutoPropertyCanBeMadeGetOnly.Global

namespace Arma3BE.Client.Modules.SteamModule.Models
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class ServerMonitorSteamQueryViewModel : ViewModelBase
    {
        private readonly IIpService _ipService;
        private bool _isBisy;


        public ServerMonitorSteamQueryViewModel(ServerInfoDto serverInfo, IIpService ipService)
        {
            _ipService = ipService;
            Host = serverInfo.Host;
            Port = serverInfo.SteamPort;

            RaisePropertyChanged(nameof(Host));
            RaisePropertyChanged(nameof(Port));

            ExcecuteCommand = new ActionCommand(() => Task.Run(() =>
            {
                try
                {
                    IsBisy = true;
                    GetStat();
                }
                finally
                {
                    IsBisy = false;
                }
            }),
                () =>
                {
                    var iphost = Host;

                    if (string.IsNullOrEmpty(iphost))
                    {
                        return false;
                    }
                    return true;
                });
        }

        private void GetStat()
        {
            var iphost = _ipService.GetIpAddress(Host);
            var server = new Server(new IPEndPoint(IPAddress.Parse(iphost), Port));

            var settings = new GetServerInfoSettings();
            var rules = server.GetServerRulesSync(settings);
            ServerRules =
                rules.Select(
                    x =>
                        new Tuple<string, string>(x.Key,
                            x.Value)).ToList();

            var serverInfoR =
                server.GetServerInfoSync(settings);

            var props = serverInfoR.GetType().GetProperties();

            ServerInfo =
                props.Select(
                    x =>
                        new Tuple<string, string>(x.Name,
                            x.GetValue(serverInfoR)
                                .ToString())).ToList();

            ServerPlayers =
                server.GetServerChallengeSync(settings);


            RaisePropertyChanged(nameof(ServerRules));
            RaisePropertyChanged(nameof(ServerInfo));
            RaisePropertyChanged(nameof(ServerPlayers));
        }

        public string Title => "Steam Query";

        public bool IsBisy
        {
            get { return _isBisy; }
            set
            {
                _isBisy = value;
                RaisePropertyChanged();
            }
        }

        public ICommand ExcecuteCommand { get; set; }
        public string Host { get; set; }
        public int Port { get; set; }
        public IEnumerable<Tuple<string, string>> ServerRules { get; private set; }
        public IEnumerable<Tuple<string, string>> ServerInfo { get; private set; }
        public ServerPlayers ServerPlayers { get; private set; }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Models/SteamDiscoveryViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Commands;
using Arma3BE.Client.Infrastructure.Models;
using Arma3BEClient.Libs.Repositories.Players;
using Arma3BEClient.Libs.Tools;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Security.Cryptography;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Input;

// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BE.Client.Modules.SteamModule.Models
{
    public class SteamDiscoveryViewModel : DisposableViewModelBase, ITitledItem
    {
        public static string StaticTitle = "Steam Discovery";
        private readonly IPlayerRepository _playerRepository;
        private readonly ISteamService _steamService;
        private CancellationTokenSource _cancelatioTokenSource;
        private long _current;
        private bool _inProcess;

        private bool _isBusy;
        private long _max;
        private long _min;
        private ObservableCollection<Tuple<string, string>> _playersFound;
        private int _progress;
        private Dictionary<string, Guid> _totalPlayers;


        public SteamDiscoveryViewModel(IPlayerRepository playerRepository, ISteamService steamService)
        {
            _playerRepository = playerRepository;
            _steamService = steamService;
            PlayersFound = new ObservableCollection<Tuple<string, string>>();
            StartCommand = new ActionCommand(async () => await StartAsync());
            StopCommand = new ActionCommand(Stop);

            Max = 8274000000L;
            Min = 7959000000L;

            Current = Min;
        }

        public ICommand StartCommand { get; set; }
        public ICommand StopCommand { get; set; }

        public long Min
        {
            get { return _min; }
            set
            {
                _min = value;
                RaisePropertyChanged();
            }
        }

        public long Max
        {
            get { return _max; }
            set
            {
                _max = value;
                RaisePropertyChanged();
            }
        }

        public long Current
        {
            get { return _current; }
            set
            {
                _current = value;
                RaisePropertyChanged();
            }
        }

        public bool IsBusy
        {
            get { return _isBusy; }
            set
            {
                _isBusy = value;
                RaisePropertyChanged();
            }
        }

        public bool InProcess
        {
            get { return _inProcess; }
            set
            {
                _inProcess = value;
                RaisePropertyChanged();
            }
        }

        public Dictionary<string, Guid> TotalPlayers
        {
            get { return _totalPlayers; }
            set
            {
                _totalPlayers = value;
                RaisePropertyChanged();
            }
        }

        public ObservableCollection<Tuple<string, string>> PlayersFound
        {
            get { return _playersFound; }
            set
            {
                _playersFound = value;
                RaisePropertyChanged();
            }
        }

        public int Progress
        {
            get { return _progress; }
            set
            {
                if (_progress != value)
                {
                    _progress = value;
                    RaisePropertyChanged();
                }
            }
        }

        public string Title => StaticTitle;

        protected override void DisposeManagedResources()
        {
            base.DisposeManagedResources();
            _cancelatioTokenSource?.Cancel();
        }

        private void Stop()
        {
            IsBusy = true;

            Task.Factory.StartNew(async () =>
            {
                try
                {
                    _cancelatioTokenSource?.Cancel();
                    await SaveAsync();
                }
                finally
                {
                    IsBusy = false;
                    InProcess = false;
                }
            });
        }

        private async Task SaveAsync()
        {
            var found = PlayersFound?.Where(x => _totalPlayers.ContainsKey(x.Item1))
                .Select(x => new { Id = _totalPlayers[x.Item1], steamId = x.Item2 })
                .ToDictionary(x => x.Id, x => x.steamId);

            if ((found != null) && (found.Count > 0))
                await _playerRepository.SaveSteamIdAsync(found);

            InProcess = false;
        }


        private async Task StartAsync()
        {
            InProcess = true;

            var found = PlayersFound;
            found.Clear();

            if (TotalPlayers == null)
                TotalPlayers = (await _playerRepository.GetAllPlayersWithoutSteamAsync())
                    .Where(x => string.IsNullOrEmpty(x.GUID) == false)
                    .GroupBy(x => x.GUID)
                    .ToDictionary(x => x.Key, x => x.First().Id);

            _cancelatioTokenSource?.Cancel();
            _cancelatioTokenSource = new CancellationTokenSource();

            if (_steamService.IsReady())
            {
                var res = await Task.Run(() => _steamService.GetSteamIds(TotalPlayers?.Keys.ToArray() ?? new string[0], _cancelatioTokenSource.Token));

                foreach (var item in res)
                {
                    PlayersFound.Add(Tuple.Create(item.Key, item.Value.ToString()));
                }

                await SaveAsync();

            }
            else
            {
                Task.Factory.StartNew(() => GenerateStart(_cancelatioTokenSource.Token),
                    TaskCreationOptions.LongRunning);
            }
        }

        private void GenerateStart(CancellationToken token)
        {
            Generate(Min, Max, token);
        }

        private void Generate(long min, long max, CancellationToken token)
        {
            var start = Current;

            for (var i = start; i <= max; i++)
            {
                var l = 76561190000000000L + i;
                var hash = Steam_Hash(l);
                Progress = (int)((i - min) * 100.0 / (max - min));

                CheckHash(l.ToString(), hash);

                Current = i;
                if (token.IsCancellationRequested)
                    return;
            }

            SaveAsync().Wait();
        }

        private void CheckHash(string currentId, string hash)
        {
            if (TotalPlayers?.ContainsKey(hash) == true)
                PlayersFound.Add(new Tuple<string, string>(hash, currentId));
        }

        private static string Steam_Hash(long num)
        {
            // http://steamcommunity.com/profiles/7656119xxxxxxxxxx 
            // http://steamcommunity.com/profiles/76561198053877632
            var steamId = num;
            var parts = new byte[] { 0x42, 0x45, 0, 0, 0, 0, 0, 0, 0, 0 };

            for (var i = 2; i < 10; i++)
            {
                var res = steamId % 256;
                steamId = steamId / 256;
                parts[i] = (byte)res;
            }

            var md5 = new MD5CryptoServiceProvider();
            var hash = md5.ComputeHash(parts);

            var result = "";
            foreach (var b in hash)
                result += b.ToString("x2");

            return result;
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/Models/SteamServiceViewModel.cs`:

```cs
using Arma3BE.Client.Infrastructure.Models;
using Arma3BE.Client.Modules.SteamModule.Core;
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Tools;
using Prism.Commands;
using System;
using System.Diagnostics;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace Arma3BE.Client.Modules.SteamModule.Models
{
    public class SteamServiceViewModel : DisposableViewModelBase, ITitledItem
    {
        private readonly ISettingsStoreSource _settingsStoreSource;
        public static string StaticTitle = "Steam Service";
        private string _folder;
        public string Title => StaticTitle;

        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        public SteamServiceViewModel(ISettingsStoreSource settingsStoreSource)
        {
            _settingsStoreSource = settingsStoreSource;
            SelectFolderCommand = new DelegateCommand(SelectFolder, () => !InProgress);
            GenerateDataCommand = new DelegateCommand(GenerateData, () => !string.IsNullOrEmpty(Folder) && !InProgress);

            CancelCommand = new DelegateCommand(Cancel, () => InProgress);

            var settings = _settingsStoreSource.GetSettingsStore();
            Folder = settings.SteamFolder;
        }

        public bool InProgress
        {
            get { return _inProgress; }
            set
            {
                if (SetProperty(ref _inProgress, value))
                {
                    CancelCommand.RaiseCanExecuteChanged();
                    GenerateDataCommand.RaiseCanExecuteChanged();
                    SelectFolderCommand.RaiseCanExecuteChanged();
                }
            }
        }

        public string Folder
        {
            get { return _folder; }
            set
            {
                if (SetProperty(ref _folder, value))
                {
                    GenerateDataCommand.RaiseCanExecuteChanged();

                    var settings = _settingsStoreSource.GetSettingsStore();
                    settings.SteamFolder = Folder;
                    settings.Save();
                }
            }
        }

        public int Progress
        {
            get { return _progress; }
            set { SetProperty(ref _progress, value); }
        }

        public DelegateCommand SelectFolderCommand { get; set; }
        public DelegateCommand GenerateDataCommand { get; set; }
        public DelegateCommand CancelCommand { get; set; }

        private void SelectFolder()
        {
            var fbd = new FolderBrowserDialog();
            var result = fbd.ShowDialog();
            if (result == DialogResult.OK)
            {
                Folder = fbd.SelectedPath;
            }
        }

        private CancellationTokenSource _cancellationTokenSource;
        private bool _inProgress;
        private int _progress;

        private void Cancel()
        {
            _cancellationTokenSource?.Cancel();
        }

        private async void GenerateData()
        {
            InProgress = true;
            Progress = 0;

            var progress = new Progress<int>();
            progress.ProgressChanged += Progress_ProgressChanged;

            _cancellationTokenSource?.Cancel();
            _cancellationTokenSource = new CancellationTokenSource();

            try
            {

                await Task.Run(() =>
                {
                    var log = new Log();
                    var md5 = new OptimizedHashProviderFactory();
                    var generator = new Uint32ToTiont32AllHashesFileGenerator(md5, log);
                    generator.GenerateFile(Folder, progress, _cancellationTokenSource.Token);
                });

                MessageBox.Show("Index files generated. Now you can restart application.", "Done", MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
            catch (Exception ex)
            {
                var baseException = ex.InnerException;
                if (baseException is OperationCanceledException)
                {
                    /* NOPE */
                    //MessageBox.Show("Operation cancelled.", "Cancelled", MessageBoxButtons.OK, MessageBoxIcon.Information);
                }
                else
                {
                    _log.Error(ex);
                    MessageBox.Show("One or more errors occured", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }

            progress.ProgressChanged -= Progress_ProgressChanged;
            InProgress = false;
        }

        private void Progress_ProgressChanged(object sender, int e)
        {
            Progress = e;
        }

        protected override void DisposeManagedResources()
        {
            Cancel();
            base.DisposeManagedResources();
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/SteamModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Infrastructure.Helpers;
using Arma3BE.Client.Modules.SteamModule.Grids;
using Arma3BE.Client.Modules.SteamModule.Models;
using Arma3BEClient.Libs.Repositories;
using Arma3BEClient.Libs.Tools;
using Microsoft.Practices.Unity;
using Prism.Commands;
using Prism.Modularity;
using Prism.Regions;
using System.Linq;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.SteamModule
{
    public class SteamModuleInit : IModule
    {
        private static IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public SteamModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        public void Initialize()
        {
            _container.RegisterType<ISteamService, Core.SteamService>(new ContainerControlledLifetimeManager());

            _regionManager.RegisterViewWithRegion(RegionNames.ServerTabPartRegion, CreateSteamQueryView);
            _regionManager.RegisterViewWithRegion(RegionNames.MenuToolsRegion, CreateSteamDiscoveryView);
            _regionManager.RegisterViewWithRegion(RegionNames.MenuToolsRegion, CreateSteamServiceView);
        }

        private object CreateSteamQueryView()
        {
            return ServerTabViewHelper.RegisterView<SteamQuery, ServerInfoDto, ServerMonitorSteamQueryViewModel>(_container,
                "serverInfo");
        }

        private object CreateSteamDiscoveryView()
        {
            return new MenuItem
            {
                Command = new DelegateCommand(() =>
                    {
                        var vm = _container.Resolve<SteamDiscoveryViewModel>();
                        var view = _container.Resolve<SteamDiscovery>();
                        view.DataContext = vm;
                        _regionManager.Regions[RegionNames.ServerTabRegion].Add(view, null, true);
                    },
                    () =>
                        _regionManager.Regions[RegionNames.ServerTabRegion].Views.OfType<SteamDiscovery>().Any() ==
                        false),
                Header = SteamDiscoveryViewModel.StaticTitle
            };
        }

        private object CreateSteamServiceView()
        {
            return new MenuItem
            {
                Command = new DelegateCommand(() =>
                    {
                        var vm = _container.Resolve<SteamServiceViewModel>();
                        var view = _container.Resolve<SteamService>();
                        view.DataContext = vm;
                        _regionManager.Regions[RegionNames.ServerTabRegion].Add(view, null, true);
                    },
                    () =>
                        _regionManager.Regions[RegionNames.ServerTabRegion].Views.OfType<SteamService>().Any() ==
                        false),
                Header = SteamServiceViewModel.StaticTitle
            };
        }
    }
}
```

`src/Arma3BE.Client.Modules.SteamModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Extended.Wpf.Toolkit" version="3.0" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Modules.ToolsModule/Arma3BE.Client.Modules.ToolsModule.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{57EF9E36-98D1-4DFE-A56B-ADE958BAB019}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Modules.ToolsModule</RootNamespace>
    <AssemblyName>Arma3BE.Client.Modules.ToolsModule</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject />
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Exporter.cs" />
    <Compile Include="Importer.cs" />
    <Compile Include="PlayerXML.cs" />
    <Compile Include="ToolsModuleInit.cs" />
    <Compile Include="VirtualServerWindow.xaml.cs">
      <DependentUpon>VirtualServerWindow.xaml</DependentUpon>
    </Compile>
    <Compile Include="Virtual\VirtualServerFactory.cs" />
    <None Include="packages.config" />
    <AppDesigner Include="Properties\" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\BattleNET\BattleNET\BattleNET.csproj">
      <Project>{db17061b-3fa9-46d5-acaf-f23693d86b5d}</Project>
      <Name>BattleNET</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{e5240a50-e944-4f50-a353-2e3c9e547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Page Include="VirtualServerWindow.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Modules.ToolsModule/Exporter.cs`:

```cs
using Arma3BEClient.Libs.Repositories.Players;
using Microsoft.Win32;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Xml.Serialization;

namespace Arma3BE.Client.Modules.ToolsModule
{
    public class Exporter
    {
        private readonly IPlayerRepository _playerRepository;

        public Exporter(IPlayerRepository playerRepository)
        {
            _playerRepository = playerRepository;
        }

        public async void Export()
        {
            var dlg = new SaveFileDialog
            {
                DefaultExt = "*.xml",
                Filter = "*.xml|*.xml",
                Title = "Select file to save players"
            };

            var res = dlg.ShowDialog();

            if (res.HasValue && res.Value)
            {
                await Export(dlg.FileName);
                MessageBox.Show("Export finished!");
            }
        }

        private async Task Export(string fname)
        {
            var list =
                (await _playerRepository.GetAllPlayersAsync())
                    .GroupBy(x => x.GUID)
                    .Select(x => x.OrderByDescending(y => y.Name).First())
                    .OrderBy(x => x.Name)
                    .Select(x =>
                        new PlayerXML
                        {
                            Guid = x.GUID,
                            SteamId = x.SteamId,
                            LastIP = x.LastIp,
                            LastSeen = x.LastSeen,
                            Name = x.Name,
                            Comment = x.Comment
                        }).ToList();


            using (var sw = new StreamWriter(fname))
            {
                var ser = new XmlSerializer(typeof(List<PlayerXML>));
                ser.Serialize(sw, list);
            }
        }
    }
}
```

`src/Arma3BE.Client.Modules.ToolsModule/Importer.cs`:

```cs
using Arma3BEClient.Common.Logging;
using Arma3BEClient.Libs.Repositories.Players;
using Microsoft.Win32;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Xml.Serialization;

namespace Arma3BE.Client.Modules.ToolsModule
{
    public class Importer
    {
        private readonly IPlayerRepository _playerRepository;
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        public Importer(IPlayerRepository playerRepository)
        {
            _playerRepository = playerRepository;
        }

        private async Task<ImportResult> Import(string fname)
        {
            var sw = Stopwatch.StartNew();
            _log.Info("Import started");

            var result = new ImportResult();

            List<PlayerXML> players;
            using (var sr = new StreamReader(fname))
            {
                var ser = new XmlSerializer(typeof(List<PlayerXML>));
                players = (List<PlayerXML>)ser.Deserialize(sr);
            }


            var db =
               (await _playerRepository.GetAllPlayersAsync().ConfigureAwait(false))
                    .GroupBy(x => x.GUID)
                    .Select(x => x.OrderByDescending(y => y.Name).First())
                    .ToDictionary(x => x.GUID);

            var toadd = new List<PlayerDto>();
            var toUpdate = new List<PlayerDto>();

            foreach (var p in players)
                if (!db.ContainsKey(p.Guid))
                {
                    toadd.Add(new PlayerDto
                    {
                        Comment = p.Comment,
                        GUID = p.Guid,
                        LastIp = p.LastIP,
                        LastSeen = p.LastSeen,
                        Name = p.Name,
                        SteamId = p.SteamId,
                        Id = Guid.NewGuid()
                    });
                }
                else
                {
                    bool updated = false;

                    var lp = db[p.Guid];
                    if (string.IsNullOrEmpty(lp.Comment) && !string.IsNullOrEmpty(p.Comment))
                    {
                        lp.Comment = p.Comment;
                        updated = true;
                    }
                    if (string.IsNullOrEmpty(lp.SteamId) && !string.IsNullOrEmpty(p.SteamId))
                    {
                        lp.SteamId = p.SteamId;
                        updated = true;
                    }
                    if (updated)
                    {
                        toUpdate.Add(lp);
                    }
                }

            result.Added = toadd.Count;
            result.Updated = toUpdate.Count;

            await _playerRepository.ImportPlayersAsync(toadd, toUpdate);

            sw.Stop();
            _log.Info($"Import takes {sw.ElapsedMilliseconds} ms. Added {result.Added}, updated {result.Updated}");
            return result;
        }

        public async void Import()
        {
            var ofd = new OpenFileDialog
            {
                DefaultExt = "*.xml",
                Filter = "*.xml|*.xml",
                Title = "Select file to import players"
            };

            var res = ofd.ShowDialog();

            if (res.HasValue && res.Value)
            {
                var result = await Import(ofd.FileName);
                MessageBox.Show($"Import finished! Added {result.Added}, updated {result.Updated}");
            }
        }

        private class ImportResult
        {
            public int Added { get; set; }
            public int Updated { get; set; }
        }
    }
}
```

`src/Arma3BE.Client.Modules.ToolsModule/PlayerXML.cs`:

```cs
using System;
using System.Xml.Serialization;

namespace Arma3BE.Client.Modules.ToolsModule
{
    public class PlayerXML
    {
        [XmlAttribute]
        public string Name { get; set; }

        [XmlAttribute]
        public string Guid { get; set; }

        [XmlAttribute]
        public string SteamId { get; set; }

        [XmlAttribute]
        public string LastIP { get; set; }

        [XmlAttribute]
        public string Comment { get; set; }

        [XmlAttribute]
        public DateTime LastSeen { get; set; }
    }
}
```

`src/Arma3BE.Client.Modules.ToolsModule/ToolsModuleInit.cs`:

```cs
using Arma3BE.Client.Infrastructure;
using Arma3BE.Client.Modules.ToolsModule.Virtual;
using Arma3BE.Server.Abstract;
using Microsoft.Practices.Unity;
using Prism.Commands;
using Prism.Modularity;
using Prism.Regions;
using System.Configuration;
using System.Windows.Controls;

namespace Arma3BE.Client.Modules.ToolsModule
{
    public class ToolsModuleInit : IModule
    {
        private static IUnityContainer _container;
        private readonly IRegionManager _regionManager;

        public ToolsModuleInit(IUnityContainer container, IRegionManager regionManager)
        {
            _container = container;
            _regionManager = regionManager;
        }

        private const string DebugServerKey = "DebugServerEnabled";

        public void Initialize()
        {
            if (ConfigurationManager.AppSettings[DebugServerKey] == bool.TrueString)
            {
                _container.RegisterType<IBattlEyeServerFactory, VirtualServerFactory>(new ContainerControlledLifetimeManager());
                _regionManager.RegisterViewWithRegion(RegionNames.MenuFileToolsRegion, CreateDebugWindow);

            }


            _regionManager.RegisterViewWithRegion(RegionNames.MenuFileToolsRegion, CreateExportViewItem);
            _regionManager.RegisterViewWithRegion(RegionNames.MenuFileToolsRegion, CreateImportViewItem);
        }

        private object CreateDebugWindow()
        {
            return new MenuItem
            {
                Header = "Debug server",
                Command = new DelegateCommand(() =>
                {
                    _container.Resolve<VirtualServerWindow>().Show();
                })
            };
        }

        private object CreateExportViewItem()
        {
            return new MenuItem
            {
                Header = "Export players",
                Command = new DelegateCommand(() =>
                {
                    _container.Resolve<Exporter>().Export();
                })
            };
        }

        private object CreateImportViewItem()
        {
            return new MenuItem
            {
                Header = "Import players",
                Command = new DelegateCommand(() =>
                {
                    _container.Resolve<Importer>().Import();
                })
            };
        }
    }
}
```

`src/Arma3BE.Client.Modules.ToolsModule/Virtual/VirtualServerFactory.cs`:

```cs
using Arma3BE.Server.Abstract;
using BattleNET;
using System;

namespace Arma3BE.Client.Modules.ToolsModule.Virtual
{
    // ReSharper disable once ClassNeverInstantiated.Global
    public class VirtualServerFactory : IBattlEyeServerFactory
    {
        private readonly Lazy<VirtualServer> _server = new Lazy<VirtualServer>(() => new VirtualServer());

        public IBattlEyeServer Create(BattlEyeLoginCredentials credentials)
        {
            return _server.Value;
        }
    }

    // ReSharper disable once ClassWithVirtualMembersNeverInherited.Global
    public class VirtualServer : IBattlEyeServer
    {
        public void Dispose()
        {

        }

        public bool Connected { get; private set; }

        public int SendCommand(BattlEyeCommand command, string parameters = "")
        {
            OnCommandRecieved(new CommandArgs(command, parameters));
            return 1;
        }

        public int SendCommand(string command)
        {
            OnPureCommandRecieved(new PureCommandArgs(command));

            return 1;
        }

        public void Disconnect()
        {
            Connected = false;
        }

        public event BattlEyeMessageEventHandler BattlEyeMessageReceived;
        public event BattlEyeConnectEventHandler BattlEyeConnected;
        public event BattlEyeDisconnectEventHandler BattlEyeDisconnected;

        public event EventHandler<CommandArgs> CommandRecieved;
        public event EventHandler<PureCommandArgs> PureCommandRecieved;


        public BattlEyeConnectionResult Connect()
        {
            Connected = true;
            return BattlEyeConnectionResult.Success;
        }

        public void OnBattlEyeConnected(BattlEyeConnectEventArgs args)
        {
            BattlEyeConnected?.Invoke(args);
        }

        public void OnBattlEyeDisconnected(BattlEyeDisconnectEventArgs args)
        {
            BattlEyeDisconnected?.Invoke(args);
        }

        public void OnBattlEyeMessageReceived(BattlEyeMessageEventArgs args)
        {
            BattlEyeMessageReceived?.Invoke(args);
        }


        public class CommandArgs : EventArgs
        {
            public BattlEyeCommand Command { get; }
            public string Parameters { get; }

            public CommandArgs(BattlEyeCommand command, string parameters = "")
            {
                Command = command;
                Parameters = parameters;
            }

        }

        public class PureCommandArgs : EventArgs
        {
            public string Command { get; }

            public PureCommandArgs(string command)
            {
                Command = command;
            }

        }

        protected virtual void OnCommandRecieved(CommandArgs e)
        {
            CommandRecieved?.Invoke(this, e);

        }

        protected virtual void OnPureCommandRecieved(PureCommandArgs e)
        {
            PureCommandRecieved?.Invoke(this, e);
        }
    }
}
```

`src/Arma3BE.Client.Modules.ToolsModule/VirtualServerWindow.xaml`:

```xaml
<Window x:Class="Arma3BE.Client.Modules.ToolsModule.VirtualServerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Arma3BE.Client.Modules.ToolsModule"
        mc:Ignorable="d"
        Title="VirtualServerWindow" Height="600" Width="600">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition Width="Auto"></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
        </Grid.ColumnDefinitions>


        <StackPanel Orientation="Horizontal"  Grid.Row="0" Grid.Column="0">

            <Button Content="Connect" Click="Connect_OnClick" ></Button>
            <Button Content="Disconnect" Click="Disconnect_OnClick" ></Button>


            <Button Content="Clear" Click="Clear_OnClick" ></Button>

        </StackPanel>


        <TextBox AcceptsTab="True" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" 
                 VerticalContentAlignment="Stretch" Name="tbCmd"
                 Grid.Row="1" Grid.Column="0"></TextBox>

        <ScrollViewer Grid.Row="1" Grid.Column="2">
            <TextBlock Name="tbCommand"   ></TextBlock>
        </ScrollViewer>
        
        <GridSplitter Grid.Column="1" Grid.RowSpan="3" VerticalContentAlignment="Stretch" Width="3" HorizontalAlignment="Center"></GridSplitter>

        <Button Content="Send" Click="Send_Click"  Grid.Row="2" Grid.Column="0"></Button>
    </Grid>
</Window>

```

`src/Arma3BE.Client.Modules.ToolsModule/VirtualServerWindow.xaml.cs`:

```cs
using Arma3BE.Client.Modules.ToolsModule.Virtual;
using Arma3BE.Server.Abstract;
using BattleNET;
using System;
using System.Windows;

namespace Arma3BE.Client.Modules.ToolsModule
{
    /// <summary>
    /// Interaction logic for VirtualServerWindow.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class VirtualServerWindow : Window
    {
        private readonly VirtualServer _server;

        public VirtualServerWindow(IBattlEyeServerFactory factory)
        {
            InitializeComponent();

            _server = factory.Create(new BattlEyeLoginCredentials()) as VirtualServer;
            if (_server != null)
            {
                _server.CommandRecieved += _server_CommandRecieved;
                _server.PureCommandRecieved += _server_PureCommandRecieved;
            }
        }

        private void _server_PureCommandRecieved(object sender, VirtualServer.PureCommandArgs e)
        {
            Dispatcher.Invoke(() =>
            {
                tbCommand.Text += $"{e.Command}" + Environment.NewLine;
            });
        }

        private void _server_CommandRecieved(object sender, VirtualServer.CommandArgs e)
        {
            Dispatcher.Invoke(() =>
            {
                tbCommand.Text += $"{e.Command} with {e.Parameters}" + Environment.NewLine;
            });
        }


        private void Connect_OnClick(object sender, RoutedEventArgs e)
        {
            _server.OnBattlEyeConnected(new BattlEyeConnectEventArgs(new BattlEyeLoginCredentials(), BattlEyeConnectionResult.Success));
        }

        private void Disconnect_OnClick(object sender, RoutedEventArgs e)
        {
            _server.OnBattlEyeDisconnected(new BattlEyeDisconnectEventArgs(new BattlEyeLoginCredentials(), BattlEyeDisconnectionType.Manual));
        }

        private int _messageId;
        private void Send_Click(object sender, RoutedEventArgs e)
        {
            _server.OnBattlEyeMessageReceived(new BattlEyeMessageEventArgs(tbCmd.Text, ++_messageId));
        }

        private void Clear_OnClick(object sender, RoutedEventArgs e)
        {
            tbCommand.Text = string.Empty;
        }
    }
}

```

`src/Arma3BE.Client.Modules.ToolsModule/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client.Styles/Arma3BE.Client.Styles.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{CF43B82B-1F25-4385-B315-AB7B4C010A4B}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Client.Styles</RootNamespace>
    <AssemblyName>Arma3BE.Client.Styles</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <CodeAnalysisIgnoreGeneratedCode>true</CodeAnalysisIgnoreGeneratedCode>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="WindowsBase" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <Resource Include="Icons\add.ico" />
    <Resource Include="Icons\bg_header.jpg" />
    <Resource Include="Icons\delete.ico" />
    <Resource Include="Icons\download.ico" />
    <Resource Include="Icons\gear.png" />
    <Resource Include="Icons\main.ico" />
    <Resource Include="Icons\refresh.ico" />
    <Resource Include="Icons\save.ico" />
    <Resource Include="Icons\site_logo.png" />
    <Resource Include="Icons\tehgam.jpg" />
  </ItemGroup>
  <ItemGroup>
    <Page Include="Styles.xaml">
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Icons.xaml" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Client.Styles/Icons.xaml`:

```xaml
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- ReSharper disable InconsistentNaming -->
  <BitmapImage  x:Key="refresh_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/refresh.ico"></BitmapImage>
  <BitmapImage  x:Key="main_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/main.ico"></BitmapImage>
  <BitmapImage  x:Key="add_icon_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/add.ico"></BitmapImage>
  <BitmapImage  x:Key="delete_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/delete.ico"></BitmapImage>
  <BitmapImage  x:Key="gear_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/gear.png"></BitmapImage>
  <BitmapImage  x:Key="download_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/download.ico"></BitmapImage>
  <BitmapImage  x:Key="save_icon" UriSource="/Arma3BE.Client.Styles;component/Icons/save.ico"></BitmapImage>
  

  <BitmapImage  x:Key="site_logo_image" UriSource="/Arma3BE.Client.Styles;component/Icons/site_logo.png"></BitmapImage>
  <BitmapImage  x:Key="tehgam_image" UriSource="/Arma3BE.Client.Styles;component/Icons/tehgam.jpg"></BitmapImage>
  <BitmapImage  x:Key="bg_header_image" UriSource="/Arma3BE.Client.Styles;component/Icons/bg_header.jpg"></BitmapImage>
    <!-- ReSharper restore InconsistentNaming -->
</ResourceDictionary>
```

`src/Arma3BE.Client.Styles/Styles.xaml`:

```xaml
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Style TargetType="Button">
        <Setter Property="Margin" Value="2" />
    </Style>


    <Style TargetType="TabItem">
        <Setter Property="Header" Value="{Binding DataContext.Title}" />
    </Style>

</ResourceDictionary>
```

`src/Arma3BE.Client.Updater/App.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1"/>
    </startup>
</configuration>

```

`src/Arma3BE.Client.Updater/App.xaml`:

```xaml
<Application x:Class="Arma3BE.Client.Updater.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:Arma3BE.Client.Updater"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
         
    </Application.Resources>
</Application>

```

`src/Arma3BE.Client.Updater/App.xaml.cs`:

```cs
using System.Windows;

namespace Arma3BE.Client.Updater
{
    /// <summary>
    /// Interaction logic for App.xaml
    /// </summary>
    public partial class App : Application
    {
    }
}

```

`src/Arma3BE.Client.Updater/Arma3BE.Client.Updater.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{9ADE6790-CEDC-43F0-8920-54AFFFB2646E}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <RootNamespace>Arma3BE.Client.Updater</RootNamespace>
    <AssemblyName>Arma3BE.Client.Updater</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <PublishUrl>publish\</PublishUrl>
    <Install>true</Install>
    <InstallFrom>Disk</InstallFrom>
    <UpdateEnabled>false</UpdateEnabled>
    <UpdateMode>Foreground</UpdateMode>
    <UpdateInterval>7</UpdateInterval>
    <UpdateIntervalUnits>Days</UpdateIntervalUnits>
    <UpdatePeriodically>false</UpdatePeriodically>
    <UpdateRequired>false</UpdateRequired>
    <MapFileExtensions>true</MapFileExtensions>
    <ApplicationRevision>0</ApplicationRevision>
    <ApplicationVersion>1.0.0.%2a</ApplicationVersion>
    <IsWebBootstrapper>false</IsWebBootstrapper>
    <UseApplicationTrust>false</UseApplicationTrust>
    <BootstrapperEnabled>true</BootstrapperEnabled>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationIcon>main.ico</ApplicationIcon>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Newtonsoft.Json, Version=10.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed, processorArchitecture=MSIL">
      <HintPath>..\packages\Newtonsoft.Json.10.0.3\lib\net45\Newtonsoft.Json.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.IO.Compression" />
    <Reference Include="System.IO.Compression.FileSystem" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
  </ItemGroup>
  <ItemGroup>
    <ApplicationDefinition Include="App.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </ApplicationDefinition>
    <Page Include="MainWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="App.xaml.cs">
      <DependentUpon>App.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="MainWindow.xaml.cs">
      <DependentUpon>MainWindow.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
    <None Include="packages.config" />
  </ItemGroup>
  <ItemGroup>
    <Resource Include="main.ico" />
  </ItemGroup>
  <ItemGroup>
    <BootstrapperPackage Include=".NETFramework,Version=v4.5.2">
      <Visible>False</Visible>
      <ProductName>Microsoft .NET Framework 4.5.2 %28x86 and x64%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>
```

`src/Arma3BE.Client.Updater/MainWindow.xaml`:

```xaml
<Window x:Class="Arma3BE.Client.Updater.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Arma3BE.Client.Updater"
        mc:Ignorable="d" WindowStyle="ToolWindow" WindowStartupLocation="CenterScreen"
        Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>

        <ProgressBar Grid.Row="0" Value="0" Maximum="100" Minimum="0"  Margin="2" IsIndeterminate="True" ></ProgressBar>
        <ScrollViewer Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Name="sv">
            <TextBox IsReadOnly="True"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="2" Name="tbOut" >
            
            </TextBox>
        </ScrollViewer>
    </Grid>
</Window>

```

`src/Arma3BE.Client.Updater/MainWindow.xaml.cs`:

```cs
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.IO.Compression;
using System.Linq;
using System.Net;
using System.Reflection;
using System.Windows;

namespace Arma3BE.Client.Updater
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            var version = Assembly.GetExecutingAssembly().GetName().Version;
            var title = $"TEHGAM.COM - Arma 3 BattlEye Tool Updater v.{version.Major}.{version.Minor}.{version.Build}";
            Title = title;

            InitFromStartupArgs();

            try
            {
                RunUpdate();
            }
            catch (Exception e)
            {
                MessageBox.Show(this, "Update failed. " + e.Message, "Error", MessageBoxButton.OK,
                    MessageBoxImage.Error);
            }
        }


        private bool _needRestart = false;
        private string _originPath = string.Empty;

        private void InitFromStartupArgs()
        {
            var args = Environment.GetCommandLineArgs();

            if (args.Length == 1) throw new Exception("invalid startup args");
            _originPath = args[1];

            if (Directory.Exists(_originPath) == false) throw new Exception("invalid directory");
            _needRestart = args.Contains("RESTART");
        }

        private async void RunUpdate()
        {
            using (var client = new WebClient())
            {
                var str = await client.DownloadStringTaskAsync(new Uri("https://ci.appveyor.com/api/projects/ArtemMuradov/arma3beclient/"));

                var data = JsonConvert.DeserializeObject<RootObject>(str);

                if (data?.build == null)
                {
                    AppendLog("No build found");

                    MessageBox.Show(this, "Update failed", "Error", MessageBoxButton.OK, MessageBoxImage.Error);

                    return;
                }
                if (data.build.status == "success" && data.build.jobs?.Count == 1)
                {
                    var origDir = _originPath;
                    var tempDirName = Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString());
                    if (Directory.Exists(tempDirName) == false) Directory.CreateDirectory(tempDirName);
                    AppendLog($"Temporary directory: {tempDirName}");

                    var downloadUri = $"https://ci.appveyor.com/api/buildjobs/{data.build.jobs[0].jobId}/artifacts/src%2FArma3BE.Client%2Fbin%2FArma3BEClient.zip";
                    AppendLog($"downloadUri {downloadUri}");

                    var fileName = Path.Combine(tempDirName, "data.zip");
                    await client.DownloadFileTaskAsync(downloadUri, fileName);
                    AppendLog($"File {fileName} downloaded");

                    var directory = Path.Combine(tempDirName, "extracted");
                    ZipFile.ExtractToDirectory(fileName, directory);
                    AppendLog($"File {fileName} extracted");

                    foreach (var file in Directory.GetFiles(origDir).Where(x => new FileInfo(x).Name != "Database.sdf"))
                    {
                        AppendLog($"Deletinng file {file}");
                        File.Delete(file);
                    }

                    foreach (var dir in Directory.GetDirectories(origDir).Where(x => new DirectoryInfo(x).Name != "Logs"))
                    {
                        AppendLog($"Deletinng directory {dir}");
                        Directory.Delete(dir, true);
                    }

                    foreach (var file in Directory.GetFiles(directory, "*.*", SearchOption.AllDirectories))
                    {
                        var dest = file.Replace(directory, origDir);
                        AppendLog($"Copiyng file {dest}");
                        var dir = Path.GetDirectoryName(dest);
                        if (Directory.Exists(dir) == false) Directory.CreateDirectory(dir);
                        File.Copy(file, dest);
                    }

                    AppendLog($"Deleting temp directory {tempDirName}");
                    Directory.Delete(tempDirName, true);

                    AppendLog("Done.");

                    MessageBox.Show(this, "Update finished", "Update finished successfully.", MessageBoxButton.OK,
                        MessageBoxImage.Information);

                    var exeFile = Path.Combine(_originPath, "Arma3BEClient.exe");

                    Process.Start(exeFile);
                    Application.Current.Shutdown();
                }
            }
        }


        void AppendLog(string message)
        {
            tbOut.Text += $"{message}{Environment.NewLine}";
            sv.ScrollToEnd();
        }
    }


    #region DTOs



    public class NuGetFeed
    {
        public string id { get; set; }
        public string name { get; set; }
        public bool publishingEnabled { get; set; }
        public string created { get; set; }
    }

    public class AccessRightDefinition
    {
        public string name { get; set; }
        public string description { get; set; }
    }

    public class AccessRight
    {
        public string name { get; set; }
        public bool allowed { get; set; }
    }

    public class RoleAce
    {
        public int roleId { get; set; }
        public string name { get; set; }
        public bool isAdmin { get; set; }
        public List<AccessRight> accessRights { get; set; }
    }

    public class SecurityDescriptor
    {
        public List<AccessRightDefinition> accessRightDefinitions { get; set; }
        public List<RoleAce> roleAces { get; set; }
    }

    public class Project
    {
        public int projectId { get; set; }
        public int accountId { get; set; }
        public string accountName { get; set; }
        public List<object> builds { get; set; }
        public string name { get; set; }
        public string slug { get; set; }
        public string repositoryType { get; set; }
        public string repositoryScm { get; set; }
        public string repositoryName { get; set; }
        public string repositoryBranch { get; set; }
        public bool isPrivate { get; set; }
        public bool skipBranchesWithoutAppveyorYml { get; set; }
        public bool enableSecureVariablesInPullRequests { get; set; }
        public bool enableSecureVariablesInPullRequestsFromSameRepo { get; set; }
        public bool enableDeploymentInPullRequests { get; set; }
        public bool rollingBuilds { get; set; }
        public bool alwaysBuildClosedPullRequests { get; set; }
        public string tags { get; set; }
        public NuGetFeed nuGetFeed { get; set; }
        public SecurityDescriptor securityDescriptor { get; set; }
        public string created { get; set; }
        public string updated { get; set; }
    }

    public class Job
    {
        public string jobId { get; set; }
        public string name { get; set; }
        public bool allowFailure { get; set; }
        public int messagesCount { get; set; }
        public int compilationMessagesCount { get; set; }
        public int compilationErrorsCount { get; set; }
        public int compilationWarningsCount { get; set; }
        public int testsCount { get; set; }
        public int passedTestsCount { get; set; }
        public int failedTestsCount { get; set; }
        public int artifactsCount { get; set; }
        public string status { get; set; }
        public string started { get; set; }
        public string finished { get; set; }
        public string created { get; set; }
        public string updated { get; set; }
    }

    public class Build
    {
        public int buildId { get; set; }
        public List<Job> jobs { get; set; }
        public int buildNumber { get; set; }
        public string version { get; set; }
        public string message { get; set; }
        public string branch { get; set; }
        public bool isTag { get; set; }
        public string commitId { get; set; }
        public string authorName { get; set; }
        public string authorUsername { get; set; }
        public string committerName { get; set; }
        public string committerUsername { get; set; }
        public string committed { get; set; }
        public List<object> messages { get; set; }
        public string status { get; set; }
        public string started { get; set; }
        public string finished { get; set; }
        public string created { get; set; }
        public string updated { get; set; }
    }

    public class RootObject
    {
        public Project project { get; set; }
        public Build build { get; set; }
    }

    #endregion
}
```

`src/Arma3BE.Client.Updater/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Newtonsoft.Json" version="10.0.3" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Client/App.Debug.config`:

```config
<?xml version="1.0" encoding="utf-8"?>

<!-- For more information on using web.config transformation visit http://go.microsoft.com/fwlink/?LinkId=125889 -->

<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
  <!--
    In the example below, the "SetAttributes" transform will change the value of 
    "connectionString" to use "ReleaseSQLServer" only when the "Match" locator 
    finds an attribute "name" that has a value of "MyDB".
    
    <connectionStrings>
      <add name="MyDB" 
        connectionString="Data Source=ReleaseSQLServer;Initial Catalog=MyReleaseDB;Integrated Security=True" 
        xdt:Transform="SetAttributes" xdt:Locator="Match(name)"/>
    </connectionStrings>
  -->
  <!--<system.web>
    
      In the example below, the "Replace" transform will replace the entire 
      <customErrors> section of your web.config file.
      Note that because there is only one customErrors section under the 
      <system.web> node, there is no need to use the "xdt:Locator" attribute.
      
      <customErrors defaultRedirect="GenericError.htm"
        mode="RemoteOnly" xdt:Transform="Replace">
        <error statusCode="500" redirect="InternalError.htm"/>
      </customErrors>
    
  </system.web>-->


<appSettings>
  <add key="DebugServerEnabled" value="True" xdt:Transform="Insert" xdt:Locator="Match(key)" />
</appSettings>


</configuration>
```

`src/Arma3BE.Client/App.Release.config`:

```config
<?xml version="1.0"?>
<!-- For more information on using app.config transformation visit http://go.microsoft.com/fwlink/?LinkId=125889 -->
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">
</configuration>
```

`src/Arma3BE.Client/App.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
  </configSections>
  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="Logs/log" />
      <param name="DatePattern" value="_yyyy_MM_dd_HH.\tx\t" />
      <param name="AppendToFile" value="true" />
      <param name="MaxSizeRollBackups" value="90" />
      <param name="RollingStyle" value="Date" />
      <param name="StaticLogFileName" value="false" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%date %logger [%thread] %-5level %message%newline" />
      </layout>
    </appender>


    <appender name="RollingFileAppenderBE" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="Logs/log" />
      <param name="DatePattern" value="_yyyy_MM_dd_HH_BELo\g.\tx\t" />
      <param name="AppendToFile" value="true" />
      <param name="MaxSizeRollBackups" value="90" />
      <param name="RollingStyle" value="Date" />
      <param name="StaticLogFileName" value="false" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%date [%thread] %-5level %message%newline" />
      </layout>
    </appender>

    <appender name="RollingFileAppenderSQL" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="Logs/log" />
      <param name="DatePattern" value="_yyyy_MM_dd_HH_SQLLo\g.\tx\t" />
      <param name="AppendToFile" value="true" />
      <param name="MaxSizeRollBackups" value="90" />
      <param name="RollingStyle" value="Date" />
      <param name="StaticLogFileName" value="false" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%date [%thread] %-5level %message%newline" />
      </layout>
    </appender>

    <appender name="DebugAppender" type="log4net.Appender.DebugAppender">
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date{dd.MM.yyyy HH:mm:ss.ffff} [%thread] %level %logger%exception - %message%newline" />
      </layout>
    </appender>

    <root>
      <level value="ALL" />
      <appender-ref ref="RollingFileAppender" />
      <appender-ref ref="DebugAppender" />
    </root>

    <logger additivity="false" name="Arma3BE.Server">
      <level value="All" />
      <appender-ref ref="RollingFileAppenderBE" />
    </logger>

    <logger additivity="false" name="Arma3BEClient.Libs">
      <level value="All" />
      <appender-ref ref="RollingFileAppenderSQL" />
    </logger>

  </log4net>
  <connectionStrings>
    <!--<add name="Arma3BEClientEntities" connectionString="metadata=res://*/Model.DbModel.csdl|res://*/Model.DbModel.ssdl|res://*/Model.DbModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=serv;initial catalog=Arma3BEClient;persist security info=True;user id=sa;password=12qw!@QW;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />-->
    <add name="Arma3BEClientEntities" providerName="System.Data.SqlServerCe.4.0" connectionString="Data Source=Database.sdf" />
  </connectionStrings>
  <appSettings>
    <!--<add key="IPServicePattern" value="http://ip-api.com/line/{0}" />-->
    <!--<add key="IPServicePattern" value="http://freegeoip.net/xml/{0}" />-->
    <add key="IPServicePattern" value="http://ipinfo.io/{0}" />
  </appSettings>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" />
  </startup>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Practices.ServiceLocation" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-1.3.0.0" newVersion="1.3.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Xceed.Wpf.AvalonDock" publicKeyToken="3e4669d2f30244f4" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.2.0.0" newVersion="2.2.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-10.0.0.0" newVersion="10.0.0.0" />
      </dependentAssembly>           
    </assemblyBinding>
  </runtime>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="System.Data.SqlServerCe.4.0" />
      </parameters>
    </defaultConnectionFactory>
    <providers>
      <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
      <provider invariantName="System.Data.SqlServerCe.4.0" type="System.Data.Entity.SqlServerCompact.SqlCeProviderServices, EntityFramework.SqlServerCompact" />
    </providers>
  </entityFramework>
  <system.data>
    <DbProviderFactories>
      <remove invariant="System.Data.SqlServerCe.4.0" />
      <add name="Microsoft SQL Server Compact Data Provider 4.0" invariant="System.Data.SqlServerCe.4.0" description=".NET Framework Data Provider for Microsoft SQL Server Compact" type="System.Data.SqlServerCe.SqlCeProviderFactory, System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    </DbProviderFactories>
  </system.data>
</configuration>

```

`src/Arma3BE.Client/App.xaml`:

```xaml
<Application x:Class="Arma3BEClient.App" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             d1p1:Ignorable="d"
             xmlns:d1p1="http://schemas.openxmlformats.org/markup-compatibility/2006"
             DispatcherUnhandledException="App_OnDispatcherUnhandledException">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Arma3BE.Client.Styles;component/Icons.xaml"></ResourceDictionary>
                <ResourceDictionary Source="/Arma3BE.Client.Styles;component/Styles.xaml"></ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Application.Resources>
</Application>
```

`src/Arma3BE.Client/App.xaml.cs`:

```cs
using Arma3BEClient.Common.Logging;
using System.Windows;
using System.Windows.Threading;

namespace Arma3BEClient
{
    /// <summary>
    ///     Interaction logic for App.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class App : Application
    {
        protected override void OnStartup(StartupEventArgs e)
        {
            base.OnStartup(e);
            var boostrapper = new Bootstrapper();
            boostrapper.Run();
        }

        private readonly ILog _logger = new Log();

        protected override void OnExit(ExitEventArgs e)
        {
            base.OnExit(e);
            _logger.Info("Exit");
        }

        private void App_OnDispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)
        {
            _logger.Fatal(e.Exception);
            e.Handled = true;
        }
    }
}
```

`src/Arma3BE.Client/Arma3BE.Client.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{46B9AF55-01D0-45B0-95CB-16F5B61A9F03}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BEClient</RootNamespace>
    <AssemblyName>Arma3BEClient</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <SccProjectName>
    </SccProjectName>
    <SccLocalPath>
    </SccLocalPath>
    <SccAuxPath>
    </SccAuxPath>
    <SccProvider>
    </SccProvider>
    <IsWebBootstrapper>false</IsWebBootstrapper>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\</SolutionDir>
    <TargetFrameworkProfile />
    <PublishUrl>D:\temp\be\</PublishUrl>
    <Install>true</Install>
    <InstallFrom>Disk</InstallFrom>
    <UpdateEnabled>false</UpdateEnabled>
    <UpdateMode>Foreground</UpdateMode>
    <UpdateInterval>7</UpdateInterval>
    <UpdateIntervalUnits>Days</UpdateIntervalUnits>
    <UpdatePeriodically>false</UpdatePeriodically>
    <UpdateRequired>false</UpdateRequired>
    <MapFileExtensions>true</MapFileExtensions>
    <ApplicationRevision>1</ApplicationRevision>
    <ApplicationVersion>1.0.0.%2a</ApplicationVersion>
    <UseApplicationTrust>false</UseApplicationTrust>
    <PublishWizardCompleted>true</PublishWizardCompleted>
    <BootstrapperEnabled>true</BootstrapperEnabled>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <RunCodeAnalysis>false</RunCodeAnalysis>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestCertificateThumbprint>5A473E09BA13D6092B9155C644D0ACE668B59811</ManifestCertificateThumbprint>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestKeyFile>Arma3BEClient_TemporaryKey.pfx</ManifestKeyFile>
  </PropertyGroup>
  <PropertyGroup>
    <GenerateManifests>true</GenerateManifests>
  </PropertyGroup>
  <PropertyGroup>
    <SignManifests>false</SignManifests>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationIcon>main.ico</ApplicationIcon>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
      <HintPath>..\packages\EntityFramework.6.1.3\lib\net45\EntityFramework.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="EntityFramework.SqlServer, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
      <HintPath>..\packages\EntityFramework.6.1.3\lib\net45\EntityFramework.SqlServer.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="EntityFramework.SqlServerCompact, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
      <HintPath>..\packages\EntityFramework.SqlServerCompact.6.1.3\lib\net45\EntityFramework.SqlServerCompact.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="log4net, Version=2.0.8.0, Culture=neutral, PublicKeyToken=669e0ddf0bb1aa2a, processorArchitecture=MSIL">
      <HintPath>..\packages\log4net.2.0.8\lib\net45-full\log4net.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.ServiceLocation, Version=1.3.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\CommonServiceLocator.1.3\lib\portable-net4+sl5+netcore45+wpa81+wp8\Microsoft.Practices.ServiceLocation.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.Configuration.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Practices.Unity.RegistrationByConvention, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6d32ff45e0ccc69f, processorArchitecture=MSIL">
      <HintPath>..\packages\Unity.4.0.1\lib\net45\Microsoft.Practices.Unity.RegistrationByConvention.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Unity.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Unity.6.3.0\lib\net45\Prism.Unity.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Prism.Wpf, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\Prism.Wpf.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.ComponentModel.DataAnnotations" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Data" />
    <Reference Include="System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.SqlServer.Compact.4.0.8876.1\lib\net40\System.Data.SqlServerCe.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Wpf.6.3.0\lib\net45\System.Windows.Interactivity.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
  </ItemGroup>
  <ItemGroup>
    <ApplicationDefinition Include="App.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </ApplicationDefinition>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Bootstrapper.cs" />
    <Compile Include="Shell.xaml.cs">
      <DependentUpon>Shell.xaml</DependentUpon>
    </Compile>
    <Compile Include="App.xaml.cs">
      <DependentUpon>App.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
    <Page Include="Shell.xaml">
      <SubType>Designer</SubType>
      <Generator>MSBuild:Compile</Generator>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
    </Compile>
    <Resource Include="main.ico" />
    <SplashScreen Include="SplashScreen.png" />
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Content Include="control.ps1">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </Content>
    <None Include="App.Debug.config">
      <DependentUpon>App.config</DependentUpon>
    </None>
    <None Include="App.Release.config">
      <DependentUpon>App.config</DependentUpon>
    </None>
    <None Include="packages.config" />
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <AppDesigner Include="Properties\" />
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj">
      <Project>{b58670e5-011f-4318-964e-35c8b63870a5}</Project>
      <Name>Arma3BE.Client.Infrastructure</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{E5240A50-E944-4F50-A353-2E3C9E547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.AdminsModule\Arma3BE.Client.Modules.AdminsModule.csproj">
      <Project>{50e80fcc-87bd-4982-901e-38fd22482d02}</Project>
      <Name>Arma3BE.Client.Modules.AdminsModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.BanModule\Arma3BE.Client.Modules.BanModule.csproj">
      <Project>{b9350497-d13c-4a2b-b4f9-51c53d28a55a}</Project>
      <Name>Arma3BE.Client.Modules.BanModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.BEServerModule\Arma3BE.Client.Modules.BEServerModule.csproj">
      <Project>{35dba2b4-0519-44cf-ba45-7aa6754866fd}</Project>
      <Name>Arma3BE.Client.Modules.BEServerModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.ChatModule\Arma3BE.Client.Modules.ChatModule.csproj">
      <Project>{49e36c5f-4a81-4338-8a34-c0e52fcfa5dc}</Project>
      <Name>Arma3BE.Client.Modules.ChatModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.CoreModule\Arma3BE.Client.Modules.CoreModule.csproj">
      <Project>{308eef0c-5de3-435e-8249-7a658bfafd08}</Project>
      <Name>Arma3BE.Client.Modules.CoreModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.IndicatorsModule\Arma3BE.Client.Modules.IndicatorsModule.csproj">
      <Project>{dee7ad82-5abd-4a16-90fa-b46da96f3049}</Project>
      <Name>Arma3BE.Client.Modules.IndicatorsModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.MainModule\Arma3BE.Client.Modules.MainModule.csproj">
      <Project>{58dbdf91-7ad0-4780-a3ef-0fa5c39e2869}</Project>
      <Name>Arma3BE.Client.Modules.MainModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.ManageServerModule\Arma3BE.Client.Modules.ManageServerModule.csproj">
      <Project>{da176f41-7db9-4678-868b-c585c95cb48e}</Project>
      <Name>Arma3BE.Client.Modules.ManageServerModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.NetModule\Arma3BE.Client.Modules.NetModule.csproj">
      <Project>{e7c5ab59-5824-40ea-ae0c-f8c75b6c919c}</Project>
      <Name>Arma3BE.Client.Modules.NetModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.OnlinePlayersModule\Arma3BE.Client.Modules.OnlinePlayersModule.csproj">
      <Project>{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}</Project>
      <Name>Arma3BE.Client.Modules.OnlinePlayersModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.OptionsModule\Arma3BE.Client.Modules.OptionsModule.csproj">
      <Project>{09d6c875-0877-40b7-b52c-7fa0476c1d5d}</Project>
      <Name>Arma3BE.Client.Modules.OptionsModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.PlayersModule\Arma3BE.Client.Modules.PlayersModule.csproj">
      <Project>{cd6c99be-b22b-4b78-ae37-a7561e1ff837}</Project>
      <Name>Arma3BE.Client.Modules.PlayersModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.SteamModule\Arma3BE.Client.Modules.SteamModule.csproj">
      <Project>{6ce098a8-dff1-4c66-ad16-909903945e2b}</Project>
      <Name>Arma3BE.Client.Modules.SteamModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Modules.ToolsModule\Arma3BE.Client.Modules.ToolsModule.csproj">
      <Project>{57ef9e36-98d1-4dfe-a56b-ade958bab019}</Project>
      <Name>Arma3BE.Client.Modules.ToolsModule</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Styles\Arma3BE.Client.Styles.csproj">
      <Project>{cf43b82b-1f25-4385-b315-ab7b4c010a4b}</Project>
      <Name>Arma3BE.Client.Styles</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Client.Updater\Arma3BE.Client.Updater.csproj">
      <Project>{9ade6790-cedc-43f0-8920-54afffb2646e}</Project>
      <Name>Arma3BE.Client.Updater</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{d507e532-7de6-4028-9dbe-aa76c54cc92a}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup />
  <ItemGroup>
    <BootstrapperPackage Include=".NETFramework,Version=v4.5">
      <Visible>False</Visible>
      <ProductName>Microsoft .NET Framework 4.5 %28x86 and x64%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Client.3.5">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1 Client Profile</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <PropertyGroup>
    <PostBuildEvent>
    if not exist "$(TargetDir)x86" md "$(TargetDir)x86"
    xcopy /s /y "$(SolutionDir)packages\Microsoft.SqlServer.Compact.4.0.8876.1\NativeBinaries\x86\*.*" "$(TargetDir)x86"
    if not exist "$(TargetDir)amd64" md "$(TargetDir)amd64"
    xcopy /s /y "$(SolutionDir)packages\Microsoft.SqlServer.Compact.4.0.8876.1\NativeBinaries\amd64\*.*" "$(TargetDir)amd64"</PostBuildEvent>
  </PropertyGroup>
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
  <UsingTask TaskName="TransformXml" AssemblyFile="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)\Web\Microsoft.Web.Publishing.Tasks.dll" />
  <Target Name="AfterCompile" Condition="Exists('App.$(Configuration).config')">
    <!--Generate transformed app config in the intermediate directory-->
    <TransformXml Source="App.config" Destination="$(IntermediateOutputPath)$(TargetFileName).config" Transform="App.$(Configuration).config" />
    <!--Force build process to use the transformed configuration file from now on.-->
    <ItemGroup>
      <AppConfigWithTargetPath Remove="App.config" />
      <AppConfigWithTargetPath Include="$(IntermediateOutputPath)$(TargetFileName).config">
        <TargetPath>$(TargetFileName).config</TargetPath>
      </AppConfigWithTargetPath>
    </ItemGroup>
  </Target>
  <!--Override After Publish to support ClickOnce AfterPublish. Target replaces the untransformed config file copied to the deployment directory with the transformed one.-->
  <Target Name="AfterPublish">
    <PropertyGroup>
      <DeployedConfig>$(_DeploymentApplicationDir)$(TargetName)$(TargetExt).config$(_DeploymentFileMappingExtension)</DeployedConfig>
    </PropertyGroup>
    <!--Publish copies the untransformed App.config to deployment directory so overwrite it-->
    <Copy Condition="Exists('$(DeployedConfig)')" SourceFiles="$(IntermediateOutputPath)$(TargetFileName).config" DestinationFiles="$(DeployedConfig)" />
  </Target>
</Project>
```

`src/Arma3BE.Client/Bootstrapper.cs`:

```cs
using Arma3BE.Client.Modules.AdminsModule;
using Arma3BE.Client.Modules.BanModule;
using Arma3BE.Client.Modules.BEServerModule;
using Arma3BE.Client.Modules.ChatModule;
using Arma3BE.Client.Modules.CoreModule;
using Arma3BE.Client.Modules.IndicatorsModule;
using Arma3BE.Client.Modules.MainModule;
using Arma3BE.Client.Modules.ManageServerModule;
using Arma3BE.Client.Modules.NetModule;
using Arma3BE.Client.Modules.OnlinePlayersModule;
using Arma3BE.Client.Modules.OptionsModule;
using Arma3BE.Client.Modules.PlayersModule;
using Arma3BE.Client.Modules.SteamModule;
using Arma3BE.Client.Modules.ToolsModule;
using Arma3BEClient.Common.Logging;
using log4net.Config;
using Microsoft.Practices.Unity;
using Prism.Logging;
using Prism.Modularity;
using Prism.Regions;
using Prism.Unity;
using System;
using System.Diagnostics;
using System.Windows;

namespace Arma3BEClient
{
    public class Bootstrapper : UnityBootstrapper
    {
        protected override DependencyObject CreateShell()
        {
            return Container.Resolve<Shell>();
        }

        protected override void InitializeShell()
        {
            XmlConfigurator.Configure();

            base.InitializeShell();

            Application.Current.MainWindow = (Window)Shell;
            Application.Current.MainWindow.Show();
        }

        protected override void ConfigureModuleCatalog()
        {
            base.ConfigureModuleCatalog();

            AddModule(typeof(CoreModuleInit));
            AddModule(typeof(NetModuleInit));
            AddModule(typeof(OptionsModuleInit));
            AddModule(typeof(ToolsModuleInit));
            AddModule(typeof(BEServerModuleInit));
            AddModule(typeof(PlayersModuleInit));
            AddModule(typeof(BanModuleInit));
            AddModule(typeof(AdminsModuleInit));
            AddModule(typeof(ChatModuleInit));
            AddModule(typeof(ManageServerModuleInit));
            AddModule(typeof(OnlinePlayersModuleInit));
            AddModule(typeof(SteamModuleInit));
            AddModule(typeof(IndicatorsModuleInit));
            AddModule(typeof(MainModuleInit));
        }

        private void AddModule(Type initType)
        {
            ModuleCatalog.AddModule(
              new ModuleInfo()
              {
                  ModuleName = initType.Name,
                  ModuleType = initType.AssemblyQualifiedName,
              });
        }

        protected override RegionAdapterMappings ConfigureRegionAdapterMappings()
        {
            // Call base method
            var mappings = base.ConfigureRegionAdapterMappings();
            if (mappings == null) return null;

            MainModuleInit.CreateRegionAdapterMappings(mappings);

            // Add custom mappings
            //mappings.RegisterMapping(typeof(DockingManager),
            //    ServiceLocator.Current.GetInstance<AvalonDockRegionAdapter>());

            // Set return value
            return mappings;
        }

        protected override ILoggerFacade CreateLogger()
        {
            return new CustomLogger();
        }

        private class CustomLogger : ILoggerFacade
        {
            private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);


            public void Log(string message, Category category, Priority priority)
            {
                switch (category)
                {
                    case Category.Debug:
                        _log.Debug($"({priority}) - {message}");
                        break;
                    case Category.Exception:
                        _log.Error($"({priority}) - {message}");
                        break;
                    case Category.Info:
                        _log.Info($"({priority}) - {message}");
                        break;
                    case Category.Warn:
                        _log.Info($"({priority}) - {message}");
                        break;
                    default:
                        throw new ArgumentOutOfRangeException(nameof(category), category, null);
                }
            }
        }
    }
}
```

`src/Arma3BE.Client/Properties/Resources.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Arma3BEClient.Properties {
    using System;
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "15.0.0.0")]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if (object.ReferenceEquals(resourceMan, null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("Arma3BEClient.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}

```

`src/Arma3BE.Client/Properties/Resources.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>
```

`src/Arma3BE.Client/Properties/Settings.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Arma3BEClient.Properties {
    
    
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "15.5.0.0")]
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}

```

`src/Arma3BE.Client/Properties/Settings.settings`:

```settings
<?xml version='1.0' encoding='utf-8'?>

<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>
```

`src/Arma3BE.Client/Shell.xaml`:

```xaml
<Window x:Class="Arma3BEClient.Shell"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Arma3BEClient"
        xmlns:regions="http://prismlibrary.com/"
        xmlns:inf="clr-namespace:Arma3BE.Client.Infrastructure;assembly=Arma3BE.Client.Infrastructure"
        xmlns:windows="clr-namespace:Arma3BE.Client.Infrastructure.Windows;assembly=Arma3BE.Client.Infrastructure"
        mc:Ignorable="d"
        Height="600"
        Width="800"
        Icon="{StaticResource main_icon}"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <ContentControl regions:RegionManager.RegionName="{x:Static inf:RegionNames.MainRegionRegion}" ></ContentControl>
    </Grid>
</Window>


```

`src/Arma3BE.Client/Shell.xaml.cs`:

```cs
using System.Reflection;
using System.Windows;

namespace Arma3BEClient
{
    /// <summary>
    /// Interaction logic for Shell.xaml
    /// </summary>
    // ReSharper disable once RedundantExtendsListEntry
    public partial class Shell : Window
    {
        public Shell()
        {
            InitializeComponent();

            var version = Assembly.GetExecutingAssembly().GetName().Version;
            var title = $"TEHGAM.COM - Arma 3 BattlEye Tool v.{version.Major}.{version.Minor}.{version.Build}";
            Title = title;
        }
    }
}

```

`src/Arma3BE.Client/control.ps1`:

```ps1
do
{
Start-Process Arma3BEClient.exe
Start-Sleep -s 10800
Stop-Process -processname Arma3BEClient
Start-Sleep -s 5
}
while($true)

// set-executionpolicy remotesigned
```

`src/Arma3BE.Client/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="CommonServiceLocator" version="1.3" targetFramework="net45" />
  <package id="EntityFramework" version="6.1.3" targetFramework="net452" />
  <package id="EntityFramework.SqlServerCompact" version="6.1.3" targetFramework="net452" />
  <package id="log4net" version="2.0.8" targetFramework="net452" />
  <package id="Microsoft.SqlServer.Compact" version="4.0.8876.1" targetFramework="net452" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Unity" version="6.3.0" targetFramework="net452" />
  <package id="Prism.Wpf" version="6.3.0" targetFramework="net452" />
  <package id="Unity" version="4.0.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Common/Arma3BE.Common.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{D507E532-7DE6-4028-9DBE-AA76C54CC92A}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BEClient.Common</RootNamespace>
    <AssemblyName>Arma3BEClient.Common</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <SccProjectName>
    </SccProjectName>
    <SccLocalPath>
    </SccLocalPath>
    <SccAuxPath>
    </SccAuxPath>
    <SccProvider>
    </SccProvider>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\</SolutionDir>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <RunCodeAnalysis>false</RunCodeAnalysis>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="log4net, Version=2.0.8.0, Culture=neutral, PublicKeyToken=669e0ddf0bb1aa2a, processorArchitecture=MSIL">
      <HintPath>..\packages\log4net.2.0.8\lib\net45-full\log4net.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Net" />
    <Reference Include="System.Runtime.Caching" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Attributes\ShowInUIAttribute.cs" />
    <Compile Include="Core\DisposeObject.cs" />
    <Compile Include="Core\ICache.cs" />
    <Compile Include="Extensions\EnumerableExtensions.cs" />
    <Compile Include="Extensions\IntExtensions.cs" />
    <Compile Include="Extensions\LogExtensions.cs" />
    <Compile Include="Extensions\StringExtensions.cs" />
    <Compile Include="Logging\ILog.cs" />
    <Compile Include="Logging\Log.cs" />
    <Compile Include="Logging\LogFactory.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Common/Attributes/ShowInUIAttribute.cs`:

```cs
using System;

namespace Arma3BEClient.Common.Attributes
{
    [AttributeUsage(AttributeTargets.Property)]
    public class ShowInUiAttribute : Attribute
    {
    }


    [AttributeUsage(AttributeTargets.Property)]
    public class EnableCopyAttribute : Attribute
    {
    }
}
```

`src/Arma3BE.Common/Core/DisposeObject.cs`:

```cs
using System;

namespace Arma3BEClient.Common.Core
{
    public abstract class DisposeObject : IDisposable
    {
        private bool _disposed;

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        ~DisposeObject()
        {
            Dispose(false);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (_disposed)
                return;

            if (disposing)
            {
                DisposeManagedResources();
            }
            DisposeUnManagedResources();
            _disposed = true;
        }

        protected virtual void DisposeManagedResources()
        {
        }

        protected virtual void DisposeUnManagedResources()
        {
        }
    }
}
```

`src/Arma3BE.Common/Core/ICache.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Caching;

namespace Arma3BEClient.Common.Core
{
    public interface ICache<T>
    {
        void Add(string key, T value);
        void Remove(string key);
        T Get(string key);
        T[] GetAll();
        T[] GetAll(IEnumerable<string> keys);
    }

    public interface ICacheFactory
    {
        ICache<T> CreateCache<T>(TimeSpan expireTIme);
    }

    internal class Cache<T> : ICache<T>
    {
        readonly MemoryCache _cache = new MemoryCache(Guid.NewGuid().ToString());
        readonly TimeSpan _expireTime;

        public Cache(TimeSpan expireTime)
        {
            _expireTime = expireTime;
        }

        public void Add(string key, T value)
        {
            var cacheItem = new CacheItem(key, value);
            // Ваши политики протухания кеша
            //var policy = new CacheItemPolicy() { SlidingExpiration = _expireTime };
            var policy = new CacheItemPolicy { SlidingExpiration = _expireTime };
            _cache.Add(cacheItem, policy);
        }

        public void Remove(string key)
        {
            _cache.Remove(key);
        }

        public T Get(string key)
        {
            var item = _cache.GetCacheItem(key);
            var ii = _cache[key];
            return (T)_cache.Get(key);
        }

        public T[] GetAll()
        {
            return _cache.Select(x => x.Value).OfType<T>().ToArray();
        }

        public T[] GetAll(IEnumerable<string> keys)
        {
            return _cache.GetValues(keys)?.Values?.OfType<T>().ToArray() ?? new T[0];
        }
    }

    public class CacheFactory : ICacheFactory
    {
        public ICache<T> CreateCache<T>(TimeSpan expireTIme)
        {
            return new Cache<T>(expireTIme);
        }
    }
}
```

`src/Arma3BE.Common/Extensions/EnumerableExtensions.cs`:

```cs
using System.Collections.Generic;
using System.Linq;

namespace Arma3BEClient.Common.Extensions
{
    public static class EnumerableExtensions
    {
        public static IEnumerable<T[]> Paged<T>(this IEnumerable<T> list, int pageSize)
        {
            var result = new List<T[]>();

            var page = new List<T>();

            foreach (var item in list)
            {
                page.Add(item);
                if (page.Count == pageSize)
                {
                    result.Add(page.ToArray());
                    page = new List<T>();
                }
            }

            if (page.Any())
            {
                result.Add(page.ToArray());
            }

            return result;
        }
    }
}
```

`src/Arma3BE.Common/Extensions/IntExtensions.cs`:

```cs
namespace Arma3BEClient.Common.Extensions
{
    public static class IntExtensions
    {
        public static int FromString(this string source, int defaultValue = 0)
        {
            if (string.IsNullOrEmpty(source)) return defaultValue;
            int v;
            if (int.TryParse(source, out v))
                return v;
            return defaultValue;
        }
    }
}
```

`src/Arma3BE.Common/Extensions/LogExtensions.cs`:

```cs
using System;
using System.Diagnostics;
using System.Runtime.CompilerServices;
using Arma3BEClient.Common.Logging;

namespace Arma3BEClient.Common.Extensions
{
    public static class LogExtensions
    {
        public static IDisposable Time(this ILog log, string message = "", [CallerMemberName] string member = "",
            [CallerFilePath] string file = "", [CallerLineNumber] int lineNumber = 0)
        {
            var sw = new Stopwatch();
            sw.Start();
            return new DisposableAction(() =>
            {
                sw.Stop();
                log.Info($"TIME: {sw.Elapsed} FOR {file}:{lineNumber} {member} {message}");
            });
        }

        private class DisposableAction : IDisposable
        {
            private readonly Action _action;

            public DisposableAction(Action action)
            {
                _action = action;
            }

            public void Dispose()
            {
                _action();
            }
        }
    }
}
```

`src/Arma3BE.Common/Extensions/StringExtensions.cs`:

```cs
namespace Arma3BEClient.Common.Extensions
{
    public static class StringExtensions
    {
        public static bool IsGuid(this string str)
        {
            if (string.IsNullOrEmpty(str)) return false;
            if (str.Length != 32) return false;
            foreach (var c in str)
            {
                if (!char.IsLetterOrDigit(c)) return false;
                if (char.IsLetter(c) && char.IsUpper(c)) return false;
            }
            return true;
        }
    }
}
```

`src/Arma3BE.Common/Logging/ILog.cs`:

```cs
namespace Arma3BEClient.Common.Logging
{
    public interface ILog
    {
        void Debug(object message);
        void Info(object message);
        void Error(object message);
        void Fatal(object message);
    }
}
```

`src/Arma3BE.Common/Logging/Log.cs`:

```cs
using log4net;
using System;
using System.Diagnostics;

namespace Arma3BEClient.Common.Logging
{
    public class Log : ILog
    {
        private readonly log4net.ILog _log;

        public Log()
        {
            _log = LogManager.GetLogger(typeof(Log));
        }

        public Log(Type targetType)
        {
            _log = LogManager.GetLogger(targetType);
        }

        #region Implementation of ILog

        public void Debug(object message)
        {
            DebugConditional(message);
        }

        [Conditional("DEBUG")]
        private void DebugConditional(object message)
        {
            _log.Debug(message);
        }


        public void Info(object message)
        {
            _log.Info(message);
        }

        public void Error(object message)
        {
            _log.Error(message);
        }

        public void Fatal(object message)
        {
            _log.Fatal(message);
        }

        #endregion
    }
}
```

`src/Arma3BE.Common/Logging/LogFactory.cs`:

```cs
using System;

namespace Arma3BEClient.Common.Logging
{
    public static class LogFactory
    {
        public static ILog Create(Type owner)
        {
            return new Log(owner);
        }
    }
}
```

`src/Arma3BE.Common/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="log4net" version="2.0.8" targetFramework="net452" />
</packages>
```

`src/Arma3BE.Server/Abstract/IBEServer.cs`:

```cs
using Arma3BE.Server.Models;
using System;
using System.Collections.Generic;

namespace Arma3BE.Server.Abstract
{
    public interface IBEServer : IDisposable
    {
        bool Connected { get; }
        //bool Disposed { get; }
        event EventHandler<BEClientEventArgs<IEnumerable<Player>>> PlayerHandler;
        event EventHandler<BEClientEventArgs<IEnumerable<Ban>>> BanHandler;
        event EventHandler<BEClientEventArgs<IEnumerable<Admin>>> AdminHandler;
        event EventHandler<BEClientEventArgs<IEnumerable<Mission>>> MissionHandler;
        event EventHandler<ChatMessage> ChatMessageHandler;
        event EventHandler<LogMessage> RConAdminLog;
        event EventHandler<LogMessage> PlayerLog;
        event EventHandler<LogMessage> BanLog;
        event EventHandler ConnectHandler;
        event EventHandler ConnectingHandler;
        event EventHandler DisconnectHandler;
        event EventHandler MessageHandler;

        //Task SendCommandAsync(CommandType type, string parameters = null);
        void SendCommand(CommandType type, string parameters = null);
        void SendCommand(string command);

        void Connect();
        void Disconnect();
    }
}
```

`src/Arma3BE.Server/Abstract/IBattlEyeServer.cs`:

```cs
using BattleNET;
using System;

namespace Arma3BE.Server.Abstract
{
    public interface IBattlEyeServer : IDisposable
    {
        bool Connected { get; }
        int SendCommand(BattlEyeCommand command, string parameters = "");
        int SendCommand(string command);
        void Disconnect();
        event BattlEyeMessageEventHandler BattlEyeMessageReceived;
        event BattlEyeConnectEventHandler BattlEyeConnected;
        event BattlEyeDisconnectEventHandler BattlEyeDisconnected;
        BattlEyeConnectionResult Connect();
    }
}
```

`src/Arma3BE.Server/Abstract/IBattlEyeServerFactory.cs`:

```cs
using BattleNET;

namespace Arma3BE.Server.Abstract
{
    public interface IBattlEyeServerFactory
    {
        IBattlEyeServer Create(BattlEyeLoginCredentials credentials);
    }
}
```

`src/Arma3BE.Server/Abstract/IServerMessageRecognizer.cs`:

```cs
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;

namespace Arma3BE.Server.Abstract
{
    public interface IServerMessageRecognizer
    {
        // ReSharper disable once UnusedParameter.Global
        ServerMessageType GetMessageType(ServerMessage message);
        bool CanRecognize(ServerMessage serverMessage);
    }
}


```

`src/Arma3BE.Server/Arma3BE.Server.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{992FAB3C-6505-41E4-A4D0-4D0657661695}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BE.Server</RootNamespace>
    <AssemblyName>Arma3BE.Server</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <CodeAnalysisIgnoreGeneratedCode>true</CodeAnalysisIgnoreGeneratedCode>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="Mocks\MockBattleEyeServer.cs" />
    <Compile Include="ServerFactory\BattlEyeServerFactory.cs" />
    <Compile Include="ServerFactory\WatcherBEServerFactory.cs" />
    <Compile Include="ServerDecorators\BattlEyeServerProxy.cs" />
    <Compile Include="ServerDecorators\BEConnectedWatcher.cs" />
    <Compile Include="CommandType.cs" />
    <Compile Include="Abstract\IBattlEyeServer.cs" />
    <Compile Include="Abstract\IBattlEyeServerFactory.cs" />
    <Compile Include="Abstract\IBEServer.cs" />
    <Compile Include="Recognizers\AdminListRecognizer.cs" />
    <Compile Include="Recognizers\BanListRecognizer.cs" />
    <Compile Include="Recognizers\BanLogRecognizer.cs" />
    <Compile Include="Recognizers\ChatMessageRecognizer.cs" />
    <Compile Include="Abstract\IServerMessageRecognizer.cs" />
    <Compile Include="Recognizers\Core\GUIDValidator.cs" />
    <Compile Include="Recognizers\Core\IPAndPortValidator.cs" />
    <Compile Include="Recognizers\MissionsListRecognizer.cs" />
    <Compile Include="Recognizers\PlayerListRecognizer.cs" />
    <Compile Include="Recognizers\PlayerLogRecognizer.cs" />
    <Compile Include="Recognizers\RconAdminLogRecognizer.cs" />
    <Compile Include="Models\Admin.cs" />
    <Compile Include="Models\AdminList.cs" />
    <Compile Include="Models\Ban.cs" />
    <Compile Include="Models\BanList.cs" />
    <Compile Include="Models\ChatMessage.cs" />
    <Compile Include="Messaging\ServerMessageType.cs" />
    <Compile Include="Models\Mission.cs" />
    <Compile Include="Models\MissionList.cs" />
    <Compile Include="Models\Player.cs" />
    <Compile Include="Models\PlayerList.cs" />
    <Compile Include="Models\ServerMessage.cs" />
    <Compile Include="Models\StateList.cs" />
    <Compile Include="BEServer.cs" />
    <Compile Include="ServerDecorators\ThreadSafeBattleEyeServer.cs" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\BattleNET\BattleNET\BattleNET.csproj">
      <Project>{db17061b-3fa9-46d5-acaf-f23693d86b5d}</Project>
      <Name>BattleNET</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Common\Arma3BE.Common.csproj">
      <Project>{D507E532-7DE6-4028-9DBE-AA76C54CC92A}</Project>
      <Name>Arma3BE.Common</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Server/BEServer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using BattleNET;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Net;

// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BE.Server
{
    public sealed class BEServer : DisposeObject, IBEServer
    {
        private readonly IBattlEyeServerFactory _battlEyeServerFactory;
        private readonly string _host;

        private readonly object _lock = new object();
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private readonly string _password;
        private readonly int _port;
        private IBattlEyeServer _battlEyeServer;


        public BEServer(string host, int port, string password, IBattlEyeServerFactory battlEyeServerFactory)
        {
            _host = host;
            _port = port;
            _password = password;
            _battlEyeServerFactory = battlEyeServerFactory;

            InitClients();
        }

        // ReSharper disable once MemberCanBePrivate.Global
        public bool Disposed { get; set; }

        public bool Connected => _battlEyeServer != null && _battlEyeServer.Connected;

        public event EventHandler<BEClientEventArgs<IEnumerable<Player>>> PlayerHandler;
        public event EventHandler<BEClientEventArgs<IEnumerable<Ban>>> BanHandler;
        public event EventHandler<BEClientEventArgs<IEnumerable<Admin>>> AdminHandler;
        public event EventHandler<BEClientEventArgs<IEnumerable<Mission>>> MissionHandler;

        public event EventHandler<ChatMessage> ChatMessageHandler;


        public event EventHandler<LogMessage> RConAdminLog;
        public event EventHandler<LogMessage> PlayerLog;
        public event EventHandler<LogMessage> BanLog;

        public event EventHandler ConnectHandler;
        public event EventHandler ConnectingHandler;
        public event EventHandler DisconnectHandler;
        public event EventHandler MessageHandler;


        public void SendCommand(string command)
        {
            _log.Info($"SERVER: {_host}:{_port} - TRY TO RCON CUSTOM COMMAND {command}");
            _battlEyeServer.SendCommand(command);
        }

        public void SendCommand(CommandType type, string parameters = null)
        {
            _log.Info($"SERVER: {_host}:{_port} - TRY TO RCON COMMAND {type} WITH PARAMS {parameters}");


            if (!Connected)
            {
                Connect();
                return;
            }

            switch (type)
            {
                case CommandType.Players:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Players);
                    break;
                case CommandType.Bans:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Bans);
                    break;
                case CommandType.Admins:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Admins);
                    break;

                case CommandType.Say:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Say, parameters);
                    break;
                case CommandType.AddBan:
                    if (!string.IsNullOrEmpty(parameters))
                        _battlEyeServer.SendCommand(BattlEyeCommand.AddBan, parameters);
                    break;

                case CommandType.Ban:
                    if (!string.IsNullOrEmpty(parameters))
                        _battlEyeServer.SendCommand(BattlEyeCommand.Ban, parameters);
                    break;

                case CommandType.Kick:
                    if (!string.IsNullOrEmpty(parameters))
                        _battlEyeServer.SendCommand(BattlEyeCommand.Kick, parameters);
                    break;


                case CommandType.RemoveBan:
                    if (!string.IsNullOrEmpty(parameters))
                        _battlEyeServer.SendCommand(BattlEyeCommand.RemoveBan, parameters);
                    break;

                case CommandType.Missions:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Missions);
                    break;

                case CommandType.Mission:
                    if (!string.IsNullOrEmpty(parameters))
                        _battlEyeServer.SendCommand(BattlEyeCommand.Mission, parameters);
                    break;


                case CommandType.Init:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Init);
                    break;

                case CommandType.Shutdown:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Shutdown);
                    break;

                case CommandType.Reassign:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Reassign);
                    break;

                case CommandType.Restart:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Restart);
                    break;


                case CommandType.RestartServer:
                    _battlEyeServer.SendCommand("#restartserver");
                    break;


                case CommandType.Lock:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Lock);
                    break;

                case CommandType.Unlock:
                    _battlEyeServer.SendCommand(BattlEyeCommand.Unlock);
                    break;


                case CommandType.LoadBans:
                    _battlEyeServer.SendCommand(BattlEyeCommand.LoadBans);
                    break;

                case CommandType.LoadEvents:
                    _battlEyeServer.SendCommand(BattlEyeCommand.LoadEvents);
                    break;

                case CommandType.LoadScripts:
                    _battlEyeServer.SendCommand(BattlEyeCommand.LoadScripts);
                    break;
            }
        }

        public void Connect()
        {
            _log.Info($"{_host}:{_port} Update client - connect");

            _battlEyeServer?.Connect();
        }

        public void Disconnect()
        {
            _log.Info($"{_host}:{_port} Update client - Disconnect");
            _battlEyeServer?.Disconnect();
        }


        private void OnMissionHandler(IEnumerable<Mission> e)
        {
            var handler = MissionHandler;
            handler?.Invoke(this, new BEClientEventArgs<IEnumerable<Mission>>(e));
        }

        private void OnBanLog(LogMessage message)
        {
            var handler = BanLog;
            handler?.Invoke(this, message);
        }

        private void OnPlayerLog(LogMessage message)
        {
            var handler = PlayerLog;
            handler?.Invoke(this, message);
        }

        private void OnRConAdminLog(LogMessage message)
        {
            var handler = RConAdminLog;
            handler?.Invoke(this, message);
        }

        private void OnAdminHandler(IEnumerable<Admin> e)
        {
            var handler = AdminHandler;
            handler?.Invoke(this, new BEClientEventArgs<IEnumerable<Admin>>(e));
        }

        private void OnChatMessageHandler(ChatMessage e)
        {
            var handler = ChatMessageHandler;
            handler?.Invoke(this, e);
        }


        private void OnBanHandler(IEnumerable<Ban> e)
        {
            var handler = BanHandler;
            handler?.Invoke(this, new BEClientEventArgs<IEnumerable<Ban>>(e));
        }

        private void OnMessageHandler()
        {
            var handler = MessageHandler;
            handler?.Invoke(this, EventArgs.Empty);
        }

        private void OnDisconnectHandler()
        {
            var handler = DisconnectHandler;
            handler?.Invoke(this, EventArgs.Empty);
        }


        private void OnConnectHandler()
        {
            var handler = ConnectHandler;
            handler?.Invoke(this, EventArgs.Empty);
        }


        private void OnPlayerHandler(IEnumerable<Player> e)
        {
            var handler = PlayerHandler;
            handler?.Invoke(this, new BEClientEventArgs<IEnumerable<Player>>(e));
        }

        private void BattlEyeServerBattlEyeDisconnected(BattlEyeDisconnectEventArgs args)
        {
            OnDisconnectHandler();
        }

        private void BattlEyeServerBattlEyeMessageReceived(BattlEyeMessageEventArgs args)
        {
            try
            {
                var message = new ServerMessage(args.Id, args.Message);

                lock (_lock)
                {
                    ProcessMessage(message);
                    OnMessageHandler();
                }
            }
            catch (Exception e)
            {
                _log.Error(e);
            }
        }

        private void BattlEyeServerBattlEyeConnected(BattlEyeConnectEventArgs args)
        {
            OnConnectHandler();
        }


        private void ProcessMessage(ServerMessage message)
        {
            var logMessage = new LogMessage
            {
                Date = DateTime.UtcNow,
                Message = message.Message
            };

            switch (message.Type)
            {
                case ServerMessageType.PlayerList:
                    var list = new PlayerList(message);
                    OnPlayerHandler(list);
                    break;
                case ServerMessageType.BanList:
                    var banList = new BanList(message);
                    OnBanHandler(banList);
                    break;

                case ServerMessageType.AdminList:
                    var adminList = new AdminList(message);
                    OnAdminHandler(adminList);
                    break;

                case ServerMessageType.MissionList:
                    var missinlist = new MissionList(message);
                    OnMissionHandler(missinlist);
                    break;

                case ServerMessageType.ChatMessage:
                    var chatMessage = new ChatMessage
                    {
                        Date = DateTime.UtcNow,
                        Message = message.Message
                    };

                    OnChatMessageHandler(chatMessage);
                    break;

                case ServerMessageType.RconAdminLog:
                    OnRConAdminLog(logMessage);
                    break;

                case ServerMessageType.PlayerLog:
                    OnPlayerLog(logMessage);
                    break;

                case ServerMessageType.BanLog:
                    OnBanLog(logMessage);
                    break;

                case ServerMessageType.Unknown:
                    //var unknownMessage = new ChatMessage
                    //{
                    //    Date = DateTime.UtcNow,
                    //    Message = message.Message
                    //};

                    //OnChatMessageHandler(unknownMessage);
                    break;
            }

            RegisterMessage(message);
        }

        // ReSharper disable once UnusedParameter.Local
        private void RegisterMessage(ServerMessage message)
        {
            if (message.Type == ServerMessageType.Unknown)
            {
                _log.Info(
                    $"UNKNOWN MESSAGE: message [\nserver ip: {_host}\nmessageId:{message.MessageId}\n{message.Message}\n]");
            }
            // _log.Info($"message [\nserver ip: {_host}\nmessageId:{message.MessageId}\n{message.Message}\n]");
        }

        private void InitClients()
        {
            _log.Info($"{_host}:{_port} Update client - InitClients");
            lock (_lock)
            {
                if (_battlEyeServer != null) ReleaseClient();

                var credentials = new BattlEyeLoginCredentials(IPAddress.Parse(_host), _port, _password);
                _battlEyeServer = _battlEyeServerFactory.Create(credentials);
                _battlEyeServer.BattlEyeConnected += BattlEyeServerBattlEyeConnected;
                _battlEyeServer.BattlEyeDisconnected += BattlEyeServerBattlEyeDisconnected;
                _battlEyeServer.BattlEyeMessageReceived += BattlEyeServerBattlEyeMessageReceived;
            }
        }

        private void ReleaseClient()
        {
            _log.Info($"{_host}:{_port} Update client - ReleaseClient");
            lock (_lock)
            {
                if (_battlEyeServer != null)
                {
                    try
                    {
                        if (_battlEyeServer.Connected) _battlEyeServer.Disconnect();

                        _battlEyeServer.BattlEyeConnected -= BattlEyeServerBattlEyeConnected;
                        _battlEyeServer.BattlEyeDisconnected -= BattlEyeServerBattlEyeDisconnected;
                        _battlEyeServer.BattlEyeMessageReceived -= BattlEyeServerBattlEyeMessageReceived;

                        _battlEyeServer.Dispose();
                    }
                    finally
                    {
                        _battlEyeServer = null;
                    }
                }
            }
        }

        protected override void DisposeUnManagedResources()
        {
            base.DisposeUnManagedResources();
            try
            {
                Disposed = true;
                ReleaseClient();
                GC.SuppressFinalize(this);
            }
            finally
            {
                _battlEyeServer = null;
            }
        }
    }


    public class BEClientEventArgs<T> : EventArgs
    {
        public BEClientEventArgs(T data)
        {
            Data = data;
        }

        public T Data { get; private set; }
    }
}
```

`src/Arma3BE.Server/CommandType.cs`:

```cs
namespace Arma3BE.Server
{
    public enum CommandType
    {
        Players,
        Bans,
        Admins,
        Say,
        AddBan,
        Ban,
        Kick,
        RemoveBan,
        Init,
        Shutdown,
        Reassign,
        Restart,
        RestartServer,
        Lock,
        Unlock,
        Mission,
        Missions,
        RConPassword,
        MaxPing,
        LoadBans,
        LoadScripts,
        LoadEvents
    };
}
```

`src/Arma3BE.Server/Messaging/ServerMessageType.cs`:

```cs
namespace Arma3BE.Server.Messaging
{
    public enum ServerMessageType
    {
        PlayerList,
        BanList,
        AdminList,
        ChatMessage,
        RconAdminLog,
        PlayerLog,
        BanLog,
        MissionList,
        Unknown
    }
}
```

`src/Arma3BE.Server/Mocks/MockBattleEyeServer.cs`:

```cs
using Arma3BE.Server.Abstract;
using BattleNET;
using System;
using System.Threading;
using System.Threading.Tasks;
// ReSharper disable UnusedMember.Local

namespace Arma3BE.Server.Mocks
{
    // ReSharper disable once UnusedMember.Global
    public class MockBattleEyeServer : IBattlEyeServer
    {
        private Timer _timer;

        public MockBattleEyeServer()
        {
            _timer = new Timer(Tick, null, 2000, Timeout.Infinite);
        }

        private void Tick(object state)
        {
            MockMessage($"(Global) bot: Текущее время {DateTime.UtcNow}");
            MockMessage("RCon admin #4 (99.99.99.99:9999) logged in");
            MockMessage("(Unknown) ToxaBes: тест для тима");


            MockMessage("Player #11 RuuT (2838840b88a3001b58f3d59fb03d23a1) has been kicked by BattlEye: Admin Ban ([tim][01.11.16 11:29:06] Teamkill)");

            MockMessage("Player #15 Z11 (8de887bdecc30ad372459776b6d7cb94) has been kicked by BattlEye: Admin Kick ([ReNegadE][05.11.16 11:47:51] )");



            //MockMessage($"Player #12 sanya disconnected");
            //MockMessage($"Player #1 Baz (be1a6a29ee0eb0851b586b2ed97ad110) has been kicked by BattlEye: Client not responding");
            //MockMessage($"Player #19 Gektor (23d1b17ce5e26ce5f69f2bddbe781d9e) has been kicked by BattlEye: Admin Ban ([vosur][15.09.15 15:14:56] Sabotage)");
            //MockMessage($"Player #6 Atamur (002da0e59f61916bc13ef5ef9bfee7e7) has been kicked by BattlEye: Admin Kick ([tim][22.11.15 15:19:44] Flud)");
            //MockMessage($"Player #11 Iteron (46.98.121.255:2304) connected");
            //MockMessage($"Verified GUID (e3807f6355d182b3ecb7eb7cf1540d40) of player #11 Iteron");
            //MockMessage($"Player #21 TipsyOstrich - GUID: c7679b5ec67c557e479a2a5057083a26 (unverified)");

            //MockMessage(GetPlayers());

            _timer?.Change(5000, Timeout.Infinite);
        }


        private int _messageIds;

        private void MockMessage(string message)
        {
            BattlEyeMessageReceived?.Invoke(new BattlEyeMessageEventArgs(message, ++_messageIds));
        }

        public void Dispose()
        {
            DisposeTimer();
        }

        private void DisposeTimer()
        {
            _timer?.Dispose();
            _timer = null;
        }

        public bool Connected { get; private set; }

        public int SendCommand(BattlEyeCommand command, string parameters = "")
        {
            Task.Factory.StartNew(() =>
            {
                MockMessage($"(Global) bot: Sended command {command} with params {parameters}");

                switch (command)
                {
                    case BattlEyeCommand.Players:
                        var pl = GetPlayers();
                        MockMessage(pl);
                        break;
                    case BattlEyeCommand.Bans:
                        MockMessage(bans);
                        break;
                    case BattlEyeCommand.Missions:
                        MockMessage(missions);
                        break;
                    case BattlEyeCommand.Admins:
                        MockMessage(admins);
                        break;
                }

            });

            return 0;
        }

        public int SendCommand(string command)
        {
            Task.Factory.StartNew(() =>
            {
                MockMessage($"(Global) bot: Sended command {command}");
            });

            return 0;
        }

        public void Disconnect()
        {
            Task.Delay(TimeSpan.FromSeconds(2)).ContinueWith(t =>
            {
                Connected = false;
                OnBattlEyeDisconnected(new BattlEyeDisconnectEventArgs(default(BattlEyeLoginCredentials), BattlEyeDisconnectionType.Manual));
            });
        }

        public event BattlEyeMessageEventHandler BattlEyeMessageReceived;
        public event BattlEyeConnectEventHandler BattlEyeConnected;
        public event BattlEyeDisconnectEventHandler BattlEyeDisconnected;

        public BattlEyeConnectionResult Connect()
        {
            Task.Delay(TimeSpan.FromSeconds(2)).ContinueWith(t =>
            {
                Connected = true;
                OnBattlEyeConnected(new BattlEyeConnectEventArgs(default(BattlEyeLoginCredentials), BattlEyeConnectionResult.Success));
            }).ConfigureAwait(false);

            return BattlEyeConnectionResult.Success;
        }

        private static string ChatMessage => $"(Global) bot: Текущее время {DateTime.UtcNow}";


        private static string _prev;
        static string GetPlayers()
        {
            _prev = _prev == players2 ? players : players2;
            return _prev;
        }


        private static string players =
            @"Players on server:
[#] [IP Address]:[Port] [Ping] [GUID] [Name]
--------------------------------------------------
0   46.149.73.255:2304     140  2c65319280ac51b220aef667552a7f06(OK) 0dmin
1   195.64.206.232:50652  205  5b0f07ce2400706dc9b3c7519beb5372(OK) SEGITO
2   81.20.205.242:17319   105  80f14b5add6cad33d5efe876cead577b(OK) Shinku
3   88.214.186.177:62404  435  2b3a3b6556a8c55dbb982de15f936a04(OK) portugalec
4   212.3.137.202:52971   105  2bae76795dc6dde5daf4681946530dcf(OK) DAN
5   78.60.57.242:2304     205  44ecfad5812b18f1cb6fce2ba0656de3(OK) Xenus
6   5.167.178.186:2304    105  ebabb77436d464d69f34741666f2cff3(OK) Free Style
7   83.149.44.204:63055   205  8fd0670162548982c2b780ba0397efeb(OK) Alex
8   128.71.243.56:2304    112  e0ebb4d1c80afc7d4063ace915e4a1b0(OK) FunnyBlooD
9   31.8.2.185:19945      265  bb70b1a929a5c20cb4e4ee04cb3f31da(OK) Renegade
10  37.232.159.82:2354    105  20446897121fafa82c1069ed07820f27(OK) Максим
11  176.213.109.193:2304  134  9d255d146ad8dc7a4aef240f828b1fb2(OK) ГНК
12  90.226.223.35:2304    123  6696c4be65554dd945475f3746bbcfa4(OK) Cheeki Breeki
14  78.60.254.40:2304     123  a0e3a667e2df374b2bcb153f83eaa172(OK) RomaFreemen417
15  128.71.57.216:2304    105  1abb90bd84d47007f1ea369ea1d2f15c(OK) rinat
17  95.56.214.138:11069   205  ac93a589cc1b5b89396caa6f322fb2f3(OK) GhostWarrior
(16 players in total)";


        private static string players2 =
            @"Players on server:
[#] [IP Address]:[Port] [Ping] [GUID] [Name]
--------------------------------------------------
0   46.149.73.255:2304     140  2c65319280ac51b220aef667552a7f06(OK) 0dmin
3   88.214.186.177:62404  435  2b3a3b6556a8c55dbb982de15f936a04(OK) portugalec
4   212.3.137.202:52971   105  2bae76795dc6dde5daf4681946530dcf(OK) DAN
5   78.60.57.242:2304     205  44ecfad5812b18f1cb6fce2ba0656de3(OK) Xenus
6   5.167.178.186:2304    105  ebabb77436d464d69f34741666f2cff3(OK) Free Style
7   83.149.44.204:63055   205  8fd0670162548982c2b780ba0397efeb(OK) Alex
8   128.71.243.56:2304    112  e0ebb4d1c80afc7d4063ace915e4a1b0(OK) FunnyBlooD
9   31.8.2.185:19945      265  bb70b1a929a5c20cb4e4ee04cb3f31da(OK) Renegade
10  37.232.159.82:2354    105  20446897121fafa82c1069ed07820f27(OK) Максим
11  176.213.109.193:2304  134  9d255d146ad8dc7a4aef240f828b1fb2(OK) ГНК
12  90.226.223.35:2304    123  6696c4be65554dd945475f3746bbcfa4(OK) Cheeki Breeki
14  78.60.254.40:2304     123  a0e3a667e2df374b2bcb153f83eaa172(OK) RomaFreemen417
15  128.71.57.216:2304    105  1abb90bd84d47007f1ea369ea1d2f15c(OK) rinat
17  95.56.214.138:11069   205  ac93a589cc1b5b89396caa6f322fb2f3(OK) GhostWarrior
(14 players in total)";

        private static string admins =
            @"Connected RCon admins:
[#] [IP Address]:[Port]
-----------------------------
0 46.149.73.255:58606
1 31.8.2.185:19880
2 109.173.19.42:54771
3 89.70.28.82:49701
";

        private static string missions =
            @"Missions on server:
RF_Liberators_0_0_7.Sara.pbo
RF_partisan_rhs_0_8_5.Takistan.pbo
RF_Liberators_0_0_6.Sara.pbo
RF_SC_VTN_0_4_2.Catalina.pbo
";

        private static string bans =
            @"GUID Bans:
[#] [GUID] [Minutes left] [Reason]
----------------------------------------
0  331e64806b30277076963283eea16438 perm destruction of equipment, TeamKill. Ban perm
1  8ce223565255b304f01ce5c3b3830d77 perm GameHack. Ban perm
2  09905030887961bf10183125880092bf perm TeamKill. Ban perm
3  c20b9665b392c4c7633d14b151a4deb3 perm destruction of equipment. Ban perm
4  d6ca371207002e53d1a7db741e2c3740 perm Teamkill. Ban perm
5  5a63b36a6047baf28e48a409fd905158 perm TeamKill. Ban perm
6  f9f7daec9196ebd1d58f631a6e91dd63 perm TeamKill. Ban perm
7  6690ea0ce46ea8eb1d8b06828ebe2221 perm TeamKill. Ban perm
8  66666bf19cd978145152974f148424cc perm destruction of equipment. Ban perm
9  7489a913db778954e9bddb4b36469a24 perm TeamKill. Ban perm
10 cbed8802b79d73c26c40650e238ef2bf perm destruction of equipment. Ban perm
11 ab7288b7456b83c204588fb80d15f703 perm Troll. Ban perm
12 bfe7fb953c08e74a1da37cd49f1093ac perm friendly Fire. Ban perm
13 bd9e33db2bac6dd0580b86b126e02359 perm friendly Fire. Ban perm
14 9861f6f2ad52ae0892b8277b72de84b0 perm Friendly fire. Ban perm
15 938ff246b4134b2e412ddf0f2b999fac perm TEamKill. Ban perm
16 eee3227c3d7ba3b628a67bc474e23b31 perm TeamKill. Ban perm
17 a2cb6ec7b2b64423f5ea5a22debfdca0 perm TeamKill. Ban perm
18 a1fd7ffb06dec4b7568ee47d8947e05d perm TeamKill. Ban perm
19 c7763411d5073956e7c517b550772f8a perm TeamKIll. Ban perm
20 f1ba3f606626779cd8d76ec73c3e4ef9 perm destruction of equipment. Ban perm
21 9f0e76794c784d6a324dcf7cdccdb06b perm Friendy fire. Ban perm
22 c50eac45236cacbed9fed6428925e542 perm TeamKill. Ban perm
23 baab3c2baea45e4b280bec2f66ef7db6 perm TeamKill. Ban perm
24 bb21173f0492a3e38681b030a6171629 perm friendly Fire. Ban perm
25 143eea8651030f1bedf316b8dd220035 perm friendly Fire. Ban perm
26 761f5bb129d6218d77666d4fab71cca0 perm TeamKill. Ban perm
27 faaba22913ce88e8ac4b7cac12981474 perm TeamKill. Ban perm
28 8306f6d1ae902e1db5411070ee9750f1 perm TeamKill. Ban perm
29 09bc80ebf8f703e905de69d7f804a831 perm TeamKill. Ban perm
30 1911f7800f5578f4921c60bc0858f4e5 perm TeamKill. Ban perm
31 ca1cc768e40080fa755b0c08fca0d791 perm TeamKill. Ban perm
32 efe5b062482125757f5792aaf94d724d perm TeamKill. Ban perm
33 edfaf581f7943535bc61030694262577 perm TeamKill. Ban perm
34 942dea253f71745a96ba60d730f7de86 perm TeamKill. Ban perm

IP Bans:
[#] [IP Address] [Minutes left] [Reason]
----------------------------------------------";

        protected virtual void OnBattlEyeConnected(BattlEyeConnectEventArgs args)
        {
            BattlEyeConnected?.Invoke(args);
        }

        protected virtual void OnBattlEyeDisconnected(BattlEyeDisconnectEventArgs args)
        {
            BattlEyeDisconnected?.Invoke(args);
        }
    }
}
```

`src/Arma3BE.Server/Models/Admin.cs`:

```cs
using Arma3BEClient.Common.Attributes;
using System;
using System.Text.RegularExpressions;

namespace Arma3BE.Server.Models
{
    public class Admin
    {
        private static readonly Regex CompidelRegex =
            new Regex(@"(\d{1,3})[ ]+(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):([\d]+)",
                RegexOptions.Compiled | RegexOptions.IgnoreCase);

        private Admin(int num, string ip, int port)
        {
            Num = num;
            IP = ip;
            Port = port;
        }

        [ShowInUi]
        [EnableCopy]
        public int Num { get; }

        [ShowInUi]
        [EnableCopy]
        public string IP { get; }

        [ShowInUi]
        [EnableCopy]
        public int Port { get; }

        private bool Equals(Admin other)
        {
            return Num == other.Num && string.Equals(IP, other.IP) && Port == other.Port;
        }

        public override int GetHashCode()
        {
            unchecked
            {
                var hashCode = Num;
                hashCode = (hashCode * 397) ^ (IP?.GetHashCode() ?? 0);
                hashCode = (hashCode * 397) ^ Port;
                return hashCode;
            }
        }

        public static Admin Parse(string input)
        {
            try
            {
                var match = CompidelRegex.Match(input);

                if (match.Success || match.Groups.Count != 6)
                {
                    int num;
                    if (!int.TryParse(match.Groups[1].Value, out num)) return null;
                    var ip = match.Groups[2].Value;
                    int port;
                    if (!int.TryParse(match.Groups[3].Value, out port)) return null;
                    return new Admin(num, ip, port);
                }

                return null;
            }
            catch (Exception)
            {
                return null;
            }
        }

        public override bool Equals(object obj)
        {
            if (ReferenceEquals(null, obj)) return false;
            if (ReferenceEquals(this, obj)) return true;
            if (obj.GetType() != GetType()) return false;
            return Equals((Admin)obj);
        }
    }
}
```

`src/Arma3BE.Server/Models/AdminList.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Server.Models
{
    public class AdminList : StateList<Admin>
    {
        public AdminList(ServerMessage message)
            : base(Parse(message.Message))
        {
        }

        private static IEnumerable<Admin> Parse(string text)
        {
            var lines = text.Split(Environment.NewLine.ToCharArray()).ToArray();
            return lines.Select(Admin.Parse).Where(p => p != null).ToList();
        }
    }
}
```

`src/Arma3BE.Server/Models/Ban.cs`:

```cs
using System;
using System.Text.RegularExpressions;

namespace Arma3BE.Server.Models
{
    public class Ban
    {
        private static readonly Regex CompidelRegex = new Regex(@"(\d{1,5})[ ]+([^ ]+)[ ]+([^ ]+)[ ]+(.*)",
            RegexOptions.Compiled | RegexOptions.IgnoreCase);

        private Ban(int num, string guidIp, int minutesleft, string reason)
        {
            Num = num;
            GuidIp = guidIp;
            Minutesleft = minutesleft;
            Reason = reason;
        }

        public int Num { get; }

        public string GuidIp { get; }

        public int Minutesleft { get; }

        public string Reason { get; }

        private bool Equals(Ban other)
        {
            return Num == other.Num && string.Equals(GuidIp, other.GuidIp) && string.Equals(Reason, other.Reason);
        }

        public override int GetHashCode()
        {
            unchecked
            {
                var hashCode = Num;
                hashCode = (hashCode * 397) ^ (GuidIp?.GetHashCode() ?? 0);
                hashCode = (hashCode * 397) ^ Minutesleft;
                hashCode = (hashCode * 397) ^ (Reason?.GetHashCode() ?? 0);
                return hashCode;
            }
        }

        public static Ban Parse(string input)
        {
            try
            {
                var match = CompidelRegex.Match(input);

                if (match.Success || match.Groups.Count != 6)
                {
                    int num;

                    if (!int.TryParse(match.Groups[1].Value, out num)) return null;

                    var guid = match.Groups[2].Value;

                    if (guid.Length != 32) return null;

                    var l = match.Groups[3].Value;

                    var left = l == "perm" ? 0 : (l == "-" ? -1 : -2);
                    if (left == -2)
                    {
                        if (!int.TryParse(l, out left)) return null;
                    }

                    var reason = match.Groups[4].Value;

                    return new Ban(num, guid, left, reason);
                }

                return null;
            }
            catch (Exception)
            {
                return null;
            }
        }

        public override string ToString()
        {
            return $"NUM {Num}\tGUIDIP {GuidIp}\tML {Minutesleft}\tREASON {Reason}";
        }

        public override bool Equals(object obj)
        {
            if (ReferenceEquals(null, obj)) return false;
            if (ReferenceEquals(this, obj)) return true;
            if (obj.GetType() != GetType()) return false;
            return Equals((Ban)obj);
        }
    }
}
```

`src/Arma3BE.Server/Models/BanList.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Server.Models
{
    public class BanList : StateList<Ban>
    {
        public BanList(ServerMessage message)
            : base(Parse(message.Message))
        {
        }

        private static IEnumerable<Ban> Parse(string text)
        {
            var lines = text.Split(Environment.NewLine.ToCharArray()).ToArray();
            return lines.Select(Ban.Parse).Where(p => p != null).ToList();
        }
    }
}
```

`src/Arma3BE.Server/Models/ChatMessage.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Server.Models
{
    public class ChatMessage : MessageBase
    {
        public enum MessageType
        {
            Unknown,
            Side,
            Direct,
            Vehicle,
            Global,
            Group,
            Command,
            RCon,
            NonCommon
        }

        public MessageType Type
        {
            get
            {
                if (Message.StartsWith("(Side)")) return MessageType.Side;
                if (Message.StartsWith("(Vehicle)")) return MessageType.Vehicle;
                if (Message.StartsWith("(Global)")) return MessageType.Global;
                if (Message.StartsWith("(Group)")) return MessageType.Group;
                if (Message.StartsWith("(Command)")) return MessageType.Command;
                if (Message.StartsWith("(Direct)")) return MessageType.Direct;
                if (Message.StartsWith("(Unknown)")) return MessageType.NonCommon;
                if (Message.StartsWith("RCon") &&
                    !Message.Contains("logged in") && !Message.Contains("Connection Lost!")) return MessageType.RCon;

                return MessageType.Unknown;
            }
        }

        public static bool IsImportantMessageProc(ChatMessage message, string[] importantWords)
        {
            if (importantWords == null) return false;
            if (string.IsNullOrEmpty(message.Message)) return false;

            var dict = new HashSet<string>(importantWords.Select(x => x.ToLower()).Distinct());
            var words = new WordParser().Parse(message.Message)
                .Where(x => !string.IsNullOrEmpty(x))
                .Select(x => x.ToLower())
                .Distinct()
                .ToList();
            if (words.Any(x => dict.Contains(x))) return true;
            return false;
        }

        private class WordParser
        {
            public IEnumerable<string> Parse(string input)
            {
                if (string.IsNullOrEmpty(input))
                    throw new ArgumentException(nameof(input));

                var words = new List<string>();

                var list = new List<char>();

                foreach (var c in input)
                {
                    if (char.IsLetterOrDigit(c) || c == '-' || c == '\'')
                    {
                        list.Add(c);
                    }
                    else
                    {
                        var str = new string(list.ToArray());
                        if (CheckWord(str))
                            words.Add(str);
                        list.Clear();
                    }
                }

                if (list.Any())
                {
                    var str = new string(list.ToArray());
                    if (CheckWord(str))
                        words.Add(str);
                }

                return words;
            }

            private bool CheckWord(string word)
            {
                return word.Any(char.IsLetterOrDigit);
            }
        }
    }

    public class LogMessage : MessageBase
    {

    }

    public abstract class MessageBase
    {
        public DateTime Date { get; set; }
        public string Message { get; set; }
    }
}
```

`src/Arma3BE.Server/Models/Mission.cs`:

```cs
using System;

namespace Arma3BE.Server.Models
{
    public class Mission
    {
        private Mission(string name)
        {
            Name = name;
        }

        public string Name { get; }

        public static Mission Parse(string input)
        {
            try
            {
                if (input == "Missions on server:") return null;
                return new Mission(input);
            }
            catch (Exception)
            {
                return null;
            }
        }
    }
}
```

`src/Arma3BE.Server/Models/MissionList.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Server.Models
{
    public class MissionList : StateList<Mission>
    {
        public MissionList(ServerMessage message)
            : base(Parse(message.Message))
        {
        }

        private static IEnumerable<Mission> Parse(string text)
        {
            var lines = text.Split(Environment.NewLine.ToCharArray()).Where(x=>!string.IsNullOrWhiteSpace(x)).ToArray();
            return lines.Select(Mission.Parse).Where(p => p != null).ToList();
        }
    }
}
```

`src/Arma3BE.Server/Models/Player.cs`:

```cs
using System;
using System.Linq;
using System.Text.RegularExpressions;

namespace Arma3BE.Server.Models
{
    public class Player
    {
        public enum PlayerState
        {
            Lobby,
            Ingame
        }

        public Player(int num, string ip, int port, int ping, string guid, string name, PlayerState state)
        {
            Num = num;
            IP = ip;
            Port = port;
            Ping = ping;
            Guid = guid;
            Name = name;
            State = state;
        }

        public int Num { get; }

        public string IP { get; }

        public int Port { get; }

        public int Ping { get; }

        public string Guid { get; }

        public string Name { get; }

        public PlayerState State { get; }

        private bool Equals(Player other)
        {
            return Num == other.Num
                   && string.Equals(IP, other.IP)
                   && Port == other.Port
                   && string.Equals(Guid, other.Guid)
                   && string.Equals(Name, other.Name)
                   && State == other.State;
        }

        public override int GetHashCode()
        {
            unchecked
            {
                var hashCode = Num;
                hashCode = (hashCode * 397) ^ (IP?.GetHashCode() ?? 0);
                hashCode = (hashCode * 397) ^ Port;
                hashCode = (hashCode * 397) ^ Ping;
                hashCode = (hashCode * 397) ^ (Guid?.GetHashCode() ?? 0);
                hashCode = (hashCode * 397) ^ (Name?.GetHashCode() ?? 0);
                hashCode = (hashCode * 397) ^ (int)State;
                return hashCode;
            }
        }


        private static readonly Regex CompidelRegex = new Regex(
                        @"(\d{1,3})[ ]+(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):([\d]+)[ ]+(-?[\d]+)[ ]+([^ ]+)[ ]+(.*)",
                        RegexOptions.Compiled | RegexOptions.IgnoreCase);

        public static Player Parse(string input)
        {
            try
            {
                var match = CompidelRegex.Match(input);

                if (match.Success || match.Groups.Count != 6)
                {
                    int num;
                    if (!int.TryParse(match.Groups[1].Value, out num)) return null;
                    var ip = match.Groups[2].Value;

                    ip = string.Join(".", ip.Split('.').Reverse());

                    int port;
                    if (!int.TryParse(match.Groups[3].Value, out port)) return null;

                    int ping;
                    if (!int.TryParse(match.Groups[4].Value, out ping)) return null;

                    var guid = match.Groups[5].Value;


                    var ind = guid.IndexOf("(", StringComparison.Ordinal);
                    guid = guid.Substring(0, ind);

                    var name = match.Groups[6].Value;

                    var state = PlayerState.Ingame;

                    if (name.EndsWith(" (Lobby)"))
                    {
                        state = PlayerState.Lobby;
                        name = name.Substring(0, name.Length - " (Lobby)".Length);
                    }

                    return new Player(num, ip, port, ping, guid, name, state);
                }

                return null;
            }
            catch (Exception)
            {
                return null;
            }
        }

        public override bool Equals(object obj)
        {
            if (ReferenceEquals(null, obj)) return false;
            if (ReferenceEquals(this, obj)) return true;
            if (obj.GetType() != GetType()) return false;
            return Equals((Player)obj);
        }
    }
}
```

`src/Arma3BE.Server/Models/PlayerList.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Server.Models
{
    public class PlayerList : StateList<Player>
    {
        public PlayerList(ServerMessage message)
            : base(Parse(message.Message))
        {
        }

        private static IEnumerable<Player> Parse(string text)
        {
            var lines = text.Split(Environment.NewLine.ToCharArray()).ToArray();
            return lines.Select(Player.Parse).Where(p => p != null).ToList();
        }
    }
}
```

`src/Arma3BE.Server/Models/ServerMessage.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Recognizers;
using System;
using System.Collections.Generic;
using System.Linq;

namespace Arma3BE.Server.Models
{
    public class ServerMessage
    {
        private static readonly IEnumerable<IServerMessageRecognizer> Recognizers = new IServerMessageRecognizer[]
        {
            new AdminListRecognizer(),
            new BanListRecognizer(),
            new BanLogRecognizer(),
            new ChatMessageRecognizer(),
            new MissionsListRecognizer(),
            new PlayerListRecognizer(),
            new PlayerLogRecognizer(),
            new RconAdminLogRecognizer(),
        };

        public ServerMessage(int messageId, string message)
        {
            MessageId = messageId;
            Message = message;

            _type = new Lazy<ServerMessageType>(GetMessageType);
        }

        // ReSharper disable once UnusedAutoPropertyAccessor.Global
        // ReSharper disable once MemberCanBePrivate.Global
        public int MessageId { get; }

        public string Message { get; }

        private readonly Lazy<ServerMessageType> _type;

        public ServerMessageType Type => _type.Value;

        private ServerMessageType GetMessageType()
        {
            var matches = Recognizers.Where(x => x.CanRecognize(this)).ToArray();
            if (matches.Length == 1) return matches[0].GetMessageType(this);
            return ServerMessageType.Unknown;
        }

    }
}
```

`src/Arma3BE.Server/Models/StateList.cs`:

```cs
using System.Collections;
using System.Collections.Generic;

namespace Arma3BE.Server.Models
{
    public abstract class StateList<T> : IEnumerable<T>
    {
        private readonly IEnumerable<T> _data;

        protected StateList(IEnumerable<T> data)
        {
            _data = data;
        }

        public IEnumerator<T> GetEnumerator()
        {
            return _data.GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return _data.GetEnumerator();
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/AdminListRecognizer.cs`:

```cs
using System;
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;
using Arma3BE.Server.Recognizers.Core;

namespace Arma3BE.Server.Recognizers
{
    public class AdminListRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.AdminList;
        }

        
        public bool CanRecognize(ServerMessage serverMessage)
        {
            var firstLines = new[]
            {
                "Connected RCon admins:",
                "[#] [IP Address]:[Port]",
                "-----------------------------"
            };


            var lines = serverMessage.Message.Split(Environment.NewLine.ToCharArray(), StringSplitOptions.RemoveEmptyEntries);

            if (lines.Length <= firstLines.Length) return false;

            var i = 0;
            for (; i < firstLines.Length; i++)
            {
                if (string.Compare(firstLines[i], lines[i], StringComparison.InvariantCultureIgnoreCase) != 0)
                    return false;
            }

            for (; i < (lines.Length); i++)
            {
                if (Admin.Parse(lines[i]) == null || !CanRecognizeLine(lines[i]))
                {
                    return false;
                }
            }

            return true;
        }

        public bool CanRecognizeLine(string line)
        {
            var lines = line.Split(" \t".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
            if (lines.Length < 2) return false;

            int test;
            if (!Int32.TryParse(lines[0], out test)) return false;

            if (!IPAndPortValidator.Validate(lines[1])) return false;

            return true;
        }
    }

//Sample
//
//Connected RCon admins:
//[#] [IP Address]:[Port]
//-----------------------------
//0 94.181.44.100:50960
//1 213.21.12.135:54678

}
```

`src/Arma3BE.Server/Recognizers/BanLogRecognizer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;

namespace Arma3BE.Server.Recognizers
{
    public class BanLogRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.BanLog;
        }

        public bool CanRecognize(ServerMessage serverMessage)
        {
            return serverMessage.Message.StartsWith("Player") && (
                serverMessage.Message.Contains("kicked") && serverMessage.Message.Contains("BattlEye: Admin Ban")
                );
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/ChatMessageRecognizer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;

namespace Arma3BE.Server.Recognizers
{
    public class ChatMessageRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.ChatMessage;
        }

        public bool CanRecognize(ServerMessage serverMessage)
        {
            if (serverMessage.Message.StartsWith("(Side)") || serverMessage.Message.StartsWith("(Vehicle)") || serverMessage.Message.StartsWith("(Unknown)") ||
                (serverMessage.Message.StartsWith("(Global)") || serverMessage.Message.StartsWith("(Group)")) ||
                (serverMessage.Message.StartsWith("(Command)") || serverMessage.Message.StartsWith("(Direct)")))
                return true;
            if (serverMessage.Message.StartsWith("RCon") && !serverMessage.Message.EndsWith("logged in"))
                return true;

            return false;
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/Core/GUIDValidator.cs`:

```cs
namespace Arma3BE.Server.Recognizers.Core
{
    public class GUIDValidator
    {
        public static bool Validate(string value)
        {
            if (string.IsNullOrEmpty(value)) return false;
            if (value.Length != 32) return false;

            return true;
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/Core/IPAndPortValidator.cs`:

```cs
using System;
using System.Text.RegularExpressions;

namespace Arma3BE.Server.Recognizers.Core
{
    public class IPAndPortValidator
    {
        public static bool Validate(string value)
        {
            if (string.IsNullOrEmpty(value)) return false;

            if (!RegexIpAndPort.IsMatch(value)) return false;
            if (value.Split(".:".ToCharArray(), StringSplitOptions.RemoveEmptyEntries).Length != 5) return false;

            return true;
        }

        private static readonly Regex RegexIpAndPort = new Regex(
            @"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):([\d]+)",
            RegexOptions.Compiled | RegexOptions.IgnoreCase);
    }
}
```

`src/Arma3BE.Server/Recognizers/MissionsListRecognizer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;

namespace Arma3BE.Server.Recognizers
{
    public class MissionsListRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.MissionList;
        }

        public bool CanRecognize(ServerMessage serverMessage)
        {
            return serverMessage.Message.StartsWith("Missions on server:");
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/PlayerListRecognizer.cs`:

```cs
using System;
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;
using Arma3BE.Server.Recognizers.Core;

namespace Arma3BE.Server.Recognizers
{
    public class PlayerListRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.PlayerList;
        }

        public bool CanRecognize(ServerMessage serverMessage)
        {
            var firstLines = new[]
            {
                "Players on server:",
                "[#] [IP Address]:[Port] [Ping] [GUID] [Name]",
                "--------------------------------------------------"
            };


            var lines = serverMessage.Message.Split(Environment.NewLine.ToCharArray(), StringSplitOptions.RemoveEmptyEntries);

            if (lines.Length <= firstLines.Length) return false;

            var i = 0;
            for (; i < firstLines.Length; i++)
            {
                if (string.Compare(firstLines[i], lines[i], StringComparison.InvariantCultureIgnoreCase) != 0)
                    return false;
            }

            for (; i < (lines.Length - 1); i++)
            {
                if (Player.Parse(lines[i]) == null || !CanRecognizeLine(lines[i]))
                {
                    return false;
                }
            }


            var lastLine = $"({lines.Length - 4} players in total)";
            if (string.Compare(lastLine, lines[lines.Length - 1], StringComparison.InvariantCultureIgnoreCase) != 0)
                return false;


            return true;
        }

        public bool CanRecognizeLine(string line)
        {
            var lines = line.Split(" \t".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
            if (lines.Length < 5) return false;

            int test;
            if (!Int32.TryParse(lines[0], out test)) return false;

            if (!IPAndPortValidator.Validate(lines[1])) return false;

            if (!Int32.TryParse(lines[2], out test)) return false;

            if (!GUIDValidator.Validate(lines[3].Replace("(OK)", string.Empty).Replace("(?)", string.Empty))) return false;

            return true;
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/PlayerLogRecognizer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;

namespace Arma3BE.Server.Recognizers
{
    public class PlayerLogRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.PlayerLog;
        }

        public bool CanRecognize(ServerMessage serverMessage)
        {
            if (serverMessage.Message.StartsWith("Player") && (
                //_message.Contains("connected")
                //||
                serverMessage.Message.EndsWith("disconnected")
                ||
                serverMessage.Message.EndsWith("connected")
                ||
                (serverMessage.Message.Contains("kicked") && !serverMessage.Message.Contains("BattlEye: Admin Ban"))
                ||
                serverMessage.Message.Contains("(unverified)")
                ||
                serverMessage.Message.Contains("is losing connection")
                ))
                return true;

            if (serverMessage.Message.StartsWith("Verified GUID"))
                return true;

            return false;
        }
    }
}
```

`src/Arma3BE.Server/Recognizers/RconAdminLogRecognizer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.Messaging;
using Arma3BE.Server.Models;

namespace Arma3BE.Server.Recognizers
{
    public class RconAdminLogRecognizer : IServerMessageRecognizer
    {
        public ServerMessageType GetMessageType(ServerMessage message)
        {
            return ServerMessageType.RconAdminLog;
        }

        public bool CanRecognize(ServerMessage serverMessage)
        {
            return serverMessage.Message.StartsWith("RCon admin") && serverMessage.Message.EndsWith("logged in");
        }
    }
}
```

`src/Arma3BE.Server/ServerDecorators/BEConnectedWatcher.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using BattleNET;
using System;
using System.Diagnostics;
using System.Threading;

namespace Arma3BE.Server.ServerDecorators
{
    public class BEConnectedWatcher : DisposeObject, IBattlEyeServer
    {
        private readonly IBattlEyeServerFactory _battlEyeServerFactory;
        private readonly BattlEyeLoginCredentials _credentials;

        private static readonly ILog Log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);

        private readonly Timer _timer;
        private readonly Timer _keepAliveTimer;

        private volatile IBattlEyeServer _battlEyeServer;
        private DateTime _lastReceived = DateTime.UtcNow;
        private int _numAttempts;

        public bool Connected => _battlEyeServer != null && _battlEyeServer.Connected;

        public BEConnectedWatcher(IBattlEyeServerFactory battlEyeServerFactory,
            BattlEyeLoginCredentials credentials)
        {
            _battlEyeServerFactory = battlEyeServerFactory;
            _credentials = credentials;

            _timer = new Timer(_timer_Elapsed, null, TimeSpan.FromSeconds(5), TimeSpan.FromSeconds(10));
            _keepAliveTimer = new Timer(_timer_KeepAlive, null, TimeSpan.FromMinutes(1), TimeSpan.FromMinutes(1));

            _battlEyeServer = Init(_credentials);
        }

        public int SendCommand(BattlEyeCommand command, string parameters = "")
        {
            _battlEyeServer?.SendCommand(command, parameters);
            return 0;
        }

        public int SendCommand(string command)
        {
            _battlEyeServer?.SendCommand(command);
            return 0;
        }

        public BattlEyeConnectionResult Connect()
        {
            var result = _battlEyeServer?.Connect();
            return result ?? BattlEyeConnectionResult.ConnectionFailed;
        }

        public void Disconnect()
        {
            _battlEyeServer?.Disconnect();
        }

        public event BattlEyeMessageEventHandler BattlEyeMessageReceived;
        public event BattlEyeConnectEventHandler BattlEyeConnected;
        public event BattlEyeDisconnectEventHandler BattlEyeDisconnected;

        private void _timer_KeepAlive(object state)
        {
            var local = _battlEyeServer;
            if (local?.Connected == true)
            {
                local.SendCommand(BattlEyeCommand.Players);
            }
        }

        private void _timer_Elapsed(object state)
        {
            if (_battlEyeServer == null || !_battlEyeServer.Connected)
            {
                _numAttempts++;
            }
            else
            {
                _numAttempts = 0;
            }

            var lastReceivedSpan = DateTime.UtcNow - _lastReceived;

            //_log.Info($"ATTEMPTS {_numAttempts} FOR {_credentials.Host}:{_credentials.Port} WITH LAST RECEIVED {lastReceivedSpan}");
            if (_numAttempts > 5 || lastReceivedSpan.TotalMinutes > 15)
            {
                _numAttempts = 0;
                _lastReceived = DateTime.UtcNow;
                Log.Info(
                    $"RECREATE CLIENT FOR {_credentials.Host}:{_credentials.Port} WITH LAST RECEIVED {lastReceivedSpan}");

                var local = _battlEyeServer;
                _battlEyeServer = null;
                if (local != null) Release(local, _credentials);

                OnBattlEyeDisconnected(new BattlEyeDisconnectEventArgs(_credentials,
                    BattlEyeDisconnectionType.ConnectionLost));

                Init(_credentials);

                _battlEyeServer = Init(_credentials);

                Connect();
            }
        }

        private IBattlEyeServer Init(BattlEyeLoginCredentials battlEyeLoginCredentials)
        {
            Log.Info($"Init {battlEyeLoginCredentials.Host}:{battlEyeLoginCredentials.Port}");

            var battlEyeServer = _battlEyeServerFactory.Create(battlEyeLoginCredentials);
            battlEyeServer.BattlEyeConnected += OnBattlEyeConnected;
            battlEyeServer.BattlEyeMessageReceived += OnBattlEyeMessageReceived;
            battlEyeServer.BattlEyeDisconnected += OnBattlEyeDisconnected;

            return battlEyeServer;
        }

        private void Release(IBattlEyeServer battlEyeServer, BattlEyeLoginCredentials battlEyeLoginCredentials)
        {
            Log.Info($"Release {battlEyeLoginCredentials.Host}:{battlEyeLoginCredentials.Port}");
            if (battlEyeServer != null)
            {
                battlEyeServer.BattlEyeConnected -= OnBattlEyeConnected;
                battlEyeServer.BattlEyeMessageReceived -= OnBattlEyeMessageReceived;
                battlEyeServer.BattlEyeDisconnected -= OnBattlEyeDisconnected;

                if (battlEyeServer.Connected) battlEyeServer.Disconnect();

                battlEyeServer.Dispose();
            }
        }


        private void OnBattlEyeMessageReceived(BattlEyeMessageEventArgs message)
        {
            _lastReceived = DateTime.UtcNow;
            BattlEyeMessageReceived?.Invoke(message);
        }

        private void OnBattlEyeConnected(BattlEyeConnectEventArgs args)
        {
            BattlEyeConnected?.Invoke(args);
        }

        private void OnBattlEyeDisconnected(BattlEyeDisconnectEventArgs args)
        {
            BattlEyeDisconnected?.Invoke(args);
        }

        protected override void DisposeManagedResources()
        {
            _timer?.Dispose();
            _keepAliveTimer?.Dispose();

            var local = _battlEyeServer;
            _battlEyeServer = null;
            if (local != null) Release(local, _credentials);


            base.DisposeManagedResources();
        }
    }
}
```

`src/Arma3BE.Server/ServerDecorators/BattlEyeServerProxy.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using BattleNET;

namespace Arma3BE.Server.ServerDecorators
{
    public class BattlEyeServerProxy : DisposeObject, IBattlEyeServer
    {
        private BattlEyeClient _battlEyeClient;
        private readonly string _serverName;
        private readonly ILog _log = new Log(typeof(BattlEyeServerProxy));

        public BattlEyeServerProxy(BattlEyeClient client, string serverName)
        {
            _battlEyeClient = client;
            _serverName = serverName;

            _battlEyeClient.ReconnectOnPacketLoss = true;

            _battlEyeClient.BattlEyeConnected += OnBattlEyeConnected;
            _battlEyeClient.BattlEyeMessageReceived += OnBattlEyeMessageReceived;
            _battlEyeClient.BattlEyeDisconnected += OnBattlEyeDisconnected;
        }

        public event BattlEyeMessageEventHandler BattlEyeMessageReceived;
        public event BattlEyeConnectEventHandler BattlEyeConnected;
        public event BattlEyeDisconnectEventHandler BattlEyeDisconnected;

        public bool Connected => _battlEyeClient.Connected;


        private void OnBattlEyeMessageReceived(BattlEyeMessageEventArgs message)
        {
            _log.Info($"{_serverName}: Received\n{message.Id}\n{message.Message}");

            if (!string.IsNullOrEmpty(message.Message))
                BattlEyeMessageReceived?.Invoke(message);
        }

        private void OnBattlEyeConnected(BattlEyeConnectEventArgs args)
        {
            _log.Info($"{_serverName}: Connected");

            if (Connected)
                BattlEyeConnected?.Invoke(args);
        }

        private void OnBattlEyeDisconnected(BattlEyeDisconnectEventArgs args)
        {
            _log.Info($"{_serverName}: Disconnected");
            BattlEyeDisconnected?.Invoke(args);
        }

        public BattlEyeConnectionResult Connect()
        {
            _log.Info($"{_serverName}: Connect called");
            return _battlEyeClient.Connect();
        }

        public void Disconnect()
        {
            _log.Info($"{_serverName}: Disconnect called");
            _battlEyeClient?.Disconnect();
        }

        public bool ReconnectOnPacketLoss
        {
            get { return _battlEyeClient.ReconnectOnPacketLoss; }
            set { _battlEyeClient.ReconnectOnPacketLoss = value; }
        }

        public int SendCommand(BattlEyeCommand command, string parameters = "")
        {
            _log.Info($"{_serverName}: Send {command} with {parameters}");
            return _battlEyeClient.SendCommand(command, parameters);
        }

        public int SendCommand(string command)
        {
            _log.Info($"{_serverName}: Send {command}");
            return _battlEyeClient.SendCommand(command);
        }

        protected override void DisposeManagedResources()
        {
            _log.Info($"{_serverName}: Dispose");
            var local = _battlEyeClient;
            _battlEyeClient = null;
            if (local != null)
            {
                local.BattlEyeConnected -= OnBattlEyeConnected;
                local.BattlEyeMessageReceived -= OnBattlEyeMessageReceived;
                local.BattlEyeDisconnected -= OnBattlEyeDisconnected;

                if (local.Connected) local.Disconnect();
            }
            base.DisposeManagedResources();
        }
    }
}
```

`src/Arma3BE.Server/ServerDecorators/ThreadSafeBattleEyeServer.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BEClient.Common.Core;
using Arma3BEClient.Common.Logging;
using BattleNET;
using System.Collections.Concurrent;
using System.Diagnostics;
using System.Threading;
using System.Threading.Tasks;
// ReSharper disable MemberCanBePrivate.Local

namespace Arma3BE.Server.ServerDecorators
{
    public class ThreadSafeBattleEyeServer : DisposeObject, IBattlEyeServer
    {
        private readonly ConcurrentQueue<ICommandPacket> _commandPackets = new ConcurrentQueue<ICommandPacket>();
        private readonly ConcurrentQueue<BattlEyeMessageEventArgs> _messages = new ConcurrentQueue<BattlEyeMessageEventArgs>();

        private readonly object _lock = new object();
        private readonly ILog _log = LogFactory.Create(new StackTrace().GetFrame(0).GetMethod().DeclaringType);
        private readonly Timer _timer;
        private IBattlEyeServer _battlEyeServer;

        public ThreadSafeBattleEyeServer(IBattlEyeServer battlEyeServer)
        {
            _battlEyeServer = battlEyeServer;
            _battlEyeServer.BattlEyeConnected += OnBattlEyeConnected;
            _battlEyeServer.BattlEyeMessageReceived += OnBattlEyeMessageReceived;
            _battlEyeServer.BattlEyeDisconnected += OnBattlEyeDisconnected;

            _timer = new Timer(Process, null, 1000, 1000);
            _log.Info($"ThreadSafeBattleEyeClient Init");
        }

        public bool Connected => _battlEyeServer.Connected;

        public int SendCommand(BattlEyeCommand command, string parameters = "")
        {
            if (_battlEyeServer != null && _commandPackets.Count < 50)
            {
                _commandPackets.Enqueue(new CommandPacket(command, parameters));
                _log.Info($"ThreadSafeBattleEyeClient Saving {command} WITH {parameters}");
            }

            if (!Connected) _battlEyeServer.Connect();
            return 0;
        }

        public int SendCommand(string command)
        {
            if (_battlEyeServer != null && _commandPackets.Count < 50)
            {
                _commandPackets.Enqueue(new PureCommandPacket(command));
                _log.Info($"ThreadSafeBattleEyeClient Saving {command}");
            }

            if (!Connected) _battlEyeServer.Connect();
            return 0;
        }

        public void Disconnect()
        {
            lock (_lock)
            {
                _battlEyeServer?.Disconnect();
            }
        }

        public BattlEyeConnectionResult Connect()
        {
            lock (_lock)
            {
                _log.Info($"TRY TO CONNECT TO");
                return _battlEyeServer.Connect();
            }
        }

        public event BattlEyeMessageEventHandler BattlEyeMessageReceived;
        public event BattlEyeConnectEventHandler BattlEyeConnected;
        public event BattlEyeDisconnectEventHandler BattlEyeDisconnected;


        private void Process(object state)
        {
            Task.Factory.StartNew(ProcessRecieveMessages);
            Task.Factory.StartNew(ProcessSendMessages);
        }

        private void ProcessRecieveMessages()
        {
            BattlEyeMessageEventArgs message;
            if (_messages.TryDequeue(out message))
            {
                lock (_lock)
                {
                    BattlEyeMessageReceived?.Invoke(message);
                }
            }
        }

        private void ProcessSendMessages()
        {
            if (_battlEyeServer == null || !_battlEyeServer.Connected)
                return;

            if (!_commandPackets.IsEmpty && _battlEyeServer.Connected)
            {
                ICommandPacket packet;

                if (_commandPackets.TryDequeue(out packet))
                {
                    lock (_lock)
                    {
                        if (_battlEyeServer != null && _battlEyeServer.Connected)
                        {
                            packet.Invoke(_battlEyeServer);
                            //_battlEyeServer.SendCommand(packet.BattlEyeCommand, packet.Parameters);
                            _log.Info($"ThreadSafeBattleEyeClient Sending {packet}");
                        }
                    }
                }
            }
        }

        private void OnBattlEyeMessageReceived(BattlEyeMessageEventArgs message)
        {
            if (!string.IsNullOrEmpty(message.Message) && _messages.Count < 1000)
                _messages.Enqueue(message);
        }

        private void OnBattlEyeConnected(BattlEyeConnectEventArgs args)
        {
            if (Connected)
                BattlEyeConnected?.Invoke(args);
        }

        private void OnBattlEyeDisconnected(BattlEyeDisconnectEventArgs args)
        {
            BattlEyeDisconnected?.Invoke(args);
        }

        protected override void DisposeManagedResources()
        {
            _timer.Dispose();

            if (_battlEyeServer != null)
            {
                lock (_lock)
                {
                    if (_battlEyeServer != null)
                    {
                        if (_battlEyeServer.Connected)
                            _battlEyeServer.Disconnect();
                        _battlEyeServer.Dispose();
                        _battlEyeServer = null;
                    }
                }
            }
            base.DisposeManagedResources();

            _log.Info($"ThreadSafeBattleEyeClient DisposeManagedResources");
        }

        private interface ICommandPacket
        {
            void Invoke(IBattlEyeServer server);
        }

        private class PureCommandPacket : ICommandPacket
        {
            private readonly string _command;

            public PureCommandPacket(string command)
            {
                _command = command;
            }

            public void Invoke(IBattlEyeServer server)
            {
                server?.SendCommand(_command);
            }

            public override string ToString()
            {
                return _command;
            }
        }

        private class CommandPacket : ICommandPacket
        {
            public CommandPacket(BattlEyeCommand battlEyeCommand, string parameters)
            {
                BattlEyeCommand = battlEyeCommand;
                Parameters = parameters;
            }

            public BattlEyeCommand BattlEyeCommand { get; }
            public string Parameters { get; }
            public void Invoke(IBattlEyeServer server)
            {
                server?.SendCommand(BattlEyeCommand, Parameters);
            }

            public override string ToString()
            {
                return $"{BattlEyeCommand} WITH {Parameters}";
            }
        }
    }
}
```

`src/Arma3BE.Server/ServerFactory/BattlEyeServerFactory.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.ServerDecorators;
using BattleNET;

namespace Arma3BE.Server.ServerFactory
{
    public class BattlEyeServerFactory : IBattlEyeServerFactory
    {
        public IBattlEyeServer Create(BattlEyeLoginCredentials credentials)
        {
            return new ThreadSafeBattleEyeServer(new BattlEyeServerProxy(new BattlEyeClient(credentials)
            {
                ReconnectOnPacketLoss = true
            }, $"{credentials.Host}:{credentials.Port}"));
        }
    }
}
```

`src/Arma3BE.Server/ServerFactory/WatcherBEServerFactory.cs`:

```cs
using Arma3BE.Server.Abstract;
using Arma3BE.Server.ServerDecorators;
using BattleNET;

namespace Arma3BE.Server.ServerFactory
{
    public class WatcherBEServerFactory : IBattlEyeServerFactory
    {
        public IBattlEyeServer Create(BattlEyeLoginCredentials credentials)
        {
            return new BEConnectedWatcher(new BattlEyeServerFactory(), credentials);
        }
    }
}
```

`src/Arma3BE.Steam/Arma3BE.Steam.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BEClient.Steam</RootNamespace>
    <AssemblyName>Arma3BEClient.Steam</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <RunCodeAnalysis>false</RunCodeAnalysis>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="..\GlobalAssemblyInfo.cs">
      <Link>Properties\GlobalAssemblyInfo.cs</Link>
    </Compile>
    <Compile Include="ServerInfoResult.cs" />
    <Compile Include="GetServerInfoSettings.cs" />
    <Compile Include="ResponseParser.cs" />
    <Compile Include="Server.cs" />
    <Compile Include="ServerPlayers.cs" />
    <Compile Include="ServerRulesResult.cs" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Steam/GetServerInfoSettings.cs`:

```cs
namespace Arma3BEClient.Steam
{
    public class GetServerInfoSettings
    {
        public int ReceiveTimeout = 2000;
        public int SendTimeout = 2000;
    }
}
```

`src/Arma3BE.Steam/ResponseParser.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Text;

namespace Arma3BEClient.Steam
{
    public class ResponseParser
    {
        private readonly byte[] _bytes;

        public ResponseParser(byte[] bytes)
        {
            _bytes = bytes;
        }

        public bool BytesLeft => _bytes.Length - 1 >= CurrentPosition;

        public int CurrentPosition { get; set; }

        public byte GetByte()
        {
            return _bytes[CurrentPosition++];
        }

        public string GetStringToTermination()
        {
            var buffer = new List<byte>();
            for (; CurrentPosition < _bytes.Length; CurrentPosition++)
            {
                var b = _bytes[CurrentPosition];
                if (b != 0x00)
                {
                    buffer.Add(b);
                }
                else
                {
                    CurrentPosition++;
                    break;
                }
            }
            return Encoding.UTF8.GetString(buffer.ToArray());
        }

        public int GetShort()
        {
            return BitConverter.ToUInt16(new[]
            {
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++]
            }, 0);
        }


        public long GetLong()
        {
            return BitConverter.ToInt32(new[]
            {
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++]
            }, 0);
        }


        public float GetDouble()
        {
            return BitConverter.ToSingle(new[]
            {
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++],
                _bytes[CurrentPosition++]
            }, 0);
        }


        public string GetStringOfByte()
        {
            return Encoding.ASCII.GetString(new[] { _bytes[CurrentPosition++] });
        }
    }
}
```

`src/Arma3BE.Steam/Server.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Sockets;
using System.Text;

namespace Arma3BEClient.Steam
{
    public class Server
    {
        public Server(IPEndPoint endPoint)
        {
            EndPoint = endPoint;
        }

        private IPEndPoint EndPoint { get; }


        public ServerRulesResult GetServerRulesSync(GetServerInfoSettings settings)
        {
            var localEndpoint = new IPEndPoint(IPAddress.Any, 0);
            using (var client = new UdpClient(localEndpoint))
            {
                client.Client.ReceiveTimeout = settings.ReceiveTimeout;
                client.Client.SendTimeout = settings.SendTimeout;

                client.Connect(EndPoint);
                var requestPacket = new List<byte>();
                requestPacket.AddRange(new byte[] { 0xFF, 0xFF, 0xFF, 0xFF, 0x56 });
                requestPacket.AddRange(BitConverter.GetBytes(-1));
                client.Send(requestPacket.ToArray(), requestPacket.ToArray().Length);
                var responseData = client.Receive(ref localEndpoint);
                requestPacket.Clear();
                requestPacket.AddRange(new byte[] { 0xFF, 0xFF, 0xFF, 0xFF, 0x56 });
                requestPacket.AddRange(responseData.Skip(5).Take(4));
                client.Send(requestPacket.ToArray(), requestPacket.ToArray().Length);
                responseData = client.Receive(ref localEndpoint);
                return ServerRulesResult.Parse(responseData);
            }
        }


        public ServerPlayers GetServerChallengeSync(GetServerInfoSettings settings)
        {
            var localEndpoint = new IPEndPoint(IPAddress.Any, 0);
            using (var client = new UdpClient(localEndpoint))
            {
                client.Client.ReceiveTimeout = settings.ReceiveTimeout;
                client.Client.SendTimeout = settings.SendTimeout;

                client.Connect(EndPoint);

                var requestPacket = new List<byte>();
                requestPacket.AddRange(new byte[] { 0xFF, 0xFF, 0xFF, 0xFF, 0x55 });
                requestPacket.AddRange(BitConverter.GetBytes(-1));

                client.Send(requestPacket.ToArray(), requestPacket.ToArray().Length);
                var responseData = client.Receive(ref localEndpoint);
                requestPacket.Clear();
                requestPacket.AddRange(new byte[] { 0xFF, 0xFF, 0xFF, 0xFF, 0x55 });
                requestPacket.AddRange(responseData.Skip(5).Take(4));
                client.Send(requestPacket.ToArray(), requestPacket.ToArray().Length);
                responseData = client.Receive(ref localEndpoint);

                return ServerPlayers.Parse(responseData);
            }
        }


        public ServerInfoResult GetServerInfoSync(GetServerInfoSettings settings)
        {
            var localEndPoint = new IPEndPoint(IPAddress.Any, 0);
            using (var client = new UdpClient(localEndPoint))
            {
                client.Client.ReceiveTimeout = settings.ReceiveTimeout;
                client.Client.SendTimeout = settings.SendTimeout;

                client.Connect(EndPoint);
                var requestPacket = new List<byte>();
                requestPacket.AddRange(new byte[] { 0xFF, 0xFF, 0xFF, 0xFF });
                requestPacket.Add(0x54);
                requestPacket.AddRange(Encoding.ASCII.GetBytes("Source Engine Query"));
                requestPacket.Add(0x00);
                var requestData = requestPacket.ToArray();
                client.Send(requestData, requestData.Length);
                var data = client.Receive(ref localEndPoint);
                return ServerInfoResult.Parse(data);
            }
        }
    }
}
```

`src/Arma3BE.Steam/ServerInfoResult.cs`:

```cs
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable NotAccessedField.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global
namespace Arma3BEClient.Steam
{
    public class ServerInfoResult
    {
        public int ID;
        public byte VAC;
        public int Protocol { get; set; }
        public string Name { get; set; }
        public string Map { get; set; }
        public string Folder { get; set; }
        public string Game { get; set; }
        public byte Players { get; set; }
        public byte MaxPlayers { get; set; }
        public byte Bots { get; set; }
        public string ServerType { get; set; }
        public string Environment { get; set; }
        public byte Visibility { get; set; }
        public string Version { get; set; }
        public int Port { get; set; }

        public static ServerInfoResult Parse(byte[] data)
        {
            var parser = new ResponseParser(data);
            parser.CurrentPosition += 5; //Header
            var result = new ServerInfoResult();
            result.Protocol = parser.GetByte();
            result.Name = parser.GetStringToTermination();
            result.Map = parser.GetStringToTermination();
            result.Folder = parser.GetStringToTermination();
            result.Game = parser.GetStringToTermination();
            result.ID = parser.GetShort();
            result.Players = parser.GetByte();
            result.MaxPlayers = parser.GetByte();
            result.Bots = parser.GetByte();
            result.ServerType = parser.GetStringOfByte();
            result.Environment = parser.GetStringOfByte();
            result.Visibility = parser.GetByte();
            result.VAC = parser.GetByte();
            result.Version = parser.GetStringToTermination();

            //get EDF
            uint edf = parser.GetByte();

            if ((edf & 0x80) != 0) //has port number
            {
                result.Port = parser.GetShort();
            }

            return result;
        }
    }
}
```

`src/Arma3BE.Steam/ServerPlayers.cs`:

```cs
using System;
// ReSharper disable MemberCanBePrivate.Global
// ReSharper disable UnusedAutoPropertyAccessor.Global

namespace Arma3BEClient.Steam
{
    public class ServerPlayers
    {
        public byte PlayerCount { get; set; }

        public PlayerInfo[] Players { get; set; }


        public static ServerPlayers Parse(byte[] data)
        {
            var parser = new ResponseParser(data);
            parser.CurrentPosition += 5; //Header
            var result = new ServerPlayers { PlayerCount = parser.GetByte() };



            result.Players = new PlayerInfo[result.PlayerCount];

            for (var i = 0; i < result.PlayerCount; i++)
            {
                var p = new PlayerInfo
                {
                    N = parser.GetByte(),
                    Name = parser.GetStringToTermination(),
                    Score = parser.GetLong(),
                    Time = TimeSpan.FromSeconds(parser.GetDouble())
                };


                //parser.CurrentPosition+=4;

                result.Players[i] = p;


                //break;
            }


            return result;
        }

        public class PlayerInfo
        {
            public byte N { get; set; }
            public string Name { get; set; }
            public long Score { get; set; }
            public TimeSpan Time { get; set; }
        }
    }
}
```

`src/Arma3BE.Steam/ServerRulesResult.cs`:

```cs
using System;
using System.Collections.Generic;

namespace Arma3BEClient.Steam
{
    [Serializable]
    public class ServerRulesResult : Dictionary<string, string>
    {
        public static ServerRulesResult Parse(byte[] bytes)
        {
            var result = new ServerRulesResult();
            var parser = new ResponseParser(bytes);
            parser.CurrentPosition += 7;
            while (parser.BytesLeft)
            {
                result.Add(parser.GetStringToTermination(), parser.GetStringToTermination());
            }
            return result;
        }
    }
}
```

`src/Arma3BE.Tests/Arma3BE.Tests.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{04AEB592-9BCB-4E4F-B4E8-A002094728CE}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Arma3BEClient.Tests</RootNamespace>
    <AssemblyName>Arma3BEClient.Tests</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
    <ReferencePath>$(ProgramFiles)\Common Files\microsoft shared\VSTT\$(VisualStudioVersion)\UITestExtensionPackages</ReferencePath>
    <IsCodedUITest>False</IsCodedUITest>
    <TestProjectType>UnitTest</TestProjectType>
    <SccProjectName>
    </SccProjectName>
    <SccLocalPath>
    </SccLocalPath>
    <SccAuxPath>
    </SccAuxPath>
    <SccProvider>
    </SccProvider>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">..\</SolutionDir>
    <TargetFrameworkProfile />
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <RunCodeAnalysis>false</RunCodeAnalysis>
    <CodeAnalysisIgnoreGeneratedCode>true</CodeAnalysisIgnoreGeneratedCode>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="nunit.framework, Version=3.6.1.0, Culture=neutral, PublicKeyToken=2638cd05610744eb, processorArchitecture=MSIL">
      <HintPath>..\packages\NUnit.3.6.1\lib\net45\nunit.framework.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="System" />
  </ItemGroup>
  <Choose>
    <When Condition="('$(VisualStudioVersion)' == '10.0' or '$(VisualStudioVersion)' == '') and '$(TargetFrameworkVersion)' == 'v3.5'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework, Version=10.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
      </ItemGroup>
    </When>
    <Otherwise>
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.UnitTestFramework">
          <Private>False</Private>
        </Reference>
      </ItemGroup>
    </Otherwise>
  </Choose>
  <ItemGroup>
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="PlayerUpaterTest.cs" />
    <Compile Include="ServerMessages\Recognizers\AdminListLineRecognizerTest.cs" />
    <Compile Include="ServerMessages\Recognizers\AdminListRecognizerTest.cs" />
    <Compile Include="ServerMessages\Recognizers\BanListLineRecognizerTest.cs" />
    <Compile Include="ServerMessages\Recognizers\BanListRecognizerTest.cs" />
    <Compile Include="ServerMessages\Recognizers\PlayerListLineRecognizerTest.cs" />
    <Compile Include="ServerMessages\Recognizers\PlayerListRecognizerTest.cs" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj">
      <Project>{E5240A50-E944-4F50-A353-2E3C9E547447}</Project>
      <Name>Arma3BE.Client.Libs</Name>
    </ProjectReference>
    <ProjectReference Include="..\Arma3BE.Server\Arma3BE.Server.csproj">
      <Project>{992fab3c-6505-41e4-a4d0-4d0657661695}</Project>
      <Name>Arma3BE.Server</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <None Include="packages.config" />
  </ItemGroup>
  <Choose>
    <When Condition="'$(VisualStudioVersion)' == '10.0' And '$(IsCodedUITest)' == 'True'">
      <ItemGroup>
        <Reference Include="Microsoft.VisualStudio.QualityTools.CodedUITestFramework, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITest.Extension, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
        <Reference Include="Microsoft.VisualStudio.TestTools.UITesting, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
          <Private>False</Private>
        </Reference>
      </ItemGroup>
    </When>
  </Choose>
  <Import Project="$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets" Condition="Exists('$(VSToolsPath)\TeamTest\Microsoft.TestTools.targets')" />
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project>
```

`src/Arma3BE.Tests/PlayerUpaterTest.cs`:

```cs
using Arma3BE.Server.Models;
using NUnit.Framework;

namespace Arma3BEClient.Tests
{
    [TestFixture]
    public class PlayerUpaterTest
    {
        [Test]
        public void Parse1()
        {
            var p =
                Player.Parse(
                    "17  188.162.228.192:63255 172  d074b6194fa864e50956a8294077f24a(OK) Cpt. JET");
            Assert.IsNotNull(p);
        }
    }
}
```

`src/Arma3BE.Tests/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Runtime.InteropServices;

// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.

[assembly: AssemblyTitle("Arma3BEClient.Tests")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("Arma3BEClient.Tests")]
[assembly: AssemblyCopyright("Copyright ©  2014")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Setting ComVisible to false makes the types in this assembly not visible 
// to COM components.  If you need to access a type in this assembly from 
// COM, set the ComVisible attribute to true on that type.

[assembly: ComVisible(false)]

// The following GUID is for the ID of the typelib if this project is exposed to COM

[assembly: Guid("50289040-5456-4f33-9270-32cc7c84dbff")]

// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Build and Revision Numbers 
// by using the '*' as shown below:
// [assembly: AssemblyVersion("1.0.*")]

[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]
```

`src/Arma3BE.Tests/ServerMessages/Recognizers/AdminListLineRecognizerTest.cs`:

```cs
using Arma3BE.Server.Recognizers;
using NUnit.Framework;

namespace Arma3BEClient.Tests.ServerMessages.Recognizers
{
    [TestFixture]
    public class AdminListLineRecognizerTest
    {
        [Test]
        [TestCase("0 94.181.44.100:50960")]
        [TestCase("1 213.21.12.135:54678")]
        public void Line_Correct_Test(string line)
        {
            var recognizer = new AdminListRecognizer();
            Assert.IsTrue(recognizer.CanRecognizeLine(line));
        }

        [Test]
        [TestCase("0 94.181..44.100:50960")]
        [TestCase("1s 213.21.12.135:54678")]
        public void Line_Not_Correct_Test(string line)
        {
            var recognizer = new AdminListRecognizer();
            Assert.IsFalse(recognizer.CanRecognizeLine(line));
        }
    }
}
```

`src/Arma3BE.Tests/ServerMessages/Recognizers/AdminListRecognizerTest.cs`:

```cs
using Arma3BE.Server.Models;
using Arma3BE.Server.Recognizers;
using NUnit.Framework;

namespace Arma3BEClient.Tests.ServerMessages.Recognizers
{
    [TestFixture]
    public class AdminListRecognizerTest
    {
        [Test]
        [TestCase(@"Connected RCon admins:
[#] [IP Address]:[Port]
-----------------------------
0 94.181.44.100:50960
1 213.21.12.135:54678")]
        [TestCase(@"Connected RCon admins:
[#] [IP Address]:[Port]
-----------------------------
0 94.181.44.100:50960
1 213.21.12.135:54678
2 191.234.50.135:1885
")]
        public void List_Test(string message)
        {
            var serverMessage = new ServerMessage(0, message);
            var recognizer = new AdminListRecognizer();
            Assert.IsTrue(recognizer.CanRecognize(serverMessage));
        }


        [Test]
        [TestCase(@"Connected RCon admins:
[#] [IP Address]:[Port]
-----------------------------
0 94.181.44.1s00:50960
1 213.21.12.135:54678")]
        [TestCase(@"Connected RCon admins:
[#] [IP Address]:[Port]
-----------------------------
0 94.181.44.10
")]
        public void List_NOT_CORECT_Test(string message)
        {
            var serverMessage = new ServerMessage(0, message);
            var recognizer = new AdminListRecognizer();
            Assert.IsFalse(recognizer.CanRecognize(serverMessage));
        }
    }
}
```

`src/Arma3BE.Tests/ServerMessages/Recognizers/BanListLineRecognizerTest.cs`:

```cs
using Arma3BE.Server.Recognizers;
using NUnit.Framework;

namespace Arma3BEClient.Tests.ServerMessages.Recognizers
{
    [TestFixture]
    public class BanListLineRecognizerTest
    {
        [Test]
        [TestCase("0  d0ee5caf1b8b6282349e79fb998c2ee2 perm TeamKill.Ban perm")]
        [TestCase("4  d0ee5caf1b8b6282349e79fb998c2ee2 perm Cheater.Ban perm!")]
        [TestCase("5  d0ee5caf1b8b6282349e79fb998c2ee2 perm Cheater(Ban PERM)")]
        [TestCase("219 d0ee5caf1b8b6282349e79fb998c2ee2 perm [tim][15.09.14 12:25:59] Teamkill")]
        [TestCase("508 d0ee5caf1b8b6282349e79fb998c2ee2 8971 [Rembowest14][18.07.15 13:38:14] Sabotage")]
        [TestCase("720 f4bee15c7747af094a25af266aa3c005 -    [ReNegadE][18.07.16 15:24:10] Read the rules!!!")]
        [TestCase("726 5968361f86a9fa0951706fab024f2586 perm")]
        public void Line_Correct_Test(string line)
        {
            var recognizer = new BanListRecognizer();
            Assert.IsTrue(recognizer.CanRecognizeLine(line));
        }

        [Test]
        [TestCase("20w  d0ee5caf1b8b6282349e79fb998c2ee2 perm TeamKill.Ban perm")]
        [TestCase("4  GU")]
        [TestCase("5d  d0ee5caf1b8b6282349e79fb998c2ee2 perm Cheater(Ban PERM)")]
        public void Line_Not_Correct_Test(string line)
        {
            var recognizer = new BanListRecognizer();
            Assert.IsFalse(recognizer.CanRecognizeLine(line));
        }
    }
}
```

`src/Arma3BE.Tests/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="NUnit" version="3.6.1" targetFramework="net452" />
</packages>
```

`src/Arma3BE.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 15
VisualStudioVersion = 15.0.27130.2036
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client", "Arma3BE.Client\Arma3BE.Client.csproj", "{46B9AF55-01D0-45B0-95CB-16F5B61A9F03}"
	ProjectSection(ProjectDependencies) = postProject
		{017F121B-3AF0-4E98-A107-0CC3F2B67FCE} = {017F121B-3AF0-4E98-A107-0CC3F2B67FCE}
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B} = {CF43B82B-1F25-4385-B315-AB7B4C010A4B}
		{DA176F41-7DB9-4678-868B-C585C95CB48E} = {DA176F41-7DB9-4678-868B-C585C95CB48E}
		{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C} = {E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}
		{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC} = {49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}
		{09D6C875-0877-40B7-B52C-7FA0476C1D5D} = {09D6C875-0877-40B7-B52C-7FA0476C1D5D}
		{B9350497-D13C-4A2B-B4F9-51C53D28A55A} = {B9350497-D13C-4A2B-B4F9-51C53D28A55A}
		{6CE098A8-DFF1-4C66-AD16-909903945E2B} = {6CE098A8-DFF1-4C66-AD16-909903945E2B}
		{35DBA2B4-0519-44CF-BA45-7AA6754866FD} = {35DBA2B4-0519-44CF-BA45-7AA6754866FD}
		{CD6C99BE-B22B-4B78-AE37-A7561E1FF837} = {CD6C99BE-B22B-4B78-AE37-A7561E1FF837}
		{50E80FCC-87BD-4982-901E-38FD22482D02} = {50E80FCC-87BD-4982-901E-38FD22482D02}
		{B58670E5-011F-4318-964E-35C8B63870A5} = {B58670E5-011F-4318-964E-35C8B63870A5}
	EndProjectSection
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Tests", "Arma3BE.Tests\Arma3BE.Tests.csproj", "{04AEB592-9BCB-4E4F-B4E8-A002094728CE}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Common", "Arma3BE.Common\Arma3BE.Common.csproj", "{D507E532-7DE6-4028-9DBE-AA76C54CC92A}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Libs", "Arma3BE.Client.Libs\Arma3BE.Client.Libs.csproj", "{E5240A50-E944-4F50-A353-2E3C9E547447}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Steam", "Arma3BE.Steam\Arma3BE.Steam.csproj", "{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Client", "Client", "{22A6CC46-99D2-45AF-B379-3320ECE99124}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Common", "Common", "{A63546C5-96E9-4DAF-ACBF-C4D0C2F6B9CF}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Server", "Server", "{009DEDB1-E6E3-4FA8-AFEC-39DBBE4FFCC6}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Server", "Arma3BE.Server\Arma3BE.Server.csproj", "{992FAB3C-6505-41E4-A4D0-4D0657661695}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Global", "Global", "{44D8CBB8-B667-461A-AA90-267147BA7055}"
	ProjectSection(SolutionItems) = preProject
		GlobalAssemblyInfo.cs = GlobalAssemblyInfo.cs
	EndProjectSection
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.MainModule", "Arma3BE.Client.Modules.MainModule\Arma3BE.Client.Modules.MainModule.csproj", "{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869}"
	ProjectSection(ProjectDependencies) = postProject
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B} = {CF43B82B-1F25-4385-B315-AB7B4C010A4B}
	EndProjectSection
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Infrastructure", "Arma3BE.Client.Infrastructure\Arma3BE.Client.Infrastructure.csproj", "{B58670E5-011F-4318-964E-35C8B63870A5}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.OnlinePlayersModule", "Arma3BE.Client.Modules.OnlinePlayersModule\Arma3BE.Client.Modules.OnlinePlayersModule.csproj", "{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.NetModule", "Arma3BE.Client.Modules.NetModule\Arma3BE.Client.Modules.NetModule.csproj", "{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.BanModule", "Arma3BE.Client.Modules.BanModule\Arma3BE.Client.Modules.BanModule.csproj", "{B9350497-D13C-4A2B-B4F9-51C53D28A55A}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Styles", "Arma3BE.Client.Styles\Arma3BE.Client.Styles.csproj", "{CF43B82B-1F25-4385-B315-AB7B4C010A4B}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.ChatModule", "Arma3BE.Client.Modules.ChatModule\Arma3BE.Client.Modules.ChatModule.csproj", "{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.AdminsModule", "Arma3BE.Client.Modules.AdminsModule\Arma3BE.Client.Modules.AdminsModule.csproj", "{50E80FCC-87BD-4982-901E-38FD22482D02}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.PlayersModule", "Arma3BE.Client.Modules.PlayersModule\Arma3BE.Client.Modules.PlayersModule.csproj", "{CD6C99BE-B22B-4B78-AE37-A7561E1FF837}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.SteamModule", "Arma3BE.Client.Modules.SteamModule\Arma3BE.Client.Modules.SteamModule.csproj", "{6CE098A8-DFF1-4C66-AD16-909903945E2B}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.ManageServerModule", "Arma3BE.Client.Modules.ManageServerModule\Arma3BE.Client.Modules.ManageServerModule.csproj", "{DA176F41-7DB9-4678-868B-C585C95CB48E}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.BEServerModule", "Arma3BE.Client.Modules.BEServerModule\Arma3BE.Client.Modules.BEServerModule.csproj", "{35DBA2B4-0519-44CF-BA45-7AA6754866FD}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "UI", "UI", "{5D341BA0-0818-480A-A61F-18E29E574A2A}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Services", "Services", "{DC5AD4D6-F483-4533-B6B4-4B514EAEED64}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.OptionsModule", "Arma3BE.Client.Modules.OptionsModule\Arma3BE.Client.Modules.OptionsModule.csproj", "{09D6C875-0877-40B7-B52C-7FA0476C1D5D}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.IndicatorsModule", "Arma3BE.Client.Modules.IndicatorsModule\Arma3BE.Client.Modules.IndicatorsModule.csproj", "{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.CoreModule", "Arma3BE.Client.Modules.CoreModule\Arma3BE.Client.Modules.CoreModule.csproj", "{308EEF0C-5DE3-435E-8249-7A658BFAFD08}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.ToolsModule", "Arma3BE.Client.Modules.ToolsModule\Arma3BE.Client.Modules.ToolsModule.csproj", "{57EF9E36-98D1-4DFE-A56B-ADE958BAB019}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Tests", "Tests", "{561F7217-8BEF-4812-91ED-3DE5483DFD07}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.BEServerModule.Tests", "Arma3BE.Client.Modules.BEServerModule.Tests\Arma3BE.Client.Modules.BEServerModule.Tests.csproj", "{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Modules.CoreModule.Tests", "Arma3BE.Client.Modules.CoreModule.Tests\Arma3BE.Client.Modules.CoreModule.Tests.csproj", "{969269FC-6C5F-49E9-BC60-96F1AE571B8F}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Arma3BE.Client.Updater", "Arma3BE.Client.Updater\Arma3BE.Client.Updater.csproj", "{9ADE6790-CEDC-43F0-8920-54AFFFB2646E}"
EndProject
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "External", "External", "{82D402E3-29C4-4486-B6DC-48D24F0CCF4F}"
EndProject
Project("{9A19103F-16F7-4668-BE54-9A1E7A4F7556}") = "BattleNET", "..\BattleNET\BattleNET\BattleNET.csproj", "{DB17061B-3FA9-46D5-ACAF-F23693D86B5D}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{46B9AF55-01D0-45B0-95CB-16F5B61A9F03}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{46B9AF55-01D0-45B0-95CB-16F5B61A9F03}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{46B9AF55-01D0-45B0-95CB-16F5B61A9F03}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{46B9AF55-01D0-45B0-95CB-16F5B61A9F03}.Release|Any CPU.Build.0 = Release|Any CPU
		{04AEB592-9BCB-4E4F-B4E8-A002094728CE}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{04AEB592-9BCB-4E4F-B4E8-A002094728CE}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{04AEB592-9BCB-4E4F-B4E8-A002094728CE}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{04AEB592-9BCB-4E4F-B4E8-A002094728CE}.Release|Any CPU.Build.0 = Release|Any CPU
		{D507E532-7DE6-4028-9DBE-AA76C54CC92A}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{D507E532-7DE6-4028-9DBE-AA76C54CC92A}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{D507E532-7DE6-4028-9DBE-AA76C54CC92A}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{D507E532-7DE6-4028-9DBE-AA76C54CC92A}.Release|Any CPU.Build.0 = Release|Any CPU
		{E5240A50-E944-4F50-A353-2E3C9E547447}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{E5240A50-E944-4F50-A353-2E3C9E547447}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{E5240A50-E944-4F50-A353-2E3C9E547447}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{E5240A50-E944-4F50-A353-2E3C9E547447}.Release|Any CPU.Build.0 = Release|Any CPU
		{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{B2948BD4-B413-4E9D-B9ED-41261B0C56DA}.Release|Any CPU.Build.0 = Release|Any CPU
		{992FAB3C-6505-41E4-A4D0-4D0657661695}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{992FAB3C-6505-41E4-A4D0-4D0657661695}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{992FAB3C-6505-41E4-A4D0-4D0657661695}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{992FAB3C-6505-41E4-A4D0-4D0657661695}.Release|Any CPU.Build.0 = Release|Any CPU
		{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869}.Release|Any CPU.Build.0 = Release|Any CPU
		{B58670E5-011F-4318-964E-35C8B63870A5}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{B58670E5-011F-4318-964E-35C8B63870A5}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{B58670E5-011F-4318-964E-35C8B63870A5}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{B58670E5-011F-4318-964E-35C8B63870A5}.Release|Any CPU.Build.0 = Release|Any CPU
		{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{017F121B-3AF0-4E98-A107-0CC3F2B67FCE}.Release|Any CPU.Build.0 = Release|Any CPU
		{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C}.Release|Any CPU.Build.0 = Release|Any CPU
		{B9350497-D13C-4A2B-B4F9-51C53D28A55A}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{B9350497-D13C-4A2B-B4F9-51C53D28A55A}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{B9350497-D13C-4A2B-B4F9-51C53D28A55A}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{B9350497-D13C-4A2B-B4F9-51C53D28A55A}.Release|Any CPU.Build.0 = Release|Any CPU
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B}.Release|Any CPU.Build.0 = Release|Any CPU
		{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC}.Release|Any CPU.Build.0 = Release|Any CPU
		{50E80FCC-87BD-4982-901E-38FD22482D02}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{50E80FCC-87BD-4982-901E-38FD22482D02}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{50E80FCC-87BD-4982-901E-38FD22482D02}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{50E80FCC-87BD-4982-901E-38FD22482D02}.Release|Any CPU.Build.0 = Release|Any CPU
		{CD6C99BE-B22B-4B78-AE37-A7561E1FF837}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{CD6C99BE-B22B-4B78-AE37-A7561E1FF837}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{CD6C99BE-B22B-4B78-AE37-A7561E1FF837}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{CD6C99BE-B22B-4B78-AE37-A7561E1FF837}.Release|Any CPU.Build.0 = Release|Any CPU
		{6CE098A8-DFF1-4C66-AD16-909903945E2B}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{6CE098A8-DFF1-4C66-AD16-909903945E2B}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{6CE098A8-DFF1-4C66-AD16-909903945E2B}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{6CE098A8-DFF1-4C66-AD16-909903945E2B}.Release|Any CPU.Build.0 = Release|Any CPU
		{DA176F41-7DB9-4678-868B-C585C95CB48E}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{DA176F41-7DB9-4678-868B-C585C95CB48E}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{DA176F41-7DB9-4678-868B-C585C95CB48E}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{DA176F41-7DB9-4678-868B-C585C95CB48E}.Release|Any CPU.Build.0 = Release|Any CPU
		{35DBA2B4-0519-44CF-BA45-7AA6754866FD}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{35DBA2B4-0519-44CF-BA45-7AA6754866FD}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{35DBA2B4-0519-44CF-BA45-7AA6754866FD}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{35DBA2B4-0519-44CF-BA45-7AA6754866FD}.Release|Any CPU.Build.0 = Release|Any CPU
		{09D6C875-0877-40B7-B52C-7FA0476C1D5D}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{09D6C875-0877-40B7-B52C-7FA0476C1D5D}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{09D6C875-0877-40B7-B52C-7FA0476C1D5D}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{09D6C875-0877-40B7-B52C-7FA0476C1D5D}.Release|Any CPU.Build.0 = Release|Any CPU
		{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049}.Release|Any CPU.Build.0 = Release|Any CPU
		{308EEF0C-5DE3-435E-8249-7A658BFAFD08}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{308EEF0C-5DE3-435E-8249-7A658BFAFD08}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{308EEF0C-5DE3-435E-8249-7A658BFAFD08}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{308EEF0C-5DE3-435E-8249-7A658BFAFD08}.Release|Any CPU.Build.0 = Release|Any CPU
		{57EF9E36-98D1-4DFE-A56B-ADE958BAB019}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{57EF9E36-98D1-4DFE-A56B-ADE958BAB019}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{57EF9E36-98D1-4DFE-A56B-ADE958BAB019}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{57EF9E36-98D1-4DFE-A56B-ADE958BAB019}.Release|Any CPU.Build.0 = Release|Any CPU
		{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF}.Release|Any CPU.Build.0 = Release|Any CPU
		{969269FC-6C5F-49E9-BC60-96F1AE571B8F}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{969269FC-6C5F-49E9-BC60-96F1AE571B8F}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{969269FC-6C5F-49E9-BC60-96F1AE571B8F}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{969269FC-6C5F-49E9-BC60-96F1AE571B8F}.Release|Any CPU.Build.0 = Release|Any CPU
		{9ADE6790-CEDC-43F0-8920-54AFFFB2646E}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{9ADE6790-CEDC-43F0-8920-54AFFFB2646E}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{9ADE6790-CEDC-43F0-8920-54AFFFB2646E}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{9ADE6790-CEDC-43F0-8920-54AFFFB2646E}.Release|Any CPU.Build.0 = Release|Any CPU
		{DB17061B-3FA9-46D5-ACAF-F23693D86B5D}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{DB17061B-3FA9-46D5-ACAF-F23693D86B5D}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{DB17061B-3FA9-46D5-ACAF-F23693D86B5D}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{DB17061B-3FA9-46D5-ACAF-F23693D86B5D}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(NestedProjects) = preSolution
		{46B9AF55-01D0-45B0-95CB-16F5B61A9F03} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{D507E532-7DE6-4028-9DBE-AA76C54CC92A} = {A63546C5-96E9-4DAF-ACBF-C4D0C2F6B9CF}
		{E5240A50-E944-4F50-A353-2E3C9E547447} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{B2948BD4-B413-4E9D-B9ED-41261B0C56DA} = {A63546C5-96E9-4DAF-ACBF-C4D0C2F6B9CF}
		{992FAB3C-6505-41E4-A4D0-4D0657661695} = {009DEDB1-E6E3-4FA8-AFEC-39DBBE4FFCC6}
		{58DBDF91-7AD0-4780-A3EF-0FA5C39E2869} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{B58670E5-011F-4318-964E-35C8B63870A5} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{017F121B-3AF0-4E98-A107-0CC3F2B67FCE} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{E7C5AB59-5824-40EA-AE0C-F8C75B6C919C} = {DC5AD4D6-F483-4533-B6B4-4B514EAEED64}
		{B9350497-D13C-4A2B-B4F9-51C53D28A55A} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{CF43B82B-1F25-4385-B315-AB7B4C010A4B} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{49E36C5F-4A81-4338-8A34-C0E52FCFA5DC} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{50E80FCC-87BD-4982-901E-38FD22482D02} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{CD6C99BE-B22B-4B78-AE37-A7561E1FF837} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{6CE098A8-DFF1-4C66-AD16-909903945E2B} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{DA176F41-7DB9-4678-868B-C585C95CB48E} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{35DBA2B4-0519-44CF-BA45-7AA6754866FD} = {DC5AD4D6-F483-4533-B6B4-4B514EAEED64}
		{5D341BA0-0818-480A-A61F-18E29E574A2A} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{DC5AD4D6-F483-4533-B6B4-4B514EAEED64} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{09D6C875-0877-40B7-B52C-7FA0476C1D5D} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{DEE7AD82-5ABD-4A16-90FA-B46DA96F3049} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{308EEF0C-5DE3-435E-8249-7A658BFAFD08} = {DC5AD4D6-F483-4533-B6B4-4B514EAEED64}
		{57EF9E36-98D1-4DFE-A56B-ADE958BAB019} = {5D341BA0-0818-480A-A61F-18E29E574A2A}
		{561F7217-8BEF-4812-91ED-3DE5483DFD07} = {DC5AD4D6-F483-4533-B6B4-4B514EAEED64}
		{FA11FEA6-31FA-4A53-AFB0-DCB23CE48ECF} = {561F7217-8BEF-4812-91ED-3DE5483DFD07}
		{969269FC-6C5F-49E9-BC60-96F1AE571B8F} = {561F7217-8BEF-4812-91ED-3DE5483DFD07}
		{9ADE6790-CEDC-43F0-8920-54AFFFB2646E} = {22A6CC46-99D2-45AF-B379-3320ECE99124}
		{DB17061B-3FA9-46D5-ACAF-F23693D86B5D} = {82D402E3-29C4-4486-B6DC-48D24F0CCF4F}
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {70F2B29D-1E4F-42D4-B9EC-58F547F06247}
	EndGlobalSection
EndGlobal

```

`src/Arma3BE.sln.DotSettings`:

```DotSettings
<wpf:ResourceDictionary xml:space="preserve" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:ss="urn:shemas-jetbrains-com:settings-storage-xaml" xmlns:wpf="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
	<s:Boolean x:Key="/Default/CodeInspection/CodeAnnotations/NamespacesWithAnnotations/=Arma3BEClient_002EAnnotations/@EntryIndexedValue">True</s:Boolean>
	<s:Boolean x:Key="/Default/CodeInspection/CodeAnnotations/NamespacesWithAnnotations/=Arma3BE_002EClient_002EInfrastructure_002EAnnotations/@EntryIndexedValue">True</s:Boolean>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=BE/@EntryIndexedValue">BE</s:String>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=GUID/@EntryIndexedValue">GUID</s:String>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=ID/@EntryIndexedValue">ID</s:String>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=IP/@EntryIndexedValue">IP</s:String>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=RTB/@EntryIndexedValue">RTB</s:String>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=VAC/@EntryIndexedValue">VAC</s:String>
	<s:String x:Key="/Default/CodeStyle/Naming/CSharpNaming/Abbreviations/=XML/@EntryIndexedValue">XML</s:String></wpf:ResourceDictionary>
```

`src/Arma3BEClient.sln.DotSettings`:

```DotSettings
<wpf:ResourceDictionary xml:space="preserve" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:ss="urn:shemas-jetbrains-com:settings-storage-xaml" xmlns:wpf="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
	<s:Boolean x:Key="/Default/CodeInspection/CodeAnnotations/NamespacesWithAnnotations/=Arma3BEClient_002EAnnotations/@EntryIndexedValue">True</s:Boolean></wpf:ResourceDictionary>
```

`src/Arma3BEClient.sln.GhostDoc.xml`:

```xml
<GhostDoc>
  <IgnoreFilePatterns>
    <IgnoreFilePattern>*.min.js</IgnoreFilePattern>
    <IgnoreFilePattern>jquery*.js</IgnoreFilePattern>
  </IgnoreFilePatterns>
</GhostDoc>

```

`src/GlobalAssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Runtime.InteropServices;

// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.

[assembly: AssemblyTitle("Arma 3 BattlEye Client")]
[assembly: AssemblyDescription("This program is designed specifically for the TEHGAM community, with the main intended purpose of managing players and bans through the BattlEye protocol.")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("tym32167")]
[assembly: AssemblyProduct("Arma 3 BattlEye Client")]
[assembly: AssemblyCopyright("Copyright © 2018")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

[assembly: ComVisible(false)]

[assembly: AssemblyVersion("0.8.*")]
[assembly: System.Resources.NeutralResourcesLanguage("en")]
```

`src/build.bat`:

```bat
rd Arma3BE.Client\bin\Debug /s /q
msbuild Arma3BE.sln
```