Project Path: arc_gmh5225_KernelMoveMouse_0r0mjnlv

Source Tree:

```txt
arc_gmh5225_KernelMoveMouse_0r0mjnlv
├── kernelMoveMouse
│   ├── driver.cpp
│   ├── includes.hpp
│   ├── kernelMoveMouse.inf
│   ├── kernelMoveMouse.vcxproj
│   ├── kernelMoveMouse.vcxproj.filters
│   ├── memory.hpp
│   └── utility.hpp
└── kernelMoveMouse.sln

```

`kernelMoveMouse.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.1.32228.430
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "kernelMoveMouse", "kernelMoveMouse\kernelMoveMouse.vcxproj", "{4B453B69-D5BF-48A7-AC43-896E138756B1}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|ARM = Debug|ARM
		Debug|ARM64 = Debug|ARM64
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|ARM = Release|ARM
		Release|ARM64 = Release|ARM64
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|ARM.ActiveCfg = Debug|ARM
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|ARM.Build.0 = Debug|ARM
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|ARM64.ActiveCfg = Debug|ARM64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|ARM64.Build.0 = Debug|ARM64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|x64.ActiveCfg = Debug|x64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|x64.Build.0 = Debug|x64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|x86.ActiveCfg = Debug|Win32
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Debug|x86.Build.0 = Debug|Win32
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|ARM.ActiveCfg = Release|ARM
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|ARM.Build.0 = Release|ARM
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|ARM64.ActiveCfg = Release|ARM64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|ARM64.Build.0 = Release|ARM64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|x64.ActiveCfg = Release|x64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|x64.Build.0 = Release|x64
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|x86.ActiveCfg = Release|Win32
		{4B453B69-D5BF-48A7-AC43-896E138756B1}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {04A86405-F6F2-4A23-AFF0-41D4BF5E4195}
	EndGlobalSection
EndGlobal

```

`kernelMoveMouse/driver.cpp`:

```cpp
#include "includes.hpp"
#include "utility.hpp"

namespace driver
{
	bool get_offsets()
	{
		//offsets from 19041 - 22000 (Windows 11 21H2 - Windows 10 20H1)
		if ( globals::u_ver_build == 22000 || globals::u_ver_build == 19041 || globals::u_ver_build == 19042 || globals::u_ver_build == 19043 || globals::u_ver_build == 19044 )
		{
			globals::offsets::i_image_file_name = 0x5a8;
			globals::offsets::i_active_process_links = 0x448;
			globals::offsets::i_active_threads = 0x5f0;

			return true;
		}

		//1903-1909
		else if ( globals::u_ver_build == 18362 || globals::u_ver_build == 18363 )
		{
			globals::offsets::i_image_file_name = 0x450;
			globals::offsets::i_active_process_links = 0x2f0;
			globals::offsets::i_active_threads = 0x498;

			return true;
		}

		//if no offsets for their version is found
		return false;
	}

	bool b_version_check()
	{
		//get windows version info
		static OSVERSIONINFOW v_info{};
		RtlGetVersion( &v_info );

		//Close driver is user is not windows 10 or higher
		if ( v_info.dwMajorVersion < 10 )
		{
			DbgPrint( "Version check failed" );
			return false;
		}

		//store windows versions for later info
		globals::u_ver_major = v_info.dwMajorVersion;
		globals::u_ver_build = v_info.dwBuildNumber;

		//get windows offsets for this windows build
		if ( !get_offsets() )
		{
			DbgPrint( "Failed to get current offsets" );
			return false;
		}

		return true;
	}

	extern "C" NTSTATUS driver_entry( PDRIVER_OBJECT  driver_object, PUNICODE_STRING registry_path )
	{
		UNREFERENCED_PARAMETER( registry_path );
		UNREFERENCED_PARAMETER( driver_object );

		//check version and get version offsets
		if ( !b_version_check() )
			return STATUS_UNSUCCESSFUL;
			

		ULONG mouse_x = 150;
		ULONG mouse_y = 150;

		//move mouse from WinApi function reference
		//sadly, only works while mouse position is already being updated, i.e. while the mouse is already moving
		utility::move_mouse( mouse_x, mouse_y );

		return STATUS_SUCCESS;
	}
}
```

`kernelMoveMouse/includes.hpp`:

```hpp
#pragma once
#include <ntifs.h>
#include <windef.h>

//global offsets
namespace globals
{
    //windows version
    ULONG u_ver_build = 0;
    ULONG u_ver_major = 0;

    namespace offsets
    {
        //EPROCESS->ImageFileName
        int i_image_file_name = 0x0;

        //EPROCESS->ActiveThreads
        int i_active_threads = 0x0;

        //EPROCESS->ActiveProcessLinks
        int i_active_process_links = 0x0;
    }
}

//undefined kernel structs
typedef struct _LDR_DATA_TABLE_ENTRY
{
    LIST_ENTRY InLoadOrderLinks;
    LIST_ENTRY InMemoryOrderLinks;
    LIST_ENTRY InInitializationOrderLinks;
    PVOID DllBase;
    PVOID EntryPoint;
    ULONG SizeOfImage;
    UNICODE_STRING FullDllName;
    UNICODE_STRING BaseDllName;
    ULONG Flags;
    WORD LoadCount;
    WORD TlsIndex;
    union
    {
        LIST_ENTRY HashLinks;
        struct
        {
            PVOID SectionPointer;
            ULONG CheckSum;
        };
    };
    union
    {
        ULONG TimeDateStamp;
        PVOID LoadedImports;
    };
    VOID* EntryPointActivationContext;
    PVOID PatchInformation;
    LIST_ENTRY ForwarderLinks;
    LIST_ENTRY ServiceTagLinks;
    LIST_ENTRY StaticLinks;
} LDR_DATA_TABLE_ENTRY, * PLDR_DATA_TABLE_ENTRY;


//undefined kernel functions
extern "C"
{
    __declspec(dllimport) PLIST_ENTRY NTAPI PsLoadedModuleList;
    __declspec(dllimport) POBJECT_TYPE* IoDriverObjectType;
    __declspec(dllimport) PVOID NTAPI RtlFindExportedRoutineByName( PVOID, PCCH );
    __declspec(dllimport) PVOID NTAPI PsGetProcessSectionBaseAddress( PEPROCESS );
    __declspec(dllimport) PPEB NTAPI PsGetProcessPeb( PEPROCESS );
    __declspec(dllimport) NTSTATUS NTAPI ZwProtectVirtualMemory( HANDLE, PVOID*, PSIZE_T, ULONG, PULONG );
    __declspec(dllimport) PIMAGE_NT_HEADERS NTAPI RtlImageNtHeader( PVOID );
    __declspec(dllimport) NTSTATUS NTAPI ObReferenceObjectByName( PUNICODE_STRING, ULONG, PACCESS_STATE, ACCESS_MASK, POBJECT_TYPE, KPROCESSOR_MODE, PVOID OPTIONAL, PVOID* );
}

```

`kernelMoveMouse/kernelMoveMouse.inf`:

```inf
;
; kernelMoveMouse.inf
;

[Version]
Signature="$WINDOWS NT$"
Class=System ; TODO: specify appropriate Class
ClassGuid={4d36e97d-e325-11ce-bfc1-08002be10318} ; TODO: specify appropriate ClassGuid
Provider=%ManufacturerName%
CatalogFile=kernelMoveMouse.cat
DriverVer= ; TODO: set DriverVer in stampinf property pages
PnpLockdown=1

[DestinationDirs]
DefaultDestDir = 12
kernelMoveMouse_Device_CoInstaller_CopyFiles = 11

[SourceDisksNames]
1 = %DiskName%,,,""

[SourceDisksFiles]
kernelMoveMouse.sys  = 1,,
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll=1 ; make sure the number matches with SourceDisksNames

;*****************************************
; Install Section
;*****************************************

[Manufacturer]
%ManufacturerName%=Standard,NT$ARCH$

[Standard.NT$ARCH$]
%kernelMoveMouse.DeviceDesc%=kernelMoveMouse_Device, Root\kernelMoveMouse ; TODO: edit hw-id

[kernelMoveMouse_Device.NT]
CopyFiles=Drivers_Dir

[Drivers_Dir]
kernelMoveMouse.sys

;-------------- Service installation
[kernelMoveMouse_Device.NT.Services]
AddService = kernelMoveMouse,%SPSVCINST_ASSOCSERVICE%, kernelMoveMouse_Service_Inst

; -------------- kernelMoveMouse driver install sections
[kernelMoveMouse_Service_Inst]
DisplayName    = %kernelMoveMouse.SVCDESC%
ServiceType    = 1               ; SERVICE_KERNEL_DRIVER
StartType      = 3               ; SERVICE_DEMAND_START
ErrorControl   = 1               ; SERVICE_ERROR_NORMAL
ServiceBinary  = %12%\kernelMoveMouse.sys

;
;--- kernelMoveMouse_Device Coinstaller installation ------
;

[kernelMoveMouse_Device.NT.CoInstallers]
AddReg=kernelMoveMouse_Device_CoInstaller_AddReg
CopyFiles=kernelMoveMouse_Device_CoInstaller_CopyFiles

[kernelMoveMouse_Device_CoInstaller_AddReg]
HKR,,CoInstallers32,0x00010000, "WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll,WdfCoInstaller"

[kernelMoveMouse_Device_CoInstaller_CopyFiles]
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll

[kernelMoveMouse_Device.NT.Wdf]
KmdfService =  kernelMoveMouse, kernelMoveMouse_wdfsect
[kernelMoveMouse_wdfsect]
KmdfLibraryVersion = $KMDFVERSION$

[Strings]
SPSVCINST_ASSOCSERVICE= 0x00000002
ManufacturerName="<Your manufacturer name>" ;TODO: Replace with your manufacturer name
DiskName = "kernelMoveMouse Installation Disk"
kernelMoveMouse.DeviceDesc = "kernelMoveMouse Device"
kernelMoveMouse.SVCDESC = "kernelMoveMouse Service"

```

`kernelMoveMouse/kernelMoveMouse.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM">
      <Configuration>Debug</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM">
      <Configuration>Release</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM64">
      <Configuration>Debug</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM64">
      <Configuration>Release</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{4B453B69-D5BF-48A7-AC43-896E138756B1}</ProjectGuid>
    <TemplateGuid>{1bc93793-694f-48fe-9372-81e2b05556fd}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>12.0</MinimumVisualStudioVersion>
    <Configuration>Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>kernelMoveMouse</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
    <Driver_SpectreMitigation>Spectre</Driver_SpectreMitigation>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
    <ClCompile>
      <BufferSecurityCheck>false</BufferSecurityCheck>
      <TreatWarningAsError>false</TreatWarningAsError>
    </ClCompile>
    <Link>
      <EntryPointSymbol>driver_entry</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="driver.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="includes.hpp" />
    <ClInclude Include="memory.hpp" />
    <ClInclude Include="utility.hpp" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`kernelMoveMouse/kernelMoveMouse.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <ClCompile Include="driver.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="includes.hpp" />
    <ClInclude Include="memory.hpp" />
    <ClInclude Include="utility.hpp" />
  </ItemGroup>
</Project>
```

`kernelMoveMouse/memory.hpp`:

```hpp
#pragma once
#include "includes.hpp"
#include <cstdint>

namespace memory
{
	//get process by name
	PEPROCESS get_process( char* process_name )
	{
		uintptr_t list_head = *(uintptr_t*)((uintptr_t)PsInitialSystemProcess + globals::offsets::i_active_process_links);
		uintptr_t list_current = list_head;

		do
		{
			uintptr_t list_entry = list_current - globals::offsets::i_active_process_links;

			if ( !_stricmp( process_name, (char*)(list_entry + globals::offsets::i_image_file_name) ) )
			{
				return (PEPROCESS)list_entry;
			}

			list_current = *(uintptr_t*)list_current;
		} while ( list_current != list_head );

		return NULL;
	}

	//get kernel module
	PLDR_DATA_TABLE_ENTRY system_module( const wchar_t* module_name )
	{
		static const auto ntoskrnl_base = *reinterpret_cast<const char**>(std::uintptr_t( PsLoadedModuleList ) + 0x30);

		UNICODE_STRING unicode_string{ };
		RtlInitUnicodeString( &unicode_string, module_name );

		PLDR_DATA_TABLE_ENTRY system_module_entry = nullptr;

		for ( auto entry = PsLoadedModuleList; entry != PsLoadedModuleList->Blink; entry = entry->Flink )
		{
			PLDR_DATA_TABLE_ENTRY data_table = CONTAINING_RECORD( entry, LDR_DATA_TABLE_ENTRY, InLoadOrderLinks );

			if ( RtlEqualUnicodeString( &data_table->BaseDllName, &unicode_string, TRUE ) )
			{
				system_module_entry = data_table;
				break;
			}
		}

		return system_module_entry;
	}

	//get WinAPI function
	void* system_export( const wchar_t* module_name, const char* export_name )
	{
		static const auto ntoskrnl_base = *reinterpret_cast<const char**>(std::uintptr_t( PsLoadedModuleList ) + 0x30);

		const auto module = system_module( module_name );

		if ( !module )
			return nullptr;

		return RtlFindExportedRoutineByName( module->DllBase, export_name );
	}
}

```

`kernelMoveMouse/utility.hpp`:

```hpp
#pragma once
#include "includes.hpp"
#include "memory.hpp"

namespace utility
{
	void move_mouse( ULONG point1, ULONG point2 )
	{
		PEPROCESS winlogon_peprocess = memory::get_process( (char*)"winlogon.exe" );
		if ( winlogon_peprocess )
		{
			KAPC_STATE apc = { 0 };
			KeStackAttachProcess( winlogon_peprocess, &apc );

			uint64_t gptCursorAsync = reinterpret_cast<uint64_t>(memory::system_export( L"win32kbase.sys", "gptCursorAsync" ));

			POINT cursor = *(POINT*)(gptCursorAsync);

			cursor.x = point1;
			cursor.y = point2;

			*(POINT*)(gptCursorAsync) = cursor;

			KeUnstackDetachProcess( &apc );
		}
	}
}
```