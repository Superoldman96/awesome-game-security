Project Path: arc_gmh5225_EtwExplorer_uc8gg9dy

Source Tree:

```txt
arc_gmh5225_EtwExplorer_uc8gg9dy
├── EtwExplorer
│   ├── App.config
│   ├── App.xaml
│   ├── App.xaml.cs
│   ├── Constants.cs
│   ├── EtwExplorer.csproj
│   ├── Icons
│   │   ├── app.ico
│   │   ├── events.ico
│   │   ├── keywords.ico
│   │   ├── open.ico
│   │   ├── pin-red.ico
│   │   ├── strings.ico
│   │   ├── summary.ico
│   │   ├── tasks.ico
│   │   └── xml.ico
│   ├── MainWindow.xaml
│   ├── MainWindow.xaml.cs
│   ├── Properties
│   │   ├── AssemblyInfo.cs
│   │   ├── Resources.Designer.cs
│   │   ├── Resources.resx
│   │   ├── Settings.Designer.cs
│   │   └── Settings.settings
│   ├── Resources
│   │   ├── Styles.xaml
│   │   └── Templates.xaml
│   ├── ViewModels
│   │   ├── EtwEventViewModel.cs
│   │   ├── EtwProviderSelectionViewModel.cs
│   │   ├── EventsTabViewModel.cs
│   │   ├── KeywordsTabViewModel.cs
│   │   ├── MainViewModel.cs
│   │   ├── StringsTabViewModel.cs
│   │   ├── SummaryTabViewModel.cs
│   │   ├── TabViewModelBase.cs
│   │   └── XmlTabViewModel.cs
│   ├── Views
│   │   ├── EtwProviderSelectionDialog.xaml
│   │   ├── EtwProviderSelectionDialog.xaml.cs
│   │   ├── EventsTabView.xaml
│   │   ├── EventsTabView.xaml.cs
│   │   ├── KeywordsTabView.xaml
│   │   ├── KeywordsTabView.xaml.cs
│   │   ├── MainView.xaml
│   │   ├── MainView.xaml.cs
│   │   ├── StringsTabView.xaml
│   │   ├── StringsTabView.xaml.cs
│   │   ├── SummaryTabView.xaml
│   │   ├── SummaryTabView.xaml.cs
│   │   ├── XmlTabView.xaml
│   │   └── XmlTabView.xaml.cs
│   ├── app.ico
│   └── packages.config
├── EtwExplorer.sln
├── EtwManifestParsing
│   ├── EtwEvent.cs
│   ├── EtwKeyword.cs
│   ├── EtwManifest.cs
│   ├── EtwManifestParsing.csproj
│   ├── EtwTask.cs
│   ├── EtwTemplate.cs
│   ├── ManifestParser.cs
│   ├── Properties
│   │   └── AssemblyInfo.cs
│   ├── app.config
│   └── packages.config
├── MigrationBackup
│   └── ae6cc1ee
│       └── EtwExplorer
│           ├── EtwExplorer.csproj
│           ├── NuGetUpgradeLog.html
│           └── packages.config
├── README.md
└── etwexplorer2.PNG

```

`EtwExplorer.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30114.128
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "EtwManifestParsing", "EtwManifestParsing\EtwManifestParsing.csproj", "{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "EtwExplorer", "EtwExplorer\EtwExplorer.csproj", "{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|Any CPU = Release|Any CPU
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Debug|x64.ActiveCfg = Debug|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Debug|x64.Build.0 = Debug|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Debug|x86.ActiveCfg = Debug|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Debug|x86.Build.0 = Debug|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Release|Any CPU.Build.0 = Release|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Release|x64.ActiveCfg = Release|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Release|x64.Build.0 = Release|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Release|x86.ActiveCfg = Release|Any CPU
		{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}.Release|x86.Build.0 = Release|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Debug|x64.ActiveCfg = Debug|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Debug|x64.Build.0 = Debug|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Debug|x86.ActiveCfg = Debug|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Debug|x86.Build.0 = Debug|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Release|Any CPU.Build.0 = Release|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Release|x64.ActiveCfg = Release|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Release|x64.Build.0 = Release|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Release|x86.ActiveCfg = Release|Any CPU
		{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}.Release|x86.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {3F746535-0F71-480E-B29E-0BD3025FFDE0}
	EndGlobalSection
EndGlobal

```

`EtwExplorer/App.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Prism" publicKeyToken="40ee6c3a2184dc59" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-8.0.0.1909" newVersion="8.0.0.1909" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.0.0.0" newVersion="5.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration>
```

`EtwExplorer/App.xaml`:

```xaml
<Application x:Class="EtwExplorer.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:EtwExplorer"
             >
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Cobalt.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseLight.xaml" />
                <ResourceDictionary Source="/Resources/Templates.xaml" />
                <ResourceDictionary Source="/Resources/Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Application.Resources>
</Application>

```

`EtwExplorer/App.xaml.cs`:

```cs
using EtwExplorer.ViewModels;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using Zodiacon.WPF;

namespace EtwExplorer {
	/// <summary>
	/// Interaction logic for App.xaml
	/// </summary>
	public partial class App : Application {
		protected override void OnStartup(StartupEventArgs e) {
			base.OnStartup(e);

			var ui = new UIServicesDefaults();
			var vm = new MainViewModel(ui);
			var win = new MainWindow { DataContext = vm };
			win.Show();
			ui.MessageBoxService.SetOwner(win);
			ShutdownMode = ShutdownMode.OnLastWindowClose;
		}
	}
}

```

`EtwExplorer/Constants.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwExplorer {
	static class Constants {
		public const string AppTitle = "ETW Explorer";
	}
}

```

`EtwExplorer/EtwExplorer.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\build\Microsoft.Diagnostics.Tracing.TraceEvent.props" Condition="Exists('..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\build\Microsoft.Diagnostics.Tracing.TraceEvent.props')" />
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{BBFF1320-0463-4B2E-B94F-5AADB60ECCDD}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <RootNamespace>EtwExplorer</RootNamespace>
    <AssemblyName>EtwExplorer</AssemblyName>
    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <Deterministic>true</Deterministic>
    <NuGetPackageImportStamp>
    </NuGetPackageImportStamp>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationIcon>app.ico</ApplicationIcon>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="ControlzEx, Version=3.0.2.4, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\ControlzEx.3.0.2.4\lib\net462\ControlzEx.dll</HintPath>
    </Reference>
    <Reference Include="Dia2Lib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\lib\net45\Dia2Lib.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="MahApps.Metro, Version=1.6.5.1, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\MahApps.Metro.1.6.5\lib\net47\MahApps.Metro.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Diagnostics.FastSerialization, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\lib\net45\Microsoft.Diagnostics.FastSerialization.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Diagnostics.Tracing.TraceEvent, Version=2.0.66.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\lib\net45\Microsoft.Diagnostics.Tracing.TraceEvent.dll</HintPath>
    </Reference>
    <Reference Include="OSExtensions, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\lib\net45\OSExtensions.dll</HintPath>
    </Reference>
    <Reference Include="Prism, Version=8.0.0.1909, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.8.0.0.1909\lib\net47\Prism.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.ComponentModel.Composition" />
    <Reference Include="System.Data" />
    <Reference Include="System.Runtime.CompilerServices.Unsafe, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Runtime.CompilerServices.Unsafe.5.0.0\lib\net45\System.Runtime.CompilerServices.Unsafe.dll</HintPath>
    </Reference>
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\ControlzEx.3.0.2.4\lib\net462\System.Windows.Interactivity.dll</HintPath>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="TraceReloggerLib, Version=0.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\lib\net45\TraceReloggerLib.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Zodiacon.WPF, Version=1.1.7035.29785, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\Zodiacon.WPF.1.3.0\lib\net462\Zodiacon.WPF.dll</HintPath>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <ApplicationDefinition Include="App.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </ApplicationDefinition>
    <Compile Include="Constants.cs" />
    <Compile Include="ViewModels\EtwEventViewModel.cs" />
    <Compile Include="ViewModels\EtwProviderSelectionViewModel.cs" />
    <Compile Include="ViewModels\EventsTabViewModel.cs" />
    <Compile Include="ViewModels\KeywordsTabViewModel.cs" />
    <Compile Include="ViewModels\MainViewModel.cs" />
    <Compile Include="ViewModels\StringsTabViewModel.cs" />
    <Compile Include="ViewModels\SummaryTabViewModel.cs" />
    <Compile Include="ViewModels\TabViewModelBase.cs" />
    <Compile Include="ViewModels\XmlTabViewModel.cs" />
    <Compile Include="Views\EtwProviderSelectionDialog.xaml.cs">
      <DependentUpon>EtwProviderSelectionDialog.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\EventsTabView.xaml.cs">
      <DependentUpon>EventsTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\KeywordsTabView.xaml.cs">
      <DependentUpon>KeywordsTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\MainView.xaml.cs">
      <DependentUpon>MainView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\StringsTabView.xaml.cs">
      <DependentUpon>StringsTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\SummaryTabView.xaml.cs">
      <DependentUpon>SummaryTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\XmlTabView.xaml.cs">
      <DependentUpon>XmlTabView.xaml</DependentUpon>
    </Compile>
    <Page Include="MainWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Compile Include="App.xaml.cs">
      <DependentUpon>App.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="MainWindow.xaml.cs">
      <DependentUpon>MainWindow.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
    <Page Include="Resources\Styles.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Resources\Templates.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\EtwProviderSelectionDialog.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\EventsTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\KeywordsTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\MainView.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\StringsTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\SummaryTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Page Include="Views\XmlTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <None Include="packages.config" />
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\EtwManifestParsing\EtwManifestParsing.csproj">
      <Project>{8a9bf640-39f0-4c33-896c-da83dd1dfbf6}</Project>
      <Name>EtwManifestParsing</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Resource Include="Icons\app.ico" />
    <Resource Include="Icons\events.ico" />
    <Resource Include="Icons\keywords.ico" />
    <Resource Include="Icons\open.ico" />
    <Resource Include="Icons\pin-red.ico" />
    <Resource Include="Icons\strings.ico" />
    <Resource Include="Icons\summary.ico" />
    <Resource Include="Icons\tasks.ico" />
    <Resource Include="Icons\xml.ico" />
  </ItemGroup>
  <ItemGroup>
    <Resource Include="app.ico" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
      <ErrorText>This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\build\Microsoft.Diagnostics.Tracing.TraceEvent.props')" Text="$([System.String]::Format('$(ErrorText)', '..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.66\build\Microsoft.Diagnostics.Tracing.TraceEvent.props'))" />
  </Target>
</Project>
```

`EtwExplorer/MainWindow.xaml`:

```xaml
<metro:MetroWindow x:Class="EtwExplorer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:local="clr-namespace:EtwExplorer"
        xmlns:view="clr-namespace:EtwExplorer.Views"
        mc:Ignorable="d"
        Title="ETW Explorer v0.39 (C)2019 Pavel Yosifovch" TitleCaps="False" ResizeMode="CanResizeWithGrip"
                   Icon="/icons/app.ico">
    <view:MainView>
        
    </view:MainView>
</metro:MetroWindow>

```

`EtwExplorer/MainWindow.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer {
	/// <summary>
	/// Interaction logic for MainWindow.xaml
	/// </summary>
	public partial class MainWindow {
		public MainWindow() {
			InitializeComponent();
		}
	}
}

```

`EtwExplorer/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Resources;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Windows;

// General Information about an assembly is controlled through the following
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
[assembly: AssemblyTitle("EtwExplorer")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("EtwExplorer")]
[assembly: AssemblyCopyright("Copyright ©  2020")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Setting ComVisible to false makes the types in this assembly not visible
// to COM components.  If you need to access a type in this assembly from
// COM, set the ComVisible attribute to true on that type.
[assembly: ComVisible(false)]

//In order to begin building localizable applications, set
//<UICulture>CultureYouAreCodingWith</UICulture> in your .csproj file
//inside a <PropertyGroup>.  For example, if you are using US english
//in your source files, set the <UICulture> to en-US.  Then uncomment
//the NeutralResourceLanguage attribute below.  Update the "en-US" in
//the line below to match the UICulture setting in the project file.

//[assembly: NeutralResourcesLanguage("en-US", UltimateResourceFallbackLocation.Satellite)]


[assembly: ThemeInfo(
    ResourceDictionaryLocation.None, //where theme specific resource dictionaries are located
                                     //(used if a resource is not found in the page,
                                     // or application resource dictionaries)
    ResourceDictionaryLocation.SourceAssembly //where the generic resource dictionary is located
                                              //(used if a resource is not found in the page,
                                              // app, or any theme specific resource dictionaries)
)]


// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Build and Revision Numbers
// by using the '*' as shown below:
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]

```

`EtwExplorer/Properties/Resources.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace EtwExplorer.Properties {


    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "4.0.0.0")]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    internal class Resources {

        private static global::System.Resources.ResourceManager resourceMan;

        private static global::System.Globalization.CultureInfo resourceCulture;

        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }

        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("EtwExplorer.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }

        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}

```

`EtwExplorer/Properties/Resources.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>
```

`EtwExplorer/Properties/Settings.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace EtwExplorer.Properties {


    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator", "11.0.0.0")]
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {

        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));

        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}

```

`EtwExplorer/Properties/Settings.settings`:

```settings
<?xml version='1.0' encoding='utf-8'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>
```

`EtwExplorer/Resources/Styles.xaml`:

```xaml
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    >
    <Style TargetType="TextBlock" x:Key="DataGridCellRightJustifiedStyle" >
        <Setter Property="TextAlignment" Value="Right" />
    </Style>
</ResourceDictionary>
```

`EtwExplorer/Resources/Templates.xaml`:

```xaml
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:view="clr-namespace:EtwExplorer.Views"
                    xmlns:vm="clr-namespace:EtwExplorer.ViewModels">
    <DataTemplate DataType="{x:Type vm:StringsTabViewModel}">
        <view:StringsTabView />
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:SummaryTabViewModel}">
        <view:SummaryTabView />
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:EventsTabViewModel}">
        <view:EventsTabView />
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:XmlTabViewModel}">
        <view:XmlTabView />
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:KeywordsTabViewModel}">
        <view:KeywordsTabView />
    </DataTemplate>
</ResourceDictionary>
```

`EtwExplorer/ViewModels/EtwEventViewModel.cs`:

```cs
using EtwManifestParsing;
using Prism.Mvvm;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwExplorer.ViewModels {

	sealed class EtwEventViewModel : BindableBase {
		public EtwEvent Event { get; }
		EtwManifest _manifest;

		public EtwEventViewModel(EtwEvent evt, EtwManifest manifest) {
			Event = evt;
			_manifest = manifest;
		}

		public IEnumerable<EtwTemplateData> EventDetails => _manifest.Templates.First(t => t.Id == Event.Template).Items;

	}
}

```

`EtwExplorer/ViewModels/EtwProviderSelectionViewModel.cs`:

```cs
using Microsoft.Diagnostics.Tracing.Session;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Data;
using Zodiacon.WPF;

namespace EtwExplorer.ViewModels {
	sealed class Provider {
		public string Name { get; set; }
		public Guid Guid { get; set; }
	}

	sealed class EtwProviderSelectionViewModel : DialogViewModelBase {
		static Provider[] _providers;

		static EtwProviderSelectionViewModel() {
			_providers = TraceEventProviders.GetPublishedProviders().Select(g => new Provider {
				Name = TraceEventProviders.GetProviderName(g),
				Guid = g
			}).ToArray();
		}

		public EtwProviderSelectionViewModel(Window dialog) : base(dialog) {
			CollectionViewSource.GetDefaultView(Providers).Filter = null;
			IsLikely = true;
		}

		public IEnumerable<Provider> Providers => _providers;

		Provider _selectedProvider;
		public Provider SelectedProvider {
			get => _selectedProvider;
			set => SetProperty(ref _selectedProvider, value);
		}

		string _searchText;
		public string SearchText {
			get => _searchText;
			set {
				if (SetProperty(ref _searchText, value)) {
					var cvs = CollectionViewSource.GetDefaultView(Providers);
					if (string.IsNullOrWhiteSpace(_searchText)) {
						cvs.Filter = IsLikely ? obj => (((Provider)obj).Name.IndexOf(' ') < 0) : (Predicate<object>)null;
					}
					else {
						string text = _searchText.ToLower();
						cvs.Filter = obj => {
							var provider = (Provider)obj;
							return provider.Name.ToLower().Contains(text);
						};
					}
				}
			}
		}

		bool _closeCurrentManifest = true;
		public bool CloseCurrentManifest {
			get => _closeCurrentManifest;
			set => SetProperty(ref _closeCurrentManifest, value);
		}

		bool _isLikely;
		public bool IsLikely {
			get => _isLikely;
			set {
				if (SetProperty(ref _isLikely, value)) {
					var cvs = CollectionViewSource.GetDefaultView(Providers);
					if (!string.IsNullOrWhiteSpace(SearchText))
						return;
					cvs.Filter = IsLikely ? obj => (((Provider)obj).Name.IndexOf(' ') < 0) : (Predicate<object>)null;

				}
			}
		}

        protected override void OnOK() {
			if (SelectedProvider == null)
				return;

            base.OnOK();
        }
    }
}

```

`EtwExplorer/ViewModels/EventsTabViewModel.cs`:

```cs
using EtwManifestParsing;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Data;

namespace EtwExplorer.ViewModels {
	sealed class EventsTabViewModel : TabViewModelBase {
		public override string Icon => "/icons/events.ico";

		public override string Header => "Events";

		readonly EtwManifest _manifest;
		public EventsTabViewModel(EtwManifest manifest) {
			_manifest = manifest;
			Events = _manifest.Events.Select(evt => new EtwEventViewModel(evt, _manifest)).ToArray();
		}

		public EtwEventViewModel[] Events { get; }

		string _searchText;
		public string SearchText {
			get => _searchText;
			set {
				if (SetProperty(ref _searchText, value)) {
					var cvs = CollectionViewSource.GetDefaultView(Events);
					if (string.IsNullOrWhiteSpace(_searchText))
						cvs.Filter = null;
					else {
						string text = _searchText.ToLower();
						cvs.Filter = obj => {
							var evt = ((EtwEventViewModel)obj).Event;
							return evt.Symbol.ToLower().Contains(text) || evt.Opcode.ToLower().Contains(text) || evt.Task.ToLower().Contains(text);
						};
					}
				}
			}
		}
	}
}

```

`EtwExplorer/ViewModels/KeywordsTabViewModel.cs`:

```cs
using EtwManifestParsing;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwExplorer.ViewModels
{
	class KeywordsTabViewModel : TabViewModelBase {
		public override string Icon => "/icons/keywords.ico";

		public override string Header => "Keywords";

		public EtwKeyword[] Keywords { get; }

		public KeywordsTabViewModel(EtwManifest manifest) {
			Keywords = manifest.Keywords;
		}

		public KeywordsTabViewModel(EtwKeyword[] keywords) {
			Keywords = keywords;
		}
	}
}

```

`EtwExplorer/ViewModels/MainViewModel.cs`:

```cs
using EtwExplorer.Views;
using EtwManifestParsing;
using Microsoft.Diagnostics.Tracing.Parsers;
using Microsoft.Diagnostics.Tracing.Session;
using Prism.Commands;
using Prism.Mvvm;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;
using Zodiacon.WPF;

namespace EtwExplorer.ViewModels {
	class MainViewModel : BindableBase {
		public readonly IUIServices UI;
		ObservableCollection<TabViewModelBase> _tabs = new ObservableCollection<TabViewModelBase>();
		public IList<TabViewModelBase> Tabs => _tabs;

		public EtwManifest Manifest { get; private set; }
		public EtwKeyword[] Keywords { get; private set; }

		string _filename;
		public string FileName {
			get => _filename;
			set => SetProperty(ref _filename, value);
		}

		string _providerName;
		public string ProviderName {
			get => _providerName;
			set => SetProperty(ref _providerName, value);
		}

		public MainViewModel(IUIServices ui, EtwManifest manifest = null) {
			UI = ui;
			Manifest = manifest;
			if (manifest != null) {
				AddTabs();
				ProviderName = manifest.ProviderName;
			}
		}

		public MainViewModel(IUIServices ui, EtwKeyword[] keywords, string providerName) {
			UI = ui;
			ProviderName = providerName;
			Keywords = keywords;
			AddTabs();
		}

		private void AddTabs() {
			if (Keywords == null) {
				Tabs.Add(new SummaryTabViewModel(Manifest));
				Tabs.Add(new EventsTabViewModel(Manifest));
				Tabs.Add(new KeywordsTabViewModel(Manifest));
				Tabs.Add(new StringsTabViewModel(Manifest));
				Tabs.Add(new XmlTabViewModel(Manifest.Xml));
			}
			else {
				Tabs.Add(new KeywordsTabViewModel(Keywords));
			}
			SelectedTab = Tabs[0];
		}

		public ICommand ExitCommand => new DelegateCommand(() => Application.Current.Shutdown());
		public ICommand OpenXmlCommand => new DelegateCommand(() => {
			var filename = UI.FileDialogService.GetFileForOpen("Xml Files|*.xml", "Open XML Manifest");
			if (filename == null)
				return;

			DoOpenFile(filename);
		});

		public ICommand CloseCommand => new DelegateCommand(DoClose);

		void DoClose() {
			Manifest = null;
			Keywords = null;
			Tabs.Clear();
			FileName = null;
			RaisePropertyChanged(nameof(Manifest));
		}

		public ICommand OpenRegisteredCommand => new DelegateCommand(() => {
			var vm = UI.DialogService.CreateDialog<EtwProviderSelectionViewModel, EtwProviderSelectionDialog>();
			if (true == vm.ShowDialog()) {
				if (vm.CloseCurrentManifest)
					DoClose();
				try {
					var xml = string.Empty;
					try {
						xml = RegisteredTraceEventParser.GetManifestForRegisteredProvider(vm.SelectedProvider.Guid);
					}
					catch (ApplicationException ae) {
						// look for a WMI EventTrace class instead - but throw the original exception otherwise
						try {
							DoOpenWmiEventTrace(vm.SelectedProvider.Guid);
							UI.MessageBoxService.ShowMessage($"{ae.Message}\n\nShowing WMI EventTrace class details instead.", Constants.AppTitle, MessageBoxButton.OK, MessageBoxImage.Information);
						}
						catch {
							throw ae;
						}
					}

					if (xml.Length > 0)
						DoOpenXml(xml);

					Keywords = null;
				}
				catch (Exception e) {
					var keywords = TraceEventProviders.GetProviderKeywords(vm.SelectedProvider.Guid).Select(info => new EtwKeyword {
						Name = info.Name,
						Mask = info.Value,
						Message = info.Description
					}).ToArray();
					UI.MessageBoxService.ShowMessage($"{e.Message}\nShowing keywords only.", Constants.AppTitle, MessageBoxButton.OK, MessageBoxImage.Warning);

					if (vm.CloseCurrentManifest) {
						DoClose();
						Keywords = keywords;
						AddTabs();
					}
					else {
						var winvm = new MainViewModel(UI, keywords, vm.SelectedProvider.Name);
						var win = new MainWindow { DataContext = winvm };
						win.Show();
					}
				}
			}
		});

		private void DoOpenXml(string xml) {
			DoOpen(ManifestParser.Parse(xml));
		}

		private void DoOpenWmiEventTrace(Guid provider) {
			DoOpen(ManifestParser.ParseWmiEventTraceClass(provider));
		}

		private void DoOpen(EtwManifest manifest) {
			if (Manifest == null) {
				Manifest = manifest;
				RaisePropertyChanged(nameof(Manifest));
				ProviderName = Manifest.ProviderName;
				AddTabs();
			}
			else {
				var vm = new MainViewModel(UI, manifest);
				var win = new MainWindow { DataContext = vm };
				win.Show();
			}
		}

		TabViewModelBase _selectedTab;
		public TabViewModelBase SelectedTab {
			get => _selectedTab;
			set => SetProperty(ref _selectedTab, value);
		}

		private void DoOpenFile(string filename) {
			try {
				var manifest = ManifestParser.Parse(File.ReadAllText(filename));
				if (Manifest == null) {
					Manifest = manifest;
					FileName = filename;
					ProviderName = Manifest.ProviderName;
					RaisePropertyChanged(nameof(Manifest));
					AddTabs();
				}
				else {
					var vm = new MainViewModel(UI, manifest);
					vm.FileName = filename;
					var win = new MainWindow { DataContext = vm };
					win.Show();
				}
				
			}
			catch (Exception ex) {
				UI.MessageBoxService.ShowMessage($"Error: {ex.Message}", Constants.AppTitle);
			}
		}

		public DelegateCommand SaveXmlCommand => new DelegateCommand(() => {
			var filename = UI.FileDialogService.GetFileForSave("XML files|*.xml|All Files|*.*");
			if (filename == null)
				return;
			DoSave(filename);
		}, () => Manifest != null).ObservesProperty(() => Manifest);

		private void DoSave(string filename) {
			try {
				File.WriteAllText(filename, Manifest.Xml);
			}
			catch (IOException ex) {
				UI.MessageBoxService.ShowMessage(ex.Message, Constants.AppTitle, MessageBoxButton.OK, MessageBoxImage.Error);
			}
		}
	}
}

```

`EtwExplorer/ViewModels/StringsTabViewModel.cs`:

```cs
using EtwManifestParsing;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Data;

namespace EtwExplorer.ViewModels {
	sealed class StringsTabViewModel : TabViewModelBase {
		public class Item {
			public string Name { get; set; }
			public string Value { get; set; }
		}

		public override string Icon => "/icons/strings.ico";

		public override string Header => "Strings";

		readonly EtwManifest _manifest;
		public StringsTabViewModel(EtwManifest manifest) {
			Debug.Assert(manifest != null);

			_manifest = manifest;
			Strings = _manifest.StringTable.Select(pair => new Item { Name = pair.Key, Value = pair.Value }).ToArray();
		}

		public Item[] Strings { get; }

		string _searchText;
		public string SearchText {
			get => _searchText;
			set {
				if (SetProperty(ref _searchText, value)) {
					var cvs = CollectionViewSource.GetDefaultView(Strings);
					if (string.IsNullOrWhiteSpace(_searchText))
						cvs.Filter = null;
					else {
						string text = _searchText.ToLower();
						cvs.Filter = obj => {
							var item = (Item)obj;
							return item.Name.ToLower().Contains(text) || item.Value.ToLower().Contains(text);
						};
					}
				}
			}
		}

	}
}

```

`EtwExplorer/ViewModels/SummaryTabViewModel.cs`:

```cs
using EtwManifestParsing;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwExplorer.ViewModels {
	sealed class SummaryTabViewModel : TabViewModelBase {
		public override string Icon => "/icons/summary.ico";

		public override string Header => "Summary";

		readonly EtwManifest _manifest;
		public SummaryTabViewModel(EtwManifest manifest) {
			_manifest = manifest;
		}

		public string ProviderName => _manifest.ProviderName;
		public Guid ProviderGuid => _manifest.ProviderGuid;
		public string ProviderSymbol => _manifest.ProviderSymbol;
		public int EventCount => _manifest.Events.Length;
		public int KeywordCount => _manifest.Keywords.Length;
		public int? TaskCount => _manifest.Tasks?.Length;
		public int TemplateCount => _manifest.Templates.Length;
	}
}

```

`EtwExplorer/ViewModels/TabViewModelBase.cs`:

```cs
using Prism.Mvvm;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwExplorer.ViewModels {
	abstract class TabViewModelBase : BindableBase {
		public abstract string Icon { get; }
		public abstract string Header { get; }
	}
}

```

`EtwExplorer/ViewModels/XmlTabViewModel.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwExplorer.ViewModels {
	sealed class XmlTabViewModel : TabViewModelBase {
		public override string Icon => "/icons/xml.ico";

		public override string Header => "XML";

		public string Xml { get; }
		public XmlTabViewModel(string xml) {
			Xml = xml;
		}

		
	}
}

```

`EtwExplorer/Views/EtwProviderSelectionDialog.xaml`:

```xaml
<metro:MetroWindow x:Class="EtwExplorer.Views.EtwProviderSelectionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EtwExplorer.Views"
                   xmlns:z="http://zodiacon.wpf/2016"
        mc:Ignorable="d" ResizeMode="CanResizeWithGrip"
        Title="Select ETW Provider" TitleCaps="False" MinHeight="400" MinWidth="600" SizeToContent="Width" >
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="6" />
            <RowDefinition />
            <RowDefinition Height="12" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Search:" VerticalAlignment="Center" />
            <TextBox Margin="4,0,0,0" Width="200" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged, Delay=300}" 
                     metro:TextBoxHelper.Watermark="Type to search" metro:TextBoxHelper.ClearTextButton="True" z:FocusProperties.FocusOnLoad="True"/>
            <ToggleButton Style="{StaticResource MetroFlatToggleButton}" Content="Likely Existing Manifests" IsChecked="{Binding IsLikely}" Margin="4,0,0,0"/>
            <CheckBox Content="Close Current Manifest" Margin="8,0,0,0" IsChecked="{Binding CloseCurrentManifest}" />
        </StackPanel>

        <DataGrid Grid.Row="2" AutoGenerateColumns="False" IsReadOnly="True" SelectionUnit="FullRow" SelectionMode="Single" SelectedItem="{Binding SelectedProvider, Mode=TwoWay}"
                  ItemsSource="{Binding Providers}" metro:ButtonHelper.PreserveTextCase="True" >
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" FontWeight="Bold" />
                <DataGridTextColumn Header="GUID" Binding="{Binding Guid}" />
            </DataGrid.Columns>
        </DataGrid>
        <Border BorderThickness="0,2,0,0" Grid.Row="4" BorderBrush="{DynamicResource AccentColorBrush2}" Padding="8">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Button Content="OK" Width="80" Command="{Binding OKCommand}" IsDefault="True" />
                <Button Content="Cancel" Width="80" Command="{Binding CancelCommand}" Margin="20,0,0,0" IsCancel="True" />
            </StackPanel>
        </Border>
    </Grid>
</metro:MetroWindow>

```

`EtwExplorer/Views/EtwProviderSelectionDialog.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;

namespace EtwExplorer.Views {
	/// <summary>
	/// Interaction logic for EtwProviderSelectionDialog.xaml
	/// </summary>
	public partial class EtwProviderSelectionDialog {
		public EtwProviderSelectionDialog() {
			InitializeComponent();
		}
	}
}

```

`EtwExplorer/Views/EventsTabView.xaml`:

```xaml
<UserControl x:Class="EtwExplorer.Views.EventsTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EtwExplorer.Views"
             xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
             mc:Ignorable="d" 
             xmlns:z="http://zodiacon.wpf/2016"
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Search:" VerticalAlignment="Center" />
            <TextBox Margin="4,0,0,0" Width="300" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged, Delay=300}" 
                     metro:TextBoxHelper.Watermark="Type to search" metro:TextBoxHelper.ClearTextButton="True" z:FocusProperties.FocusOnLoad="True" />
        </StackPanel>
        <DataGrid Grid.Row="2" ItemsSource="{Binding Events}" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" SelectionUnit="FullRow" 
                  metro:ButtonHelper.PreserveTextCase="True" RowDetailsVisibilityMode="VisibleWhenSelected" VirtualizingPanel.VirtualizationMode="Recycling">
            <DataGrid.RowDetailsTemplate>
                <DataTemplate>
                    <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding EventDetails}" IsReadOnly="True" BorderBrush="{DynamicResource BlackBrush}" BorderThickness="1" Margin="4"
                              HorizontalAlignment="Left" SelectionMode="Single" SelectionUnit="FullRow" MaxHeight="300">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" FontWeight="Bold" />
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}" />
                        </DataGrid.Columns>
                    </DataGrid>
                </DataTemplate>
            </DataGrid.RowDetailsTemplate>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" Binding="{Binding Event.Symbol}" FontWeight="Bold" />
                <DataGridTextColumn Header="Value" Binding="{Binding Event.Value}" ElementStyle="{StaticResource DataGridCellRightJustifiedStyle}"/>
                <DataGridTextColumn Header="Version" Binding="{Binding Event.Version}" ElementStyle="{StaticResource DataGridCellRightJustifiedStyle}"/>
                <DataGridTextColumn Header="Task" Binding="{Binding Event.Task}" />
                <DataGridTextColumn Header="Keyword" Binding="{Binding Event.Keyword}" />
                <DataGridTextColumn Header="Template" Binding="{Binding Event.Template}" />
                <DataGridTextColumn Header="Opcode" Binding="{Binding Event.Opcode}" />
                <DataGridTextColumn Header="Level" Binding="{Binding Event.Level}" />
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>

```

`EtwExplorer/Views/EventsTabView.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer.Views {
	/// <summary>
	/// Interaction logic for EventsTabView.xaml
	/// </summary>
	public partial class EventsTabView : UserControl {
		public EventsTabView() {
			InitializeComponent();
		}
	}
}

```

`EtwExplorer/Views/KeywordsTabView.xaml`:

```xaml
<UserControl x:Class="EtwExplorer.Views.KeywordsTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EtwExplorer.Views"
             mc:Ignorable="d" 
             xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <DataGrid ItemsSource="{Binding Keywords}" AutoGenerateColumns="False" IsReadOnly="True" metro:ButtonHelper.PreserveTextCase="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" FontWeight="Bold" />
                <DataGridTextColumn Header="Value" Binding="{Binding Mask, StringFormat=0x\{0:X\}}" ElementStyle="{StaticResource DataGridCellRightJustifiedStyle}" />
                <DataGridTextColumn Header="Description" Binding="{Binding Message}" />
            </DataGrid.Columns>
        </DataGrid>       
    </Grid>
</UserControl>

```

`EtwExplorer/Views/KeywordsTabView.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer.Views
{
    /// <summary>
    /// Interaction logic for KeywordsTabView.xaml
    /// </summary>
    public partial class KeywordsTabView : UserControl
    {
        public KeywordsTabView()
        {
            InitializeComponent();
        }
    }
}

```

`EtwExplorer/Views/MainView.xaml`:

```xaml
<UserControl x:Class="EtwExplorer.Views.MainView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EtwExplorer.Views"
             mc:Ignorable="d" 
             xmlns:z="http://zodiacon.wpf/2016"
             xmlns:vm="clr-namespace:EtwExplorer.ViewModels"
             xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Menu>
            <MenuItem Header="_File" z:InputHelper.AttachInputBindings="True">
                <MenuItem Header="Open Registered ETW Provider Manifest..." InputGestureText="Ctrl+O" Command="{Binding OpenRegisteredCommand}" 
                          Icon="{z:Image /icons/open.ico, Width=16, Height=16}"/>
                <MenuItem Header="Open XML ETW Manifest..." Command="{Binding OpenXmlCommand}" />
                <MenuItem Header="Save XML Manifest..." InputGestureText="Ctrl+S" Command="{Binding SaveXmlCommand}" />
                <MenuItem Header="Close" Command="{Binding CloseCommand}" InputGestureText="Ctrl+F4" />
                <Separator />
                <MenuItem Header="_Recent Items" ItemsSource="{Binding RecentItems}">
                    
                </MenuItem>
                <Separator />
                <MenuItem Header="E_xit" Command="{Binding ExitCommand}" />
            </MenuItem>
        </Menu>
        <ToolBar Grid.Row="1" >
            <Button Command="{Binding OpenRegisteredCommand}">
                <StackPanel Orientation="Horizontal">
                    <Image Source="/icons/open.ico" Width="24" Height="24" />
                    <TextBlock Margin="4,0,0,0" VerticalAlignment="Center" Text="Open Provider..." />
                </StackPanel>
            </Button>
        </ToolBar>
        <TabControl Grid.Row="2" ItemsSource="{Binding Tabs}" z:TabControlProperties.IsCached="True" SelectedItem="{Binding SelectedTab, Mode=TwoWay}" >
            <TabControl.ItemContainerStyle>
                <Style TargetType="{x:Type TabItem}" >
                    <!--<Setter Property="FontSize" Value="15" />-->
                    <Setter Property="Background" Value="{DynamicResource AccentColorBrush4}" />
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="FontWeight" Value="Bold" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </TabControl.ItemContainerStyle>
            <TabControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{Binding Icon}" Width="16" Height="16" />
                        <TextBlock Text="{Binding Header}" Margin="4,0,0,0" VerticalAlignment="Center" FontSize="15"/>
                    </StackPanel>
                </DataTemplate>
            </TabControl.ItemTemplate>
        </TabControl>
        <StatusBar Grid.Row="3">
            <TextBlock Text="{Binding FileName, TargetNullValue=(No file), StringFormat=File: \{0\}}" />
            <Separator />
            <TextBlock Text="{Binding ProviderName}" />
        </StatusBar>
    </Grid>
</UserControl>

```

`EtwExplorer/Views/MainView.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer.Views {
	/// <summary>
	/// Interaction logic for MainView.xaml
	/// </summary>
	public partial class MainView : UserControl {
		public MainView() {
			InitializeComponent();
		}
	}
}

```

`EtwExplorer/Views/StringsTabView.xaml`:

```xaml
<UserControl x:Class="EtwExplorer.Views.StringsTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EtwExplorer.Views"
             xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="6" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Search:" VerticalAlignment="Center" />
            <TextBox Margin="4,0,0,0" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged, Delay=300}" Width="300"
                     metro:TextBoxHelper.Watermark="Type to search" metro:TextBoxHelper.ClearTextButton="True" />
        </StackPanel>
        <DataGrid Grid.Row="2" IsReadOnly="True" CanUserResizeRows="False" ItemsSource="{Binding Strings}" SelectionMode="Single"
                  metro:ButtonHelper.PreserveTextCase="True" AutoGenerateColumns="False" SelectionUnit="FullRow">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" />
                <DataGridTextColumn Header="Value" Binding="{Binding Value}" />
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>

```

`EtwExplorer/Views/StringsTabView.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer.Views {
	/// <summary>
	/// Interaction logic for StringsTab.xaml
	/// </summary>
	public partial class StringsTabView {
		public StringsTabView() {
			InitializeComponent();
		}
	}
}

```

`EtwExplorer/Views/SummaryTabView.xaml`:

```xaml
<UserControl x:Class="EtwExplorer.Views.SummaryTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EtwExplorer.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid Margin="8" TextBlock.FontSize="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="10" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <TextBlock Text="Provider Name:" />
        <TextBlock Text="{Binding ProviderName}" Grid.Column="2" FontWeight="Bold" />

        <TextBlock Grid.Row="2" Text="Provider GUID:" />
        <TextBlock Grid.Row="2" Text="{Binding ProviderGuid}" Grid.Column="2" FontWeight="Bold" />

        <TextBlock Grid.Row="4" Text="Provider Symbol:" />
        <TextBlock Grid.Row="4" Text="{Binding ProviderSymbol}" Grid.Column="2" FontWeight="Bold" />

        <TextBlock Grid.Row="6" Text="Keywords:" />
        <TextBlock Grid.Row="6" Text="{Binding KeywordCount}" Grid.Column="2" FontWeight="Bold" />

        <TextBlock Grid.Row="8" Text="Events:" />
        <TextBlock Grid.Row="8" Text="{Binding EventCount}" Grid.Column="2" FontWeight="Bold" />

        <TextBlock Grid.Row="10" Text="Tasks:" />
        <TextBlock Grid.Row="10" Text="{Binding TaskCount}" Grid.Column="2" FontWeight="Bold" />

        <TextBlock Grid.Row="12" Text="Templates:" />
        <TextBlock Grid.Row="12" Text="{Binding TemplateCount}" Grid.Column="2" FontWeight="Bold" />
    </Grid>
</UserControl>

```

`EtwExplorer/Views/SummaryTabView.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer.Views {
	/// <summary>
	/// Interaction logic for SummaryTabView.xaml
	/// </summary>
	public partial class SummaryTabView : UserControl {
		public SummaryTabView() {
			InitializeComponent();
		}
	}
}

```

`EtwExplorer/Views/XmlTabView.xaml`:

```xaml
<UserControl x:Class="EtwExplorer.Views.XmlTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EtwExplorer.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <TextBox AcceptsReturn="True" Text="{Binding Xml, Mode=OneTime}" IsReadOnly="True" VerticalScrollBarVisibility="Auto"
             FontFamily="Consolas" HorizontalScrollBarVisibility="Auto" />
</UserControl>

```

`EtwExplorer/Views/XmlTabView.xaml.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace EtwExplorer.Views {
	/// <summary>
	/// Interaction logic for XmlTabView.xaml
	/// </summary>
	public partial class XmlTabView {
		public XmlTabView() {
			InitializeComponent();

		}

	}
}

```

`EtwExplorer/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="ControlzEx" version="3.0.2.4" targetFramework="net472" />
  <package id="MahApps.Metro" version="1.6.5" targetFramework="net472" />
  <package id="Microsoft.Diagnostics.Tracing.TraceEvent" version="2.0.66" targetFramework="net472" />
  <package id="Prism.Core" version="8.0.0.1909" targetFramework="net472" />
  <package id="System.Runtime.CompilerServices.Unsafe" version="5.0.0" targetFramework="net472" />
  <package id="Zodiacon.WPF" version="1.3.0" targetFramework="net472" />
</packages>
```

`EtwManifestParsing/EtwEvent.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwManifestParsing {
	public enum EventLevel {
	}

	public sealed class EtwEvent {
		public int Value { get; internal set; }
		public string Symbol { get; internal set; }
		public int Version { get; internal set; }
		public string Opcode { get; internal set; }
		public string Level { get; internal set; }
		public string Template { get; internal set; }
		public string Keyword { get; internal set; }
		public string Task { get; internal set; }

		public override string ToString() => $"{Symbol}={Value} {Opcode} {Template}";
	}
}

```

`EtwManifestParsing/EtwKeyword.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EtwManifestParsing {
	public sealed class EtwKeyword {
		public string Name { get; set; }
		public string Message { get; set; }
		public ulong Mask { get; set; }

		public override string ToString() => $"{Name} {Message} 0x{Mask:X}";

	}
}

```

`EtwManifestParsing/EtwManifest.cs`:

```cs
using System;
using System.Collections.Generic;

namespace EtwManifestParsing {
	public class EtwManifest {
		internal EtwManifest(string xml) {
			Xml = xml;
		}

		public string Xml { get; }
		public EtwEvent[] Events { get; internal set; }
		public EtwKeyword[] Keywords { get; internal set; }
		public EtwTemplate[] Templates { get; internal set; }

		public EtwTask[] Tasks { get; internal set; }

		public IDictionary<string, string> StringTable { get; internal set; }
		public string ProviderName { get; internal set; }
		public Guid ProviderGuid { get; internal set; }
		public string ProviderSymbol { get; internal set; }

		public string GetString(string messageId) {
			string value = null;
			StringTable?.TryGetValue(messageId, out value);
			return value;
		}
	}
}
```

`EtwManifestParsing/EtwManifestParsing.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\build\Microsoft.Diagnostics.Tracing.TraceEvent.props" Condition="Exists('..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\build\Microsoft.Diagnostics.Tracing.TraceEvent.props')" />
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{8A9BF640-39F0-4C33-896C-DA83DD1DFBF6}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>EtwManifestParsing</RootNamespace>
    <AssemblyName>EtwManifestParsing</AssemblyName>
    <TargetFrameworkVersion>v4.6.1</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <NuGetPackageImportStamp>
    </NuGetPackageImportStamp>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="Dia2Lib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\lib\net45\Dia2Lib.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="Microsoft.Diagnostics.FastSerialization, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\lib\net45\Microsoft.Diagnostics.FastSerialization.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Diagnostics.Tracing.TraceEvent, Version=2.0.56.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\lib\net45\Microsoft.Diagnostics.Tracing.TraceEvent.dll</HintPath>
    </Reference>
    <Reference Include="OSExtensions, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\lib\net45\OSExtensions.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Management" />
    <Reference Include="System.Runtime.CompilerServices.Unsafe, Version=4.0.6.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\System.Runtime.CompilerServices.Unsafe.4.7.1\lib\net461\System.Runtime.CompilerServices.Unsafe.dll</HintPath>
    </Reference>
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
    <Reference Include="TraceReloggerLib, Version=0.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\lib\net45\TraceReloggerLib.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="EtwEvent.cs" />
    <Compile Include="EtwKeyword.cs" />
    <Compile Include="EtwManifest.cs" />
    <Compile Include="EtwTask.cs" />
    <Compile Include="ManifestParser.cs" />
    <Compile Include="EtwTemplate.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="app.config" />
    <None Include="packages.config" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
      <ErrorText>This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\build\Microsoft.Diagnostics.Tracing.TraceEvent.props')" Text="$([System.String]::Format('$(ErrorText)', '..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.56\build\Microsoft.Diagnostics.Tracing.TraceEvent.props'))" />
  </Target>
</Project>
```

`EtwManifestParsing/EtwTask.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml.Linq;

namespace EtwManifestParsing {
	public sealed class EtwOpcode {
		public string Name { get; internal set; }
		public string Message { get; internal set; }
		public int Value { get; internal set; }
	}

	public sealed class EtwTask {
		public int Value { get; }
		public string Name { get; }

		public EtwOpcode[] Opcodes { get; }

		internal EtwTask(XElement element, EtwManifest manifest) {
			Name = (string)element.Attribute("name");
			Value = (int)element.Attribute("value");

			Opcodes = element.Descendants("opcode").Select(node => new EtwOpcode {
				Name = (string)node.Attribute("name"),
				Message = GetString((string)node.Attribute("message"), manifest),
				Value = (int)node.Attribute("value")
			}).ToArray();
		}

		private string GetString(string name, EtwManifest manifest) {
			return manifest.GetString(name.Substring(9, name.Length - 10));
		}

		public override string ToString() => $"{Name} {Value} {Opcodes.Length} opcodes";
	}
}

```

`EtwManifestParsing/EtwTemplate.cs`:

```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml.Linq;

namespace EtwManifestParsing {
	public sealed class EtwTemplateData {
		public string Name { get; set; }
		public string Type { get; set; }
	}

	public sealed class EtwTemplate {
		public string Id { get; }
		public EtwTemplateData[] Items { get; }

		internal EtwTemplate(XElement element) {
			Id = (string)element.Attribute("tid");
			Items = element.DescendantNodes().OfType<XElement>().Select(node => new EtwTemplateData {
				Name = (string)node.Attribute("name"),
				Type = ((string)node.Attribute("inType")).Substring(4)
			}).ToArray();
		}

		internal EtwTemplate(string id, EtwTemplateData[] items)
		{
			Id = id;
			Items = items;
		}

		public override string ToString() => $"{Id} {Items.Length} template items";
	}
}

```

`EtwManifestParsing/ManifestParser.cs`:

```cs
using Microsoft.Diagnostics.Tracing.Session;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Management;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using System.Xml.Linq;

namespace EtwManifestParsing {
	public static class ManifestParser {
		public static EtwManifest Parse(XElement element) {
			var manifest = new EtwManifest(element.ToString());
			try {
				var ns = element.GetDefaultNamespace();

				var stringTable = element.Descendants(ns + "stringTable").FirstOrDefault();
				if (stringTable != null) {
					var strings = stringTable.DescendantNodes().OfType<XElement>().ToArray();
					var table = new Dictionary<string, string>(strings.Length);
					Array.ForEach(strings, node => { try { table.Add((string)node.Attribute("id"), (string)node.Attribute("value")); } catch { } });
					manifest.StringTable = table;
				}

				var providerElement = element.Descendants(ns + "provider").First();
				manifest.ProviderName = (string)providerElement.Attribute("name");
				manifest.ProviderSymbol = (string)providerElement.Attribute("symbol");
				manifest.ProviderGuid = Guid.Parse((string)providerElement.Attribute("guid"));

				var events = from node in element.Descendants(ns + "event")
							 let level = GetString(node.Attribute("level"))
							 select new EtwEvent {
								 Value = (int)node.Attribute("value"),
								 Symbol = (string)node.Attribute("symbol"),
								 Level = level.Substring(level.IndexOf(':') + 1),
								 Opcode = GetString(node.Attribute("opcode")),
								 Version = (int)node.Attribute("version"),
								 Template = (string)node.Attribute("template"),
								 Keyword = (string)node.Attribute("keywords"),
								 Task = (string)node.Attribute("task")
							 };

				manifest.Events = events.ToArray();

				var keywords = element.Descendants(ns + "keyword").Select(node => new EtwKeyword {
					Name = (string)node.Attribute("name"),
					Mask = ulong.Parse(((string)node.Attribute("mask")).Substring(2), System.Globalization.NumberStyles.HexNumber),
					Message = GetMessageString(manifest, (string)node.Attribute("message"))
				});

				manifest.Keywords = keywords.ToArray();

				var templates = element.Descendants(ns + "template").Select(node => new EtwTemplate(node));
				manifest.Templates = templates.ToArray();

				var tasks = element.Descendants(ns + "task").Select(node => new EtwTask(node, manifest));
				manifest.Tasks = tasks.ToArray();

				return manifest;
			}
			catch (Exception ex) {
				throw new ApplicationException("Failed to parse manifest XML", ex);
			}
		}

		private static string GetString(XAttribute attribute) {
			if (attribute == null)
				return string.Empty;
			var value = (string)attribute;
			return value.Substring(value.IndexOf(':') + 1);
		}

		private static string GetMessageString(EtwManifest manifest, string message) {
			if (message.StartsWith("$")) {
				message = message.Substring(9, message.Length - 10);
				return manifest.GetString(message);
			}
			return message;
		}

		public static EtwManifest Parse(string xml) {
			return Parse(XElement.Parse(xml));
		}

        public static EtwManifest ParseWmiEventTraceClass(Guid provider) {
            // we make a best effort attempt to fit the metadata of this Legacy (MOF) provider into the instrumentation manifest format

            // we need to find the EventTrace class where the Guid class qualifier matches our provider Guid
            // afaik you can't query for qualifiers...just classes and properties.  :-/
            // so we loop through all of the EventTrace classes and compare
            var providerSearcher = new ManagementObjectSearcher("root\\WMI", $"SELECT * FROM meta_class WHERE __superclass = 'EventTrace'", null);
            ManagementClass providerClass = null;
            foreach (ManagementClass candidateProviderClass in providerSearcher.Get()) {
                foreach (QualifierData qd in candidateProviderClass.Qualifiers) {
                    if (qd.Name.ToLower() == "guid" && new Guid((string)qd.Value) == provider) {
                        providerClass = candidateProviderClass;
                        break; // found
                    }
                }

                if (providerClass != null)
                    break; // found
            }

            if (providerClass == null) // not found
                throw new ApplicationException($"Provider {provider} has no corresponding EventTrace class in WMI Repository");

            var mof = ToMofString(providerClass);

            var manifest = new EtwManifest(mof)
            {
                ProviderGuid = provider,
                ProviderSymbol = (string)providerClass["__CLASS"]
            };

            var events = new SortedDictionary<string, EtwEvent>();
            var templates = new List<EtwTemplate>();
            var stringTable = new Dictionary<string, string>();

            // the provider name is usually in the Description Qualifier for the EventTrace class (but not always?)
            // and the keywords are properties for the EventTrace class
            // but we can already get both of these easily from Microsoft.Diagnostics.Tracing
            manifest.ProviderName = TraceEventProviders.GetProviderName(provider);
            manifest.Keywords = TraceEventProviders.GetProviderKeywords(provider).Select(info => new EtwKeyword
            {
                Name = info.Name,
                Mask = info.Value,
                Message = info.Description
            }).ToArray();

            // event details are in the grandchildren of the top-level (EventTrace) provider class
            // WMI EventTrace children ~ a versioned category grouping
            // WMI EventTrace grandchildren ~ instrumentation manifest templates
            // note - event version can be set on the category and/or the event
            var templateNames = new SortedSet<string>();
            var taskSearcher = new ManagementObjectSearcher("root\\WMI", $"SELECT * FROM meta_class WHERE __superclass = '{providerClass["__CLASS"]}'", null);
            foreach (ManagementClass categoryVersionClass in taskSearcher.Get())
            {
                var categoryVersion = 0;
                var category = string.Empty;
                var description = string.Empty;
                var displayName = string.Empty;
                foreach (QualifierData qd in categoryVersionClass.Qualifiers) {
                    if (qd.Value.GetType() == typeof(Int32) && qd.Name.ToLower() == "eventversion")
                        categoryVersion = (Int32)qd.Value;
                    else if (qd.Value.GetType() == typeof(String) && qd.Name.ToLower() == "guid")
                        category = (string)qd.Value;
                    else if (qd.Value.GetType() == typeof(String) && qd.Name.ToLower() == "description")
                        description = (string)qd.Value;
                    else if (qd.Value.GetType() == typeof(String) && qd.Name.ToLower() == "displayname")
                        displayName = (string)qd.Value;
                }

                if (!string.IsNullOrEmpty(description)) {
                    // MOF doesn't enforce unique strings, but our model does
                    // append spaces to make a unique key
                    var key = !string.IsNullOrEmpty(displayName) ? displayName : (string)categoryVersionClass["__CLASS"];
                    while (stringTable.ContainsKey(key))
                        key += " ";
                    stringTable.Add(key, description);
                }

                var templateSearcher = new ManagementObjectSearcher("root\\WMI", $"SELECT * FROM meta_class WHERE __superclass = '{categoryVersionClass["__CLASS"]}'", null);
                foreach (ManagementClass templateClass in templateSearcher.Get()) {
                    // EventTypeName qualifier ~ OpCode
                    var template = (string)templateClass["__CLASS"];
                    var eventType = string.Empty;
                    var version = categoryVersion;
                    description = string.Empty;
                    foreach (QualifierData qd in templateClass.Qualifiers) {
                        if (qd.Value.GetType() == typeof(Int32) && qd.Name.ToLower() == "eventversion")
                            version = (Int32)qd.Value; // override category version with specific event version
                        else if (qd.Value.GetType() == typeof(String) && qd.Name.ToLower() == "eventtypename")
                            eventType = (string)qd.Value;
                        else if (qd.Value.GetType() == typeof(String) && qd.Name.ToLower() == "description")
                            description = (string)qd.Value;
                    }

                    if (!string.IsNullOrEmpty(description)) {
                        // append spaces to make a unique key
                        var key = template;
                        while (stringTable.ContainsKey(key))
                            key += " ";
                        stringTable.Add(key, description);
                    }

                    // EventType -> id(s)
                    var ids = new SortedSet<Int32>();
                    foreach (QualifierData qd in templateClass.Qualifiers) {
                        if (qd.Name.ToLower() == "eventtype") {
                            if (qd.Value.GetType() == typeof(Int32))
                                ids.Add((Int32)qd.Value);
                            else if (qd.Value.GetType().IsArray) {
                                foreach (var element in (Array)qd.Value) {
                                    if (element.GetType() == typeof(Int32))
                                        ids.Add((Int32)element);
                                }
                            }
                            break;
                        }
                    }

                    // sort by category, id, version
                    foreach (var id in ids)
                    {
                        events.Add($"{category}{id,6}{version,6}",
                            new EtwEvent
                            {
                                Value = id,
                                Symbol = template,
                                Opcode = eventType,
                                Version = version,
                                Template = template,
                                Keyword = string.Empty,
                                Task = category
                            });
                    }

                    // create a template from the properties
                    var templateData = new SortedDictionary<int, EtwTemplateData>();
                    foreach (PropertyData pd in templateClass.Properties) {
                        foreach (QualifierData qd in pd.Qualifiers) {
                            if (qd.Value.GetType() == typeof(Int32) && qd.Name.ToLower() == "wmidataid") {
                                var id = (int)qd.Value;
                                templateData[id] = new EtwTemplateData
                                {
                                    Name = pd.Name,
                                    Type = pd.Type.ToString()
                                };
                                break;
                            }
                        }
                    }

                    templates.Add(new EtwTemplate(template, templateData.Values.ToArray()));
                }
            }

            manifest.Events = events.Values.ToArray();
            manifest.Templates = templates.ToArray();
            manifest.StringTable = stringTable;

            return manifest;
        }

        static string ToMofString(ManagementClass wmiClass)
        {
            var mofString = string.Empty;

            // print the (qualified) class name, and then all of the (qualified) properties
            mofString += ToMofString(wmiClass.Qualifiers, string.Empty, "\n");
            mofString += $"class {wmiClass["__CLASS"]} : {wmiClass["__SUPERCLASS"]}\n";
            mofString += "{\n";

            var orderedProperties = new SortedDictionary<int, string>();
            foreach (PropertyData pd in wmiClass.Properties) {
                if (!pd.IsLocal)
                    continue;
                // sort properties according to the WmiDataId qualifer (if available)
                var propertyString = $"\t{ToMofString(pd.Qualifiers, "\t", " ")}{pd.Type.ToString().ToLower()} {pd.Name};\n";
                var propertyMatch = new Regex(@"wmidataid\((?<WmiDataId>\d+)\)", RegexOptions.IgnoreCase).Match(propertyString);
                if (propertyMatch.Success)
                    orderedProperties[Convert.ToInt32(propertyMatch.Groups["WmiDataId"].Value)] = propertyString;
                else
                    mofString += propertyString;
            }

            foreach (var propertyString in orderedProperties.Values) {
                mofString += propertyString;
            }

            mofString += "};\n\n";

            // event details are in descendant classes of the top-level (EventTrace) provider class
            // so also enumerate all of the children on this class
            var providerSearcher = new ManagementObjectSearcher("root\\WMI", $"SELECT * FROM meta_class WHERE __superclass = '{wmiClass["__CLASS"]}'", null);
            foreach (ManagementClass providerClass in providerSearcher.Get()) {
                mofString += ToMofString(providerClass);
            }

            return mofString;
        }

        // based on the mof representation of wbemtest
        internal static string[] qualifierOrder = { "wmidataid(", "dynamic", "description(", "guid(", "displayname(", "displaynames(", "eventtype(", "eventtype{", "eventtypename(", "eventtypename{", "eventversion(", "valuedescriptions{", "definevalues{", "values{", "valuemap{", "valuetype(", "extension(", "activityid", "relatedactivityid", "stringtermination(", "format(", "wmisizeis(", "xmlfragment", "pointer", "read", "max", "locale(" };

        static string ToMofString(QualifierDataCollection qualifiers, string prefix, string suffix)
        {
            var qualifierString = string.Empty;

            var qualifierList = new List<string>();
            var maxQualifierLength = 0;

            foreach (QualifierData qualifier in qualifiers) {
                if (qualifier.Name == "CIMTYPE")
                    continue;

                var strQualifier = qualifier.Name;
                if (qualifier.Value.GetType() == typeof(String))
                    strQualifier += $"(\"{qualifier.Value}\")";
                else if (qualifier.Value.GetType() == typeof(Int32))
                    strQualifier += $"({qualifier.Value})";
                else if (qualifier.Value.GetType() == typeof(Boolean))
                { } // add nothing
                else if (qualifier.Value.GetType().IsArray) {
                    var qualifierValueList = new List<string>();
                    foreach (var element in (Array)qualifier.Value)
                        qualifierValueList.Add(element.GetType() == typeof(String) ? $"\"{element}\"" : $"{element}");
                    strQualifier += $"{{{string.Join(", ", qualifierValueList)}}}";
                }
                else
                    throw new ApplicationException($"Unsupported Qualifier Type - {qualifier.Value.GetType().Name}");

                if (qualifier.PropagatesToInstance)
                    strQualifier += ": ToInstance";

                maxQualifierLength = strQualifier.Length > maxQualifierLength ? strQualifier.Length : maxQualifierLength;
                qualifierList.Add(strQualifier);
            }

            var orderedQualifierList = new List<string>();
            foreach (var nextQualifierInOrder in qualifierOrder) {
                var foundQualifier = string.Empty;
                foreach (var qualifier in qualifierList) {
                    if (qualifier.ToLower().StartsWith(nextQualifierInOrder)) {
                        orderedQualifierList.Add(qualifier);
                        continue;
                    }
                }
            }

            if (qualifierList.Count != orderedQualifierList.Count)
                throw new ApplicationException($"Unknown Qualifier Type(s) - {String.Join(",", qualifierList.ToArray())}");

            if (orderedQualifierList.Count > 0) {
                var wrapQualifiers = maxQualifierLength > 80;
                var header = "[";
                var delimiter = wrapQualifiers ? $",\n{prefix} " : ", ";
                var footer = wrapQualifiers ? $"\n{prefix}]{suffix}" : $"]{suffix}";

                qualifierString = $"{header}{string.Join(delimiter, orderedQualifierList)}{footer}";
            }

            return qualifierString;
        }
    }
}

```

`EtwManifestParsing/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// General Information about an assembly is controlled through the following
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
[assembly: AssemblyTitle("EtwManifestParsing")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("EtwManifestParsing")]
[assembly: AssemblyCopyright("Copyright ©  2018")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// Setting ComVisible to false makes the types in this assembly not visible
// to COM components.  If you need to access a type in this assembly from
// COM, set the ComVisible attribute to true on that type.
[assembly: ComVisible(false)]

// The following GUID is for the ID of the typelib if this project is exposed to COM
[assembly: Guid("8a9bf640-39f0-4c33-896c-da83dd1dfbf6")]

// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Build and Revision Numbers
// by using the '*' as shown below:
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]

```

`EtwManifestParsing/app.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.6.0" newVersion="4.0.6.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration>
```

`EtwManifestParsing/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Microsoft.Diagnostics.Tracing.TraceEvent" version="2.0.56" targetFramework="net461" />
  <package id="System.Runtime.CompilerServices.Unsafe" version="4.7.1" targetFramework="net461" />
</packages>
```

`MigrationBackup/ae6cc1ee/EtwExplorer/EtwExplorer.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\build\Microsoft.Diagnostics.Tracing.TraceEvent.props" Condition="Exists('..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\build\Microsoft.Diagnostics.Tracing.TraceEvent.props')" />
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{EA67414B-2371-4FF2-9347-B0771D9E8E7D}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <RootNamespace>EtwExplorer</RootNamespace>
    <AssemblyName>EtwExplorer</AssemblyName>
    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <WarningLevel>4</WarningLevel>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <Deterministic>true</Deterministic>
    <NuGetPackageImportStamp>
    </NuGetPackageImportStamp>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <Prefer32Bit>false</Prefer32Bit>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationIcon>Icons\app.ico</ApplicationIcon>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="ControlzEx, Version=3.0.2.4, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\ControlzEx.3.0.2.4\lib\net462\ControlzEx.dll</HintPath>
    </Reference>
    <Reference Include="Dia2Lib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\lib\net45\Dia2Lib.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="MahApps.Metro, Version=1.6.5.1, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\MahApps.Metro.1.6.5\lib\net47\MahApps.Metro.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Diagnostics.FastSerialization, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\lib\net45\Microsoft.Diagnostics.FastSerialization.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Diagnostics.Tracing.TraceEvent, Version=2.0.36.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\lib\net45\Microsoft.Diagnostics.Tracing.TraceEvent.dll</HintPath>
    </Reference>
    <Reference Include="OSExtensions, Version=1.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\lib\net45\OSExtensions.dll</HintPath>
    </Reference>
    <Reference Include="Prism, Version=6.3.0.0, Culture=neutral, PublicKeyToken=40ee6c3a2184dc59, processorArchitecture=MSIL">
      <HintPath>..\packages\Prism.Core.6.3.0\lib\net45\Prism.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.ComponentModel.Composition" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Interactivity, Version=4.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
      <HintPath>..\packages\ControlzEx.3.0.2.4\lib\net462\System.Windows.Interactivity.dll</HintPath>
    </Reference>
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xaml">
      <RequiredTargetFramework>4.0</RequiredTargetFramework>
    </Reference>
    <Reference Include="TraceReloggerLib, Version=0.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\lib\net45\TraceReloggerLib.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="WindowsBase" />
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />
    <Reference Include="Zodiacon.WPF, Version=1.1.6599.28064, Culture=neutral, processorArchitecture=MSIL">
      <HintPath>..\packages\Zodiacon.WPF.1.2.17\lib\net45\Zodiacon.WPF.dll</HintPath>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <ApplicationDefinition Include="App.xaml">
      <Generator>MSBuild:Compile</Generator>
    </ApplicationDefinition>
    <Compile Include="Constants.cs" />
    <Compile Include="ViewModels\EtwEventViewModel.cs" />
    <Compile Include="ViewModels\EtwProviderSelectionViewModel.cs" />
    <Compile Include="ViewModels\EventsTabViewModel.cs" />
    <Compile Include="ViewModels\KeywordsTabViewModel.cs" />
    <Compile Include="ViewModels\MainViewModel.cs" />
    <Compile Include="ViewModels\StringsTabViewModel.cs" />
    <Compile Include="ViewModels\SummaryTabViewModel.cs" />
    <Compile Include="ViewModels\TabViewModelBase.cs" />
    <Compile Include="ViewModels\XmlTabViewModel.cs" />
    <Compile Include="Views\EtwProviderSelectionDialog.xaml.cs">
      <DependentUpon>EtwProviderSelectionDialog.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\EventsTabView.xaml.cs">
      <DependentUpon>EventsTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\KeywordsTabView.xaml.cs">
      <DependentUpon>KeywordsTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\MainView.xaml.cs">
      <DependentUpon>MainView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\StringsTabView.xaml.cs">
      <DependentUpon>StringsTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\SummaryTabView.xaml.cs">
      <DependentUpon>SummaryTabView.xaml</DependentUpon>
    </Compile>
    <Compile Include="Views\XmlTabView.xaml.cs">
      <DependentUpon>XmlTabView.xaml</DependentUpon>
    </Compile>
    <Page Include="MainWindow.xaml">
      <Generator>MSBuild:Compile</Generator>
      <SubType>Designer</SubType>
    </Page>
    <Compile Include="App.xaml.cs">
      <DependentUpon>App.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="MainWindow.xaml.cs">
      <DependentUpon>MainWindow.xaml</DependentUpon>
      <SubType>Code</SubType>
    </Compile>
    <Page Include="Resources\Styles.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Resources\Templates.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\EtwProviderSelectionDialog.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\EventsTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\KeywordsTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\MainView.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\StringsTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\SummaryTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
    <Page Include="Views\XmlTabView.xaml">
      <Generator>MSBuild:Compile</Generator>
    </Page>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <None Include="packages.config" />
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
  </ItemGroup>
  <ItemGroup>
    <Resource Include="Icons\summary.ico" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\EtwManifestParsing\EtwManifestParsing.csproj">
      <Project>{8a9bf640-39f0-4c33-896c-da83dd1dfbf6}</Project>
      <Name>EtwManifestParsing</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Resource Include="Icons\events.ico" />
    <Resource Include="Icons\open.ico" />
    <Resource Include="Icons\pin-red.ico" />
    <Resource Include="Icons\strings.ico" />
    <Resource Include="Icons\xml.ico" />
  </ItemGroup>
  <ItemGroup>
    <Resource Include="Icons\app.ico" />
  </ItemGroup>
  <ItemGroup>
    <Resource Include="Icons\keywords.ico" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
      <ErrorText>This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\build\Microsoft.Diagnostics.Tracing.TraceEvent.props')" Text="$([System.String]::Format('$(ErrorText)', '..\packages\Microsoft.Diagnostics.Tracing.TraceEvent.2.0.36\build\Microsoft.Diagnostics.Tracing.TraceEvent.props'))" />
  </Target>
</Project>
```

`MigrationBackup/ae6cc1ee/EtwExplorer/NuGetUpgradeLog.html`:

```html
<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->

    <html xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><meta content="en-us" http-equiv="Content-Language" /><meta content="text/html; charset=utf-16" http-equiv="Content-Type" /><title _locID="NuGetUpgradeReportTitle">
          NuGetMigrationLog
        </title><style>
            
                    /* Body style, for the entire document */
                    body
                    {
                        background: #F3F3F4;
                        color: #1E1E1F;
                        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                        font-size: 12pt;
                        padding: 0;
                        margin: 0;
                    }

                    /* Header1 style, used for the main title */
                    h1
                    {
                        padding: 10px 0px 10px 10px;
                        font-size: 21pt;
                        background-color: #E2E2E2;
                        border-bottom: 1px #C1C1C2 solid; 
                        color: #201F20;
                        margin: 0;
                        font-weight: normal;
                    }

                    /* Header2 style, used for "Overview" and other sections */
                    h2
                    {
                        font-size: 18pt;
                        font-weight: normal;
                        padding: 15px 0 5px 0;
                        margin: 0;
                    }

                    /* Header3 style, used for sub-sections, such as project name */
                    h3
                    {
                        font-weight: normal;
                        font-size: 15pt;
                        margin: 0;
                        padding: 15px 0 5px 0;
                        background-color: transparent;
                    }

                    .info-text
                    {
                        margin: 0px 0 0.75em 0;
                    }

                    /* Color all hyperlinks one color */
                    a
                    {
                        color: #1382CE;
                    }

                    /* Table styles */ 
                    table
                    {
                        border-spacing: 0 0;
                        border-collapse: collapse;
                        font-size: 11pt;
                    }

                    table th
                    {
                        background: #E7E7E8;
                        text-align: left;
                        text-decoration: none;
                        font-weight: normal;
                        padding: 3px 6px 3px 6px;
                    }

                    table td
                    {
                        vertical-align: top;
                        padding: 3px 6px 5px 5px;
                        margin: 0px;
                        border: 1px solid #E7E7E8;
                        background: #F7F7F8;
                    }

                    /* Local link is a style for hyperlinks that link to file:/// content, there are lots so color them as 'normal' text until the user mouse overs */
                    .localLink
                    {
                        color: #1E1E1F;
                        background: #EEEEED;
                        text-decoration: none;
                    }

                    .localLink:hover
                    {
                        color: #1382CE;
                        background: #FFFF99;
                        text-decoration: none;
                    }

                    .issueCell
                    {
                        width: 100%;
                    }

                    .packageIssue
                    {
                        margin-left: 25px;
                    }

                    /* Padding around the content after the h1 */ 
                    #content 
                    {
	                    padding: 0px 20px 20px 20px; 
                    }

                    .issues table
                    {
                        width: 97%;
                    }

                    /* All Icons */
                    .IconSuccessEncoded, .IconInfoEncoded, .IconWarningEncoded, .IconErrorEncoded
                    {
                        min-width:18px;
                        min-height:18px; 
                        background-repeat:no-repeat;
                        background-position:center;
                    }

                    .IconSuccessEncoded
                    {
                        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABcElEQVR4Xq2TsUsCURzHv15g8ZJcBWlyiYYgCIWcb9DFRRwMW5TA2c0/QEFwFkxxUQdxVlBwCYWOi6IhWgQhBLHJUCkhLr/BW8S7gvrAg+N+v8/v+x68Z8MGy+XSCyABQAXgBgHGALoASkIIDWSLeLBetdHryMjd5IxQPWT4rn1c/P7+xxp72Cs9m5SZ0Bq2vPnbPFafK2zDvmNHypdC0BPkLlQhxJsCAhQoZwdZU5mwxh720qGo8MzTxTTKZDPCx2HoVzp6lz0Q9tKhyx0kGs8Ny+TkWRKk8lCROwEduhyg9l/6lunOPSfmH3NUH6uQ0KHLAe7JYvJjevm+DAMGJHToKtigE+vwvIidxLamb8IBY9e+C5LiXREkfho3TSd06HJA13/oh6T51MTsfQbHrsMynQ5dDihFjiK8JJAU9AKIWTp76dCVN7HWHrajmUEGvyF9nkbAE6gLIS7kTUyuf2gscLoJrElZo/Mvj+nPz/kLTmfnEwP3tB0AAAAASUVORK5CYII=);
                    }

                    .IconInfoEncoded
                    {
                        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABHElEQVR4Xs2TsUoDQRRF7wwoziokjZUKadInhdhukR9YP8DMX1hYW+QvdsXa/QHBbcXC7W0CamWTQnclFutceIQJwwaWNLlwm5k5d94M76mmaeCrrmsLYOocY12FcxZFUeozCqKqqgYA8uevv1H6VuPxcwlfk5N92KHBxfFeCSAxxswlYAW/Xr989x/mv9gkhtyMDhcAxgzRsp7flj8B/HF1RsMXq+NZMkopaHe7lbKxQUEIGbKsYNoGn969060hZBkQex/W8oRQwsQaW2o3Ago2SVcJUzAgY3N0lTCZZm+zPS8HB51gMmS1DEYyOz9acKO1D8JWTlafKIMxdhvlfdyT94Vv5h7P8Ky7nQzACmhvKq3zk3PjW9asz9D/1oigecsioooAAAAASUVORK5CYII=);
                    }

                    .IconWarningEncoded
                    {
                        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAx0lEQVR4XpWSMQ7CMAxFf4xAyBMLCxMrO8dhaBcuwdCJS3RJBw7SA/QGTCxdWJgiQYWKXJWKIXHIlyw5lqr34tQgEOdcBsCOx5yZK3hCCKdYXneQkh4pEfqzLfu+wVDSyyzFoJjfz9NB+pAF+eizx2Vruts0k15mPgvS6GYvpVtQhB61IB/dk6AF6fS4Ben0uIX5odtFe8Q/eW1KvFeH4e8khT6+gm5B+t3juyDt7n0jpe+CANTd+oTUjN/U3yVaABnSUjFz/gFq44JaVSCXeQAAAABJRU5ErkJggg==);
                    }

                    .IconErrorEncoded
                    {
                        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABQElEQVR4XqWTvUoEQRCE6wYPZUA80AfwAQz23uCMjA7MDRQEIzPBVEyNTQUFIw00vcQTTMzuAh/AxEQQT8HF/3G/oGGnEUGuoNnd6qoZuqltyKEsyzVJq5I6rnUp6SjGeGhESikzzlc1eL7opfuVbrqbU1Zw9NCgtQMaZpY0eNnaaL2fHusvTK5vKu7sjSS1Y4y3QUA6K3e3Mau5UFDyMP7tYF9o8cAHZv68vipoIJg971PZIZ5HiwdvYGGvFVFHmGmZ2MxwmQYPXubPl9Up0tfoMQGetXd6mRbvhBw+boZ6WF7Mbv1+GsHRk0fQmPAH1GfmZirbCfDJ61tw3Px8/8pZsPAG4jlVhcPgZ7adwNWBB68lkRQWFiTgFlbnLY3DGGM7izIJIyT/jjIvEJw6fdJTc6krDzh6aMwMP9bvDH4ADSsa9uSWVJkAAAAASUVORK5CYII=);
                    }
                
          </style></head><body><h1>
          NuGet Migration Report - EtwExplorer</h1><div id="content"><h2 _locID="OverviewTitle">Overview</h2><div class="info-text">Migration to PackageReference was completed successfully. Please build and run your solution to verify that all packages are available.</div><div class="info-text">
            If you run into any problems, have feedback, questions, or concerns, please
            <a href="https://github.com/NuGet/Home/issues/">file an issue on the NuGet GitHub repository.</a></div><div class="info-text">
            Changed files and this report have been backed up here:
            <a href="C:\dev\EtwExplorer\MigrationBackup\ae6cc1ee\EtwExplorer">C:\dev\EtwExplorer\MigrationBackup\ae6cc1ee\EtwExplorer</a></div><div class="info-text"><a href="https://aka.ms/nuget-pc2pr-migrator-rollback">Help me rollback to packages.config</a></div><h2 _locID="PackagesTitle">Packages processed</h2><h3 _locID="IncludePackagesTitle">Top-level dependencies:</h3><div class="issues"><table><tr><th class="issueCell">Package Id</th><th>Version</th></tr><tr><td class="issueCell"><span>ControlzEx</span></td><td><span>
                v3.0.2.4</span></td></tr><tr><td class="issueCell"><span>MahApps.Metro</span></td><td><span>
                v1.6.5</span></td></tr><tr><td class="issueCell"><span>Microsoft.Diagnostics.Tracing.TraceEvent</span></td><td><span>
                v2.0.36</span></td></tr><tr><td class="issueCell"><span>Prism.Core</span></td><td><span>
                v6.3.0</span></td></tr><tr><td class="issueCell"><span>Zodiacon.WPF</span></td><td><span>
                v1.2.17</span></td></tr></table></div><p /><h3 _locID="IncludePackagesTitle">Transitive dependencies:</h3><div class="issues"><table><tr><th class="issueCell">Package Id</th><th>Version</th></tr><tr><td class="issueCell">
                No transitive dependencies found.
              </td><td /></tr></table></div><h2 _locID="IssuesTitle">Package compatibility issues</h2><div class="issues"><table><tr><th /><th class="issueCell" _locID="DescriptionTableHeader">Description</th></tr><tr><td class="IconInfoEncoded" /><td class="issueCell">
                No issues were found.
              </td></tr></table></div></div></body></html>
```

`MigrationBackup/ae6cc1ee/EtwExplorer/packages.config`:

```config
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="ControlzEx" version="3.0.2.4" targetFramework="net472" />
  <package id="MahApps.Metro" version="1.6.5" targetFramework="net472" />
  <package id="Microsoft.Diagnostics.Tracing.TraceEvent" version="2.0.48" targetFramework="net472" />
  <package id="Prism.Core" version="6.3.0" targetFramework="net472" />
  <package id="Zodiacon.WPF" version="1.2.17" targetFramework="net472" />
</packages>
```

`README.md`:

```md
# EtwExplorer
View ETW Provider metadata

Event Tracing for Windows ([ETW](https://docs.microsoft.com/en-us/windows/win32/etw/event-metadata-overview)) is a logging facility built into the Windows OS. Modern providers register a manifest that describes all the events they support, with their properties. Classic providers register a MOF instead.

ETW Explorer attempts to show these events with a simple GUI.

![ETWExplorer](./etwexplorer2.PNG)

```