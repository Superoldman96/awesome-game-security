Project Path: arc_gmh5225_pooldump_18kxow5q

Source Tree:

```txt
arc_gmh5225_pooldump_18kxow5q
├── README.md
├── pooldump
│   ├── driver.cpp
│   ├── pooldump.inf
│   ├── pooldump.vcxproj
│   └── pooldump.vcxproj.filters
├── pooldump.sln
└── scripts
    └── debug-driver.bat

```

`README.md`:

```md
# pooldump
Attempts to dump all nonpaged `BigPool`s from kernel.  

**WARNING**: Insanely retarded code. This project can and will induce brain damage.

## Usage
```shell
mkdir C:\tmp
kdmapper.exe pooldump.sys
```

## EasyAntiCheat
This tool can be used to extract the DLL that EACs manualmaps into the game process. Before launching the driver start your EAC protected game and then scan for the `eac0` or `eac1` segment. You'll will most likely need to remove the first ~7 bytes (up until the `MZ` header). Example:
```shell
grep -rnwa . -e "eac0"
```

```

`pooldump.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.32002.261
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "pooldump", "pooldump\pooldump.vcxproj", "{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|ARM = Debug|ARM
		Debug|ARM64 = Debug|ARM64
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|ARM = Release|ARM
		Release|ARM64 = Release|ARM64
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|ARM.ActiveCfg = Debug|ARM
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|ARM.Build.0 = Debug|ARM
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|ARM.Deploy.0 = Debug|ARM
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|ARM64.ActiveCfg = Debug|ARM64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|ARM64.Build.0 = Debug|ARM64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|ARM64.Deploy.0 = Debug|ARM64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|x64.ActiveCfg = Debug|x64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|x64.Build.0 = Debug|x64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|x64.Deploy.0 = Debug|x64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|x86.ActiveCfg = Debug|Win32
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|x86.Build.0 = Debug|Win32
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Debug|x86.Deploy.0 = Debug|Win32
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|ARM.ActiveCfg = Release|ARM
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|ARM.Build.0 = Release|ARM
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|ARM.Deploy.0 = Release|ARM
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|ARM64.ActiveCfg = Release|ARM64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|ARM64.Build.0 = Release|ARM64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|ARM64.Deploy.0 = Release|ARM64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|x64.ActiveCfg = Release|x64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|x64.Build.0 = Release|x64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|x64.Deploy.0 = Release|x64
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|x86.ActiveCfg = Release|Win32
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|x86.Build.0 = Release|Win32
		{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}.Release|x86.Deploy.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {4FC4350F-655B-483F-8F5F-DE702D72C703}
	EndGlobalSection
EndGlobal

```

`pooldump/driver.cpp`:

```cpp
#include <ntddk.h>
#include <windef.h>
#include <ntstrsafe.h>

#define TAG 'enoN'
#define LOG(x, ...) DbgPrint("[pooldump] " x, __VA_ARGS__)
#define STATUS_ASSERT(x) \
	do { \
		if (!NT_SUCCESS(x)) \
			LOG("NTSTATUS = %x\n", x); \
		NT_VERIFY(NT_SUCCESS(x)); \
	} while (0)

typedef struct _SYSTEM_BIGPOOL_ENTRY
{
	union
	{
		PVOID VirtualAddress;
		ULONG_PTR NonPaged : 1;
	};
	ULONG_PTR SizeInBytes;
	union
	{
		UCHAR Tag[4];
		ULONG TagUlong;
	};
} SYSTEM_BIGPOOL_ENTRY, *PSYSTEM_BIGPOOL_ENTRY;

typedef struct _SYSTEM_BIGPOOL_INFORMATION
{
	ULONG Count;
	SYSTEM_BIGPOOL_ENTRY AllocatedInfo[ANYSIZE_ARRAY];
} SYSTEM_BIGPOOL_INFORMATION, *PSYSTEM_BIGPOOL_INFORMATION;

typedef enum _SYSTEM_INFORMATION_CLASS
{
	SystemBigPoolInformation = 0x42
} SYSTEM_INFORMATION_CLASS;

typedef NTSTATUS(WINAPI* ZwQuerySystemInformation)(
	_In_ SYSTEM_INFORMATION_CLASS SystemInformationClass,
	_Inout_ PVOID SystemInformation,
	_In_ ULONG SystemInformationLength,
	_Out_opt_ PULONG ReturnLength);

ZwQuerySystemInformation k_ZwQuerySystemInformation = nullptr;

template<class Routine>
Routine GetProcAddress(
	_In_ const wchar_t* Name)
{
	UNICODE_STRING routine{};
	Routine ptr{};

	RtlInitUnicodeString(&routine, Name);

	ptr = reinterpret_cast<Routine>(
		MmGetSystemRoutineAddress(&routine));
	STATUS_ASSERT(ptr != nullptr);

	return ptr;
}

SYSTEM_BIGPOOL_INFORMATION* FetchPoolInformation()
{
	SYSTEM_BIGPOOL_INFORMATION* query{};
	NTSTATUS status{};
	ULONG size{};

	do
	{
		query = static_cast<SYSTEM_BIGPOOL_INFORMATION*>(
			ExAllocatePoolWithTag(NonPagedPoolNx, size, TAG));
		ASSERT(query != nullptr);

		status = k_ZwQuerySystemInformation(SystemBigPoolInformation, query, size, &size);

		if (NT_SUCCESS(status))
			break;

		ExFreePoolWithTag(query, TAG);
	} while (status == STATUS_INFO_LENGTH_MISMATCH);

	STATUS_ASSERT(status);

	return query;
}

VOID DumpPools(
	_In_ VOID* Context)
{
	UNREFERENCED_PARAMETER(Context);

	OBJECT_ATTRIBUTES attributes{};
	IO_STATUS_BLOCK statusBlock{};
	UNICODE_STRING dumpFile{};
	WCHAR emptyBuffer[64]{};
	NTSTATUS status{};
	HANDLE handle{};
	UINT8* buffer{};
	ULONG size{};

	LOG("Loaded driver\n");

	k_ZwQuerySystemInformation =
		GetProcAddress<ZwQuerySystemInformation>(L"ZwQuerySystemInformation");

	SYSTEM_BIGPOOL_INFORMATION* information = FetchPoolInformation();

	for (ULONG i = 0; i < information->Count; ++i)
	{
		PSYSTEM_BIGPOOL_ENTRY entry = &information->AllocatedInfo[i];

		if (!entry->NonPaged)
			continue;

		LOG("Found %p\n", entry->VirtualAddress);

		buffer = (UINT8*)ExAllocatePoolWithTag(NonPagedPoolNx, entry->SizeInBytes, TAG);
		ASSERT(buffer != nullptr);

		for (ULONG_PTR j = 0; j < entry->SizeInBytes; ++j)
		{
			PVOID addr = (PVOID)((ULONG_PTR)entry->VirtualAddress + j);
			if (MmIsAddressValid(addr))
			{
				buffer[j] = *(UINT8*)addr;
				size++;
			}
			else
			{
				LOG("Aborted copying @ %p\n", addr);
				break;
			}
		}

		LOG("Copied to %p\n", buffer);

		if (size > 0)
		{
			RtlInitEmptyUnicodeString(
				&dumpFile, emptyBuffer, sizeof(emptyBuffer));
			status = RtlUnicodeStringPrintf(
				&dumpFile, L"\\??\\C:\\tmp\\pool_%lu.bin", i);
			STATUS_ASSERT(status);

			InitializeObjectAttributes(
				&attributes, &dumpFile,
				OBJ_CASE_INSENSITIVE | OBJ_KERNEL_HANDLE,
				NULL, NULL);

			status = ZwCreateFile(
				&handle, GENERIC_WRITE,
				&attributes, &statusBlock, NULL,
				FILE_ATTRIBUTE_NORMAL, 0,
				FILE_OVERWRITE_IF,
				FILE_SYNCHRONOUS_IO_NONALERT,
				NULL, 0);
			STATUS_ASSERT(status);

			status = ZwWriteFile(
				handle, NULL, NULL, NULL,
				&statusBlock, buffer, size,
				NULL, NULL);
			STATUS_ASSERT(status);

			status = ZwClose(handle);
			STATUS_ASSERT(status);
		}

		ExFreePoolWithTag(buffer, TAG);

		size = 0;
	}

	ExFreePoolWithTag(information, TAG);
}

extern "C" NTSTATUS DriverEntry(
	_In_ PDRIVER_OBJECT DriverObject,
	_In_ PUNICODE_STRING RegistryPath)
{
	UNREFERENCED_PARAMETER(DriverObject);
	UNREFERENCED_PARAMETER(RegistryPath);

	// Doesn't necessarily need to run in a seperate thread,
	// but it's recommended for use with kdmapper.
	HANDLE handle = nullptr;
	PsCreateSystemThread(&handle, GENERIC_ALL, nullptr, nullptr, nullptr, DumpPools, nullptr);

	return STATUS_SUCCESS;
}
```

`pooldump/pooldump.inf`:

```inf
;
; pooldump.inf
;

[Version]
Signature="$WINDOWS NT$"
Class=System ; TODO: specify appropriate Class
ClassGuid={4d36e97d-e325-11ce-bfc1-08002be10318} ; TODO: specify appropriate ClassGuid
Provider=%ManufacturerName%
CatalogFile=pooldump.cat
DriverVer= ; TODO: set DriverVer in stampinf property pages
PnpLockdown=1

[DestinationDirs]
DefaultDestDir = 12
pooldump_Device_CoInstaller_CopyFiles = 11

[SourceDisksNames]
1 = %DiskName%,,,""

[SourceDisksFiles]
pooldump.sys  = 1,,
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll=1 ; make sure the number matches with SourceDisksNames

;*****************************************
; Install Section
;*****************************************

[Manufacturer]
%ManufacturerName%=Standard,NT$ARCH$

[Standard.NT$ARCH$]
%pooldump.DeviceDesc%=pooldump_Device, Root\pooldump ; TODO: edit hw-id

[pooldump_Device.NT]
CopyFiles=Drivers_Dir

[Drivers_Dir]
pooldump.sys

;-------------- Service installation
[pooldump_Device.NT.Services]
AddService = pooldump,%SPSVCINST_ASSOCSERVICE%, pooldump_Service_Inst

; -------------- pooldump driver install sections
[pooldump_Service_Inst]
DisplayName    = %pooldump.SVCDESC%
ServiceType    = 1               ; SERVICE_KERNEL_DRIVER
StartType      = 3               ; SERVICE_DEMAND_START
ErrorControl   = 1               ; SERVICE_ERROR_NORMAL
ServiceBinary  = %12%\pooldump.sys

;
;--- pooldump_Device Coinstaller installation ------
;

[pooldump_Device.NT.CoInstallers]
AddReg=pooldump_Device_CoInstaller_AddReg
CopyFiles=pooldump_Device_CoInstaller_CopyFiles

[pooldump_Device_CoInstaller_AddReg]
HKR,,CoInstallers32,0x00010000, "WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll,WdfCoInstaller"

[pooldump_Device_CoInstaller_CopyFiles]
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll

[pooldump_Device.NT.Wdf]
KmdfService =  pooldump, pooldump_wdfsect
[pooldump_wdfsect]
KmdfLibraryVersion = $KMDFVERSION$

[Strings]
SPSVCINST_ASSOCSERVICE= 0x00000002
ManufacturerName="<Your manufacturer name>" ;TODO: Replace with your manufacturer name
DiskName = "pooldump Installation Disk"
pooldump.DeviceDesc = "pooldump Device"
pooldump.SVCDESC = "pooldump Service"

```

`pooldump/pooldump.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM">
      <Configuration>Debug</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM">
      <Configuration>Release</Configuration>
      <Platform>ARM</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|ARM64">
      <Configuration>Debug</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|ARM64">
      <Configuration>Release</Configuration>
      <Platform>ARM64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{4722FD6B-D2D0-45C4-9E05-33EA8A6A74E3}</ProjectGuid>
    <TemplateGuid>{1bc93793-694f-48fe-9372-81e2b05556fd}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>12.0</MinimumVisualStudioVersion>
    <Configuration>Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>pooldump</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
    <Driver_SpectreMitigation>Spectre</Driver_SpectreMitigation>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
    <Driver_SpectreMitigation>Spectre</Driver_SpectreMitigation>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'" Label="Configuration">
    <TargetVersion>Windows10</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver10.0</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>KMDF</DriverType>
    <DriverTargetPlatform>Universal</DriverTargetPlatform>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <Inf2CatUseLocalTime>true</Inf2CatUseLocalTime>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <Inf2CatUseLocalTime>true</Inf2CatUseLocalTime>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <Inf2CatUseLocalTime>true</Inf2CatUseLocalTime>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <Inf2CatUseLocalTime>true</Inf2CatUseLocalTime>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
    <ClCompile>
      <BufferSecurityCheck>false</BufferSecurityCheck>
    </ClCompile>
    <Link>
      <EntryPointSymbol>DriverEntry</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
    <ClCompile>
      <BufferSecurityCheck>false</BufferSecurityCheck>
    </ClCompile>
    <Link>
      <EntryPointSymbol>DriverEntry</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|ARM64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|ARM64'">
    <DriverSign>
      <FileDigestAlgorithm>sha256</FileDigestAlgorithm>
    </DriverSign>
  </ItemDefinitionGroup>
  <ItemGroup>
    <Inf Include="pooldump.inf" />
  </ItemGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="driver.cpp" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`pooldump/pooldump.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
    <Filter Include="Driver Files">
      <UniqueIdentifier>{8E41214B-6785-4CFE-B992-037D68949A14}</UniqueIdentifier>
      <Extensions>inf;inv;inx;mof;mc;</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <Inf Include="pooldump.inf">
      <Filter>Driver Files</Filter>
    </Inf>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="driver.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
</Project>
```

`scripts/debug-driver.bat`:

```bat
call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat" x64

cd pooldump && msbuild /property:Configuration=Debug /property:Platform=x64 || exit /b
cd ..

copy pooldump\x64\Debug\pooldump.sys C:\Users\luca\Documents\Projects\kdbg-driver-workstation\guest\layle.sys

cd C:\Users\luca\Documents\Projects\kdbg-driver-workstation
.\kdbg.bat
```