Project Path: arc_gmh5225_DayZ-Server-Battleye-Remover_j41chvqo

Source Tree:

```txt
arc_gmh5225_DayZ-Server-Battleye-Remover_j41chvqo
├── DayZServerPatcher
│   ├── DayZServerPatcher.vcxproj
│   ├── DayZServerPatcher.vcxproj.filters
│   └── src
│       ├── main.cpp
│       ├── pch.h
│       └── utils
│           ├── utils.cpp
│           └── utils.hpp
├── DayZServerPatcher.sln
└── README.md

```

`DayZServerPatcher.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.2.32630.192
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "DayZServerPatcher", "DayZServerPatcher\DayZServerPatcher.vcxproj", "{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Debug|x64.ActiveCfg = Debug|x64
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Debug|x64.Build.0 = Debug|x64
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Debug|x86.ActiveCfg = Debug|Win32
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Debug|x86.Build.0 = Debug|Win32
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Release|x64.ActiveCfg = Release|x64
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Release|x64.Build.0 = Release|x64
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Release|x86.ActiveCfg = Release|Win32
		{FADBAA93-0F43-4DFA-882B-414F6F3A16FC}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {8DC68B3B-09D4-4A64-8C44-EA17824BFF6A}
	EndGlobalSection
EndGlobal

```

`DayZServerPatcher/DayZServerPatcher.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>16.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{fadbaa93-0f43-4dfa-882b-414f6f3a16fc}</ProjectGuid>
    <RootNamespace>DayZServerPatcher</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
      <AdditionalIncludeDirectories>$(ProjectDir)/src;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
      <LanguageStandard>stdcpp20</LanguageStandard>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="src\main.cpp" />
    <ClCompile Include="src\utils\utils.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="src\pch.h" />
    <ClInclude Include="src\utils\utils.hpp" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`DayZServerPatcher/DayZServerPatcher.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;c++;cppm;ixx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;h++;hm;inl;inc;ipp;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="src\main.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
    <ClCompile Include="src\utils\utils.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="src\pch.h">
      <Filter>Header Files</Filter>
    </ClInclude>
    <ClInclude Include="src\utils\utils.hpp">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```

`DayZServerPatcher/src/main.cpp`:

```cpp
#include "pch.h"
#include "utils/utils.hpp"

std::string consoleTitle = "DayZ patched version";
std::string filePath, fileBakPath;
std::vector<BYTE> fileBytes;

int main(int argc, char* argv[]) {
    if (argv[1] == nullptr || !std::filesystem::exists(argv[1])) {
        std::cout << "Start application with target file path." << std::endl;
        system("pause");
        return 0;
    }

    filePath = argv[1];
    fileBakPath = argv[1];
    fileBakPath.append(".bak");

    if (!Utils::ReadFileToVector(filePath, &fileBytes)) {
        std::cout << "Failed to copy file data." << std::endl;
        system("pause");
        return 0;
    }

    if (!Utils::WriteVectorToFile(fileBakPath, &fileBytes)) {
        std::cout << "Failed to create backup of original dayz server." << std::endl;
        system("pause");
        return 0;
    }

    std::cout << "Created backup." << std::endl;

    auto address = Utils::Scan(fileBytes.data(), fileBytes.size(), "40 53 56 57 41 54 41 57 48 81 EC ? ? ? ? 45 33 E4 48 8B D9 44");
    if (!address) {
        std::cout << "Failed to find battleye init function." << std::endl;
        system("pause");
        return 0;
    }

    /*
       mov al, 1
       ret
    */

    BYTE retal1[] = { 0xB0, 0x01, 0xC3 }; 
    memcpy((PVOID)address, retal1, 3); //forcing init function to return true

    std::cout << "Patched battleye init function." << std::endl;

    address = Utils::Scan(fileBytes.data(), fileBytes.size(), "74 5C B8 ? ? ? ? 66 3B C3 75 09 E8 ? ? ? ? 84 C0 74 49 0F B7");
    if (!address) {
        std::cout << "Failed to find VAC check." << std::endl;
        system("pause");
        return 0;
    }

    *(BYTE*)(address) = 0xEB; //change jz to jmp

    std::cout << "Patched VAC check." << std::endl;

    address = Utils::Scan(fileBytes.data(), fileBytes.size(), "44 61 79 5A 20 43 6F 6E");
    if (address) {
        memcpy((PVOID)address, consoleTitle.c_str(), consoleTitle.size());
        std::cout << "Patched console title." << std::endl;
    } else {
        std::cout << "Failed to find patch console title, skipping..." << std::endl;
    }

    if (!Utils::WriteVectorToFile(filePath, &fileBytes)) {
        std::cout << "Failed to write patched file." << std::endl;
        system("pause");
        return 0;
    }

    std::cout << "Wrote patched dayz server back to original file." << std::endl;

    system("pause");
}

```

`DayZServerPatcher/src/pch.h`:

```h
#pragma once

#include <iostream>
#include <stdio.h>
#include <Windows.h>
#include <vector>
#include <sstream>
#include <fstream>
#include <filesystem>

```

`DayZServerPatcher/src/utils/utils.cpp`:

```cpp
#include "utils.hpp"

namespace Utils {
	bool ReadFileToVector(std::string path, std::vector<BYTE>* out) {
		std::ifstream infile(path, std::ios::binary);
		if (!infile)
			return false;

		out->assign((std::istreambuf_iterator<char>(infile)), std::istreambuf_iterator<char>());
		infile.close();
		return true;
	}

	bool WriteVectorToFile(std::string path, std::vector<BYTE>* in) {
		std::ofstream outfile(path, std::ios::binary);
		if (!outfile)
			return false;

		outfile.write((const char*)in->data(), in->size());

		outfile.close();
		return true;
	}

	DWORD64 Scan(BYTE* base, DWORD size, const char* sig) {
		std::vector<PatternByte> p;
		std::istringstream iss(sig);
		std::string w;

		while (iss >> w) {
			if (w.data()[0] == '?') {
				p.emplace_back();
			} else if (w.length() == 2 && isxdigit(w[0]) && isxdigit(w[1])) { 
				p.emplace_back(w);
			} else {
				return NULL;
			}
		}

		for (DWORD i = 0; i < size; i++) {
			auto lpCurrentByte = (BYTE*)(base + i);

			bool found = true;

			for (size_t ps = 0; ps < p.size(); ps++) {
				if (p[ps].ignore == false && lpCurrentByte[ps] != p[ps].data) {
					found = false;
					break;
				}
			}

			if (found) {
				return (DWORD64)lpCurrentByte;
			}
		}

		return NULL;
	}
}
```

`DayZServerPatcher/src/utils/utils.hpp`:

```hpp
#pragma once
#include "pch.h"

namespace Utils {
	struct PatternByte {
		PatternByte() : ignore(true), data(0) {}

		PatternByte(std::string byteString, bool ignoreThis = false) {
			data = ConvertToByte(byteString);
			ignore = ignoreThis;
		}

		bool ignore;
		BYTE data;

	private:
		BYTE ConvertToByte(std::string str) {
			std::istringstream iss(str);

			DWORD ret;
			if (iss >> std::hex >> ret) {
				return static_cast<BYTE>(ret);
			}

			return 0;
		}
	};

	bool ReadFileToVector(std::string path, std::vector<BYTE>* out);
	bool WriteVectorToFile(std::string path, std::vector<BYTE>* in);

	DWORD64 Scan(BYTE* base, DWORD size, const char* sig);
}
```

`README.md`:

```md
# DayZ Server Battleye Remover

Simple program written in c++ to modify the DayZ server exe to disable Battleye<br>
and to allow players with DayZ VAC bans to join your server.<br>
Wrote this so that after each DayZServer update I don't have to manually patch the file<br>
and decided to share it here because why not?

How to use
<ul>
<li>Drag original DayZServer_x64.exe onto the application</li>
<li>If succesful the DayZServer_x64.exe will now be patched, just start up your server.</li>
</ul>

<img src="https://i.imgur.com/ubea0S4.png" width="70%" height="70%">

```