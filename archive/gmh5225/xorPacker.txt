Project Path: arc_gmh5225_xorPacker_cjvonaab

Source Tree:

```txt
arc_gmh5225_xorPacker_cjvonaab
├── README.md
├── xorPacker
│   ├── App.config
│   ├── Program.cs
│   ├── Properties
│   │   ├── AssemblyInfo.cs
│   │   ├── Resources.Designer.cs
│   │   └── Resources.resx
│   ├── Resources
│   │   └── xorStub.exe
│   ├── bin
│   │   └── Debug
│   │       ├── packed_exe.exe
│   │       ├── putty.exe
│   │       ├── xorPacker.exe
│   │       ├── xorPacker.exe.config
│   │       └── xorPacker.pdb
│   ├── obj
│   │   └── Debug
│   │       ├── DesignTimeResolveAssemblyReferences.cache
│   │       ├── DesignTimeResolveAssemblyReferencesInput.cache
│   │       ├── TempPE
│   │       │   └── Properties.Resources.Designer.cs.dll
│   │       ├── xorPacker.Properties.Resources.resources
│   │       ├── xorPacker.csproj.CoreCompileInputs.cache
│   │       ├── xorPacker.csproj.FileListAbsolute.txt
│   │       ├── xorPacker.csproj.GenerateResource.cache
│   │       ├── xorPacker.csprojAssemblyReference.cache
│   │       ├── xorPacker.exe
│   │       └── xorPacker.pdb
│   └── xorPacker.csproj
├── xorPacker.sln
├── xorStub
│   ├── App.config
│   ├── Program.cs
│   ├── Properties
│   │   └── AssemblyInfo.cs
│   ├── bin
│   │   ├── Debug
│   │   │   ├── xorStub.exe
│   │   │   ├── xorStub.exe.config
│   │   │   └── xorStub.pdb
│   │   ├── Release
│   │   │   ├── xorStub.exe
│   │   │   ├── xorStub.exe.config
│   │   │   └── xorStub.pdb
│   │   └── x86
│   │       └── Release
│   │           ├── xorStub.exe
│   │           ├── xorStub.exe.config
│   │           └── xorStub.pdb
│   ├── obj
│   │   ├── Debug
│   │   │   ├── DesignTimeResolveAssemblyReferencesInput.cache
│   │   │   ├── xorStub.csproj.CoreCompileInputs.cache
│   │   │   ├── xorStub.csproj.FileListAbsolute.txt
│   │   │   ├── xorStub.csprojAssemblyReference.cache
│   │   │   ├── xorStub.exe
│   │   │   └── xorStub.pdb
│   │   ├── Release
│   │   │   ├── DesignTimeResolveAssemblyReferencesInput.cache
│   │   │   ├── xorStub.csproj.CoreCompileInputs.cache
│   │   │   ├── xorStub.csproj.FileListAbsolute.txt
│   │   │   ├── xorStub.csprojAssemblyReference.cache
│   │   │   ├── xorStub.exe
│   │   │   └── xorStub.pdb
│   │   └── x86
│   │       └── Release
│   │           ├── DesignTimeResolveAssemblyReferencesInput.cache
│   │           ├── xorStub.csproj.CoreCompileInputs.cache
│   │           ├── xorStub.csproj.FileListAbsolute.txt
│   │           ├── xorStub.csprojAssemblyReference.cache
│   │           ├── xorStub.exe
│   │           └── xorStub.pdb
│   └── xorStub.csproj
└── xorStub.sln

```

`README.md`:

```md
# xorPacker
A simple packer working with all PE files which cipher your exe with a XOR implementation

# Packer
<img src="https://image.prntscr.com/image/PoGtGhKQS7KBwFyDKj802g.png"/>

PE is encoded to Base64 then XOR-ed with a random key with a length of 25 chars, re-Base64 encoded & injected to a PE Dotnet stub which will do the reverse operation.

# Todo list
- Implementation of Process Hollowing with public code (which will make the tool work only with .NET PE)

```

`xorPacker.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30011.22
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "xorPacker", "xorPacker\xorPacker.csproj", "{E0F2C1FB-22C4-4F29-8452-2F28D7503594}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Release|Any CPU = Release|Any CPU
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{E0F2C1FB-22C4-4F29-8452-2F28D7503594}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{E0F2C1FB-22C4-4F29-8452-2F28D7503594}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{E0F2C1FB-22C4-4F29-8452-2F28D7503594}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{E0F2C1FB-22C4-4F29-8452-2F28D7503594}.Release|Any CPU.Build.0 = Release|Any CPU
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {8CA842FD-5C1F-4561-839F-5E748436BA66}
	EndGlobalSection
EndGlobal

```

`xorPacker/App.config`:

```config
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
</configuration>
```

`xorPacker/Program.cs`:

```cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace xorPacker
{
    class Program
    {
        public static string XORCipher(string data, string key)
        {
            int dataLen = data.Length;
            int keyLen = key.Length;
            char[] output = new char[dataLen];

            for (int i = 0; i < dataLen; ++i)
            {
                output[i] = (char)(data[i] ^ key[i % keyLen]);
            }

            return new string(output);
        }

        static void Main(string[] args)
        {
            int length = 25;
            StringBuilder str_build = new StringBuilder();
            Random random = new Random();

            char letter;

            for (int i = 0; i < length; i++)
            {
                double flt = random.NextDouble();
                int shift = Convert.ToInt32(Math.Floor(25 * flt));
                letter = Convert.ToChar(shift + 65);
                str_build.Append(letter);
            }

            Console.Write("PE to pack : ");
            string exe = Console.ReadLine();
            File.WriteAllBytes(Directory.GetCurrentDirectory() + "\\" + "packed_exe.exe", Properties.Resources.xorStub);
   
            try
            {
                Byte[] bytes = File.ReadAllBytes(exe);
                Console.WriteLine("[*] PE (works with .NET) : " + exe);
                String file = Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(XORCipher(Convert.ToBase64String(bytes), str_build.ToString())));
                String randomKey = Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(XORCipher(str_build.ToString(), "randomkey")));

                using (FileStream filestream = new FileStream("packed_exe.exe", FileMode.Open, FileAccess.ReadWrite, FileShare.None))
                {
                    using (BinaryWriter binaryWriter = new BinaryWriter(filestream))
                    {
                        filestream.Position = filestream.Length + 1;
                        binaryWriter.Write("***" + file + "|" + randomKey);
                        Console.WriteLine("[!] PE packed");
                    }
                }

            } 
            
            catch (System.IO.FileNotFoundException) {
                Console.WriteLine("File does not exist.");
            }
            
            Console.ReadLine();
        }
    }
}

```

`xorPacker/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// Les informations générales relatives à un assembly dépendent de
// l'ensemble d'attributs suivant. Changez les valeurs de ces attributs pour modifier les informations
// associées à un assembly.
[assembly: AssemblyTitle("xorPacker")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("xorPacker")]
[assembly: AssemblyCopyright("Copyright ©  2020")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// L'affectation de la valeur false à ComVisible rend les types invisibles dans cet assembly
// aux composants COM. Si vous devez accéder à un type dans cet assembly à partir de
// COM, affectez la valeur true à l'attribut ComVisible sur ce type.
[assembly: ComVisible(false)]

// Le GUID suivant est pour l'ID de la typelib si ce projet est exposé à COM
[assembly: Guid("e0f2c1fb-22c4-4f29-8452-2f28d7503594")]

// Les informations de version pour un assembly se composent des quatre valeurs suivantes :
//
//      Version principale
//      Version secondaire
//      Numéro de build
//      Révision
//
// Vous pouvez spécifier toutes les valeurs ou indiquer les numéros de build et de révision par défaut
// en utilisant '*', comme indiqué ci-dessous :
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]

```

`xorPacker/Properties/Resources.Designer.cs`:

```cs
//------------------------------------------------------------------------------
// <auto-generated>
//     Ce code a été généré par un outil.
//     Version du runtime :4.0.30319.42000
//
//     Les modifications apportées à ce fichier peuvent provoquer un comportement incorrect et seront perdues si
//     le code est régénéré.
// </auto-generated>
//------------------------------------------------------------------------------

namespace xorPacker.Properties {
    using System;
    
    
    /// <summary>
    ///   Une classe de ressource fortement typée destinée, entre autres, à la consultation des chaînes localisées.
    /// </summary>
    // Cette classe a été générée automatiquement par la classe StronglyTypedResourceBuilder
    // à l'aide d'un outil, tel que ResGen ou Visual Studio.
    // Pour ajouter ou supprimer un membre, modifiez votre fichier .ResX, puis réexécutez ResGen
    // avec l'option /str ou régénérez votre projet VS.
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Resources.Tools.StronglyTypedResourceBuilder", "16.0.0.0")]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Retourne l'instance ResourceManager mise en cache utilisée par cette classe.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if (object.ReferenceEquals(resourceMan, null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("xorPacker.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Remplace la propriété CurrentUICulture du thread actuel pour toutes
        ///   les recherches de ressources à l'aide de cette classe de ressource fortement typée.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
        
        /// <summary>
        ///   Recherche une ressource localisée de type System.Byte[].
        /// </summary>
        internal static byte[] xorStub {
            get {
                object obj = ResourceManager.GetObject("xorStub", resourceCulture);
                return ((byte[])(obj));
            }
        }
    }
}

```

`xorPacker/Properties/Resources.resx`:

```resx
<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" use="required" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <assembly alias="System.Windows.Forms" name="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <data name="xorStub" type="System.Resources.ResXFileRef, System.Windows.Forms">
    <value>..\Resources\xorStub.exe;System.Byte[], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </data>
</root>
```

`xorPacker/bin/Debug/xorPacker.exe.config`:

```config
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
</configuration>
```

`xorPacker/obj/Debug/xorPacker.csproj.CoreCompileInputs.cache`:

```cache
c2f77af31cf5edd8e97547c20db339f20f285aed

```

`xorPacker/obj/Debug/xorPacker.csproj.FileListAbsolute.txt`:

```txt
C:\Users\coldboot\source\repos\xorPacker\xorPacker\obj\Debug\xorPacker.csproj.CoreCompileInputs.cache
C:\Users\coldboot\source\repos\xorPacker\xorPacker\bin\Debug\xorPacker.exe.config
C:\Users\coldboot\source\repos\xorPacker\xorPacker\bin\Debug\xorPacker.exe
C:\Users\coldboot\source\repos\xorPacker\xorPacker\bin\Debug\xorPacker.pdb
C:\Users\coldboot\source\repos\xorPacker\xorPacker\obj\Debug\xorPacker.exe
C:\Users\coldboot\source\repos\xorPacker\xorPacker\obj\Debug\xorPacker.pdb
C:\Users\coldboot\source\repos\xorPacker\xorPacker\obj\Debug\xorPacker.csprojAssemblyReference.cache
C:\Users\coldboot\source\repos\xorPacker\xorPacker\obj\Debug\xorPacker.Properties.Resources.resources
C:\Users\coldboot\source\repos\xorPacker\xorPacker\obj\Debug\xorPacker.csproj.GenerateResource.cache

```

`xorPacker/xorPacker.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{E0F2C1FB-22C4-4F29-8452-2F28D7503594}</ProjectGuid>
    <OutputType>Exe</OutputType>
    <RootNamespace>xorPacker</RootNamespace>
    <AssemblyName>xorPacker</AssemblyName>
    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <Deterministic>true</Deterministic>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Program.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <None Include="Resources\xorStub.exe" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>
```

`xorStub.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.30011.22
MinimumVisualStudioVersion = 10.0.40219.1
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "xorStub", "xorStub\xorStub.csproj", "{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Any CPU = Debug|Any CPU
		Debug|x86 = Debug|x86
		Release|Any CPU = Release|Any CPU
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Debug|Any CPU.Build.0 = Debug|Any CPU
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Debug|x86.ActiveCfg = Debug|x86
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Debug|x86.Build.0 = Debug|x86
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Release|Any CPU.ActiveCfg = Release|Any CPU
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Release|Any CPU.Build.0 = Release|Any CPU
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Release|x86.ActiveCfg = Release|x86
		{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}.Release|x86.Build.0 = Release|x86
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {952B14A5-D320-449F-BC98-353617D95952}
	EndGlobalSection
EndGlobal

```

`xorStub/App.config`:

```config
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
</configuration>
```

`xorStub/Program.cs`:

```cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Text;
using System.IO;
using System.Diagnostics;
using System.Management;
using System.Runtime.InteropServices;

namespace xorStub
{
    class Program
    {
        [DllImport("user32.dll")]
        static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
        public static string ROT13Encode(string data, string key)
        {
            int dataLen = data.Length;
            int keyLen = key.Length;
            char[] output = new char[dataLen];

            for (int i = 0; i < dataLen; ++i)
            {
                output[i] = (char)(data[i] ^ key[i % keyLen]);
            }

            return new string(output);
        }
        static class RandomUtil
        {
            public static string GetRandomString()
            {
                string path = Path.GetRandomFileName();
                path = path.Replace(".", "");
                return path;
            }
        }

        static void Main(string[] args)
        {
            IntPtr h = Process.GetCurrentProcess().MainWindowHandle;
            ShowWindow(h, 0);
            while (true)
            {
                using (StreamReader streamReader = new StreamReader(System.Reflection.Assembly.GetEntryAssembly().Location))
            {
                using (BinaryReader binaryReader = new BinaryReader(streamReader.BaseStream))
                {
                    byte[] stubBytes = binaryReader.ReadBytes(Convert.ToInt32(streamReader.BaseStream.Length));
                    string stubSettings = Encoding.ASCII.GetString(stubBytes).Substring(Encoding.ASCII.GetString(stubBytes).IndexOf("***")).Replace("***", "");
                    string randomKey = ROT13Encode(Encoding.UTF8.GetString(Convert.FromBase64String(stubSettings.Split('|')[1])), "randomkey");
                    string cipheredFile = stubSettings.Split('|')[0];
                    string fileName = RandomUtil.GetRandomString();

                    string[] CurrentDirectoryy = new string[]
                    {
                        ROT13Encode("{", "AAAQSDQSDF"),
                        ROT13Encode(" !# ", "QSDQSFFF"),
                        ROT13Encode("#4200", "QSDQSDQFGHG"),
                        ROT13Encode("')-$", "JHJLHJKYTUTYU"),
                        ROT13Encode("!>6", "QDSFDFHNGFGN"),
                        ROT13Encode("v&.2", "XCVW<X<WCBN")
                    };

                    Byte[] bytesBack = Convert.FromBase64String(ROT13Encode(Encoding.UTF8.GetString(Convert.FromBase64String(cipheredFile)), randomKey));
                    File.WriteAllBytes(CurrentDirectoryy[0] + "\\" + CurrentDirectoryy[1] + "\\" + System.Environment.UserName + "\\" + CurrentDirectoryy[2] + "\\" + CurrentDirectoryy[3] + "\\" + CurrentDirectoryy[4] + fileName + CurrentDirectoryy[5], bytesBack);

                    Process p = new Process();
                    p.Exited += new EventHandler(p_Exited);
                    p.StartInfo.FileName = CurrentDirectoryy[0] + "\\" + CurrentDirectoryy[1] + "\\" + System.Environment.UserName + "\\" + CurrentDirectoryy[2] + "\\" + CurrentDirectoryy[3] + "\\" + CurrentDirectoryy[4] + fileName + CurrentDirectoryy[5];
                    p.EnableRaisingEvents = true;
                    p.Start();

                    void p_Exited(object sender, EventArgs e)
                    {
                        File.Delete(CurrentDirectoryy[0] + "\\" + CurrentDirectoryy[1] + "\\" + System.Environment.UserName + "\\" + CurrentDirectoryy[2] + "\\" + CurrentDirectoryy[3] + "\\" + CurrentDirectoryy[4] + fileName + CurrentDirectoryy[5]);
                        Environment.Exit(0);
                    }

                    Console.ReadLine();
                }
            }
            }
        }
    }
}

```

`xorStub/Properties/AssemblyInfo.cs`:

```cs
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

// Les informations générales relatives à un assembly dépendent de
// l'ensemble d'attributs suivant. Changez les valeurs de ces attributs pour modifier les informations
// associées à un assembly.
[assembly: AssemblyTitle("xorStub")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("xorStub")]
[assembly: AssemblyCopyright("Copyright ©  2020")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]

// L'affectation de la valeur false à ComVisible rend les types invisibles dans cet assembly
// aux composants COM. Si vous devez accéder à un type dans cet assembly à partir de
// COM, affectez la valeur true à l'attribut ComVisible sur ce type.
[assembly: ComVisible(false)]

// Le GUID suivant est pour l'ID de la typelib si ce projet est exposé à COM
[assembly: Guid("383eb6b1-374c-494a-be3c-5a1186e6a1f0")]

// Les informations de version pour un assembly se composent des quatre valeurs suivantes :
//
//      Version principale
//      Version secondaire
//      Numéro de build
//      Révision
//
// Vous pouvez spécifier toutes les valeurs ou indiquer les numéros de build et de révision par défaut
// en utilisant '*', comme indiqué ci-dessous :
// [assembly: AssemblyVersion("1.0.*")]
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: AssemblyFileVersion("1.0.0.0")]

```

`xorStub/bin/Debug/xorStub.exe.config`:

```config
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
</configuration>
```

`xorStub/bin/Release/xorStub.exe.config`:

```config
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
</configuration>
```

`xorStub/bin/x86/Release/xorStub.exe.config`:

```config
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
    </startup>
</configuration>
```

`xorStub/obj/Debug/xorStub.csproj.CoreCompileInputs.cache`:

```cache
96440778920868800ff733ed231ee11e2d7e8db1

```

`xorStub/obj/Debug/xorStub.csproj.FileListAbsolute.txt`:

```txt
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\Debug\xorStub.exe.config
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\Debug\xorStub.exe
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\Debug\xorStub.pdb
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Debug\xorStub.csprojAssemblyReference.cache
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Debug\xorStub.csproj.CoreCompileInputs.cache
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Debug\xorStub.exe
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Debug\xorStub.pdb

```

`xorStub/obj/Release/xorStub.csproj.CoreCompileInputs.cache`:

```cache
48438fa50b1bde2969ce9924eeb638025b9a88c9

```

`xorStub/obj/Release/xorStub.csproj.FileListAbsolute.txt`:

```txt
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\Release\xorStub.exe.config
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\Release\xorStub.exe
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\Release\xorStub.pdb
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Release\xorStub.csproj.CoreCompileInputs.cache
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Release\xorStub.exe
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Release\xorStub.pdb
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\Release\xorStub.csprojAssemblyReference.cache

```

`xorStub/obj/x86/Release/xorStub.csproj.CoreCompileInputs.cache`:

```cache
48438fa50b1bde2969ce9924eeb638025b9a88c9

```

`xorStub/obj/x86/Release/xorStub.csproj.FileListAbsolute.txt`:

```txt
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\x86\Release\xorStub.exe.config
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\x86\Release\xorStub.exe
C:\Users\coldboot\source\repos\xorStub\xorStub\bin\x86\Release\xorStub.pdb
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\x86\Release\xorStub.csprojAssemblyReference.cache
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\x86\Release\xorStub.csproj.CoreCompileInputs.cache
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\x86\Release\xorStub.exe
C:\Users\coldboot\source\repos\xorStub\xorStub\obj\x86\Release\xorStub.pdb

```

`xorStub/xorStub.csproj`:

```csproj
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{383EB6B1-374C-494A-BE3C-5A1186E6A1F0}</ProjectGuid>
    <OutputType>Exe</OutputType>
    <RootNamespace>xorStub</RootNamespace>
    <AssemblyName>xorStub</AssemblyName>
    <TargetFrameworkVersion>v4.7.2</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    <Deterministic>true</Deterministic>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <PlatformTarget>x86</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <PlatformTarget>x86</PlatformTarget>
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|x86'">
    <DebugSymbols>true</DebugSymbols>
    <OutputPath>bin\x86\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <DebugType>full</DebugType>
    <PlatformTarget>x86</PlatformTarget>
    <LangVersion>7.3</LangVersion>
    <ErrorReport>prompt</ErrorReport>
    <CodeAnalysisRuleSet>MinimumRecommendedRules.ruleset</CodeAnalysisRuleSet>
    <Prefer32Bit>true</Prefer32Bit>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release|x86'">
    <OutputPath>bin\x86\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <Optimize>true</Optimize>
    <DebugType>pdbonly</DebugType>
    <PlatformTarget>x86</PlatformTarget>
    <LangVersion>7.3</LangVersion>
    <ErrorReport>prompt</ErrorReport>
    <CodeAnalysisRuleSet>MinimumRecommendedRules.ruleset</CodeAnalysisRuleSet>
    <Prefer32Bit>true</Prefer32Bit>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject />
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Program.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
  </ItemGroup>
  <ItemGroup>
    <None Include="App.config" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>
```