Project Path: arc_gmh5225_ProxyAPICall_3ihdcp3s

Source Tree:

```txt
arc_gmh5225_ProxyAPICall_3ihdcp3s
├── ProxyAPICall.cpp
├── ProxyAPICall.sln
├── ProxyAPICall.vcxproj
├── README.md
└── stub.h

```

`ProxyAPICall.cpp`:

```cpp
#include <windows.h>
#include <tuple>
#include <map>
#include <stdio.h>
#include "stub.h"


char* WorkCallbackArgAddr = NULL;
int offset = 0;

template<class Tuple, std::size_t N>
struct TuplePrinter {
    static void operate(const Tuple& t)
    {
        TuplePrinter<Tuple, N - 1>::operate(t);
        memcpy(WorkCallbackArgAddr + offset, &std::get<N - 1>(t), sizeof(char*));
        offset += sizeof(char*);
    }
};

template<class Tuple>
struct TuplePrinter<Tuple, 1> {
    static void operate(const Tuple& t)
    {
        memcpy(WorkCallbackArgAddr + offset, &std::get<0>(t), sizeof(char*));
        offset += sizeof(char*);
    }
};

template<class... Args>
void OperateTuple(const std::tuple<Args...>& t){
    TuplePrinter<decltype(t), sizeof...(Args)>::operate(t);
}


template<typename... ServiceArgs>
uint32_t ProxyCall(ServiceArgs... args) {

    //Init
    FARPROC pTpAllocWork = GetProcAddress(GetModuleHandleA("ntdll"), "TpAllocWork");
    FARPROC pTpPostWork = GetProcAddress(GetModuleHandleA("ntdll"), "TpPostWork");
    FARPROC pTpReleaseWork = GetProcAddress(GetModuleHandleA("ntdll"), "TpReleaseWork");

    //Init Call Stub Map
    std::map<int, unsigned char*> stub_map;
    stub_map.insert(std::make_pair(1, WorkCallback_stub_arg_1));
    stub_map.insert(std::make_pair(2, WorkCallback_stub_arg_2));
    stub_map.insert(std::make_pair(3, WorkCallback_stub_arg_3));
    stub_map.insert(std::make_pair(4, WorkCallback_stub_arg_4));
    stub_map.insert(std::make_pair(5, WorkCallback_stub_arg_5));
    stub_map.insert(std::make_pair(6, WorkCallback_stub_arg_6));
    stub_map.insert(std::make_pair(7, WorkCallback_stub_arg_7));
    stub_map.insert(std::make_pair(8, WorkCallback_stub_arg_8));
    stub_map.insert(std::make_pair(9, WorkCallback_stub_arg_9));
    stub_map.insert(std::make_pair(10, WorkCallback_stub_arg_10));
    stub_map.insert(std::make_pair(11, WorkCallback_stub_arg_11));


    std::size_t argsize = sizeof...(ServiceArgs);
    auto data = std::make_tuple(std::forward<ServiceArgs>(args)...);
   
    std::size_t argBufferSize = argsize * sizeof(char*);
    WorkCallbackArgAddr = (char*)malloc(argBufferSize);
    memset(WorkCallbackArgAddr, 0x00, argBufferSize);

    //operate args
    OperateTuple(data);

    //locate args num
    auto maplocation = stub_map.find(argsize);
    unsigned char* WorkCallback_stub = maplocation->second;

    PTP_WORK WorkReturn = NULL;
    ((TPALLOCWORK)pTpAllocWork)(&WorkReturn, (PTP_WORK_CALLBACK)WorkCallback_stub, WorkCallbackArgAddr, NULL);
    ((TPPOSTWORK)pTpPostWork)(WorkReturn);
    ((TPRELEASEWORK)pTpReleaseWork)(WorkReturn);

    WaitForSingleObject((HANDLE)-1, 0x1000);

    free(WorkCallbackArgAddr);

    return 0;

}

int main()
{   
    void* allocation = nullptr;
    SIZE_T size = 0x1000;
    
    UINT_PTR pNtAllocateVirtualMemory = (UINT_PTR)GetProcAddress(GetModuleHandleA("ntdll"), "NtAllocateVirtualMemory");

    ProxyCall(pNtAllocateVirtualMemory,
        (ULONG_PTR) -1,
        &allocation,
        (ULONG_PTR) 0,
        &size,
        (ULONG_PTR)MEM_RESERVE | MEM_COMMIT,
        (ULONG_PTR)PAGE_READWRITE);

    printf("allocatedAddress: %p\n", allocation);
}


```

`ProxyAPICall.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 17
VisualStudioVersion = 17.4.33103.184
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ProxyAPICall", "ProxyAPICall.vcxproj", "{80B8E19E-68DE-484B-8B5C-A03E499BD646}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|x64 = Debug|x64
		Debug|x86 = Debug|x86
		Release|x64 = Release|x64
		Release|x86 = Release|x86
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Debug|x64.ActiveCfg = Debug|x64
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Debug|x64.Build.0 = Debug|x64
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Debug|x86.ActiveCfg = Debug|Win32
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Debug|x86.Build.0 = Debug|Win32
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Release|x64.ActiveCfg = Release|x64
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Release|x64.Build.0 = Release|x64
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Release|x86.ActiveCfg = Release|Win32
		{80B8E19E-68DE-484B-8B5C-A03E499BD646}.Release|x86.Build.0 = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
	GlobalSection(ExtensibilityGlobals) = postSolution
		SolutionGuid = {F063D57C-BB40-4366-BB1E-57C5AF57A24B}
	EndGlobalSection
EndGlobal

```

`ProxyAPICall.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Debug|x64">
      <Configuration>Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|x64">
      <Configuration>Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <VCProjectVersion>16.0</VCProjectVersion>
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{80b8e19e-68de-484b-8b5c-a03e499bd646}</ProjectGuid>
    <RootNamespace>ProxyAPICall</RootNamespace>
    <WindowsTargetPlatformVersion>10.0</WindowsTargetPlatformVersion>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'" Label="Configuration">
    <ConfigurationType>Application</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v143</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="Shared">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|x64'">
    <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <SDLCheck>true</SDLCheck>
      <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <ConformanceMode>true</ConformanceMode>
    </ClCompile>
    <Link>
      <SubSystem>Console</SubSystem>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="ProxyAPICall.cpp" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="stub.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`README.md`:

```md
# ProxyAPICall
 Just another version of the custom stack call from Proxy-Function-Calls-For-ETwTI

 Support 1 to 11 args call

 Compile in VisualStudio

### Study:

https://0xdarkvortex.dev/hiding-in-plainsight/

https://github.com/paranoidninja/Proxy-Function-Calls-For-ETwTI


```

`stub.h`:

```h
#pragma once
#include <windows.h>

//stub in .text section
#define ALLOC_ON_CODE \
_Pragma("section(\".text\")") \
__declspec(allocate(".text"))


typedef NTSTATUS(NTAPI* TPALLOCWORK)(PTP_WORK* ptpWrk, PTP_WORK_CALLBACK pfnwkCallback, PVOID OptionalArg, PTP_CALLBACK_ENVIRON CallbackEnvironment);
typedef VOID(NTAPI* TPPOSTWORK)(PTP_WORK);
typedef VOID(NTAPI* TPRELEASEWORK)(PTP_WORK);

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_1[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_2[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_3[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx + 0x18]

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_4[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx + 0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_5[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx + 0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx+0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_6[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx + 0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x30,                                 // mov r10, QWORD PTR[rbx + 0x30]
    0x4c, 0x89, 0x54, 0x24, 0x30,                           // mov QWORD PTR[rsp + 0x30], r10
    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx + 0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_7[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx+0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x38,                                 // mov r10, QWORD PTR[rbx + 0x38]
    0x4c, 0x89, 0x54, 0x24, 0x38,                           // mov QWORD PTR[rsp + 0x38], r10
    0x4c, 0x8b, 0x53, 0x30,                                 // mov r10, QWORD PTR[rbx + 0x30]
    0x4c, 0x89, 0x54, 0x24, 0x30,                           // mov QWORD PTR[rsp + 0x30], r10
    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx + 0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_8[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx+0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x40,                                 // mov r10, QWORD PTR[rbx + 0x40]
    0x4c, 0x89, 0x54, 0x24, 0x40,                           // mov QWORD PTR[rsp + 0x40], r10
    0x4c, 0x8b, 0x53, 0x38,                                 // mov r10, QWORD PTR[rbx + 0x38]
    0x4c, 0x89, 0x54, 0x24, 0x38,                           // mov QWORD PTR[rsp + 0x38], r10
    0x4c, 0x8b, 0x53, 0x30,                                 // mov r10, QWORD PTR[rbx + 0x30]
    0x4c, 0x89, 0x54, 0x24, 0x30,                           // mov QWORD PTR[rsp + 0x30], r10
    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx + 0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_9[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx+0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x48,                                 // mov r10, QWORD PTR[rbx + 0x48]
    0x4c, 0x89, 0x54, 0x24, 0x48,                           // mov QWORD PTR[rsp + 0x48], r10
    0x4c, 0x8b, 0x53, 0x40,                                 // mov r10, QWORD PTR[rbx + 0x40]
    0x4c, 0x89, 0x54, 0x24, 0x40,                           // mov QWORD PTR[rsp + 0x40], r10
    0x4c, 0x8b, 0x53, 0x38,                                 // mov r10, QWORD PTR[rbx + 0x38]
    0x4c, 0x89, 0x54, 0x24, 0x38,                           // mov QWORD PTR[rsp + 0x38], r10
    0x4c, 0x8b, 0x53, 0x30,                                 // mov r10, QWORD PTR[rbx + 0x30]
    0x4c, 0x89, 0x54, 0x24, 0x30,                           // mov QWORD PTR[rsp + 0x30], r10
    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx + 0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_10[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx+0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x50,                                 // mov r10, QWORD PTR[rbx + 0x50]
    0x4c, 0x89, 0x54, 0x24, 0x50,                           // mov QWORD PTR[rsp + 0x50], r10
    0x4c, 0x8b, 0x53, 0x48,                                 // mov r10, QWORD PTR[rbx + 0x48]
    0x4c, 0x89, 0x54, 0x24, 0x48,                           // mov QWORD PTR[rsp + 0x48], r10
    0x4c, 0x8b, 0x53, 0x40,                                 // mov r10, QWORD PTR[rbx + 0x40]
    0x4c, 0x89, 0x54, 0x24, 0x40,                           // mov QWORD PTR[rsp + 0x40], r10
    0x4c, 0x8b, 0x53, 0x38,                                 // mov r10, QWORD PTR[rbx + 0x38]
    0x4c, 0x89, 0x54, 0x24, 0x38,                           // mov QWORD PTR[rsp + 0x38], r10
    0x4c, 0x8b, 0x53, 0x30,                                 // mov r10, QWORD PTR[rbx + 0x30]
    0x4c, 0x89, 0x54, 0x24, 0x30,                           // mov QWORD PTR[rsp + 0x30], r10
    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx + 0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};

ALLOC_ON_CODE unsigned char WorkCallback_stub_arg_11[] = {

    0x48, 0x89, 0xd3,                                       // mov rbx, rdx
    0x48, 0x8b, 0x03,                                       // mov rax, QWORD PTR[rbx]
    0x48, 0x8b, 0x4b, 0x08,                                 // mov rcx, QWORD PTR[rbx + 0x8]
    0x48, 0x8b, 0x53, 0x10,                                 // mov rdx, QWORD PTR[rbx + 0x10]
    0x4c, 0x8b, 0x43, 0x18,                                 // mov r8,  QWORD PTR[rbx+0x18]
    0x4c, 0x8b, 0x4b, 0x20,                                 // mov r9,  QWORD PTR[rbx + 0x20]

    0x4c, 0x8b, 0x53, 0x58,                                 // mov r10, QWORD PTR[rbx + 0x58]
    0x4c, 0x89, 0x54, 0x24, 0x58,                           // mov QWORD PTR[rsp + 0x58], r10
    0x4c, 0x8b, 0x53, 0x48,                                 // mov r10, QWORD PTR[rbx + 0x48]
    0x4c, 0x89, 0x54, 0x24, 0x48,                           // mov QWORD PTR[rsp + 0x48], r10
    0x4c, 0x8b, 0x53, 0x40,                                 // mov r10, QWORD PTR[rbx + 0x40]
    0x4c, 0x89, 0x54, 0x24, 0x40,                           // mov QWORD PTR[rsp + 0x40], r10
    0x4c, 0x8b, 0x53, 0x38,                                 // mov r10, QWORD PTR[rbx + 0x38]
    0x4c, 0x89, 0x54, 0x24, 0x38,                           // mov QWORD PTR[rsp + 0x38], r10
    0x4c, 0x8b, 0x53, 0x30,                                 // mov r10, QWORD PTR[rbx + 0x30]
    0x4c, 0x89, 0x54, 0x24, 0x30,                           // mov QWORD PTR[rsp + 0x30], r10
    0x4c, 0x8b, 0x53, 0x28,                                 // mov r10, QWORD PTR[rbx + 0x28]
    0x4c, 0x89, 0x54, 0x24, 0x28,                           // mov QWORD PTR[rsp + 0x28], r10

    0xff, 0xe0                                              // jmp rax

};
```