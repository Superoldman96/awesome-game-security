Project Path: arc_gmh5225_Kernel-dll-injector_od3fmxni

Source Tree:

```txt
arc_gmh5225_Kernel-dll-injector_od3fmxni
├── README.md
└── Sirifef
    ├── MyDLL
    │   ├── MyDLL.vcxproj
    │   ├── MyDLL.vcxproj.filters
    │   └── Source.cpp
    ├── Sirifef
    │   ├── Sf.c
    │   ├── Sf.h
    │   ├── Sirifef.inf
    │   ├── Sirifef.vcxproj
    │   └── Sirifef.vcxproj.filters
    ├── Sirifef Package
    │   ├── Sirifef Package.vcxproj
    │   └── Sirifef Package.vcxproj.filters
    ├── Sirifef.sln
    ├── Sirifef.v12.suo
    └── bin
        ├── MyDLL.dll
        └── Sirifef.sys

```

`README.md`:

```md
# Kernel-dll-injector
Kernel-Mode Driver that loads a dll into every new created process that loads kernel32.dll module </br>
Code is based on reversed rootkit Sirifef aka max++, one of the most well coded rootkits for Windows Operating Systems of all time </br>
# How to use
Project is compiled using VS 2013 and WDK 8.1, if you use a new version simply upgrade the whole project, should work just fine </br>
Windows x86 version only </br>
Place your dll in whatever location, compile the driver with the new dll path </br>
Load the driver </br>
Dll should inject in every new process that needs to load kernel32.dll </br>
# Limitations
Not compatible with x64, but adaptability its pretty much straightforward </br>
Not sure about the impact the whole process injection can cause on the system, tested the project for about 1 hour and no BSOD's whatsoever </br>
# More Information
https://alexvogtkernel.blogspot.com/2018/09/kernel-injection-code-reversing-sirifef.html </br>

```

`Sirifef/MyDLL/MyDLL.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Debug|Win32">
      <Configuration>Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Release|Win32">
      <Configuration>Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}</ProjectGuid>
    <Keyword>Win32Proj</Keyword>
    <RootNamespace>MyDLL</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>v120</PlatformToolset>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'" Label="Configuration">
    <ConfigurationType>DynamicLibrary</ConfigurationType>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>v120</PlatformToolset>
    <WholeProgramOptimization>true</WholeProgramOptimization>
    <CharacterSet>Unicode</CharacterSet>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <ImportGroup Label="PropertySheets" Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <LinkIncremental>true</LinkIncremental>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <LinkIncremental>false</LinkIncremental>
    <OutDir>$(SolutionDir)bin\</OutDir>
    <IntDir>bin\</IntDir>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">
    <ClCompile>
      <PrecompiledHeader>
      </PrecompiledHeader>
      <WarningLevel>Level3</WarningLevel>
      <Optimization>Disabled</Optimization>
      <PreprocessorDefinitions>WIN32;_DEBUG;_WINDOWS;_USRDLL;MYDLL_EXPORTS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
    </ClCompile>
    <Link>
      <SubSystem>Windows</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Release|Win32'">
    <ClCompile>
      <WarningLevel>TurnOffAllWarnings</WarningLevel>
      <PrecompiledHeader>
      </PrecompiledHeader>
      <Optimization>MaxSpeed</Optimization>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <PreprocessorDefinitions>WIN32;NDEBUG;_WINDOWS;_USRDLL;MYDLL_EXPORTS;%(PreprocessorDefinitions)</PreprocessorDefinitions>
      <RuntimeLibrary>MultiThreaded</RuntimeLibrary>
      <BufferSecurityCheck>false</BufferSecurityCheck>
    </ClCompile>
    <Link>
      <SubSystem>Windows</SubSystem>
      <GenerateDebugInformation>true</GenerateDebugInformation>
      <EnableCOMDATFolding>true</EnableCOMDATFolding>
      <OptimizeReferences>true</OptimizeReferences>
    </Link>
  </ItemDefinitionGroup>
  <ItemGroup>
    <ClCompile Include="Source.cpp" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`Sirifef/MyDLL/MyDLL.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hh;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="Source.cpp">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
</Project>
```

`Sirifef/MyDLL/Source.cpp`:

```cpp
#include <Windows.h>


BOOL WINAPI DllMain(HMODULE hModule, DWORD dwReason, LPVOID lParam)
{
	switch (dwReason)
	{
	case DLL_PROCESS_ATTACH:
		MessageBox(NULL, L"DLL Injected", L"Kernel Injector", MB_ICONINFORMATION);
		break;
	case DLL_PROCESS_DETACH:
		MessageBox(NULL, L"DLL Detached from process", L"Kernel Injector", MB_ICONINFORMATION);
		break;
	case DLL_THREAD_ATTACH:
	case DLL_THREAD_DETACH:
	default:
		break;
	}

	return TRUE;
}
```

`Sirifef/Sirifef Package/Sirifef Package.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Win8.1 Debug|Win32">
      <Configuration>Win8.1 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8.1 Release|Win32">
      <Configuration>Win8.1 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|Win32">
      <Configuration>Win8 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|Win32">
      <Configuration>Win8 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|Win32">
      <Configuration>Win7 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|Win32">
      <Configuration>Win7 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8.1 Debug|x64">
      <Configuration>Win8.1 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8.1 Release|x64">
      <Configuration>Win8.1 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|x64">
      <Configuration>Win8 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|x64">
      <Configuration>Win8 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|x64">
      <Configuration>Win7 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|x64">
      <Configuration>Win7 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}</ProjectGuid>
    <TemplateGuid>{4605da2c-74a5-4865-98e1-152ef136825f}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>11.0</MinimumVisualStudioVersion>
    <Configuration>Win8.1 Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>Sirifef_Package</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|Win32'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|Win32'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|x64'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|x64'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Utility</ConfigurationType>
    <DriverType>Package</DriverType>
    <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <EnableDeployment>False</EnableDeployment>
    <RemoveDriver>True</RemoveDriver>
    <HardwareIdString />
    <CommandLine />
    <DeployFiles />
    <EnableVerifier>False</EnableVerifier>
    <AllDrivers>False</AllDrivers>
    <VerifyProjectOutput>True</VerifyProjectOutput>
    <VerifyDrivers />
    <VerifyFlags>133563</VerifyFlags>
  </PropertyGroup>
  <ItemGroup>
    <FilesToPackage Include="@(Inf->'%(CopyOutput)')" Condition="'@(Inf)'!=''" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\Sirifef\Sirifef.vcxproj">
      <Project>{d1abcab4-eb4c-442a-b20f-678130d185c9}</Project>
    </ProjectReference>
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`Sirifef/Sirifef Package/Sirifef Package.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Driver Files">
      <UniqueIdentifier>{8E41214B-6785-4CFE-B992-037D68949A14}</UniqueIdentifier>
      <Extensions>inf;inv;inx;mof;mc;</Extensions>
    </Filter>
  </ItemGroup>
</Project>
```

`Sirifef/Sirifef.sln`:

```sln

Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio 2013
VisualStudioVersion = 12.0.40629.0
MinimumVisualStudioVersion = 10.0.40219.1
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "Sirifef", "Sirifef\Sirifef.vcxproj", "{D1ABCAB4-EB4C-442A-B20F-678130D185C9}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "Sirifef Package", "Sirifef Package\Sirifef Package.vcxproj", "{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}"
	ProjectSection(ProjectDependencies) = postProject
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9} = {D1ABCAB4-EB4C-442A-B20F-678130D185C9}
	EndProjectSection
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "SirifefHash", "SirifefHash\SirifefHash.vcxproj", "{036647AC-824C-4111-8349-444414F7750A}"
EndProject
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "MyDLL", "MyDLL\MyDLL.vcxproj", "{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}"
EndProject
Global
	GlobalSection(SolutionConfigurationPlatforms) = preSolution
		Debug|Win32 = Debug|Win32
		Debug|x64 = Debug|x64
		Release|Win32 = Release|Win32
		Release|x64 = Release|x64
		Win7 Debug|Win32 = Win7 Debug|Win32
		Win7 Debug|x64 = Win7 Debug|x64
		Win7 Release|Win32 = Win7 Release|Win32
		Win7 Release|x64 = Win7 Release|x64
		Win8 Debug|Win32 = Win8 Debug|Win32
		Win8 Debug|x64 = Win8 Debug|x64
		Win8 Release|Win32 = Win8 Release|Win32
		Win8 Release|x64 = Win8 Release|x64
		Win8.1 Debug|Win32 = Win8.1 Debug|Win32
		Win8.1 Debug|x64 = Win8.1 Debug|x64
		Win8.1 Release|Win32 = Win8.1 Release|Win32
		Win8.1 Release|x64 = Win8.1 Release|x64
	EndGlobalSection
	GlobalSection(ProjectConfigurationPlatforms) = postSolution
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Debug|Win32.ActiveCfg = Win8.1 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Debug|Win32.Build.0 = Win8.1 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Debug|Win32.Deploy.0 = Win8.1 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Debug|x64.ActiveCfg = Win8.1 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Debug|x64.Build.0 = Win8.1 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Debug|x64.Deploy.0 = Win8.1 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Release|Win32.ActiveCfg = Win8.1 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Release|Win32.Build.0 = Win8.1 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Release|Win32.Deploy.0 = Win8.1 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Release|x64.ActiveCfg = Win8.1 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Release|x64.Build.0 = Win8.1 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Release|x64.Deploy.0 = Win8.1 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Debug|Win32.ActiveCfg = Win7 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Debug|Win32.Build.0 = Win7 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Debug|Win32.Deploy.0 = Win7 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Debug|x64.ActiveCfg = Win7 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Debug|x64.Build.0 = Win7 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Debug|x64.Deploy.0 = Win7 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Release|Win32.ActiveCfg = Win7 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Release|Win32.Build.0 = Win7 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Release|Win32.Deploy.0 = Win7 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Release|x64.ActiveCfg = Win7 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Release|x64.Build.0 = Win7 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win7 Release|x64.Deploy.0 = Win7 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Debug|Win32.ActiveCfg = Win8 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Debug|Win32.Build.0 = Win8 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Debug|Win32.Deploy.0 = Win8 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Debug|x64.ActiveCfg = Win8 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Debug|x64.Build.0 = Win8 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Debug|x64.Deploy.0 = Win8 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Release|Win32.ActiveCfg = Win8 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Release|Win32.Build.0 = Win8 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Release|Win32.Deploy.0 = Win8 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Release|x64.ActiveCfg = Win8 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Release|x64.Build.0 = Win8 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8 Release|x64.Deploy.0 = Win8 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Debug|Win32.ActiveCfg = Win8.1 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Debug|Win32.Build.0 = Win8.1 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Debug|Win32.Deploy.0 = Win8.1 Debug|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Debug|x64.ActiveCfg = Win8.1 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Debug|x64.Build.0 = Win8.1 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Debug|x64.Deploy.0 = Win8.1 Debug|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Release|Win32.ActiveCfg = Win8.1 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Release|Win32.Build.0 = Win8.1 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Release|Win32.Deploy.0 = Win8.1 Release|Win32
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Release|x64.ActiveCfg = Win8.1 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Release|x64.Build.0 = Win8.1 Release|x64
		{D1ABCAB4-EB4C-442A-B20F-678130D185C9}.Win8.1 Release|x64.Deploy.0 = Win8.1 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Debug|Win32.ActiveCfg = Win8.1 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Debug|Win32.Build.0 = Win8.1 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Debug|Win32.Deploy.0 = Win8.1 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Debug|x64.ActiveCfg = Win8.1 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Debug|x64.Build.0 = Win8.1 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Debug|x64.Deploy.0 = Win8.1 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Release|Win32.ActiveCfg = Win8.1 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Release|Win32.Build.0 = Win8.1 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Release|Win32.Deploy.0 = Win8.1 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Release|x64.ActiveCfg = Win8.1 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Release|x64.Build.0 = Win8.1 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Release|x64.Deploy.0 = Win8.1 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Debug|Win32.ActiveCfg = Win7 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Debug|Win32.Build.0 = Win7 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Debug|Win32.Deploy.0 = Win7 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Debug|x64.ActiveCfg = Win7 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Debug|x64.Build.0 = Win7 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Debug|x64.Deploy.0 = Win7 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Release|Win32.ActiveCfg = Win7 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Release|Win32.Build.0 = Win7 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Release|Win32.Deploy.0 = Win7 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Release|x64.ActiveCfg = Win7 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Release|x64.Build.0 = Win7 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win7 Release|x64.Deploy.0 = Win7 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Debug|Win32.ActiveCfg = Win8 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Debug|Win32.Build.0 = Win8 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Debug|Win32.Deploy.0 = Win8 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Debug|x64.ActiveCfg = Win8 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Debug|x64.Build.0 = Win8 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Debug|x64.Deploy.0 = Win8 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Release|Win32.ActiveCfg = Win8 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Release|Win32.Build.0 = Win8 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Release|Win32.Deploy.0 = Win8 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Release|x64.ActiveCfg = Win8 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Release|x64.Build.0 = Win8 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8 Release|x64.Deploy.0 = Win8 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Debug|Win32.ActiveCfg = Win8.1 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Debug|Win32.Build.0 = Win8.1 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Debug|Win32.Deploy.0 = Win8.1 Debug|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Debug|x64.ActiveCfg = Win8.1 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Debug|x64.Build.0 = Win8.1 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Debug|x64.Deploy.0 = Win8.1 Debug|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Release|Win32.ActiveCfg = Win8.1 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Release|Win32.Build.0 = Win8.1 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Release|Win32.Deploy.0 = Win8.1 Release|Win32
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Release|x64.ActiveCfg = Win8.1 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Release|x64.Build.0 = Win8.1 Release|x64
		{D15FE5B0-75D3-407D-A9CE-77F0EB38588F}.Win8.1 Release|x64.Deploy.0 = Win8.1 Release|x64
		{036647AC-824C-4111-8349-444414F7750A}.Debug|Win32.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Debug|Win32.Build.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Debug|Win32.Deploy.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Debug|x64.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Release|Win32.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Release|Win32.Build.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Release|Win32.Deploy.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Release|x64.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Debug|Win32.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Debug|Win32.Build.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Debug|Win32.Deploy.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Debug|x64.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Release|Win32.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Release|Win32.Build.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Release|Win32.Deploy.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win7 Release|x64.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Debug|Win32.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Debug|Win32.Build.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Debug|Win32.Deploy.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Debug|x64.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Release|Win32.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Release|Win32.Build.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Release|Win32.Deploy.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8 Release|x64.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Debug|Win32.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Debug|Win32.Build.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Debug|Win32.Deploy.0 = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Debug|x64.ActiveCfg = Debug|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Release|Win32.ActiveCfg = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Release|Win32.Build.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Release|Win32.Deploy.0 = Release|Win32
		{036647AC-824C-4111-8349-444414F7750A}.Win8.1 Release|x64.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Debug|Win32.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Debug|Win32.Build.0 = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Debug|x64.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Release|Win32.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Release|Win32.Build.0 = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Release|x64.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win7 Debug|Win32.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win7 Debug|Win32.Build.0 = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win7 Debug|x64.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win7 Release|Win32.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win7 Release|Win32.Build.0 = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win7 Release|x64.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8 Debug|Win32.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8 Debug|Win32.Build.0 = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8 Debug|x64.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8 Release|Win32.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8 Release|Win32.Build.0 = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8 Release|x64.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8.1 Debug|Win32.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8.1 Debug|Win32.Build.0 = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8.1 Debug|x64.ActiveCfg = Debug|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8.1 Release|Win32.ActiveCfg = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8.1 Release|Win32.Build.0 = Release|Win32
		{73CC87B1-96A5-4AAD-BBC4-DF8656EEA825}.Win8.1 Release|x64.ActiveCfg = Release|Win32
	EndGlobalSection
	GlobalSection(SolutionProperties) = preSolution
		HideSolutionNode = FALSE
	EndGlobalSection
EndGlobal

```

`Sirifef/Sirifef/Sf.c`:

```c
#include <ntifs.h>
#include <ntddk.h>
#include <ntimage.h>

#include "Sf.h"

GET_ADDRESS Hash = { 0 };

UINT32 HashString(PCHAR pcString)
{
	INT Counter = NULL;
	UINT32 Hash = 0, N = 0;
	while ((Counter = *pcString++))
	{
		Hash ^= ((N++ & 1) == NULL) ? ((Hash << 5) ^ Counter ^ (Hash >> 1)) :
			(~((Hash << 9) ^ Counter ^ (Hash >> 3)));
	}

	return (Hash & 0x7FFFFFFF);
}

PVOID GetProcedureAddressByHash(PVOID ModuleBase,ULONG dwHash, ULONG Data)
{
	PIMAGE_DOS_HEADER ImageDosHeader = (PIMAGE_DOS_HEADER)ModuleBase;
	if (ImageDosHeader->e_magic == IMAGE_DOS_SIGNATURE)
	{
		PIMAGE_NT_HEADERS ImageNtHeaders = ((PIMAGE_NT_HEADERS)(RtlOffsetToPointer(ModuleBase, ImageDosHeader->e_lfanew)));
		if (ImageNtHeaders->Signature == IMAGE_NT_SIGNATURE)
		{
			if (ImageNtHeaders->OptionalHeader.DataDirectory[Data].VirtualAddress && Data < ImageNtHeaders->OptionalHeader.NumberOfRvaAndSizes) {
				PIMAGE_EXPORT_DIRECTORY ImageExport = (((PIMAGE_EXPORT_DIRECTORY)(PUCHAR)RtlOffsetToPointer(ModuleBase, ImageNtHeaders->OptionalHeader.DataDirectory[Data].VirtualAddress)));
				if (ImageExport)
				{
					PULONG AddressOfNames = ((PULONG)RtlOffsetToPointer(ModuleBase, ImageExport->AddressOfNames));
					for (ULONG n = 0; n < ImageExport->NumberOfNames; ++n)
					{
						LPSTR Func = ((LPSTR)RtlOffsetToPointer(ModuleBase, AddressOfNames[n]));
						if (HashString(Func) == dwHash)
						{
							PULONG AddressOfFunctions = ((PULONG)RtlOffsetToPointer(ModuleBase, ImageExport->AddressOfFunctions));
							PUSHORT AddressOfOrdinals = ((PUSHORT)RtlOffsetToPointer(ModuleBase, ImageExport->AddressOfNameOrdinals));
							return ((PVOID)RtlOffsetToPointer(ModuleBase, AddressOfFunctions[AddressOfOrdinals[n]]));

						}
					}

				}
			}
		}
	}
	return NULL;
}

PVOID ResolveDynamicImport(PVOID ModuleBase, ULONG Hash)
{
	return GetProcedureAddressByHash(ModuleBase, Hash,0);
}

VOID NTAPI APCKernelRoutine(PKAPC Apc, PKNORMAL_ROUTINE* NormalRoutine, PVOID *SysArg1, PVOID *SysArg2, PVOID *Context)
{
	ExFreePool(Apc);
	return;
}

NTSTATUS DllInject(HANDLE ProcessId, PEPROCESS Peprocess, PETHREAD Pethread, BOOLEAN Alert)
{
	HANDLE hProcess;
	OBJECT_ATTRIBUTES oa = { sizeof(OBJECT_ATTRIBUTES) };
	CLIENT_ID cidprocess = { 0 };
	CHAR DllFormatPath[] = "C:\\MyDLL.dll";
	ULONG Size = strlen(DllFormatPath) + 1;
	PVOID pvMemory = NULL;

	cidprocess.UniqueProcess = ProcessId;
	cidprocess.UniqueThread = 0;
	if (NT_SUCCESS(ZwOpenProcess(&hProcess, PROCESS_ALL_ACCESS, &oa, &cidprocess)))
	{
		if (NT_SUCCESS(ZwAllocateVirtualMemory(hProcess, &pvMemory, 0, &Size, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE)))
		{
			KAPC_STATE KasState;
			PKAPC Apc;

			KeStackAttachProcess(Peprocess, &KasState);
			strcpy(pvMemory, DllFormatPath);
			KeUnstackDetachProcess(&KasState);
			Apc = (PKAPC)ExAllocatePool(NonPagedPool, sizeof(KAPC));
			if (Apc)
			{
				KeInitializeApc(Apc, Pethread, 0, (PKKERNEL_ROUTINE)APCKernelRoutine, 0, (PKNORMAL_ROUTINE)Hash.pvLoadLibraryExA, UserMode, pvMemory);
				KeInsertQueueApc(Apc, 0, 0, IO_NO_INCREMENT);
				return STATUS_SUCCESS;
			}
		}
		ZwClose(hProcess);
	}

	return STATUS_NO_MEMORY;
}

VOID SirifefWorkerRoutine(PVOID Context)
{
	DllInject(((PSIRIFEF_INJECTION_DATA)Context)->ProcessId, ((PSIRIFEF_INJECTION_DATA)Context)->Process, ((PSIRIFEF_INJECTION_DATA)Context)->Ethread, FALSE);
	KeSetEvent(&((PSIRIFEF_INJECTION_DATA)Context)->Event, (KPRIORITY)0, FALSE);
	return;
}

VOID NTAPI APCInjectorRoutine(PKAPC Apc, PKNORMAL_ROUTINE *NormalRoutine, PVOID *SystemArgument1, PVOID *SystemArgument2, PVOID* Context)
{
	SIRIFEF_INJECTION_DATA Sf;

	RtlSecureZeroMemory(&Sf, sizeof(SIRIFEF_INJECTION_DATA));
	ExFreePool(Apc);
	Sf.Ethread = KeGetCurrentThread();
	Sf.Process = IoGetCurrentProcess();
	Sf.ProcessId = PsGetCurrentProcessId();
	KeInitializeEvent(&Sf.Event, NotificationEvent, FALSE);
	ExInitializeWorkItem(&Sf.WorkItem, (PWORKER_THREAD_ROUTINE)SirifefWorkerRoutine, &Sf);
	ExQueueWorkItem(&Sf.WorkItem, DelayedWorkQueue);
	KeWaitForSingleObject(&Sf.Event, Executive, KernelMode, TRUE, 0);
	return;
	
}

VOID LoadImageNotifyRoutine(IN PUNICODE_STRING ImageName,IN HANDLE ProcessId, IN PIMAGE_INFO pImageInfo)
{
	if (ImageName != NULL)
	{
		WCHAR kernel32Mask[] = L"*\\KERNEL32.DLL";
		UNICODE_STRING kernel32us;

		RtlInitUnicodeString(&kernel32us, kernel32Mask);
		if (FsRtlIsNameInExpression(&kernel32us, ImageName, TRUE, NULL))
		{
			PKAPC Apc;
			
			if (Hash.Kernel32dll == 0)
			{
				Hash.Kernel32dll = (PVOID)pImageInfo->ImageBase;
				Hash.pvLoadLibraryExA = (fnLoadLibraryExA)ResolveDynamicImport(Hash.Kernel32dll, SIRIFEF_LOADLIBRARYEXA_ADDRESS);
			}

			Apc = (PKAPC)ExAllocatePool(NonPagedPool, sizeof(KAPC));
			if (Apc)
			{
				KeInitializeApc(Apc, KeGetCurrentThread(), 0, (PKKERNEL_ROUTINE)APCInjectorRoutine, 0, 0, KernelMode, 0);
				KeInsertQueueApc(Apc, 0, 0, IO_NO_INCREMENT);
			}
		}
	}

	return;
}


VOID Unload(IN PDRIVER_OBJECT pDriverobject)
{
	PsRemoveLoadImageNotifyRoutine(&LoadImageNotifyRoutine);
}

NTSTATUS DriverEntry(IN PDRIVER_OBJECT pDriverobject, IN PUNICODE_STRING pRegister)
{
	NTSTATUS st;

	PsSetLoadImageNotifyRoutine(&LoadImageNotifyRoutine);

	pDriverobject->DriverUnload = (PDRIVER_UNLOAD)Unload;

	return STATUS_SUCCESS;
}
```

`Sirifef/Sirifef/Sf.h`:

```h
#pragma once

#include <ntddk.h>


#define SIRIFEF_LOADLIBRARYEXA_ADDRESS 1268416216


typedef PVOID(*fnLoadLibraryExA)(
	LPCSTR lpLibFileName,
	HANDLE hFile,
	ULONG  dwFlags
	);


typedef struct _SIRIFEF_INJECTION_DATA
{
	BOOLEAN Executing;
	PEPROCESS Process;
	PETHREAD Ethread;
	KEVENT Event;
	WORK_QUEUE_ITEM WorkItem;
	ULONG ProcessId;

}SIRIFEF_INJECTION_DATA, *PSIRIFEF_INJECTION_DATA;

typedef struct GET_ADDRESS
{
	PVOID Kernel32dll;
	fnLoadLibraryExA pvLoadLibraryExA;

}GET_ADDRESS, *PGET_ADDRESS;

extern PGET_ADDRESS GET_SIRIFEF_ADDRESS;

typedef enum _KAPC_ENVIRONMENT
{
	OriginalApcEnvironment,
	AttachedApcEnvironment,
	CurrentApcEnvironment,
	InsertApcEnvironment
}KAPC_ENVIRONMENT, *PKAPC_ENVIRONMENT;

typedef VOID(NTAPI *PKNORMAL_ROUTINE)(
	PVOID NormalContext,
	PVOID SystemArgument1,
	PVOID SystemArgument2
	);

typedef VOID KKERNEL_ROUTINE(
	PRKAPC Apc,
	PKNORMAL_ROUTINE *NormalRoutine,
	PVOID *NormalContext,
	PVOID *SystemArgument1,
	PVOID *SystemArgument2
	);

typedef KKERNEL_ROUTINE(NTAPI *PKKERNEL_ROUTINE);

typedef VOID(NTAPI *PKRUNDOWN_ROUTINE)(
	PRKAPC Apc
	);

void KeInitializeApc(
	PRKAPC Apc,
	PRKTHREAD Thread,
	KAPC_ENVIRONMENT Environment,
	PKKERNEL_ROUTINE KernelRoutine,
	PKRUNDOWN_ROUTINE RundownRoutine,
	PKNORMAL_ROUTINE NormalRoutine,
	KPROCESSOR_MODE ProcessorMode,
	PVOID NormalContext
	);

BOOLEAN KeInsertQueueApc(
	PRKAPC Apc,
	PVOID SystemArgument1,
	PVOID SystemArgument2,
	KPRIORITY Increment
	);


VOID Unload(IN PDRIVER_OBJECT pDriverobject);
NTSTATUS DriverEntry(IN PDRIVER_OBJECT pDriverobject, IN PUNICODE_STRING pRegister);
VOID NTAPI APCKernelRoutine(PKAPC Apc, PKNORMAL_ROUTINE* NormalRoutine, PVOID *SysArg1, PVOID *SysArg2, PVOID *Context);
NTSTATUS DllInject(HANDLE ProcessId, PEPROCESS Peprocess, PETHREAD Pethread, BOOLEAN Alert);
VOID LoadImageNotifyRoutine(IN PUNICODE_STRING ImageName, IN HANDLE ProcessId, IN PIMAGE_INFO pImageInfo);
VOID NTAPI APCInjectorRoutine(PKAPC Apc, PKNORMAL_ROUTINE *NormalRoutine, PVOID *SystemArgument1, PVOID *SystemArgument2, PVOID *Context);
VOID SirifefWorkerRoutine(PVOID Context);
UINT32 HashString(PCHAR pcString);
PVOID GetProcedureAddressByHash(PVOID ModuleBase, ULONG Hash, ULONG Data);
VOID NTAPI LoadDynamicFunctions(PGET_ADDRESS Hash);
PVOID ResolveDynamicImport(PVOID ModuleBase, ULONG Hash);

extern GET_ADDRESS Hash;
```

`Sirifef/Sirifef/Sirifef.inf`:

```inf
;
; Sirifef.inf
;

[Version]
Signature="$WINDOWS NT$"
Class=
ClassGuid=
Provider=
DriverVer=
CatalogFile=

[DestinationDirs]
DefaultDestDir = 12


[SourceDisksNames]
1 = %DiskName%,,,""

[SourceDisksFiles]


[Manufacturer]
%ManufacturerName%=Standard,NT$ARCH$

[Standard.NT$ARCH$]


[Strings]
ManufacturerName=""
ClassName=""
DiskName="Sirifef Source Disk"

```

`Sirifef/Sirifef/Sirifef.vcxproj`:

```vcxproj
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup Label="ProjectConfigurations">
    <ProjectConfiguration Include="Win8.1 Debug|Win32">
      <Configuration>Win8.1 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8.1 Release|Win32">
      <Configuration>Win8.1 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|Win32">
      <Configuration>Win8 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|Win32">
      <Configuration>Win8 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|Win32">
      <Configuration>Win7 Debug</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|Win32">
      <Configuration>Win7 Release</Configuration>
      <Platform>Win32</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8.1 Debug|x64">
      <Configuration>Win8.1 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8.1 Release|x64">
      <Configuration>Win8.1 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Debug|x64">
      <Configuration>Win8 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win8 Release|x64">
      <Configuration>Win8 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Debug|x64">
      <Configuration>Win7 Debug</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
    <ProjectConfiguration Include="Win7 Release|x64">
      <Configuration>Win7 Release</Configuration>
      <Platform>x64</Platform>
    </ProjectConfiguration>
  </ItemGroup>
  <PropertyGroup Label="Globals">
    <ProjectGuid>{D1ABCAB4-EB4C-442A-B20F-678130D185C9}</ProjectGuid>
    <TemplateGuid>{dd38f7fc-d7bd-488b-9242-7d8754cde80d}</TemplateGuid>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <MinimumVisualStudioVersion>11.0</MinimumVisualStudioVersion>
    <Configuration>Win8.1 Debug</Configuration>
    <Platform Condition="'$(Platform)' == ''">Win32</Platform>
    <RootNamespace>Sirifef</RootNamespace>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|Win32'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|Win32'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|x64'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|x64'" Label="Configuration">
    <TargetVersion>WindowsV6.3</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|x64'" Label="Configuration">
    <TargetVersion>Windows8</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>true</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'" Label="Configuration">
    <TargetVersion>Windows7</TargetVersion>
    <UseDebugLibraries>false</UseDebugLibraries>
    <PlatformToolset>WindowsKernelModeDriver8.1</PlatformToolset>
    <ConfigurationType>Driver</ConfigurationType>
    <DriverType>WDM</DriverType>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionSettings">
  </ImportGroup>
  <ImportGroup Label="PropertySheets">
    <Import Project="$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props" Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" Label="LocalAppDataPlatform" />
  </ImportGroup>
  <PropertyGroup Label="UserMacros" />
  <PropertyGroup />
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <OutDir>$(SolutionDir)bin\</OutDir>
    <IntDir>bin\</IntDir>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
    <OutDir>$(SolutionDir)bin\</OutDir>
    <IntDir>bin\</IntDir>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8.1 Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win8 Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|x64'">
    <DebuggerFlavor>DbgengKernelDebugger</DebuggerFlavor>
  </PropertyGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Release|Win32'">
    <ClCompile>
      <WarningLevel>TurnOffAllWarnings</WarningLevel>
    </ClCompile>
    <Link>
      <EntryPointSymbol>DriverEntry</EntryPointSymbol>
    </Link>
  </ItemDefinitionGroup>
  <ItemDefinitionGroup Condition="'$(Configuration)|$(Platform)'=='Win7 Debug|Win32'">
    <ClCompile>
      <WarningLevel>TurnOffAllWarnings</WarningLevel>
    </ClCompile>
  </ItemDefinitionGroup>
  <ItemGroup>
    <Inf Include="Sirifef.inf" />
  </ItemGroup>
  <ItemGroup>
    <FilesToPackage Include="$(TargetPath)" />
    <FilesToPackage Include="@(Inf->'%(CopyOutput)')" Condition="'@(Inf)'!=''" />
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="Sf.c" />
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Sf.h" />
  </ItemGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
  <ImportGroup Label="ExtensionTargets">
  </ImportGroup>
</Project>
```

`Sirifef/Sirifef/Sirifef.vcxproj.filters`:

```filters
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <Filter Include="Source Files">
      <UniqueIdentifier>{4FC737F1-C7A5-4376-A066-2A32D752A2FF}</UniqueIdentifier>
      <Extensions>cpp;c;cc;cxx;def;odl;idl;hpj;bat;asm;asmx</Extensions>
    </Filter>
    <Filter Include="Header Files">
      <UniqueIdentifier>{93995380-89BD-4b04-88EB-625FBE52EBFB}</UniqueIdentifier>
      <Extensions>h;hpp;hxx;hm;inl;inc;xsd</Extensions>
    </Filter>
    <Filter Include="Resource Files">
      <UniqueIdentifier>{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}</UniqueIdentifier>
      <Extensions>rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav;mfcribbon-ms</Extensions>
    </Filter>
    <Filter Include="Driver Files">
      <UniqueIdentifier>{8E41214B-6785-4CFE-B992-037D68949A14}</UniqueIdentifier>
      <Extensions>inf;inv;inx;mof;mc;</Extensions>
    </Filter>
  </ItemGroup>
  <ItemGroup>
    <Inf Include="Sirifef.inf">
      <Filter>Driver Files</Filter>
    </Inf>
  </ItemGroup>
  <ItemGroup>
    <ClCompile Include="Sf.c">
      <Filter>Source Files</Filter>
    </ClCompile>
  </ItemGroup>
  <ItemGroup>
    <ClInclude Include="Sf.h">
      <Filter>Header Files</Filter>
    </ClInclude>
  </ItemGroup>
</Project>
```